"2023-11-15 15:36:27.747 [Thread-692] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id b4991061-7804-4233-a15d-ff9981e6b0be has started processing message with message_id 048ac17e-3102-44d9-ae34-ad001d0dc813 and thread_id 867 
""2023-11-15 15:36:27.760 [Thread-692] INFO  com.modak.utils.logging.LoggingTemplateUtitlity - 2023-11-15 15:36:27.75 Task start data_movement_flow_queries of process_id 1700062586993189 of bot DBOpsBot  with id b4991061-7804-4233-a15d-ff9981e6b0be
""2023-11-15 15:36:27.760 [Thread-692] INFO  com.modak.utils.logging.FileLogger - ../logs/logger_output.log
""2023-11-15 15:36:27.760 [Thread-692] DEBUG com.modak.utils.logging.FileLogger - Log file executed 2023-11-15 15:36:27.75 Task start data_movement_flow_queries of process_id 1700062586993189 of bot DBOpsBot  with id b4991061-7804-4233-a15d-ff9981e6b0be 
""2023-11-15 15:36:27.760 [Thread-692] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=e035080f-88d6-4fdb-a318-a1ad0f1a8cc9, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=data_movement_initial_flow_queries, message_id=048ac17e-3102-44d9-ae34-ad001d0dc813, task_retry_intervals_secs=[], bot_id=e035080f-88d6-4fdb-a318-a1ad0f1a8cc9, message_topic=nabu_2_jdbc, tags={process_id=1700062586993189, initial_ts=1700062586993, batch_name=Ingestion_20231115, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, generated_ts=1700062586993, task_dependency=true, tags=[AuthToken]}}
""2023-11-15 15:36:27.792 [Thread-692] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
select dm.data_movement_id, case when jsd.job_type_id = 6 then true else false end as manual_retry, coalesce(data_movement_additional_info->'flow_details'->>'retry',data_movement_additional_info->'flow_details'->>'pipeline_retry','false') :: boolean as pipeline_retry, coalesce(data_movement_additional_info->'flow_details'->'pre_conditions'->>'enabled','false') :: boolean as pipeline_pre_conditions_enabled, coalesce(data_movement_additional_info->'flow_details'->>'ignore_null_tables','false') :: boolean as ignore_null_tables_flag from nabu.data_movement_physical dm inner join nabu.job_schedule_details jsd on jsd.data_movement_id =dm.data_movement_id where jsd.valid_to_ts ='9999-12-31' and dm.valid_to_ts = '9999-12-31' and dm.data_movement_id=261 and jsd.job_schedule_id=1567
""2023-11-15 15:36:27.804 [Thread-692] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 15:36:27.805 [Thread-692] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:36:27.810 [Thread-692] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:36:27.811 [Thread-692] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id b4991061-7804-4233-a15d-ff9981e6b0be has started process logic with message_id 048ac17e-3102-44d9-ae34-ad001d0dc813 and thread_id 867
""2023-11-15 15:36:27.829 [Thread-352] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 486afeb4-6773-4602-858d-8923a464a6b8 has started processing message with message_id 1b0ea5e9-df75-4b53-a742-d2a949e1b6d8 and thread_id 470 
""2023-11-15 15:36:27.973 [Thread-352] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:27.973 [Thread-352] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=048ac17e-3102-44d9-ae34-ad001d0dc813, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=1b0ea5e9-df75-4b53-a742-d2a949e1b6d8, task_retry_intervals_secs=[], bot_id=b4991061-7804-4233-a15d-ff9981e6b0be, message_topic=nabu_2_taskmonitor, tags={process_id=1700062586993189, initial_ts=1700062586993, batch_name=Ingestion_20231115, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, ignore_job_termination=true, tags=[AuthToken, TaskMonitorBot]}}
""2023-11-15 15:36:27.984 [Thread-352] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 1700062586993189, 'DBOpsBot', 'data_movement_initial_flow_queries', 'data_movement_flow_queries', 10 , TO_TIMESTAMP(1700062587750::double precision / 1000) ,'b4991061-7804-4233-a15d-ff9981e6b0be');
""2023-11-15 15:36:27.984 [Thread-352] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 486afeb4-6773-4602-858d-8923a464a6b8 has started process logic with message_id 1b0ea5e9-df75-4b53-a742-d2a949e1b6d8 and thread_id 470
""2023-11-15 15:36:28.348 [Thread-352] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 486afeb4-6773-4602-858d-8923a464a6b8 has finished process logic with message_id 1b0ea5e9-df75-4b53-a742-d2a949e1b6d8 and thread_id 470
""2023-11-15 15:36:28.348 [Thread-352] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:28.348 [Thread-352] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 1b0ea5e9-df75-4b53-a742-d2a949e1b6d8
""2023-11-15 15:36:28.820 [Thread-692] DEBUG com.modak.bots.DBOpsBot - to execute query timeTakenInMillis : 1009
""2023-11-15 15:36:28.934 [Thread-692] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id b4991061-7804-4233-a15d-ff9981e6b0be has finished process logic with message_id 048ac17e-3102-44d9-ae34-ad001d0dc813 and thread_id 867
""2023-11-15 15:36:28.934 [Thread-692] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : true
""2023-11-15 15:36:28.934 [Thread-692] INFO  com.modak.bots.basebot.AbstractBaseBot -  skipBotLogic == false && useIncomingData == true ..,so both inputData map and botLogic output map is send as output message
""2023-11-15 15:36:28.934 [Thread-692] INFO  com.modak.bots.basebot.AbstractBaseBot - botLogicOutput : { "outputList" : [ { "data_movement_id" : 261, "manual_retry" : false, "pipeline_retry" : false, "pipeline_pre_conditions_enabled" : false, "ignore_null_tables_flag" : false } ] }
""2023-11-15 15:36:28.964 [Thread-692] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "DBOpsBot", "bot_metadata": { "message_topic": "nabu_2_jdbc", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "message_id": "d87ea871-a925-4c04-8723-76f8c1058f2c", "bot_id": "e035080f-88d6-4fdb-a318-a1ad0f1a8cc9", "parent_id": "e035080f-88d6-4fdb-a318-a1ad0f1a8cc9", "tags": { "process_id": 1700062586993189, "initial_ts": 1700062586993, "generated_ts": 1700062586993, "batch_id":17000625866627691, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "environment": "modak", "tags": [ "AuthToken", ], "job_schedule_id":1567, "task_dependency": true, "retry_attempt": 0 }, "task_retry_intervals_secs": [ ], "message_context": "starting_message_for_ingestion" }, "bot_tasks": [ { "task_name": "checking_pre_conditions_or_starting_msg_of_ingestion", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "skipLogicPattern": "doNothing", "pre_task_logging_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "pre_log_template" }, "app_template_details": { "template_group": "templates/artifact_ingestion/ingestion_fc.stg", "template_name": "data_movement_queries" }, "input_data": { "template_execution_type": "sequential", "useTransactionControl":false, "query_input": { "bot_topic_prefix" : "nabu_", "workflow_engine_id" : 2, "batch_id": 17000625866627691, "process_id": 1700062586993189, "batch_name": "Ingestion_20231115", "data_movement_id":261, "environment": "modak", "pipeline_retry": false, "ignore_null_tables_flag":false, "include_blobs": "", "manual_retry":false, "job_schedule_id":1567, "job_scheduled_user_id":"Manaswini Chinthalapudi", "job_type": "ingestion", "destination_type":"", "workflow_route_bot_topic_details" : {"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"} } }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/ingestion_fc.stg", "template_name": "data_movement_deciding_msg" }, { "template_group": "templates/artifact_ingestion/ingestion_flow.stg", "template_name": "task_status_success_msg" } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "error_template_create_msg" } ] } ] }
""2023-11-15 15:36:28.965 [Thread-692] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_jdbc
""2023-11-15 15:36:28.968 [Thread-692] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_jdbc
""2023-11-15 15:36:28.969 [Thread-692] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-15 15:36:28.978 [Thread-692] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "b8101be1-d80d-49eb-9634-63153d105f91", "parent_id": "048ac17e-3102-44d9-ae34-ad001d0dc813", "bot_id": "b4991061-7804-4233-a15d-ff9981e6b0be", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":1700062586993189, "initial_ts":1700062586993, "batch_id":17000625866627691, "batch_name":"Ingestion_20231115", "job_schedule_id":1567, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "", "environment": "modak", "ignore_job_termination" : true, "tags": ["AuthToken", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"b4991061-7804-4233-a15d-ff9981e6b0be", "bot_name":"DBOpsBot", "process_context":"data_movement_initial_flow_queries", "task_name":"data_movement_flow_queries", "process_id":"1700062586993189", "task_ts":1700062588934, "batch_id":"17000625866627691", "status_code_id": 6 } } ] }
""2023-11-15 15:36:28.979 [Thread-692] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:36:28.995 [Thread-692] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:36:28.998 [Thread-1965] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 0b7cd6db-90a2-40e7-8778-af8e103dca31 has started processing message with message_id b8101be1-d80d-49eb-9634-63153d105f91 and thread_id 2402 
""2023-11-15 15:36:28.999 [Thread-1965] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:28.999 [Thread-1965] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=048ac17e-3102-44d9-ae34-ad001d0dc813, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=b8101be1-d80d-49eb-9634-63153d105f91, task_retry_intervals_secs=[], bot_id=b4991061-7804-4233-a15d-ff9981e6b0be, message_topic=nabu_2_taskmonitor, tags={process_id=1700062586993189, initial_ts=1700062586993, batch_name=Ingestion_20231115, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, ignore_job_termination=true, tags=[AuthToken, TaskMonitorBot]}}
""2023-11-15 15:36:29.004 [Thread-692] INFO  com.modak.utils.logging.LoggingTemplateUtitlity - 2023-11-15 15:36:28.995 Task end data_movement_flow_queries of process_id 1700062586993189 of bot DBOpsBot  with id b4991061-7804-4233-a15d-ff9981e6b0be
""2023-11-15 15:36:29.005 [Thread-692] INFO  com.modak.utils.logging.FileLogger - ../logs/logger_output.log
""2023-11-15 15:36:29.005 [Thread-692] DEBUG com.modak.utils.logging.FileLogger - Log file executed 2023-11-15 15:36:28.995 Task end data_movement_flow_queries of process_id 1700062586993189 of bot DBOpsBot  with id b4991061-7804-4233-a15d-ff9981e6b0be 
""2023-11-15 15:36:29.005 [Thread-692] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot finished processing message with id 048ac17e-3102-44d9-ae34-ad001d0dc813
""2023-11-15 15:36:29.012 [Thread-1965] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 1700062586993189, 'DBOpsBot', 'data_movement_initial_flow_queries', 'data_movement_flow_queries', 6 , TO_TIMESTAMP(1700062588934::double precision / 1000) ,'b4991061-7804-4233-a15d-ff9981e6b0be');
""2023-11-15 15:36:29.012 [Thread-1965] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 0b7cd6db-90a2-40e7-8778-af8e103dca31 has started process logic with message_id b8101be1-d80d-49eb-9634-63153d105f91 and thread_id 2402
""2023-11-15 15:36:29.018 [Thread-1965] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 0b7cd6db-90a2-40e7-8778-af8e103dca31 has finished process logic with message_id b8101be1-d80d-49eb-9634-63153d105f91 and thread_id 2402
""2023-11-15 15:36:29.018 [Thread-1965] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:29.018 [Thread-1965] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id b8101be1-d80d-49eb-9634-63153d105f91
""2023-11-15 15:36:29.036 [Thread-588] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 942cd0aa-e1f3-4ce0-a8b7-25fc58d2f938 has started processing message with message_id d87ea871-a925-4c04-8723-76f8c1058f2c and thread_id 745 
""2023-11-15 15:36:29.036 [Thread-588] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:29.036 [Thread-588] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, parent_id=e035080f-88d6-4fdb-a318-a1ad0f1a8cc9, message_context=starting_message_for_ingestion, message_id=d87ea871-a925-4c04-8723-76f8c1058f2c, task_retry_intervals_secs=[], message_topic=nabu_2_jdbc, bot_id=e035080f-88d6-4fdb-a318-a1ad0f1a8cc9, tags={process_id=1700062586993189, initial_ts=1700062586993, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, generated_ts=1700062586993, task_dependency=true, retry_attempt=0, tags=[AuthToken]}}
""2023-11-15 15:36:29.081 [Thread-588] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
{ "input_data": { "batch_id": 17000625866627691, "process_id": 1700062586993189, "batch_name": "Ingestion_20231115", "data_movement_id":261, "environment": "modak", "pipeline_retry": false, "ignore_null_tables_flag": false, "include_blobs": "", "destination_type":"", "job_type":"ingestion", "manual_retry":false, "job_schedule_id":1567, "job_scheduled_user_id":"Manaswini Chinthalapudi", "workflow_route_bot_topic_details" : {"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"} }, "sequential_templates":[ { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "fetch_source_metadata_category", "query_output_key": "source_metadata_category", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "fetch_data_movement_info", "query_output_key": "data_movement_info", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "schema_drift_object_info", "query_output_key": "schema_drift_table_info", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "fetch_job_type_id", "query_output_key": "job_type_id", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "check_if_selected_schemas_are_empty", "query_output_key": "check_if_selected_schemas_are_empty", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "get_deleted_objects", "query_output_key": "get_deleted_objects", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "get_schema_drift_ignore_tables", "query_output_key": "get_schema_drift_ignore_tables", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "insert_schema_drift_ignore_tables", "query_output_key": "insert_schema_drift_ignore_tables", "query_type":"insert" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "advanced_options_mapping_details", "query_output_key": "advanced_options_mapping_details", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "insert_data_movement_schema_drift_table", "query_output_key": "insert_data_movement_schema_drift_table", "query_type":"insert" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "get_datatype_ignore_tables", "query_output_key": "get_datatype_ignore_tables", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "insert_datatype_ignore_tables", "query_output_key": "insert_datatype_ignore_tables", "query_type":"insert" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "fetch_pipeline_data", "query_output_key": "fetch_pipeline_data", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "get_jwt_details", "query_output_key": "get_jwt_details", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "ingestion_object_info", "query_output_key": "nabu_ingestion", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "email_input", "query_output_key": "email_input", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "rest_api_input", "query_output_key": "rest_api_input", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "condition_for_success_mail", "query_output_key": "condition_for_success_mail", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "condition_for_failure_mail", "query_output_key": "condition_for_failure_mail", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "condition_for_schema_drift_mail", "query_output_key": "condition_for_schema_drift_mail", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "get_rest_apis", "query_output_key": "get_rest_apis", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "flows_list_query", "query_output_key": "flows", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "get_batch_datamovement_id", "query_output_key": "get_batch_datamovement_id", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "flow_controller_timeout", "query_output_key": "flow_controller_timeout", "query_type":"select" } ], "output_keys":["flows","schema_drift_table_info","get_schema_drift_ignore_tables","get_datatype_ignore_tables","get_batch_datamovement_id","nabu_ingestion","email_input","rest_api_input","condition_for_schema_drift_mail","condition_for_success_mail","condition_for_failure_mail","flow_controller_timeout","get_deleted_objects","source_metadata_category","get_jwt_details", "get_ignore_null_tables","check_if_selected_schemas_are_empty"] }
""2023-11-15 15:36:29.093 [Thread-588] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 15:36:29.094 [Thread-588] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:36:29.100 [Thread-588] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:36:29.100 [Thread-588] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 942cd0aa-e1f3-4ce0-a8b7-25fc58d2f938 has started process logic with message_id d87ea871-a925-4c04-8723-76f8c1058f2c and thread_id 745
""2023-11-15 15:36:29.146 [Thread-2061] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id fcbc16aa-d9de-4d67-90e8-a0c8ef4447e2 has started processing message with message_id 6d43cf0d-c05e-4131-990c-2409838bdc40 and thread_id 2514 
""2023-11-15 15:36:29.146 [Thread-2061] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:29.146 [Thread-2061] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=d87ea871-a925-4c04-8723-76f8c1058f2c, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=6d43cf0d-c05e-4131-990c-2409838bdc40, task_retry_intervals_secs=[], bot_id=942cd0aa-e1f3-4ce0-a8b7-25fc58d2f938, message_topic=nabu_2_taskmonitor, tags={process_id=1700062586993189, initial_ts=1700062586993, batch_name=, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, TaskMonitorBot]}}
""2023-11-15 15:36:29.147 [Thread-588] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select distinct dm.data_movement_id,dcml.metadata_category as source_type, dscl.dataplace_sub_component_type as source from nabu.data_movement_details_physical dm inner join nabu.dataplace_physical dp on dp.dataplace_id=dm.source_dataplace_id
inner join  nabu.dataplace_component_mapping_lookup dcml on dcml.dataplace_sub_component_id =dp.dataplace_sub_component_id
inner join nabu.dataplace_sub_component_lookup dscl on dcml.dataplace_sub_component_id =dscl.dataplace_sub_component_id
where dm.data_movement_id=261 and dp.valid_to_ts='9999-12-31 00:00:00' and dm.valid_to_ts ='9999-12-31 00:00:00'
""2023-11-15 15:36:29.643 [Thread-588] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select  string_agg('('||where_condition||')',' or ') as where_condition,string_agg('('||table_id_where_condition||')',' or ') as table_id_where_condition,workflow_name,schema_drift_option, schema_drift_option_id
from(
select  data_movement_id,source_dataplace_id,source_schema_id,
case when where_condition is null then 'schema_id = '|| source_schema_id || ' and table_type in ('||ingest_all_tables_views||')'||' and dataplace_id = '||source_dataplace_id
          else string_agg('('||where_condition||')',' and ') over(partition by data_movement_id,source_dataplace_id,source_schema_id) || ' and schema_id = ' || source_schema_id || ' and table_type in ('||ingest_all_tables_views||')'||' and dataplace_id = '||source_dataplace_id end as where_condition,
case when where_condition is null then 'schema_id = '|| source_schema_id ||' and dataplace_id = '||source_dataplace_id
          else string_agg('('||where_condition||')',' and ') over(partition by data_movement_id,source_dataplace_id,source_schema_id) || ' and schema_id = ' || source_schema_id || ' and dataplace_id = '||source_dataplace_id end as table_id_where_condition,
ingest_all_tables_views,workflow_name,schema_drift_option, schema_drift_option_id
from(
select  data_movement_id,source_dataplace_id,source_schema_id,
string_agg('('||where_condition||')',' and ') over(partition by data_movement_id,source_dataplace_id,filter_type_id,source_schema_id) as where_condition,
ingest_all_tables_views,workflow_name,schema_drift_option, schema_drift_option_id
from (
select a.data_movement_id, a.source_dataplace_id, a.source_schema_id, a.filter_type_id,workflow_name,
case when a.filter_type_id = 1 then 'table_name ~* '''||regexp_replace(a.filter_rule::text,'\[|\]|"'::text,''::text,'g')||''''
     when a.filter_type_id = 2 then 'table_name !~* '''||regexp_replace(a.filter_rule::text,'\[|\]|"'::text,''::text,'g')||''''
     when a.filter_type_id = 3 then 'table_name like ''%'||regexp_replace(a.filter_rule::text,'\[|\]|"'::text,''::text,'g')||'%'''
     when a.filter_type_id = 4 then 'table_name not like ''%'||regexp_replace(a.filter_rule::text,'\[|\]|"'::text,''::text,'g')||'%'''
     when a.filter_type_id = 5 then 'table_id in ('||regexp_replace(a.filter_rule::text,'\[|\]|"'::text,''::text,'g')||')'
     else null
     end as where_condition,
     regexp_replace(regexp_replace(a.ingest_all_tables_views::text,'"','''','g'),'\[|\]|'::text,''::text,'g') as ingest_all_tables_views,schema_drift_option, schema_drift_option_id
from
(
select b.data_movement_id,source_dataplace_id,
source_schema_directory_id as source_schema_id,destination_dataplace_id,destination_schema_directory_id as destination_schema_id,
filter_rule,filter_type_id,
ingest_all_tables_views,a.priority_order,d.workflow_name,
case when ((((data_movement_additional_info->>'flow_details')::json->>'schema_drift')::json)->>'advanced_options_sub_type') is null then 'drop_create_table' else ((((data_movement_additional_info->>'flow_details')::json->>'schema_drift')::json)->>'advanced_options_sub_type') end as schema_drift_option,
((((data_movement_additional_info->>'flow_details')::json->>'schema_drift')::json)->>'advanced_options_sub_type_id')::int as schema_drift_option_id
from nabu.data_movement_details_physical a
inner join nabu.dataplace_physical dp
on a.destination_dataplace_id =dp.dataplace_id
inner join nabu.data_movement_physical b
on a.data_movement_id = b.data_movement_id
inner join nabu.workflow_engine c on c.workflow_engine_id = b.workflow_engine_id
inner join nabu.bot_configuration_workflow d on d.workflow_id = b.workflow_id
where b.data_movement_id = 261 and a.valid_to_ts = '9999-12-31'
and b.valid_to_ts = '9999-12-31') a
inner join nabu.filter_type_lookup b
on a.filter_type_id = b.filter_type_id
order by data_movement_id,priority_order
) x
) y
) z
group by data_movement_id,workflow_name,schema_drift_option, schema_drift_option_id

""2023-11-15 15:36:29.663 [Thread-2061] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 1700062586993189, 'DBOpsBot', 'starting_message_for_ingestion', 'checking_pre_conditions_or_starting_msg_of_ingestion', 10 , TO_TIMESTAMP(1700062589036::double precision / 1000) ,'942cd0aa-e1f3-4ce0-a8b7-25fc58d2f938');
""2023-11-15 15:36:29.664 [Thread-2061] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id fcbc16aa-d9de-4d67-90e8-a0c8ef4447e2 has started process logic with message_id 6d43cf0d-c05e-4131-990c-2409838bdc40 and thread_id 2514
""2023-11-15 15:36:29.779 [Thread-2061] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id fcbc16aa-d9de-4d67-90e8-a0c8ef4447e2 has finished process logic with message_id 6d43cf0d-c05e-4131-990c-2409838bdc40 and thread_id 2514
""2023-11-15 15:36:29.780 [Thread-2061] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:29.780 [Thread-2061] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 6d43cf0d-c05e-4131-990c-2409838bdc40
""2023-11-15 15:36:29.827 [Thread-588] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with data_movement_schema_drift_table_ids as(
select * from(
select data_movement_id, dataplace_id, schema_directory_id, object_id, cru_ts, row_number() over(partition by object_id order by cru_ts desc) as rownum
from nabu.data_movement_schema_drift_details
where data_movement_id = 261) a
where rownum = 1
),
get_table_ids as (
select table_id from nabu.dataplace_table_metadata_physical dtmp where ((((table_id in (37234))) and schema_id = 453 and table_type in ('T','V','M') and dataplace_id = 42)) and valid_to_ts = '9999-12-31'
),
get_non_schema_drifted_table_ids as(
select a.dataplace_id,a.schema_id, a.dataplace_component_type_id,a.table_id
from nabu.dataplace_table_schema_drift_details a
inner join
data_movement_schema_drift_table_ids b
on a.table_id = b.object_id
and a.schema_id = b.schema_directory_id
and a.dataplace_id = b.dataplace_id
where a.valid_to_ts = '9999-12-31'
and a.crt_ts < b.cru_ts
and b.data_movement_id = 261
union all
select a.dataplace_id,a.schema_id, a.dataplace_component_type_id,a.table_id
from nabu.dataplace_table_schema_drift_details a
inner join
nabu.structured_jobtotable b
on a.table_id = b.object_id
and a.dataplace_id = b.dataplace_id
where b.data_movement_id = 261
and b.object_type = 'S'
and a.valid_to_ts = '9999-12-31'
and b.cru_ts > a.crt_ts
union all
select a.dataplace_id,a.schema_id, a.dataplace_component_type_id,a.table_id
from nabu.dataplace_table_schema_drift_details a
where table_id in(select * from get_table_ids)
and a.valid_to_ts = '9999-12-31'
and table_id not in (select object_id as table_id from nabu.structured_jobtotable b
where b.data_movement_id = 261 and b.object_type = 'S'
)
)
select string_agg(a.table_id::text,',') as schema_drifted_table_id_list from nabu.dataplace_table_schema_drift_details a
where table_id in (select table_id from get_table_ids)
and a.valid_to_ts = '9999-12-31'
and table_id not in (select table_id from get_non_schema_drifted_table_ids)
""2023-11-15 15:36:30.409 [Thread-588] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select job_type_id from nabu.job_type_lookup where job_type='ingestion'
""2023-11-15 15:36:30.452 [Thread-588] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select case count(*) when 0 then true else false end as empty_schma from nabu.dataplace_table_metadata_physical where ((((table_id in (37234))) and schema_id = 453 and table_type in ('T','V','M') and dataplace_id = 42))
""2023-11-15 15:36:30.492 [Thread-588] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with get_table_ids as(
select row_number()over(partition by table_id order by valid_to_ts desc) as rownum,* from nabu.dataplace_table_metadata_physical
where ((((table_id in (37234))) and schema_id = 453 and table_type in ('T','V','M') and dataplace_id = 42))
)
select string_agg(a.table_id::text,',') as object_id from get_table_ids a where rownum =1 and valid_to_ts != '9999-12-31'
""2023-11-15 15:36:30.531 [Thread-588] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with cte2 as(
select rows/1 as flow_number,*
from (
select row_number()over(order by table_id) as rows,* from nabu.dataplace_table_metadata_physical
where ((((table_id in (37234))) and schema_id = 453 and table_type in ('T','V','M') and dataplace_id = 42)) and valid_to_ts='9999-12-31'
)a
),
get_schema_drifted_table_ids as(
select a.dataplace_id,a.schema_id, a.schema_name, a.dataplace_component_type_id,a.table_id
from nabu.table_schema_drift a
where 1 = 0
),
table_ids_for_ingestion as(
select a.* from cte2 a left outer join get_schema_drifted_table_ids b
on a.table_id = b.table_id
and a.schema_id = b.schema_id
and a.schema_name = b.schema_name
and a.dataplace_id = b.dataplace_id
and a.dataplace_component_type_id = b.dataplace_component_type_id
where b.table_id is not null)

select string_agg(a.table_id::text,',') as object_id,
30 as status_code_id,
0 as retry_count
from table_ids_for_ingestion a
""2023-11-15 15:36:30.565 [Thread-588] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : INSERT INTO nabu.flow_task_status
(data_movement_id,  batch_id,job_type_id, status_code_id, retry_count,object_id,process_id, flow_task_ts, flow_task_date)
with cte as (
select 261 as data_movement_id ,  17000625866627691 as batch_id ,1 as job_type_id,30 as status_code_id,0 as retry_count,
unnest(string_to_array('',',' ))::int4 as object_id
)
select a.data_movement_id,a.batch_id,a.job_type_id,a.status_code_id,a.retry_count,a.object_id,('1700062586993189'||a.flow_number) :: bigint as process_id,current_timestamp,current_date from (select cte.*,row_number ()over( order by cte.object_id )as flow_number from cte)a

""2023-11-15 15:36:30.598 [Thread-588] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query :     select case when ((((data_movement_additional_info->>'flow_details')::json->>'schema_drift')::json)->>'advanced_options_sub_type') is null then 'drop_create_table'
else ((((data_movement_additional_info->>'flow_details')::json->>'schema_drift')::json)->>'advanced_options_sub_type') end as schema_drift_option,
case when ((((data_movement_additional_info->>'flow_details')::json->>'schema_drift')::json)->>'advanced_options_sub_type_id') is null then '3'
else ((((data_movement_additional_info->>'flow_details')::json->>'schema_drift')::json)->>'advanced_options_sub_type_id') end as schema_drift_option_id
,data_movement_id
from nabu.data_movement_physical
where data_movement_id = 261
and valid_to_ts = '9999-12-31'
""2023-11-15 15:36:30.635 [Thread-588] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with process_id_for_ignore_tables as(select * from nabu.flow_task_status
where status_code_id= 30
and batch_id = 17000625866627691)

INSERT INTO nabu.data_movement_schema_drift_details
(data_movement_id, dataplace_id, schema_directory_id, object_id, advanced_options_sub_type_id, advanced_options_sub_type, cru_by, cru_ts, batch_id, process_id)
select 261 as data_movement_id, a.dataplace_id, a.schema_id as schema_directory_id, a.table_id as object_id,
4 as advanced_options_sub_type_id,
'drop_create_table' as advanced_options_sub_type, 'Modak', now(),
b.batch_id, b.process_id
from nabu.dataplace_table_schema_drift_details a
inner join process_id_for_ignore_tables b
on a.table_id = b.object_id
where 1 = 0

""2023-11-15 15:36:30.679 [Thread-588] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with datatypes_to_be_ignored as (
 select replace((json_array_elements(data_movement_additional_info->'flow_details'->'ignore_data_types'))::text,'"','') as ignore_data_types
 from nabu.data_movement_physical
 where data_movement_id =261 and valid_to_ts='9999-12-31'
 union
 select source_datatype_name as ignore_data_types from nabu.user_defined_trans_for_unsupported_datatype udtfud where advanced_options_sub_type_id =16 and
	data_movement_id =261 and valid_to_ts='9999-12-31'
),
get_table_ids as(
select table_id from nabu.dataplace_table_metadata_physical dtmp where ((((table_id in (37234))) and schema_id = 453 and table_type in ('T','V','M') and dataplace_id = 42)) and valid_to_ts='9999-12-31'
),
tables_with_valid_column_data_types as (
select table_id, count(*) as cnt
from nabu.dataplace_column_metadata_physical
where table_id in(select * from get_table_ids) and valid_to_ts='9999-12-31'
and data_type not in ( select * from datatypes_to_be_ignored ) group by table_id
),
datatype_ignored_tables as (
select a.table_id, case when b.cnt is null then true when b.cnt is not null then false end as ignore_status_flag
from get_table_ids a
left outer join tables_with_valid_column_data_types b on a.table_id = b.table_id
),
ignored_tables_in_pipeline_adv_opt as(
Select * from datatype_ignored_tables where table_id not in (select object_id from nabu.advanced_options_object_details aood where data_movement_id = 261  and valid_to_ts = '9999-12-31')
)
select string_agg(a.table_id::text,',') as object_id,
 31 as status_code_id,
 0 as retry_count
 from ignored_tables_in_pipeline_adv_opt a where ignore_status_flag=true
""2023-11-15 15:36:30.849 [Thread-588] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : INSERT INTO nabu.flow_task_status
(data_movement_id,batch_id,job_type_id, status_code_id, retry_count,object_id,process_id, flow_task_ts, flow_task_date)
with cte as (
select 261 as data_movement_id , 17000625866627691 as batch_id ,1 as job_type_id,31 as status_code_id,0 as retry_count,
unnest(string_to_array('',',' ))::int4 as object_id
)
select a.data_movement_id,a.batch_id,a.job_type_id,a.status_code_id,a.retry_count,a.object_id,('1700062586993189'||a.flow_number) :: bigint as process_id,current_timestamp,current_date from (select cte.*,row_number ()over( order by cte.object_id )as flow_number from cte)a

""2023-11-15 15:36:30.885 [Thread-588] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select
data_movement_additional_info->'flow_details'->'schema_drift'->'config'->>'suffix' as suffix,
case when ((data_movement_additional_info->>'ingestion_table_format')::json->>'prefix')::boolean
then (data_movement_additional_info->>'ingestion_table_format')::json->>'prefix_value' || '_'
else '' end as ingestion_table_format,
'17000625866627691' as batch_id,(data_movement_additional_info->>'target_relative_path') as relative_file_path,
case when (data_movement_additional_info->>'target_relative_path'='') then false
when ((data_movement_additional_info->>'overwrite_default_relative_path')::varchar='true')then true
 else false end as is_relative_file_path,
data_movement_name
from nabu.data_movement_physical
where
data_movement_id =261
and
valid_to_ts ='9999-12-31'
""2023-11-15 15:36:30.925 [Thread-588] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with cte1 as(select coalesce(data_movement_additional_info->'flow_details'->>'flow_timeout',data_movement_additional_info->'flow_details'->>'pipeline_flow_timeout')::int *3600000 as flow_timeout
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 261 and dmp.valid_to_ts = '9999-12-31' )
select ae.job_type,case when ct.flow_timeout is null then ae.jwt_ttl else flow_timeout end as jwt_ttl
from nabu.authtoken_expiration ae,cte1 as ct where job_type ='default'
""2023-11-15 15:36:30.958 [Thread-588] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with cte2 as(
select rows/1 as flow_number,*
from (
select row_number()over(order by table_id) as rows, table_id,schema_name, dataplace_id from nabu.dataplace_table_metadata_physical
where ((((table_id in (37234))) and schema_id = 453 and table_type in ('T','V','M') and dataplace_id = 42)) and valid_to_ts='9999-12-31'
)a
),
dataplace_details as(
select c.*,
case when (b.dataplace_sub_component_type='hive' or b.dataplace_sub_component_type='cloudera_hive')  then trim(((dataplace_info->>'jdbc_info')::json)->>'database_name')
when ((b.dataplace_sub_component_type = 'bigquery')) then dataplace_info->>'bucket_name'
else trim(dataplace_info->>'database_name') end as source_db
from nabu.dataplace_physical a, nabu.dataplace_sub_component_lookup b, cte2 c
where a.dataplace_sub_component_id = b.dataplace_sub_component_id
and a.dataplace_id = c.dataplace_id
),

get_last_run_timestamp as (
    select flow_task_ts, object_id, data_movement_id from (
    	select flow_task_ts, object_id, data_movement_id,
    	row_number() over( partition by data_movement_id, object_id order by flow_task_ts desc ) as rownum
    	from nabu.flow_task_status
    	where process_id in (
    				select process_id from (
    						select process_id, row_number() over( partition by data_movement_id, object_id order by flow_task_ts desc ) as rownum
    						from nabu.flow_task_status
    						where data_movement_id = 261
    						and object_id in ( select table_id from dataplace_details )
    						and status_code_id = 15
    				)a
    				where rownum = 1
    	)
    	and status_code_id = 19
    )b
    where rownum = 1 and data_movement_id = 261
)

select  17000625866627691 as batch_id,
       'Ingestion_20231115' as batch_name,
       261 as data_movement_id,
       '' as relative_file_path,
       '' as ingestion_table_format,
       '' as suffix,
	  false as is_relative_file_path,
	   lower(a.schema_name) as source_schema_name_lowercase,
	  lower(a.source_db) as source_database_name_lowercase,
	   a.schema_name as source_schema_name,
	  a.source_db as source_database_name,
	   upper(a.schema_name) as source_schema_name_uppercase,
	  upper(a.source_db) as source_database_name_uppercase,
	   'ss_compass_adb_validation' as data_movement_name,
       'modak' as environment,
       1 as job_type_id,
       '' as type,
       1567 as job_schedule_id,
       'Manaswini Chinthalapudi' as job_scheduled_user_id,
       case when b.flow_task_ts is null then '0001-01-01T00:00:00.103+02'::timestamp else b.flow_task_ts end as last_run_timestamp,
        '{
             "payload_variables": {
             }
         }'::json as variables,
        '{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}' :: json as workflow_route_bot_topic_details,
       'artifact_generation' as workflow_name,
       '1700062586993189'||flow_number :: text as process_id,
        table_id  as where_condition,flow_number
        from dataplace_details a
        left outer join get_last_run_timestamp b
        on a.table_id = b.object_id

""2023-11-15 15:36:30.993 [Thread-588] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select 17000625866627691 as batch_id,
       'Ingestion_20231115' as batch_name,
       261 as data_movement_id,
       1567 as job_schedule_id,
       'Manaswini Chinthalapudi' as job_scheduled_user_id,
       'artifact_generation' as workflow_name,
	   '1700062586993189'||workflow_engine_id :: text as process_id,
	   '{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}' :: json as workflow_route_bot_topic_details,
       'email_notification_enable' as flow_name,15 as job_type_id,
       'modak' as environment from nabu.data_movement_physical where data_movement_id = 261
""2023-11-15 15:36:31.027 [Thread-588] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select 17000625866627691 as batch_id,
       'Ingestion_20231115' as batch_name,
       261 as data_movement_id,
       1567 as job_schedule_id,
       data_movement_name,
       '2023-11-07 12:42:00.86365' as last_run_timestamp,
       'Manaswini Chinthalapudi' as job_scheduled_user_id,
       'artifact_generation' as workflow_name,
	   '1700062586993189'||workflow_engine_id :: text as process_id,
        '{
             "payload_variables": {
             }
         }'::json as variables,
	   '{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}' :: json as workflow_route_bot_topic_details,
       'rest_api_notification_enable' as flow_name,
       19 as job_type_id,
       'modak' as environment from nabu.data_movement_physical
       where data_movement_id = 261
       and valid_to_ts = '9999-12-31'
""2023-11-15 15:36:31.066 [Thread-588] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select case when a.email_id='' then false else true end as email_id  from
(select
replace( trim(trailing ']' from trim( leading '[' from (data_movement_additional_info->'flow_details'->>'email_notification')::json->>'on_success' )),'"','')  as email_id
from nabu.data_movement_physical where data_movement_id=261 and valid_to_ts='9999-12-31')a
""2023-11-15 15:36:31.103 [Thread-588] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select case when a.email_id='' then false else true end as email_id  from
(select
replace( trim(trailing ']' from trim( leading '[' from (data_movement_additional_info->'flow_details'->>'email_notification')::json->>'on_failure' )),'"','')  as email_id
from nabu.data_movement_physical where data_movement_id=261 and valid_to_ts='9999-12-31')a
""2023-11-15 15:36:31.141 [Thread-588] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select ((data_movement_additional_info->'flow_details'->>'schema_drift')::json->>'enabled')::boolean as  email_id from nabu.data_movement_physical where data_movement_id = 261 and valid_to_ts='9999-12-31'

""2023-11-15 15:36:31.174 [Thread-588] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : 
with get_rest_api_details as(
    select a.is_postconditions_enabled,
    (a.rest_api_details->>'rest_api_id')::int as rest_api_id,
    (a.rest_api_details->>'rest_api_name')::text as rest_api_name,
    (a.rest_api_details->>'status_code_id')::int as status_code_id,
    (a.rest_api_details->>'payload') as payload,
    (a.rest_api_details->>'ordinal_position')::int ordinal_position
    from (
        select
        (data_movement_additional_info ->'flow_details'->'post_conditions'->>'enabled')::boolean as is_postconditions_enabled,
        json_array_elements(data_movement_additional_info ->'flow_details'->'post_conditions'->'rest_api_details') as rest_api_details
        from nabu.data_movement_physical
        where data_movement_id = 261
        and valid_to_ts ='9999-12-31'
    )a
)
,get_valid_apis as (
	select c.*
	from get_rest_api_details c left outer join nabu_ui.rest_api_info rai
    on c.rest_api_id = rai.rest_api_id
    where rai.valid_to_ts ='9999-12-31'
)
select a.*,
case
	when a.status_code_id = 21 then 'complete'
	when a.status_code_id = 13 then 'error'
	else 'success'
end as status_code_description,
b.rest_api_name||'_'||b.ordinal_position as input_flow from get_valid_apis a
left outer join get_valid_apis b
on a.ordinal_position=b.ordinal_position+1
and a.status_code_id = b.status_code_id
""2023-11-15 15:36:31.210 [Thread-588] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with flows as(
select 1 as task,
'' as emptyOutputTemplate,
'' as outputflows_template,
'' as input_flows,
cast((extract(epoch from now())*100) as bigint)::text||1567||1 as flow_id,
'fc_ingestion_flow_task' as flowtask_template,
 'ingestion_'||'261_17000625866627691' as flow_name,
false as is_success_mail,'ingestion' as flow_type,
'' as output_flows,
'nabu_ingestion' as task_data_key,
17000625866627691
 as batch_id,
261 as data_movement_id,
1567 as job_schedule_id,
coalesce(data_movement_additional_info->'flow_details'->>'flow_timeout',data_movement_additional_info->'flow_details'->>'pipeline_flow_timeout','72') as flow_timeout,
coalesce((data_movement_additional_info->>'flow_details')::json->>'parallel_count',
(data_movement_additional_info->>'flow_details')::json->>'parallel_source_connections','10') as parallel_count,
coalesce(data_movement_additional_info->'flow_details'->>'retry_count','3'):: int as number_of_retries,
true as loggers_required ,
true as pre_agg_stats_required,
true as delete_credentials,
true as delete_almaren,
'' as rest_api_id,'' as payload,
true as flow_condition,82800000 as jwt_ttl, 'default' as authtoken_job_type
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 261 and dmp.valid_to_ts = '9999-12-31'

union all

select 2 as task,
'' as emptyOutputTemplate,
'' as outputflows_template,
'"ingestion_261_17000625866627691.success"' as input_flows,
cast((extract(epoch from now())*100) as bigint)::text||1567||2 as flow_id,
'end_mail_flow_task' as flowtask_template,
'success_notification_email' as flow_name, true as is_success_mail,'success' as flow_type,
'' as output_flows,
'email_input' as task_data_key,
 17000625866627691  as batch_id,
261 as data_movement_id,
1567 as job_schedule_id,
coalesce(data_movement_additional_info->'flow_details'->>'flow_timeout','72') as flow_timeout,
coalesce(data_movement_additional_info->'flow_details'->>'parallel_count','10') as parallel_count,
coalesce(data_movement_additional_info->'flow_details'->>'retry_count','10'):: int as number_of_retries,
false as loggers_required ,
false as pre_agg_stats_required,
false as delete_credentials,
false as delete_almaren,
'' as rest_api_id,'' as payload,
false as flow_condition,82800000 as jwt_ttl,'default' as authtoken_job_type
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 261 and dmp.valid_to_ts = '9999-12-31'
union all

select 3 as task,
'' as emptyOutputTemplate,
'' as outputflows_template,
'"ingestion_261_17000625866627691.error"' as input_flows,
cast((extract(epoch from now())*100) as bigint)::text||1567||3 as flow_id,
'end_mail_flow_task' as flowtask_template,
'failure_notification_email' as flow_name, false as is_success_mail, 'failure' as flow_type,
'' as output_flows,
'email_input' as task_data_key,
 17000625866627691  as batch_id,
261 as data_movement_id,
1567 as job_schedule_id,
coalesce(data_movement_additional_info->'flow_details'->>'flow_timeout','72') as flow_timeout,
coalesce(data_movement_additional_info->'flow_details'->>'parallel_count','10') as parallel_count,
coalesce(data_movement_additional_info->'flow_details'->>'retry_count','10'):: int as number_of_retries,
false as loggers_required ,
false as pre_agg_stats_required,
false as delete_credentials,
false as delete_almaren,
'' as rest_api_id,'' as payload,
false as flow_condition,82800000 as jwt_ttl, 'default' as authtoken_job_type
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 261 and dmp.valid_to_ts = '9999-12-31'

union all

select 4 as task,
'' as emptyOutputTemplate,
'' as outputflows_template,
'"ingestion_261_17000625866627691.flow_timeout"' as input_flows,
cast((extract(epoch from now())*100) as bigint)::text||1567||4 as flow_id,
'timed_out_end_mail_flow_task' as flowtask_template,
'flow_timeout_notification_email' as flow_name, false as is_success_mail, null as flow_type,
'' as output_flows,
'email_input' as task_data_key,
 17000625866627691  as batch_id,
261 as data_movement_id,
1567 as job_schedule_id,
coalesce(data_movement_additional_info->'flow_details'->>'flow_timeout','72') as flow_timeout,
coalesce(data_movement_additional_info->'flow_details'->>'parallel_count','10') as parallel_count,
coalesce(data_movement_additional_info->'flow_details'->>'retry_count','10'):: int as number_of_retries,
false as loggers_required ,
false as pre_agg_stats_required,
false as delete_credentials,
false as delete_almaren,
'' as rest_api_id,'' as payload,
false as flow_condition,82800000 as jwt_ttl, 'default' as authtoken_job_type
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 261 and dmp.valid_to_ts = '9999-12-31'

union all

select 5 as task,
'' as emptyOutputTemplate,
'' as outputflows_template,
'' as input_flows,
cast((extract(epoch from now())*100) as bigint)::text||1567||5 as flow_id,
'schema_drift_mail_flow_task' as flowtask_template,
'schema_drift_notification_email' as flow_name, false as is_success_mail, 'schema_drift' as flow_type,
'' as output_flows,
'email_input' as task_data_key,
 17000625866627691  as batch_id,
261 as data_movement_id,
1567 as job_schedule_id,
coalesce(data_movement_additional_info->'flow_details'->>'flow_timeout','72') as flow_timeout,
coalesce(data_movement_additional_info->'flow_details'->>'parallel_count','3') as parallel_count,
coalesce(data_movement_additional_info->'flow_details'->>'retry_count','10'):: int as number_of_retries,
false as loggers_required ,
false as pre_agg_stats_required,
false as delete_credentials,
false as delete_almaren,
'' as rest_api_id,'' as payload,
false as flow_condition,82800000 as jwt_ttl, 'default' as authtoken_job_type
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 261 and dmp.valid_to_ts = '9999-12-31'

union all

select 6 as task,
'' as emptyOutputTemplate,'' as outputflows_template,
'"ingestion_261_17000625866627691.success"' as input_flows,
cast((extract(epoch from now())*100) as bigint)::text||1567||6 as flow_id,
'end_mail_flow_task_manual_retry' as flowtask_template,
'success_notification_email_manual_retry' as flow_name, true as is_success_mail, 'success' as flow_type,
'' as output_flows,
'email_input' as task_data_key,
 17000625866627691  as batch_id,
261 as data_movement_id,
1567 as job_schedule_id,
coalesce(data_movement_additional_info->'flow_details'->>'flow_timeout','72') as flow_timeout,
coalesce(data_movement_additional_info->'flow_details'->>'parallel_count','10') as parallel_count,
coalesce(data_movement_additional_info->'flow_details'->>'retry_count','10'):: int as number_of_retries,
false as loggers_required ,
false as pre_agg_stats_required,
false as delete_credentials,
false as delete_almaren,
'' as rest_api_id,'' as payload,
false as flow_condition,82800000 as jwt_ttl, 'default' as authtoken_job_type
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 261 and dmp.valid_to_ts = '9999-12-31'

union all

select 7 as task,
'' as emptyOutputTemplate,
'' as outputflows_template,
'"ingestion_261_17000625866627691.error"' as input_flows,
cast((extract(epoch from now())*100) as bigint)::text||1567||7 as flow_id,
'end_mail_flow_task_manual_retry' as flowtask_template,
'failure_notification_email_manual_retry' as flow_name, false as is_success_mail, 'failure' as flow_type,
'' as output_flows,
'email_input' as task_data_key,
 17000625866627691  as batch_id,
261 as data_movement_id,
1567 as job_schedule_id,
coalesce(data_movement_additional_info->'flow_details'->>'flow_timeout','72') as flow_timeout,
coalesce(data_movement_additional_info->'flow_details'->>'parallel_count','3') as parallel_count,
coalesce(data_movement_additional_info->'flow_details'->>'retry_count','10'):: int as number_of_retries,
false as loggers_required ,
false as pre_agg_stats_required,
false as delete_credentials,
false as delete_almaren,
'' as rest_api_id,'' as payload,
false as flow_condition,82800000 as jwt_ttl, 'default' as authtoken_job_type
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 261 and dmp.valid_to_ts = '9999-12-31'

union all

select 8 as task,
'' as emptyOutputTemplate,
'' as outputflows_template,
'"ingestion_261_17000625866627691.flow_timeout"' as input_flows,
cast((extract(epoch from now())*100) as bigint)::text||1567||8 as flow_id,
'timed_out_end_mail_flow_task' as flowtask_template,
'flow_timeout_notification_email_manual_retry' as flow_name, true as is_success_mail, '_manual_retry' as flow_type,
'' as output_flows,
'email_input' as task_data_key,
 17000625866627691  as batch_id,
261 as data_movement_id,
1567 as job_schedule_id,
coalesce(data_movement_additional_info->'flow_details'->>'flow_timeout','72') as flow_timeout,
coalesce(data_movement_additional_info->'flow_details'->>'parallel_count','3') as parallel_count,
coalesce(data_movement_additional_info->'flow_details'->>'retry_count','10'):: int as number_of_retries,
false as loggers_required ,
false as pre_agg_stats_required,
false as delete_credentials,
false as delete_almaren,
'' as rest_api_id,'' as payload,
false as flow_condition,82800000 as jwt_ttl, 'default' as authtoken_job_type
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 261 and dmp.valid_to_ts = '9999-12-31'

)
select * from flows where flow_condition=true order by  task asc
""2023-11-15 15:36:31.246 [Thread-588] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select 261 as data_movement_id,1 as job_type_id, 17000625866627691 as batch_id  ,36  as status_code_id , 1567 as job_schedule_id
""2023-11-15 15:36:31.287 [Thread-588] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select
coalesce (data_movement_additional_info->'flow_details'->>'pipeline_flow_timeout','72') as flow_timeout
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 261 and dmp.valid_to_ts = '9999-12-31'
""2023-11-15 15:36:31.292 [Thread-588] DEBUG com.modak.bots.DBOpsBot - to execute query timeTakenInMillis : 2192
""2023-11-15 15:36:31.292 [Thread-588] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 942cd0aa-e1f3-4ce0-a8b7-25fc58d2f938 has finished process logic with message_id d87ea871-a925-4c04-8723-76f8c1058f2c and thread_id 745
""2023-11-15 15:36:31.292 [Thread-588] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-15 15:36:31.327 [Thread-588] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "DBOpsBot", "bot_metadata": { "message_id": "ca07b3da-5988-403b-9b89-4a7c46144b24", "parent_id": "d87ea871-a925-4c04-8723-76f8c1058f2c", "bot_id": "942cd0aa-e1f3-4ce0-a8b7-25fc58d2f938", "message_topic":"nabu_2_jdbc", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":1700062586993189, "initial_ts":1700062586993, "batch_id":17000625866627691, "batch_name":"", "job_schedule_id":1567, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "", "environment": "modak", "ignore_job_termination" : false, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot" ],"task_dependency":true}, "task_retry_intervals_secs": [ ], "message_context": "data_movement_deciding" }, "bot_tasks": [ { "task_name": "data_movement_deciding_msg", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "pre_task_logging_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "pre_log_template" }, "app_template_details": { "template_group": "templates/artifact_ingestion/ingestion_fc.stg", "template_name": "doNothingTemplate" }, "input_data": { "template_execution_type": "single", "query_type":"json", "encryption_details" : {"encryption" : "no"}, "query_input": { "condition_for_success_mail" : [ { "email_id" : false } ], "get_deleted_objects" : [ { "object_id" : null } ], "get_batch_datamovement_id" : [ { "data_movement_id" : 261, "job_type_id" : 1, "batch_id" : 17000625866627691, "status_code_id" : 36, "job_schedule_id" : 1567 } ], "email_input" : [ { "batch_id" : 17000625866627691, "batch_name" : "Ingestion_20231115", "data_movement_id" : 261, "job_schedule_id" : 1567, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "workflow_name" : "artifact_generation", "process_id" : "17000625869931892", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "flow_name" : "email_notification_enable", "job_type_id" : 15, "environment" : "modak" } ], "rest_api_input" : [ { "batch_id" : 17000625866627691, "batch_name" : "Ingestion_20231115", "data_movement_id" : 261, "job_schedule_id" : 1567, "data_movement_name" : "ss_compass_adb_validation", "last_run_timestamp" : "2023-11-07 12:42:00.86365", "job_scheduled_user_id" : "Manaswini Chinthalapudi", "workflow_name" : "artifact_generation", "process_id" : "17000625869931892", "variables" : { "payload_variables" : {} }, "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "flow_name" : "rest_api_notification_enable", "job_type_id" : 19, "environment" : "modak" } ], "get_ignore_null_tables" : null, "condition_for_schema_drift_mail" : [ { "email_id" : true } ], "check_if_selected_schemas_are_empty" : [ { "empty_schma" : false } ], "get_datatype_ignore_tables" : [ { "object_id" : null, "status_code_id" : 31, "retry_count" : 0 } ], "get_schema_drift_ignore_tables" : [ { "object_id" : null, "status_code_id" : 30, "retry_count" : 0 } ], "condition_for_failure_mail" : [ { "email_id" : false } ], "schema_drift_table_info" : [ { "schema_drifted_table_id_list" : null } ], "flows" : [ { "task" : 1, "emptyoutputtemplate" : "", "outputflows_template" : "", "input_flows" : "", "flow_id" : "17000625912115671", "flowtask_template" : "fc_ingestion_flow_task", "flow_name" : "ingestion_261_17000625866627691", "is_success_mail" : false, "flow_type" : "ingestion", "output_flows" : "", "task_data_key" : "nabu_ingestion", "batch_id" : 17000625866627691, "data_movement_id" : 261, "job_schedule_id" : 1567, "flow_timeout" : "23", "parallel_count" : "1", "number_of_retries" : 0, "loggers_required" : true, "pre_agg_stats_required" : true, "delete_credentials" : true, "delete_almaren" : true, "rest_api_id" : "", "payload" : "", "flow_condition" : true, "jwt_ttl" : 82800000, "authtoken_job_type" : "default" } ], "get_jwt_details" : [ { "job_type" : "default", "jwt_ttl" : 82800000 } ], "nabu_ingestion" : [ { "batch_id" : 17000625866627691, "batch_name" : "Ingestion_20231115", "data_movement_id" : 261, "relative_file_path" : "", "ingestion_table_format" : "", "suffix" : "", "is_relative_file_path" : false, "source_schema_name_lowercase" : "acuity-develop", "source_database_name_lowercase" : "development-db", "source_schema_name" : "acuity-develop", "source_database_name" : "development-db", "source_schema_name_uppercase" : "ACUITY-DEVELOP", "source_database_name_uppercase" : "DEVELOPMENT-DB", "data_movement_name" : "ss_compass_adb_validation", "environment" : "modak", "job_type_id" : 1, "type" : "", "job_schedule_id" : 1567, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "last_run_timestamp" : "2023-11-07 12:42:00.86365", "variables" : { "payload_variables" : {} }, "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "workflow_name" : "artifact_generation", "process_id" : "17000625869931891", "where_condition" : 37234, "flow_number" : 1 } ], "source_metadata_category" : [ { "data_movement_id" : 261, "source_type" : "relational", "source" : "sql_server" } ], "flow_controller_timeout" : [ { "flow_timeout" : "23" } ] } }, "skipLogicPattern" : "doNothing", "output_message_templates": [ { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "flow_controller_message_for_ingestion", "useIncomingData":true }, { "template_group": "templates/artifact_ingestion/ingestion_flow.stg", "template_name": "task_status_success_msg", "useIncomingData":true } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/ingestion_templates.stg", "template_name": "error_template_create_msg" } ] } ] }
""2023-11-15 15:36:31.329 [Thread-588] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_jdbc
""2023-11-15 15:36:31.334 [Thread-588] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_jdbc
""2023-11-15 15:36:31.334 [Thread-588] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-15 15:36:31.430 [Thread-1786] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id bc98c972-baaf-4fc0-8920-c5549ebbc364 has started processing message with message_id ca07b3da-5988-403b-9b89-4a7c46144b24 and thread_id 2193 
""2023-11-15 15:36:31.430 [Thread-1786] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:31.430 [Thread-1786] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=d87ea871-a925-4c04-8723-76f8c1058f2c, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=data_movement_deciding, message_id=ca07b3da-5988-403b-9b89-4a7c46144b24, task_retry_intervals_secs=[], bot_id=942cd0aa-e1f3-4ce0-a8b7-25fc58d2f938, message_topic=nabu_2_jdbc, tags={process_id=1700062586993189, batch_id=17000625866627691, job_scheduled_user_id=Manaswini Chinthalapudi, tags=[AuthToken, DBOpsBot], initial_ts=1700062586993, batch_name=, environment=modak, job_schedule_id=1567, data_movement_id=261, last_run_timestamp=, retry_attempt=0, task_dependency=true, ignore_job_termination=false}}
""2023-11-15 15:36:31.627 [Thread-1786] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
doNothing
""2023-11-15 15:36:31.639 [Thread-1786] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 15:36:31.640 [Thread-1786] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:36:31.644 [Thread-1786] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:36:31.644 [Thread-1786] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : true
""2023-11-15 15:36:31.651 [Thread-680] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 97ffcb2c-0174-4d94-8b9d-f2d6b87a42ca has started processing message with message_id e3c6f4f8-b681-42f8-95b3-b23ac01ae6d8 and thread_id 852 
""2023-11-15 15:36:31.651 [Thread-680] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:31.651 [Thread-680] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=ca07b3da-5988-403b-9b89-4a7c46144b24, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=e3c6f4f8-b681-42f8-95b3-b23ac01ae6d8, task_retry_intervals_secs=[], bot_id=bc98c972-baaf-4fc0-8920-c5549ebbc364, message_topic=nabu_2_taskmonitor, tags={process_id=1700062586993189, initial_ts=1700062586993, batch_name=, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, TaskMonitorBot]}}
""2023-11-15 15:36:31.665 [Thread-680] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 1700062586993189, 'DBOpsBot', 'data_movement_deciding', 'data_movement_deciding_msg', 10 , TO_TIMESTAMP(1700062591430::double precision / 1000) ,'bc98c972-baaf-4fc0-8920-c5549ebbc364');
""2023-11-15 15:36:31.665 [Thread-680] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 97ffcb2c-0174-4d94-8b9d-f2d6b87a42ca has started process logic with message_id e3c6f4f8-b681-42f8-95b3-b23ac01ae6d8 and thread_id 852
""2023-11-15 15:36:31.670 [Thread-680] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 97ffcb2c-0174-4d94-8b9d-f2d6b87a42ca has finished process logic with message_id e3c6f4f8-b681-42f8-95b3-b23ac01ae6d8 and thread_id 852
""2023-11-15 15:36:31.670 [Thread-680] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:31.670 [Thread-680] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id e3c6f4f8-b681-42f8-95b3-b23ac01ae6d8
""2023-11-15 15:36:31.678 [Thread-1786] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "FlowControllerBot", "bot_metadata": { "message_id": "b069046f-8526-4bc6-8dbc-93e25a119ff8", "parent_id": "ca07b3da-5988-403b-9b89-4a7c46144b24", "bot_id": "bc98c972-baaf-4fc0-8920-c5549ebbc364", "message_topic":"nabu_2_flowcontroller", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":1700062586993189, "initial_ts":1700062586993, "batch_id":17000625866627691, "batch_name":"", "job_schedule_id":1567, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "", "environment": "modak", "ignore_job_termination" : false, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot" ],"task_dependency":true}, "task_retry_intervals_secs": [ ], "message_context": "flowcontroller_message_to_generate_flows" }, "bot_tasks": [ { "task_name": "generate_flows", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "pre_task_logging_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "pre_log_template" }, "app_template_details": { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "generate_flows" }, "input_data":{ "query_input" : { "condition_for_success_mail" : [ { "email_id" : false } ], "get_deleted_objects" : [ { "object_id" : null } ], "get_batch_datamovement_id" : [ { "status_code_id" : 36, "batch_id" : 17000625866627691, "job_schedule_id" : 1567, "data_movement_id" : 261, "job_type_id" : 1 } ], "email_input" : [ { "process_id" : "17000625869931892", "batch_name" : "Ingestion_20231115", "environment" : "modak", "batch_id" : 17000625866627691, "workflow_name" : "artifact_generation", "job_schedule_id" : 1567, "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "data_movement_id" : 261, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "flow_name" : "email_notification_enable", "job_type_id" : 15 } ], "rest_api_input" : [ { "process_id" : "17000625869931892", "variables" : { "payload_variables" : {} }, "batch_id" : 17000625866627691, "workflow_name" : "artifact_generation", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "flow_name" : "rest_api_notification_enable", "job_type_id" : 19, "batch_name" : "Ingestion_20231115", "environment" : "modak", "job_schedule_id" : 1567, "data_movement_id" : 261, "last_run_timestamp" : "2023-11-07 12:42:00.86365", "data_movement_name" : "ss_compass_adb_validation" } ], "get_ignore_null_tables" : null, "condition_for_schema_drift_mail" : [ { "email_id" : true } ], "check_if_selected_schemas_are_empty" : [ { "empty_schma" : false } ], "get_datatype_ignore_tables" : [ { "status_code_id" : 31, "retry_count" : 0, "object_id" : null } ], "get_schema_drift_ignore_tables" : [ { "status_code_id" : 30, "retry_count" : 0, "object_id" : null } ], "condition_for_failure_mail" : [ { "email_id" : false } ], "schema_drift_table_info" : [ { "schema_drifted_table_id_list" : null } ], "flows" : [ { "jwt_ttl" : 82800000, "rest_api_id" : "", "batch_id" : 17000625866627691, "pre_agg_stats_required" : true, "outputflows_template" : "", "parallel_count" : "1", "emptyoutputtemplate" : "", "payload" : "", "flow_id" : "17000625912115671", "job_schedule_id" : 1567, "delete_credentials" : true, "number_of_retries" : 0, "delete_almaren" : true, "input_flows" : "", "flow_name" : "ingestion_261_17000625866627691", "output_flows" : "", "task_data_key" : "nabu_ingestion", "flow_condition" : true, "task" : 1, "flow_type" : "ingestion", "authtoken_job_type" : "default", "is_success_mail" : false, "flowtask_template" : "fc_ingestion_flow_task", "data_movement_id" : 261, "flow_timeout" : "23", "loggers_required" : true } ], "get_jwt_details" : [ { "job_type" : "default", "jwt_ttl" : 82800000 } ], "nabu_ingestion" : [ { "process_id" : "17000625869931891", "flow_number" : 1, "source_database_name_lowercase" : "development-db", "batch_id" : 17000625866627691, "workflow_name" : "artifact_generation", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "where_condition" : 37234, "suffix" : "", "type" : "", "job_type_id" : 1, "ingestion_table_format" : "", "job_schedule_id" : 1567, "relative_file_path" : "", "data_movement_name" : "ss_compass_adb_validation", "source_schema_name_lowercase" : "acuity-develop", "variables" : { "payload_variables" : {} }, "source_database_name_uppercase" : "DEVELOPMENT-DB", "job_scheduled_user_id" : "Manaswini Chinthalapudi", "source_schema_name_uppercase" : "ACUITY-DEVELOP", "source_schema_name" : "acuity-develop", "batch_name" : "Ingestion_20231115", "environment" : "modak", "source_database_name" : "development-db", "data_movement_id" : 261, "last_run_timestamp" : "2023-11-07 12:42:00.86365", "is_relative_file_path" : false } ], "source_metadata_category" : [ { "data_movement_id" : 261, "source_type" : "relational", "source" : "sql_server" } ], "flow_controller_timeout" : [ { "flow_timeout" : "23" } ] }, "encryption_details" : { "encryption" : "no" }, "batch_id" : "17000625866627691", "template_execution_type" : "single", "query_type" : "json", "currentBotMessageMap" : { "parent_id" : "d87ea871-a925-4c04-8723-76f8c1058f2c", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "message_context" : "data_movement_deciding", "message_id" : "ca07b3da-5988-403b-9b89-4a7c46144b24", "task_retry_intervals_secs" : [], "bot_id" : "942cd0aa-e1f3-4ce0-a8b7-25fc58d2f938", "message_topic" : "nabu_2_jdbc", "tags" : { "process_id" : 1700062586993189, "batch_id" : 17000625866627691, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "tags" : [ "AuthToken", "DBOpsBot" ], "initial_ts" : 1700062586993, "batch_name" : "", "environment" : "modak", "job_schedule_id" : 1567, "data_movement_id" : 261, "last_run_timestamp" : "", "retry_attempt" : 0, "task_dependency" : true, "ignore_job_termination" : false } } }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "task_status_success_msg" } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "error_template_create_msg" } ], "loggers":{ "pre_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "bot_pre_log", "log_type": "FILE", "log_file_location": "../logs/logger_output.log" } ], "post_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "bot_post_log", "log_type": "FILE", "log_file_location": "../logs/logger_output.log" } ], "error_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "bot_error_log", "log_type": "FILE", "log_file_location": "../logs/logger_output.log" } ] } } ] } 
""2023-11-15 15:36:31.682 [Thread-1786] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_flowcontroller
""2023-11-15 15:36:31.687 [Thread-1786] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_flowcontroller
""2023-11-15 15:36:31.688 [Thread-1786] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : true
""2023-11-15 15:36:31.720 [Thread-588] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "7650a057-b720-45f5-a1f9-ee5529d60a09", "parent_id": "d87ea871-a925-4c04-8723-76f8c1058f2c", "bot_id": "942cd0aa-e1f3-4ce0-a8b7-25fc58d2f938", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":1700062586993189, "initial_ts":1700062586993, "batch_id":17000625866627691, "batch_name":"", "job_schedule_id":1567, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"942cd0aa-e1f3-4ce0-a8b7-25fc58d2f938", "bot_name":"DBOpsBot", "process_context":"starting_message_for_ingestion", "task_name":"checking_pre_conditions_or_starting_msg_of_ingestion", "process_id":"1700062586993189", "task_ts":1700062591292, "batch_id":"17000625866627691", "status_code_id": 6 } } ] }
""2023-11-15 15:36:31.723 [Thread-588] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:36:31.729 [Thread-588] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:36:31.729 [Thread-588] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:31.730 [Thread-588] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot finished processing message with id d87ea871-a925-4c04-8723-76f8c1058f2c
""2023-11-15 15:36:31.785 [Thread-464] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 5b116219-7bf5-423b-a09f-c9352a1f0e6f has started processing message with message_id 7650a057-b720-45f5-a1f9-ee5529d60a09 and thread_id 600 
""2023-11-15 15:36:31.785 [Thread-464] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:31.785 [Thread-464] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=d87ea871-a925-4c04-8723-76f8c1058f2c, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=7650a057-b720-45f5-a1f9-ee5529d60a09, task_retry_intervals_secs=[], bot_id=942cd0aa-e1f3-4ce0-a8b7-25fc58d2f938, message_topic=nabu_2_taskmonitor, tags={process_id=1700062586993189, initial_ts=1700062586993, batch_name=, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, TaskMonitorBot]}}
""2023-11-15 15:36:31.785 [pool-24-thread-20] INFO  com.modak.bots.basebot.AbstractBaseBot - FlowControllerBot with bot_id d6a03616-281f-4a28-9811-52d565f7ccd1 has started processing message with message_id b069046f-8526-4bc6-8dbc-93e25a119ff8 and thread_id 5336 
""2023-11-15 15:36:31.794 [Thread-464] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 1700062586993189, 'DBOpsBot', 'starting_message_for_ingestion', 'checking_pre_conditions_or_starting_msg_of_ingestion', 6 , TO_TIMESTAMP(1700062591292::double precision / 1000) ,'942cd0aa-e1f3-4ce0-a8b7-25fc58d2f938');
""2023-11-15 15:36:31.794 [Thread-464] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 5b116219-7bf5-423b-a09f-c9352a1f0e6f has started process logic with message_id 7650a057-b720-45f5-a1f9-ee5529d60a09 and thread_id 600
""2023-11-15 15:36:31.917 [Thread-464] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 5b116219-7bf5-423b-a09f-c9352a1f0e6f has finished process logic with message_id 7650a057-b720-45f5-a1f9-ee5529d60a09 and thread_id 600
""2023-11-15 15:36:31.917 [Thread-464] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:31.917 [Thread-464] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 7650a057-b720-45f5-a1f9-ee5529d60a09
""2023-11-15 15:36:31.959 [pool-24-thread-20] INFO  com.modak.utils.logging.LoggingTemplateUtitlity - 2023-11-15 15:36:31.786 Task start generate_flows of process_id 1700062586993189 of bot FlowControllerBot  with id d6a03616-281f-4a28-9811-52d565f7ccd1
""2023-11-15 15:36:31.962 [pool-24-thread-20] INFO  com.modak.utils.logging.FileLogger - ../logs/logger_output.log
""2023-11-15 15:36:31.963 [pool-24-thread-20] DEBUG com.modak.utils.logging.FileLogger - Log file executed 2023-11-15 15:36:31.786 Task start generate_flows of process_id 1700062586993189 of bot FlowControllerBot  with id d6a03616-281f-4a28-9811-52d565f7ccd1 
""2023-11-15 15:36:31.963 [pool-24-thread-20] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=ca07b3da-5988-403b-9b89-4a7c46144b24, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=flowcontroller_message_to_generate_flows, message_id=b069046f-8526-4bc6-8dbc-93e25a119ff8, task_retry_intervals_secs=[], bot_id=bc98c972-baaf-4fc0-8920-c5549ebbc364, message_topic=nabu_2_flowcontroller, tags={process_id=1700062586993189, batch_id=17000625866627691, job_scheduled_user_id=Manaswini Chinthalapudi, tags=[AuthToken, DBOpsBot, DBOpsBot], initial_ts=1700062586993, batch_name=, environment=modak, job_schedule_id=1567, data_movement_id=261, last_run_timestamp=, retry_attempt=0, task_dependency=true, ignore_job_termination=false}}
""2023-11-15 15:36:31.996 [pool-24-thread-20] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
{ "flows":[ { "flowName": "ingestion_261_17000625866627691", "flowId":17000625912115671, "batch_id":17000625866627691, "job_schedule_id": "1567", "job_type_id": 1, "data_movement_id":"261", "flow_type": "ingestion", "metaflowData": { "tags": { "tags": [ "ingestion_261_17000625866627691" ] } }, "configuration": { "parallel":1, "flowTimeoutHrs":23 }, "uiInfo": { "description": "Auto generated by flow controller for flow ingestion_261_17000625866627691" }, "flowTasks": [ { "flowTaskName": "spark_ingestion_almaren_261_1", "flowTaskId": 2611, "processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "bot_metadata": { "tags":{ "process_id":17000625869931891, "batch_id": 17000625866627691, "batch_name": "Ingestion_20231115", "environment": "modak", "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "2023-11-07 12:42:00.86365", "job_schedule_id": 1567, "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"} } }, "app_template_details": { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "generate_input_data" }, "input_data": { "variables": { "env_variables": { }, "user_variables": { }, "payload_variables": { } }, "environment": "modak", "data_movement_id":"261", "process_id": "17000625869931891", "batch_id": "17000625866627691", "batch_name": "Ingestion_20231115", "workflow_name": "artifact_generation", "where_condition":"37234", "flow_number":1, "job_schedule_id": 1567, "job_scheduled_user_id": "Manaswini Chinthalapudi", "relative_file_path": "", "ingestion_table_format": "", "suffix": "", "is_relative_file_path": false, "source_schema_name": "acuity-develop", "source_database_name": "development-db", "source_schema_name_lowercase": "acuity-develop", "source_database_name_lowercase": "development-db", "source_database_name_uppercase": "DEVELOPMENT-DB", "source_schema_name_uppercase": "ACUITY-DEVELOP", "data_movement_name":"ss_compass_adb_validation", "last_run_timestamp": "2023-11-07 12:42:00.86365", "job_type_id":"1", "jwt_ttl":"82800000", "authtoken_job_type":"default" }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "artifact_generation_auth_token_msg" } ], "retry_template": { "retry_template_group": "templates/artifact_ingestion/flow_controller.stg", "retry_template_name": "artifact_generation_auth_token_msg_retry" }, "loggers":{ "scheduled_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_scheduled_log", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" } ], "pre_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_running_log", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_pre_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" } ], "post_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_post_log_db", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_post_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" } ], "retry_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_retry_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" } ] }, "completionCriteria": { "success":{ "botTopics": [ "nabu_2_completion" ], "criteria":[ "AND", { "bot_metadata.tags.process_id": 17000625869931891, "opOperator": "==" }, { "bot_metadata.message_context": "end_of_the_flow", "opOperator": "==" } ] }, "error": { "botTopics": [ "nabu_2_errorbot" ], "criteria": [ "AND", { "opOperator": "==", "bot_metadata.tags.process_id": 17000625869931891 }, { "opOperator": "==", "bot_metadata.message_context": "taskstatus_bot_error_msg" } ] }, "retry": [ "AND", { "error_data.retry_attempt": 0, "opOperator": "<" }, { "error_data.error_json": "(?i).*exception.*", "opOperator": "~" } ] } } ], "inputFlows": [], "outputFlows": [], "flowOutputTemplates": [ { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "delete_almaren_code_from_kosh" }, { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "delete_created_credentials" } ,{ "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "insert_pre_agg_stats_template" } ] ,"loggers":{ "pre_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_pre_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_pre_log_db", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" } ], "post_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_post_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_post_log_db", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" } ] } } ], "flow_timeout":23 }
""2023-11-15 15:36:32.009 [pool-24-thread-20] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 15:36:32.010 [pool-24-thread-20] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:36:32.013 [pool-24-thread-20] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:36:32.013 [pool-24-thread-20] INFO  com.modak.bots.basebot.AbstractBaseBot - FlowControllerBot with bot_id d6a03616-281f-4a28-9811-52d565f7ccd1 has started process logic with message_id b069046f-8526-4bc6-8dbc-93e25a119ff8 and thread_id 5336
""2023-11-15 15:36:32.014 [pool-24-thread-20] DEBUG com.modak.bots.FlowControllerBot - FlowController bot data : { "flows":[ { "flowName": "ingestion_261_17000625866627691", "flowId":17000625912115671, "batch_id":17000625866627691, "job_schedule_id": "1567", "job_type_id": 1, "data_movement_id":"261", "flow_type": "ingestion", "metaflowData": { "tags": { "tags": [ "ingestion_261_17000625866627691" ] } }, "configuration": { "parallel":1, "flowTimeoutHrs":23 }, "uiInfo": { "description": "Auto generated by flow controller for flow ingestion_261_17000625866627691" }, "flowTasks": [ { "flowTaskName": "spark_ingestion_almaren_261_1", "flowTaskId": 2611, "processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "bot_metadata": { "tags":{ "process_id":17000625869931891, "batch_id": 17000625866627691, "batch_name": "Ingestion_20231115", "environment": "modak", "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "2023-11-07 12:42:00.86365", "job_schedule_id": 1567, "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"} } }, "app_template_details": { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "generate_input_data" }, "input_data": { "variables": { "env_variables": { }, "user_variables": { }, "payload_variables": { } }, "environment": "modak", "data_movement_id":"261", "process_id": "17000625869931891", "batch_id": "17000625866627691", "batch_name": "Ingestion_20231115", "workflow_name": "artifact_generation", "where_condition":"37234", "flow_number":1, "job_schedule_id": 1567, "job_scheduled_user_id": "Manaswini Chinthalapudi", "relative_file_path": "", "ingestion_table_format": "", "suffix": "", "is_relative_file_path": false, "source_schema_name": "acuity-develop", "source_database_name": "development-db", "source_schema_name_lowercase": "acuity-develop", "source_database_name_lowercase": "development-db", "source_database_name_uppercase": "DEVELOPMENT-DB", "source_schema_name_uppercase": "ACUITY-DEVELOP", "data_movement_name":"ss_compass_adb_validation", "last_run_timestamp": "2023-11-07 12:42:00.86365", "job_type_id":"1", "jwt_ttl":"82800000", "authtoken_job_type":"default" }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "artifact_generation_auth_token_msg" } ], "retry_template": { "retry_template_group": "templates/artifact_ingestion/flow_controller.stg", "retry_template_name": "artifact_generation_auth_token_msg_retry" }, "loggers":{ "scheduled_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_scheduled_log", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" } ], "pre_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_running_log", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_pre_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" } ], "post_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_post_log_db", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_post_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" } ], "retry_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_retry_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" } ] }, "completionCriteria": { "success":{ "botTopics": [ "nabu_2_completion" ], "criteria":[ "AND", { "bot_metadata.tags.process_id": 17000625869931891, "opOperator": "==" }, { "bot_metadata.message_context": "end_of_the_flow", "opOperator": "==" } ] }, "error": { "botTopics": [ "nabu_2_errorbot" ], "criteria": [ "AND", { "opOperator": "==", "bot_metadata.tags.process_id": 17000625869931891 }, { "opOperator": "==", "bot_metadata.message_context": "taskstatus_bot_error_msg" } ] }, "retry": [ "AND", { "error_data.retry_attempt": 0, "opOperator": "<" }, { "error_data.error_json": "(?i).*exception.*", "opOperator": "~" } ] } } ], "inputFlows": [], "outputFlows": [], "flowOutputTemplates": [ { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "delete_almaren_code_from_kosh" }, { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "delete_created_credentials" } ,{ "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "insert_pre_agg_stats_template" } ] ,"loggers":{ "pre_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_pre_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_pre_log_db", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" } ], "post_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_post_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_post_log_db", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" } ] } } ], "flow_timeout":23 }
""2023-11-15 15:36:32.014 [pool-24-thread-20] DEBUG com.modak.bots.FlowControllerBot - flowMap to flowcontroller is {flows=[{flowOutputTemplates=[{template_name=delete_almaren_code_from_kosh, template_group=templates/artifact_ingestion/flow_controller.stg}, {template_name=delete_created_credentials, template_group=templates/artifact_ingestion/flow_controller.stg}, {template_name=insert_pre_agg_stats_template, template_group=templates/artifact_ingestion/flow_controller.stg}], batch_id=17000625866627691, configuration={parallel=1, flowTimeoutHrs=23}, loggers={post_loggers=[{template_name=flow_post_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_post_log_db, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], pre_loggers=[{template_name=flow_pre_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_pre_log_db, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}]}, flowName=ingestion_261_17000625866627691, job_type_id=1, flow_type=ingestion, uiInfo={description=Auto generated by flow controller for flow ingestion_261_17000625866627691}, flowTasks=[{input_data={jwt_ttl=82800000, process_id=17000625869931891, flow_number=1, source_database_name_lowercase=development-db, batch_id=17000625866627691, workflow_name=artifact_generation, where_condition=37234, suffix=, job_type_id=1, ingestion_table_format=, job_schedule_id=1567, relative_file_path=, data_movement_name=ss_compass_adb_validation, source_schema_name_lowercase=acuity-develop, variables={env_variables={}, user_variables={}, payload_variables={}}, source_database_name_uppercase=DEVELOPMENT-DB, job_scheduled_user_id=Manaswini Chinthalapudi, source_schema_name_uppercase=ACUITY-DEVELOP, source_schema_name=acuity-develop, environment=modak, batch_name=Ingestion_20231115, source_database_name=development-db, authtoken_job_type=default, data_movement_id=261, last_run_timestamp=2023-11-07 12:42:00.86365, is_relative_file_path=false}, flowTaskId=2611, bot_metadata={tags={process_id=17000625869931891, batch_name=Ingestion_20231115, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365}}, retry_template={retry_template_name=artifact_generation_auth_token_msg_retry, retry_template_group=templates/artifact_ingestion/flow_controller.stg}, loggers={scheduled_loggers=[{template_name=flow_task_scheduled_log, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], post_loggers=[{template_name=flow_task_post_log_db, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_task_post_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], pre_loggers=[{template_name=flow_task_running_log, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_task_pre_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], retry_loggers=[{template_name=flow_task_retry_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}]}, completionCriteria={success={botTopics=[nabu_2_completion], criteria=[AND, {bot_metadata.tags.process_id=17000625869931891, opOperator===}, {opOperator===, bot_metadata.message_context=end_of_the_flow}]}, error={botTopics=[nabu_2_errorbot], criteria=[AND, {bot_metadata.tags.process_id=17000625869931891, opOperator===}, {opOperator===, bot_metadata.message_context=taskstatus_bot_error_msg}]}, retry=[AND, {error_data.retry_attempt=0, opOperator=<}, {error_data.error_json=(?i).*exception.*, opOperator=~}]}, app_template_details={template_name=generate_input_data, template_group=templates/artifact_ingestion/flow_controller.stg}, output_message_templates=[{template_name=artifact_generation_auth_token_msg, template_group=templates/artifact_ingestion/flow_controller.stg}], processor={classname=com.modak.bots.processor.NullProcessor, props={}}, flowTaskName=spark_ingestion_almaren_261_1}], job_schedule_id=1567, data_movement_id=261, inputFlows=[], outputFlows=[], flowId=17000625912115671, metaflowData={tags={tags=[ingestion_261_17000625866627691]}}}], flow_timeout=23}
""2023-11-15 15:36:32.014 [pool-24-thread-20] DEBUG com.modak.bots.FlowControllerBot - inputMessageMetadataMap to flowcontroller is {flowControllerMetadata={parent_id=ca07b3da-5988-403b-9b89-4a7c46144b24, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=flowcontroller_message_to_generate_flows, message_id=b069046f-8526-4bc6-8dbc-93e25a119ff8, task_retry_intervals_secs=[], bot_id=bc98c972-baaf-4fc0-8920-c5549ebbc364, message_topic=nabu_2_flowcontroller, tags={process_id=1700062586993189, batch_id=17000625866627691, job_scheduled_user_id=Manaswini Chinthalapudi, tags=[AuthToken, DBOpsBot, DBOpsBot], initial_ts=1700062586993, batch_name=, environment=modak, job_schedule_id=1567, data_movement_id=261, last_run_timestamp=, retry_attempt=0, task_dependency=true, ignore_job_termination=false}}, bot_id=d6a03616-281f-4a28-9811-52d565f7ccd1}
""2023-11-15 15:36:32.015 [pool-24-thread-20] DEBUG com.modak.bots.flowcontroller.FlowController - FlowController input : 
{"flows":[{"flowOutputTemplates":[{"template_group":"templates/artifact_ingestion/flow_controller.stg","template_name":"delete_almaren_code_from_kosh"},{"template_group":"templates/artifact_ingestion/flow_controller.stg","template_name":"delete_created_credentials"},{"template_group":"templates/artifact_ingestion/flow_controller.stg","template_name":"insert_pre_agg_stats_template"}],"batch_id":17000625866627691,"configuration":{"parallel":1,"flowTimeoutHrs":23},"loggers":{"post_loggers":[{"template_name":"flow_post_log","log_type":"FILE","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"},{"template_name":"flow_post_log_db","log_type":"DB","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"}],"pre_loggers":[{"template_name":"flow_pre_log","log_type":"FILE","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"},{"template_name":"flow_pre_log_db","log_type":"DB","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"}]},"flowName":"ingestion_261_17000625866627691","job_type_id":1,"flow_type":"ingestion","uiInfo":{"description":"Auto generated by flow controller for flow ingestion_261_17000625866627691"},"flowTasks":[{"input_data":{"jwt_ttl":"82800000","process_id":"17000625869931891","flow_number":1,"source_database_name_lowercase":"development-db","batch_id":"17000625866627691","workflow_name":"artifact_generation","where_condition":"37234","suffix":"","job_type_id":"1","ingestion_table_format":"","job_schedule_id":1567,"relative_file_path":"","data_movement_name":"ss_compass_adb_validation","source_schema_name_lowercase":"acuity-develop","variables":{"env_variables":{},"user_variables":{},"payload_variables":{}},"source_database_name_uppercase":"DEVELOPMENT-DB","job_scheduled_user_id":"Manaswini Chinthalapudi","source_schema_name_uppercase":"ACUITY-DEVELOP","source_schema_name":"acuity-develop","environment":"modak","batch_name":"Ingestion_20231115","source_database_name":"development-db","authtoken_job_type":"default","data_movement_id":"261","last_run_timestamp":"2023-11-07 12:42:00.86365","is_relative_file_path":false},"flowTaskId":2611,"bot_metadata":{"tags":{"process_id":17000625869931891,"batch_name":"Ingestion_20231115","environment":"modak","batch_id":17000625866627691,"job_schedule_id":1567,"workflow_route_bot_topic_details":{"DBOpsBot":"nabu_2_jdbc","ScriptBot":"nabu_2_scriptbot","SparkComputeEngineBot":"nabu_2_spark_compute","FilterResolverDBOpsBot":"nabu_2_filter_resolver_jdbc","S3StreamBot":"nabu_2_s3_stream","ErrorBot":"nabu_2_errorbot","AuthTokenBot":"nabu_2_authtoken","OnDemandBot":"nabu_2_ondemand_bot","EmailBot":"nabu_2_emailbot","PipelineDependencyCheckerBot":"nabu_2_pipelinedependency_checker","RPCSparkScriptBot":"nabu_2_rpc_spark_script","SparkScriptBot":"nabu_2_spark_script","RestAPIBot":"nabu_2_restapibot","CurationSparkScriptBot":"nabu_2_curation_script","TaskMonitorBot":"nabu_2_taskmonitor","completion_topic":"nabu_2_completion","FlowControllerBot":"nabu_2_flowcontroller","UpdateDBOpsBot":"nabu_2_update_jdbc"},"data_movement_id":261,"job_scheduled_user_id":"Manaswini Chinthalapudi","last_run_timestamp":"2023-11-07 12:42:00.86365"}},"retry_template":{"retry_template_name":"artifact_generation_auth_token_msg_retry","retry_template_group":"templates/artifact_ingestion/flow_controller.stg"},"loggers":{"scheduled_loggers":[{"template_name":"flow_task_scheduled_log","log_type":"DB","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"}],"post_loggers":[{"template_name":"flow_task_post_log_db","log_type":"DB","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"},{"template_name":"flow_task_post_log","log_type":"FILE","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"}],"pre_loggers":[{"template_name":"flow_task_running_log","log_type":"DB","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"},{"template_name":"flow_task_pre_log","log_type":"FILE","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"}],"retry_loggers":[{"template_name":"flow_task_retry_log","log_type":"FILE","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"}]},"completionCriteria":{"error":{"botTopics":["nabu_2_errorbot"],"criteria":["AND",{"opOperator":"==","bot_metadata.tags.process_id":17000625869931891},{"opOperator":"==","bot_metadata.message_context":"taskstatus_bot_error_msg"}]},"success":{"botTopics":["nabu_2_completion"],"criteria":["AND",{"opOperator":"==","bot_metadata.tags.process_id":17000625869931891},{"opOperator":"==","bot_metadata.message_context":"end_of_the_flow"}]},"retry":["AND",{"opOperator":"<","error_data.retry_attempt":0},{"error_data.error_json":"(?i).*exception.*","opOperator":"~"}]},"app_template_details":{"template_group":"templates/artifact_ingestion/flow_controller.stg","template_name":"generate_input_data"},"output_message_templates":[{"template_group":"templates/artifact_ingestion/flow_controller.stg","template_name":"artifact_generation_auth_token_msg"}],"processor":{"classname":"com.modak.bots.processor.NullProcessor","props":{}},"flowTaskName":"spark_ingestion_almaren_261_1"}],"job_schedule_id":"1567","data_movement_id":"261","inputFlows":[],"outputFlows":[],"flowId":17000625912115671,"metaflowData":{"tags":{"tags":["ingestion_261_17000625866627691"]}}}],"flow_timeout":23}
""2023-11-15 15:36:32.015 [pool-24-thread-20] DEBUG com.modak.bots.flowcontroller.FlowController - Flow Timeout is configured as: 23
""2023-11-15 15:36:32.015 [pool-24-thread-20] DEBUG com.modak.bots.flowcontroller.FlowController - executorService FixedThreadPool size is : 1 for batchid : 17000625866627691
""2023-11-15 15:36:32.015 [pool-24-thread-20] DEBUG com.modak.bots.flowcontroller.FlowController - start flow out side the loop flowcontroller object com.modak.bots.flowcontroller.FlowController@433ade9b with batchid 17000625866627691
""2023-11-15 15:36:32.015 [pool-24-thread-20] DEBUG com.modak.bots.flowcontroller.FlowController - Inside startFlows() of batchid 17000625866627691
""2023-11-15 15:36:32.015 [pool-24-thread-20] DEBUG com.modak.bots.flowcontroller.FlowController - flowsToBeStartedMap in startflows() : {ingestion_261_17000625866627691={flowOutputTemplates=[{template_name=delete_almaren_code_from_kosh, template_group=templates/artifact_ingestion/flow_controller.stg}, {template_name=delete_created_credentials, template_group=templates/artifact_ingestion/flow_controller.stg}, {template_name=insert_pre_agg_stats_template, template_group=templates/artifact_ingestion/flow_controller.stg}], batch_id=17000625866627691, configuration={parallel=1, flowTimeoutHrs=23}, loggers={post_loggers=[{template_name=flow_post_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_post_log_db, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], pre_loggers=[{template_name=flow_pre_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_pre_log_db, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}]}, flowName=ingestion_261_17000625866627691, job_type_id=1, flow_type=ingestion, uiInfo={description=Auto generated by flow controller for flow ingestion_261_17000625866627691}, flowTasks=[{input_data={jwt_ttl=82800000, process_id=17000625869931891, flow_number=1, source_database_name_lowercase=development-db, batch_id=17000625866627691, workflow_name=artifact_generation, where_condition=37234, suffix=, job_type_id=1, ingestion_table_format=, job_schedule_id=1567, relative_file_path=, data_movement_name=ss_compass_adb_validation, source_schema_name_lowercase=acuity-develop, variables={env_variables={}, user_variables={}, payload_variables={}}, source_database_name_uppercase=DEVELOPMENT-DB, job_scheduled_user_id=Manaswini Chinthalapudi, source_schema_name_uppercase=ACUITY-DEVELOP, source_schema_name=acuity-develop, environment=modak, batch_name=Ingestion_20231115, source_database_name=development-db, authtoken_job_type=default, data_movement_id=261, last_run_timestamp=2023-11-07 12:42:00.86365, is_relative_file_path=false}, flowTaskId=2611, bot_metadata={tags={process_id=17000625869931891, batch_name=Ingestion_20231115, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365}}, retry_template={retry_template_name=artifact_generation_auth_token_msg_retry, retry_template_group=templates/artifact_ingestion/flow_controller.stg}, loggers={scheduled_loggers=[{template_name=flow_task_scheduled_log, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], post_loggers=[{template_name=flow_task_post_log_db, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_task_post_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], pre_loggers=[{template_name=flow_task_running_log, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_task_pre_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], retry_loggers=[{template_name=flow_task_retry_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}]}, completionCriteria={success={botTopics=[nabu_2_completion], criteria=[AND, {bot_metadata.tags.process_id=17000625869931891, opOperator===}, {opOperator===, bot_metadata.message_context=end_of_the_flow}]}, error={botTopics=[nabu_2_errorbot], criteria=[AND, {bot_metadata.tags.process_id=17000625869931891, opOperator===}, {opOperator===, bot_metadata.message_context=taskstatus_bot_error_msg}]}, retry=[AND, {error_data.retry_attempt=0, opOperator=<}, {error_data.error_json=(?i).*exception.*, opOperator=~}]}, app_template_details={template_name=generate_input_data, template_group=templates/artifact_ingestion/flow_controller.stg}, output_message_templates=[{template_name=artifact_generation_auth_token_msg, template_group=templates/artifact_ingestion/flow_controller.stg}], processor={classname=com.modak.bots.processor.NullProcessor, props={}}, flowTaskName=spark_ingestion_almaren_261_1}], job_schedule_id=1567, data_movement_id=261, inputFlows=[], outputFlows=[], flowId=17000625912115671, metaflowData={tags={tags=[ingestion_261_17000625866627691]}}}}
""2023-11-15 15:36:32.015 [pool-24-thread-20] DEBUG com.modak.bots.flowcontroller.FlowController - Inside startFlows() if block
""2023-11-15 15:36:32.015 [pool-24-thread-20] DEBUG com.modak.bots.flowcontroller.FlowController - flowsToBeStartedMap.keySet() is : [ingestion_261_17000625866627691]
""2023-11-15 15:36:32.015 [pool-24-thread-20] DEBUG com.modak.bots.flowcontroller.FlowController - checking the dependencies of flow ingestion_261_17000625866627691
""2023-11-15 15:36:32.015 [pool-24-thread-20] DEBUG com.modak.bots.flowcontroller.FlowController - dependencies are : []
""2023-11-15 15:36:32.015 [pool-24-thread-20] DEBUG com.modak.bots.flowcontroller.FlowController - isAllDependenciesCompleted value is  : true
""2023-11-15 15:36:32.015 [pool-24-thread-20] DEBUG com.modak.bots.flowcontroller.FlowController - completedFlowsStatusMap value is : {}
""2023-11-15 15:36:32.015 [pool-24-thread-20] DEBUG com.modak.bots.flowcontroller.FlowController - isAllDependenciesCompleted value is : true
""2023-11-15 15:36:32.015 [pool-24-thread-20] DEBUG com.modak.bots.flowcontroller.FlowController - flowTasks ingestion_261_17000625866627691 all dependencies [] are completed
""2023-11-15 15:36:32.015 [pool-24-thread-20] DEBUG com.modak.bots.flowcontroller.FlowController - flowInputMap when isAllDependenciesCompleted is true : {flowOutputTemplates=[{template_name=delete_almaren_code_from_kosh, template_group=templates/artifact_ingestion/flow_controller.stg}, {template_name=delete_created_credentials, template_group=templates/artifact_ingestion/flow_controller.stg}, {template_name=insert_pre_agg_stats_template, template_group=templates/artifact_ingestion/flow_controller.stg}], batch_id=17000625866627691, configuration={parallel=1, flowTimeoutHrs=23}, loggers={post_loggers=[{template_name=flow_post_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_post_log_db, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], pre_loggers=[{template_name=flow_pre_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_pre_log_db, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}]}, flowName=ingestion_261_17000625866627691, job_type_id=1, flow_type=ingestion, uiInfo={description=Auto generated by flow controller for flow ingestion_261_17000625866627691}, flowTasks=[{input_data={jwt_ttl=82800000, process_id=17000625869931891, flow_number=1, source_database_name_lowercase=development-db, batch_id=17000625866627691, workflow_name=artifact_generation, where_condition=37234, suffix=, job_type_id=1, ingestion_table_format=, job_schedule_id=1567, relative_file_path=, data_movement_name=ss_compass_adb_validation, source_schema_name_lowercase=acuity-develop, variables={env_variables={}, user_variables={}, payload_variables={}}, source_database_name_uppercase=DEVELOPMENT-DB, job_scheduled_user_id=Manaswini Chinthalapudi, source_schema_name_uppercase=ACUITY-DEVELOP, source_schema_name=acuity-develop, environment=modak, batch_name=Ingestion_20231115, source_database_name=development-db, authtoken_job_type=default, data_movement_id=261, last_run_timestamp=2023-11-07 12:42:00.86365, is_relative_file_path=false}, flowTaskId=2611, bot_metadata={tags={process_id=17000625869931891, batch_name=Ingestion_20231115, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365}}, retry_template={retry_template_name=artifact_generation_auth_token_msg_retry, retry_template_group=templates/artifact_ingestion/flow_controller.stg}, loggers={scheduled_loggers=[{template_name=flow_task_scheduled_log, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], post_loggers=[{template_name=flow_task_post_log_db, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_task_post_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], pre_loggers=[{template_name=flow_task_running_log, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_task_pre_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], retry_loggers=[{template_name=flow_task_retry_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}]}, completionCriteria={success={botTopics=[nabu_2_completion], criteria=[AND, {bot_metadata.tags.process_id=17000625869931891, opOperator===}, {opOperator===, bot_metadata.message_context=end_of_the_flow}]}, error={botTopics=[nabu_2_errorbot], criteria=[AND, {bot_metadata.tags.process_id=17000625869931891, opOperator===}, {opOperator===, bot_metadata.message_context=taskstatus_bot_error_msg}]}, retry=[AND, {error_data.retry_attempt=0, opOperator=<}, {error_data.error_json=(?i).*exception.*, opOperator=~}]}, app_template_details={template_name=generate_input_data, template_group=templates/artifact_ingestion/flow_controller.stg}, output_message_templates=[{template_name=artifact_generation_auth_token_msg, template_group=templates/artifact_ingestion/flow_controller.stg}], processor={classname=com.modak.bots.processor.NullProcessor, props={}}, flowTaskName=spark_ingestion_almaren_261_1}], job_schedule_id=1567, data_movement_id=261, inputFlows=[], outputFlows=[], flowId=17000625912115671, metaflowData={tags={tags=[ingestion_261_17000625866627691]}}}
""2023-11-15 15:36:32.015 [pool-24-thread-20] INFO  com.modak.bots.flowcontroller.Flow - Flow ingestion_261_17000625866627691 with FlowId 17000625912115671 subscribed topics : [nabu_2_errorbot, nabu_2_completion]
""2023-11-15 15:36:32.016 [pool-24-thread-20] INFO  com.modak.bots.flowcontroller.Flow - topics : [nabu_2_errorbot, nabu_2_completion]
""2023-11-15 15:36:32.016 [pool-24-thread-20] INFO  com.modak.bots.flowcontroller.Flow - topic : nabu_2_errorbot
""2023-11-15 15:36:32.016 [pool-24-thread-20] INFO  com.modak.bots.flowcontroller.Flow - not null
""2023-11-15 15:36:32.016 [pool-24-thread-20] INFO  com.modak.bots.flowcontroller.Flow - groupId fc_1700062592016438
""2023-11-15 15:36:32.016 [pool-24-thread-20] INFO  com.modak.bots.flowcontroller.Flow - topic : nabu_2_completion
""2023-11-15 15:36:32.016 [pool-24-thread-20] INFO  com.modak.bots.flowcontroller.Flow - not null
""2023-11-15 15:36:32.016 [pool-24-thread-20] INFO  com.modak.bots.flowcontroller.Flow - groupId fc_1700062592016438
""2023-11-15 15:36:32.016 [pool-24-thread-20] INFO  com.modak.bots.flowcontroller.Flow - subscribeTopicList : [{routing=nabu_2_errorbot, is_durable_queue=false, queue=fc_1700062592016438}, {routing=nabu_2_completion, is_durable_queue=false, queue=fc_1700062592016438}]
""2023-11-15 15:36:32.016 [pool-24-thread-20] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - messageBusConfig : {messageBusClassName=com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusPullAdapter, privateKeyPath=NABU_PRIVATE_KEY_PATH, rabbitMQConnectionConfig={control_topic=NABU_CONTROL_TOPIC, rabbitmq_ssl_enabled=NABU_RABBITMQ_SSL_ENABLED, control_messagebus_classname=com.modak.bots.messagebus.rabbitmq.RabbitMQControlMessageBusAdapter, heart_beat_frequency=5, heart_beat_duration=NABU_RABBITMQ_HEARTBEAT_DURATION, status_topic=NABU_STATUS_TOPIC, public_key_path=NABU_PUBLIC_KEY_PATH, password=NABU_RABBITMQ_ACCOUNT_PASS, rabbitmq_port=NABU_RABBITMQ_PORT, exchange=NABU_BOTWORKS_EXCHANGE_NAME, num_connections=10, rabbitmq_host=NABU_RABBITMQ_HOSTNAME, username=NABU_RABBITMQ_ACCOUNT, encrypted_password=N, virtual_host=NABU_RABBITMQ_VIRTUAL_HOST}, maximumMessageSize=1, botTopics=[{routing=nabu_2_errorbot, is_durable_queue=false, queue=fc_1700062592016438}, {routing=nabu_2_completion, is_durable_queue=false, queue=fc_1700062592016438}], publicKeyPath=NABU_PUBLIC_KEY_PATH}
""2023-11-15 15:36:32.016 [pool-24-thread-20] DEBUG com.modak.utils.connectionutils.rabbitmq.RabbitMQNabuConnectionFactory - rabbitMQConnectionConfig is : {control_topic=NABU_CONTROL_TOPIC, rabbitmq_ssl_enabled=NABU_RABBITMQ_SSL_ENABLED, control_messagebus_classname=com.modak.bots.messagebus.rabbitmq.RabbitMQControlMessageBusAdapter, heart_beat_frequency=5, heart_beat_duration=NABU_RABBITMQ_HEARTBEAT_DURATION, status_topic=NABU_STATUS_TOPIC, public_key_path=NABU_PUBLIC_KEY_PATH, password=NABU_RABBITMQ_ACCOUNT_PASS, rabbitmq_port=NABU_RABBITMQ_PORT, exchange=NABU_BOTWORKS_EXCHANGE_NAME, num_connections=10, rabbitmq_host=NABU_RABBITMQ_HOSTNAME, username=NABU_RABBITMQ_ACCOUNT, encrypted_password=N, virtual_host=NABU_RABBITMQ_VIRTUAL_HOST}
""2023-11-15 15:36:32.018 [pool-24-thread-20] INFO  com.modak.utils.connectionutils.rabbitmq.RabbitMQNabuConnectionFactory - Using Existing RabbitMQ connections
""2023-11-15 15:36:32.018 [pool-24-thread-20] INFO  com.modak.utils.connectionutils.rabbitmq.RabbitMQNabuConnectionFactory - Returning connection of address amqp://srv_account_rabbitmq@10.213.53.98:5672/
""2023-11-15 15:36:32.086 [pool-24-thread-20] DEBUG com.modak.bots.flowcontroller.Flow - parallelTaskCount for taskexecutors is 1
""2023-11-15 15:36:32.087 [pool-24-thread-20] DEBUG com.modak.bots.flowcontroller.FlowController - flow ingestion_261_17000625866627691 got submitted, the flowid of the flow 17000625912115671
""2023-11-15 15:36:32.087 [pool-24-thread-20] DEBUG com.modak.bots.flowcontroller.FlowController - runningFutureObjectsMap value is : {ingestion_261_17000625866627691=java.util.concurrent.FutureTask@5a26e39b}
""2023-11-15 15:36:32.087 [pool-24-thread-20] DEBUG com.modak.bots.flowcontroller.FlowController - triggered startFlows outside of loop
""2023-11-15 15:36:32.087 [pool-24-thread-20] DEBUG com.modak.bots.flowcontroller.FlowController - runningFutureObjectsMap is : {ingestion_261_17000625866627691=java.util.concurrent.FutureTask@5a26e39b}
""2023-11-15 15:36:32.111 [Thread-1786] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "55d073b7-0a29-499b-93b4-d604fddbbafc", "parent_id": "ca07b3da-5988-403b-9b89-4a7c46144b24", "bot_id": "bc98c972-baaf-4fc0-8920-c5549ebbc364", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":1700062586993189, "initial_ts":1700062586993, "batch_id":17000625866627691, "batch_name":"", "job_schedule_id":1567, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"bc98c972-baaf-4fc0-8920-c5549ebbc364", "bot_name":"DBOpsBot", "process_context":"data_movement_deciding", "task_name":"data_movement_deciding_msg", "process_id":"1700062586993189", "task_ts":1700062591644, "batch_id":"17000625866627691", "status_code_id": 6 } } ] }
""2023-11-15 15:36:32.112 [Thread-1786] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:36:32.115 [Thread-1786] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:36:32.115 [Thread-1786] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:32.115 [Thread-1786] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot finished processing message with id ca07b3da-5988-403b-9b89-4a7c46144b24
""2023-11-15 15:36:32.121 [Thread-680] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 97ffcb2c-0174-4d94-8b9d-f2d6b87a42ca has started processing message with message_id 7a86b9c2-5aa7-4426-9d46-33edea78c8e3 and thread_id 852 
""2023-11-15 15:36:32.121 [Thread-680] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:32.121 [Thread-680] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=b069046f-8526-4bc6-8dbc-93e25a119ff8, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=7a86b9c2-5aa7-4426-9d46-33edea78c8e3, task_retry_intervals_secs=[], bot_id=d6a03616-281f-4a28-9811-52d565f7ccd1, message_topic=nabu_2_taskmonitor, tags={process_id=1700062586993189, initial_ts=1700062586993, batch_name=, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, TaskMonitorBot]}}
""2023-11-15 15:36:32.121 [Thread-296] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 5a6ad2b1-dbad-437f-925c-391fad0cb6c1 has started processing message with message_id 55d073b7-0a29-499b-93b4-d604fddbbafc and thread_id 405 
""2023-11-15 15:36:32.121 [Thread-296] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:32.121 [Thread-296] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=ca07b3da-5988-403b-9b89-4a7c46144b24, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=55d073b7-0a29-499b-93b4-d604fddbbafc, task_retry_intervals_secs=[], bot_id=bc98c972-baaf-4fc0-8920-c5549ebbc364, message_topic=nabu_2_taskmonitor, tags={process_id=1700062586993189, initial_ts=1700062586993, batch_name=, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, TaskMonitorBot]}}
""2023-11-15 15:36:32.134 [Thread-680] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 1700062586993189, 'FlowControllerBot', 'flowcontroller_message_to_generate_flows', 'generate_flows', 10 , TO_TIMESTAMP(1700062591785::double precision / 1000) ,'d6a03616-281f-4a28-9811-52d565f7ccd1');
""2023-11-15 15:36:32.134 [Thread-680] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 97ffcb2c-0174-4d94-8b9d-f2d6b87a42ca has started process logic with message_id 7a86b9c2-5aa7-4426-9d46-33edea78c8e3 and thread_id 852
""2023-11-15 15:36:32.140 [Thread-680] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 97ffcb2c-0174-4d94-8b9d-f2d6b87a42ca has finished process logic with message_id 7a86b9c2-5aa7-4426-9d46-33edea78c8e3 and thread_id 852
""2023-11-15 15:36:32.140 [Thread-680] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:32.140 [Thread-680] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 7a86b9c2-5aa7-4426-9d46-33edea78c8e3
""2023-11-15 15:36:32.141 [Thread-296] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 1700062586993189, 'DBOpsBot', 'data_movement_deciding', 'data_movement_deciding_msg', 6 , TO_TIMESTAMP(1700062591644::double precision / 1000) ,'bc98c972-baaf-4fc0-8920-c5549ebbc364');
""2023-11-15 15:36:32.141 [Thread-296] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 5a6ad2b1-dbad-437f-925c-391fad0cb6c1 has started process logic with message_id 55d073b7-0a29-499b-93b4-d604fddbbafc and thread_id 405
""2023-11-15 15:36:32.514 [Thread-296] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 5a6ad2b1-dbad-437f-925c-391fad0cb6c1 has finished process logic with message_id 55d073b7-0a29-499b-93b4-d604fddbbafc and thread_id 405
""2023-11-15 15:36:32.514 [Thread-296] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:32.514 [Thread-296] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 55d073b7-0a29-499b-93b4-d604fddbbafc
""2023-11-15 15:36:42.228 [Thread-140] INFO  com.modak.bots.basebot.AbstractBaseBot - AuthTokenBot with bot_id e08c9817-76e3-4737-a19e-055d0ca3ef76 has started processing message with message_id 5317a19c-9159-4208-9fdc-c0d0f1b90608 and thread_id 224 
""2023-11-15 15:36:42.228 [Thread-140] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:42.228 [Thread-140] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=b069046f-8526-4bc6-8dbc-93e25a119ff8, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=generating_token_for_credentials, message_id=5317a19c-9159-4208-9fdc-c0d0f1b90608, task_retry_intervals_secs=[], bot_id=d6a03616-281f-4a28-9811-52d565f7ccd1, message_topic=nabu_2_authtoken, tags={process_id=17000625869931891, initial_ts=1700062586993, batch_name=Ingestion_20231115, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, job_scheduled_user_id=Manaswini Chinthalapudi, data_movement_id=261, last_run_timestamp=2023-11-07 12:42:00.86365, include_blobs=, retry_attempt=0, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken]}}
""2023-11-15 15:36:42.245 [Thread-140] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
doNothing
""2023-11-15 15:36:42.258 [Thread-140] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 15:36:42.259 [Thread-140] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:36:42.263 [Thread-140] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:36:42.263 [Thread-140] INFO  com.modak.bots.basebot.AbstractBaseBot - AuthTokenBot with bot_id e08c9817-76e3-4737-a19e-055d0ca3ef76 has started process logic with message_id 5317a19c-9159-4208-9fdc-c0d0f1b90608 and thread_id 224
""2023-11-15 15:36:42.791 [Thread-140] INFO  com.modak.bots.AuthTokenBot - connection closed!
""2023-11-15 15:36:42.791 [Thread-140] DEBUG com.modak.bots.AuthTokenBot - redisConfig map is : {minConnectionsIdleSize=NABU_REDIS_MIN_CONNECTION_IDLE_SIZE, password=NABU_REDIS_PASSWORD, PrivateKey=NABU_PRIVATE_KEY_PATH, redis_url=NABU_REDIS_URL, connection_pool_size=NABU_REDIS_CONNECTION_POOL_SIZE, idle_connection_timeout=NABU_REDIS_IDLE_CONNECTION_TIME_OUT, connection_timeout=NABU_REDIS_CONNECTION_TIME_OUT, encrypted_password=N}
""2023-11-15 15:36:42.792 [Thread-140] INFO  com.modak.bots.AuthTokenBot - authMapType: authTokenBotMap
""2023-11-15 15:36:42.792 [Thread-140] DEBUG com.modak.utils.jwt.AuthTokenGenerator - redisson object value is null
""2023-11-15 15:36:43.556 [Thread-1872] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id e66f3c06-216b-4861-be02-93ba09599724 has started processing message with message_id d41e9fca-25d9-4009-801d-ce3c9039527c and thread_id 2292 
""2023-11-15 15:36:43.556 [Thread-1872] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:43.556 [Thread-1872] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=5317a19c-9159-4208-9fdc-c0d0f1b90608, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=d41e9fca-25d9-4009-801d-ce3c9039527c, task_retry_intervals_secs=[], bot_id=e08c9817-76e3-4737-a19e-055d0ca3ef76, message_topic=nabu_2_taskmonitor, tags={process_id=17000625869931891, initial_ts=1700062586993, batch_name=Ingestion_20231115, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, TaskMonitorBot]}}
""2023-11-15 15:36:43.734 [Thread-1872] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 17000625869931891, 'AuthTokenBot', 'generating_token_for_credentials', 'generating_token_for_credentials', 10 , TO_TIMESTAMP(1700062602228::double precision / 1000) ,'e08c9817-76e3-4737-a19e-055d0ca3ef76');
""2023-11-15 15:36:43.734 [Thread-1872] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id e66f3c06-216b-4861-be02-93ba09599724 has started process logic with message_id d41e9fca-25d9-4009-801d-ce3c9039527c and thread_id 2292
""2023-11-15 15:36:44.096 [Thread-1872] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id e66f3c06-216b-4861-be02-93ba09599724 has finished process logic with message_id d41e9fca-25d9-4009-801d-ce3c9039527c and thread_id 2292
""2023-11-15 15:36:44.097 [Thread-1872] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:44.097 [Thread-1872] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id d41e9fca-25d9-4009-801d-ce3c9039527c
""2023-11-15 15:36:45.268 [Thread-140] INFO  com.modak.bots.basebot.AbstractBaseBot - AuthTokenBot with bot_id e08c9817-76e3-4737-a19e-055d0ca3ef76 has finished process logic with message_id 5317a19c-9159-4208-9fdc-c0d0f1b90608 and thread_id 224
""2023-11-15 15:36:45.268 [Thread-140] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : true
""2023-11-15 15:36:45.268 [Thread-140] INFO  com.modak.bots.basebot.AbstractBaseBot -  skipBotLogic == false && useIncomingData == true ..,so both inputData map and botLogic output map is send as output message
""2023-11-15 15:36:45.268 [Thread-140] INFO  com.modak.bots.basebot.AbstractBaseBot - botLogicOutput : { "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDYyNjA0ODY3ODczNSwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0NTQwNSwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2MjYwNH0.TdlKYjNFZRULplibTKTBiTeNTShCsDicocUZq9KQkMiynWn2WsDoCNVj1Gnby5Zevba71EIlyJc7hK0-wksFFLDOu-AutbS3q-JSjcWr7zHFmWQ3NR6Xs_ycLsdTfh9HnCPt4R-GHKm9SOS5CzT6JBg08gb9cZtV2havzmaG4v9vckfKagGuftWnBKcsQNp2h9zB_EDYLVdDOUd_Aa8UHMklrT8W0SjKoDgbHVZ5T506nwQL-nXZYY0_YHP9KqDtPRiRq-k6db434A4pMx6BkTAG1z355WIuqa1fwRtrSB5HZQULpX85KD8FMpbt2gBBHWDn01TnO5_crpf0lv-SfQ", "end_point" : "http:\/\/dev-dha.humana.com:8889\/fireshots\/credentialsFetchWebService" }
""2023-11-15 15:36:45.306 [Thread-140] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "DBOpsBot", "bot_metadata": { "message_id": "a489ee69-3503-4b6b-8101-2a8b49f47961", "parent_id": "5317a19c-9159-4208-9fdc-c0d0f1b90608", "bot_id": "e08c9817-76e3-4737-a19e-055d0ca3ef76", "message_topic":"nabu_2_jdbc", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":17000625869931891, "initial_ts":1700062586993, "batch_id":17000625866627691, "batch_name":"Ingestion_20231115", "job_schedule_id":1567, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "2023-11-07 12:42:00.86365", "environment": "modak", "ignore_job_termination" : false, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot" ],"task_dependency":true}, "task_retry_intervals_secs": [ ], "message_context": "generating pipeline start timestamp" }, "bot_tasks": [ { "task_name": "generating_relative_file_path", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "pre_task_logging_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "pre_log_template" }, "app_template_details": { "template_group": "templates/artifact_ingestion/ingestion_templates.stg", "template_name": "get_pipeline_run_timestamp_object_name" }, "input_data":{ "input_data" : { "jwt_ttl" : "82800000", "process_id" : "17000625869931891", "flow_number" : 1, "source_database_name_lowercase" : "development-db", "batch_id" : "17000625866627691", "workflow_name" : "artifact_generation", "where_condition" : "37234", "suffix" : "", "job_type_id" : "1", "ingestion_table_format" : "", "job_schedule_id" : 1567, "relative_file_path" : "", "data_movement_name" : "ss_compass_adb_validation", "source_schema_name_lowercase" : "acuity-develop", "currentBotMessageMap" : { "parent_id" : "b069046f-8526-4bc6-8dbc-93e25a119ff8", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "message_context" : "generating_token_for_credentials", "message_id" : "5317a19c-9159-4208-9fdc-c0d0f1b90608", "task_retry_intervals_secs" : [], "bot_id" : "d6a03616-281f-4a28-9811-52d565f7ccd1", "message_topic" : "nabu_2_authtoken", "tags" : { "process_id" : 17000625869931891, "initial_ts" : 1700062586993, "batch_name" : "Ingestion_20231115", "environment" : "modak", "batch_id" : 17000625866627691, "job_schedule_id" : 1567, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "data_movement_id" : 261, "last_run_timestamp" : "2023-11-07 12:42:00.86365", "include_blobs" : "", "retry_attempt" : 0, "tags" : [ "AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken" ] } }, "variables" : { "env_variables" : {}, "user_variables" : {}, "payload_variables" : {} }, "source_database_name_uppercase" : "DEVELOPMENT-DB", "botLogicOutputMap" : { "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDYyNjA0ODY3ODczNSwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0NTQwNSwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2MjYwNH0.TdlKYjNFZRULplibTKTBiTeNTShCsDicocUZq9KQkMiynWn2WsDoCNVj1Gnby5Zevba71EIlyJc7hK0-wksFFLDOu-AutbS3q-JSjcWr7zHFmWQ3NR6Xs_ycLsdTfh9HnCPt4R-GHKm9SOS5CzT6JBg08gb9cZtV2havzmaG4v9vckfKagGuftWnBKcsQNp2h9zB_EDYLVdDOUd_Aa8UHMklrT8W0SjKoDgbHVZ5T506nwQL-nXZYY0_YHP9KqDtPRiRq-k6db434A4pMx6BkTAG1z355WIuqa1fwRtrSB5HZQULpX85KD8FMpbt2gBBHWDn01TnO5_crpf0lv-SfQ", "end_point" : "http:\/\/dev-dha.humana.com:8889\/fireshots\/credentialsFetchWebService" }, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "source_schema_name_uppercase" : "ACUITY-DEVELOP", "source_schema_name" : "acuity-develop", "environment" : "modak", "batch_name" : "Ingestion_20231115", "source_database_name" : "development-db", "authtoken_job_type" : "default", "data_movement_id" : "261", "last_run_timestamp" : "2023-11-07 12:42:00.86365", "is_relative_file_path" : false }, "template_execution_type": "sequential", "useTransactionControl": true }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "generating_relative_file_path", "useIncomingData":true }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "task_status_success_msg" } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "error_template_create_msg" } ] } ] }
""2023-11-15 15:36:45.310 [Thread-140] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_jdbc
""2023-11-15 15:36:45.315 [Thread-140] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_jdbc
""2023-11-15 15:36:45.315 [Thread-140] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : true
""2023-11-15 15:36:45.315 [Thread-140] INFO  com.modak.bots.basebot.AbstractBaseBot -  skipBotLogic == false && useIncomingData == true ..,so both inputData map and botLogic output map is send as output message
""2023-11-15 15:36:45.315 [Thread-140] INFO  com.modak.bots.basebot.AbstractBaseBot - botLogicOutput : { "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDYyNjA0ODY3ODczNSwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0NTQwNSwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2MjYwNH0.TdlKYjNFZRULplibTKTBiTeNTShCsDicocUZq9KQkMiynWn2WsDoCNVj1Gnby5Zevba71EIlyJc7hK0-wksFFLDOu-AutbS3q-JSjcWr7zHFmWQ3NR6Xs_ycLsdTfh9HnCPt4R-GHKm9SOS5CzT6JBg08gb9cZtV2havzmaG4v9vckfKagGuftWnBKcsQNp2h9zB_EDYLVdDOUd_Aa8UHMklrT8W0SjKoDgbHVZ5T506nwQL-nXZYY0_YHP9KqDtPRiRq-k6db434A4pMx6BkTAG1z355WIuqa1fwRtrSB5HZQULpX85KD8FMpbt2gBBHWDn01TnO5_crpf0lv-SfQ", "end_point" : "http:\/\/dev-dha.humana.com:8889\/fireshots\/credentialsFetchWebService" }
""2023-11-15 15:36:45.326 [Thread-140] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "b285b07f-9e47-4561-9a40-f3320ef1a403", "parent_id": "5317a19c-9159-4208-9fdc-c0d0f1b90608", "bot_id": "e08c9817-76e3-4737-a19e-055d0ca3ef76", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":17000625869931891, "initial_ts":1700062586993, "batch_id":17000625866627691, "batch_name":"Ingestion_20231115", "job_schedule_id":1567, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "2023-11-07 12:42:00.86365", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"e08c9817-76e3-4737-a19e-055d0ca3ef76", "bot_name":"AuthTokenBot", "process_context":"generating_token_for_credentials", "task_name":"generating_token_for_credentials", "process_id":"17000625869931891", "task_ts":1700062605268, "batch_id":"17000625866627691", "status_code_id": 6 } } ] }
""2023-11-15 15:36:45.327 [Thread-140] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:36:45.330 [Thread-140] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:36:45.330 [Thread-140] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:45.330 [Thread-140] INFO  com.modak.bots.basebot.AbstractBaseBot - AuthTokenBot finished processing message with id 5317a19c-9159-4208-9fdc-c0d0f1b90608
""2023-11-15 15:36:45.421 [Thread-2301] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id e070d8f7-7524-4683-a208-e74b76c4d260 has started processing message with message_id b285b07f-9e47-4561-9a40-f3320ef1a403 and thread_id 2795 
""2023-11-15 15:36:45.421 [Thread-2301] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:45.421 [Thread-2301] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=5317a19c-9159-4208-9fdc-c0d0f1b90608, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=b285b07f-9e47-4561-9a40-f3320ef1a403, task_retry_intervals_secs=[], bot_id=e08c9817-76e3-4737-a19e-055d0ca3ef76, message_topic=nabu_2_taskmonitor, tags={process_id=17000625869931891, initial_ts=1700062586993, batch_name=Ingestion_20231115, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, TaskMonitorBot]}}
""2023-11-15 15:36:45.431 [Thread-1786] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id bc98c972-baaf-4fc0-8920-c5549ebbc364 has started processing message with message_id a489ee69-3503-4b6b-8101-2a8b49f47961 and thread_id 2193 
""2023-11-15 15:36:45.431 [Thread-1786] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:45.431 [Thread-1786] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=5317a19c-9159-4208-9fdc-c0d0f1b90608, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=generating pipeline start timestamp, message_id=a489ee69-3503-4b6b-8101-2a8b49f47961, task_retry_intervals_secs=[], bot_id=e08c9817-76e3-4737-a19e-055d0ca3ef76, message_topic=nabu_2_jdbc, tags={process_id=17000625869931891, batch_id=17000625866627691, job_scheduled_user_id=Manaswini Chinthalapudi, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot], initial_ts=1700062586993, batch_name=Ingestion_20231115, environment=modak, job_schedule_id=1567, data_movement_id=261, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, task_dependency=true, ignore_job_termination=false}}
""2023-11-15 15:36:45.433 [Thread-2301] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 17000625869931891, 'AuthTokenBot', 'generating_token_for_credentials', 'generating_token_for_credentials', 6 , TO_TIMESTAMP(1700062605268::double precision / 1000) ,'e08c9817-76e3-4737-a19e-055d0ca3ef76');
""2023-11-15 15:36:45.433 [Thread-2301] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id e070d8f7-7524-4683-a208-e74b76c4d260 has started process logic with message_id b285b07f-9e47-4561-9a40-f3320ef1a403 and thread_id 2795
""2023-11-15 15:36:45.811 [Thread-2301] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id e070d8f7-7524-4683-a208-e74b76c4d260 has finished process logic with message_id b285b07f-9e47-4561-9a40-f3320ef1a403 and thread_id 2795
""2023-11-15 15:36:45.811 [Thread-2301] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:45.811 [Thread-2301] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id b285b07f-9e47-4561-9a40-f3320ef1a403
""2023-11-15 15:36:46.020 [Thread-1786] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
{ "input_data": { "data_movement_id" : 261, "variables": { "env_variables": { }, "user_variables": { }, "payload_variables": { } }, "where_condition":"37234" }, "sequential_templates":[ { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_env_variables", "query_output_key": "get_env_variables", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_user_variables", "query_output_key": "get_user_variables", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "generate_variables", "query_output_key": "generate_variables", "query_type":"json", "encryption_details" : { "encryption" : "no", "encryption_type" : "" } }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "fetch_source_type", "query_output_key": "fetch_source_type", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_pipeline_run_timestamp", "query_output_key": "pipeline_run_timestamp", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_object_name", "query_output_key": "object_name", "query_type":"select" } ], "output_keys":["generate_variables","fetch_source_type","pipeline_run_timestamp","object_name"] }
""2023-11-15 15:36:46.030 [Thread-1786] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 15:36:46.031 [Thread-1786] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:36:46.034 [Thread-1786] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:36:46.034 [Thread-1786] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id bc98c972-baaf-4fc0-8920-c5549ebbc364 has started process logic with message_id a489ee69-3503-4b6b-8101-2a8b49f47961 and thread_id 2193
""2023-11-15 15:36:46.189 [Thread-520] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 66ff0f10-d990-450e-ab3f-02058068117b has started processing message with message_id 8b5e3464-b0e9-4a1f-88a3-69ed5ddde83f and thread_id 665 
""2023-11-15 15:36:46.190 [Thread-520] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:46.190 [Thread-520] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=a489ee69-3503-4b6b-8101-2a8b49f47961, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=8b5e3464-b0e9-4a1f-88a3-69ed5ddde83f, task_retry_intervals_secs=[], bot_id=bc98c972-baaf-4fc0-8920-c5549ebbc364, message_topic=nabu_2_taskmonitor, tags={process_id=17000625869931891, initial_ts=1700062586993, batch_name=Ingestion_20231115, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, TaskMonitorBot]}}
""2023-11-15 15:36:46.199 [Thread-520] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 17000625869931891, 'DBOpsBot', 'generating pipeline start timestamp', 'generating_relative_file_path', 10 , TO_TIMESTAMP(1700062605431::double precision / 1000) ,'bc98c972-baaf-4fc0-8920-c5549ebbc364');
""2023-11-15 15:36:46.199 [Thread-520] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 66ff0f10-d990-450e-ab3f-02058068117b has started process logic with message_id 8b5e3464-b0e9-4a1f-88a3-69ed5ddde83f and thread_id 665
""2023-11-15 15:36:46.325 [Thread-520] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 66ff0f10-d990-450e-ab3f-02058068117b has finished process logic with message_id 8b5e3464-b0e9-4a1f-88a3-69ed5ddde83f and thread_id 665
""2023-11-15 15:36:46.325 [Thread-520] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:46.325 [Thread-520] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 8b5e3464-b0e9-4a1f-88a3-69ed5ddde83f
""2023-11-15 15:36:46.480 [Thread-1786] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select
json_object_agg(ev.env_name,ev.env_value) as env_variables
from nabu.environment_variables ev
where is_deleted = false
""2023-11-15 15:36:46.688 [Thread-1786] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select
json_object_agg(a.user_variables_details->>'variable',a.user_variables_details->>'value') as user_variables
from (
select
	json_array_elements(dmp.data_movement_additional_info ->'user_variables_details') as user_variables_details
	from nabu.data_movement_physical dmp
	where dmp.data_movement_id = 261
	and dmp.valid_to_ts = '9999-12-31'
)a
""2023-11-15 15:36:47.431 [Thread-1786] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : {
    "env_variables": {},
    "rest_api_variables": {},
    "user_variables": {},
    "payload_variables": {
},
}
""2023-11-15 15:36:47.630 [Thread-1786] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with CTE1 as (
select distinct dm.data_movement_id,dcml.metadata_category as source_type, dscl.dataplace_sub_component_type as source from nabu.data_movement_details_physical dm inner join nabu.dataplace_physical dp on dp.dataplace_id=dm.source_dataplace_id
inner join  nabu.dataplace_component_mapping_lookup dcml on dcml.dataplace_sub_component_id =dp.dataplace_sub_component_id
inner join nabu.dataplace_sub_component_lookup dscl on dcml.dataplace_sub_component_id =dscl.dataplace_sub_component_id
where dm.data_movement_id=261 and dp.valid_to_ts='9999-12-31 00:00:00' and dm.valid_to_ts ='9999-12-31 00:00:00'
),
CTE2 as (
select distinct dm.data_movement_id,dcml.metadata_category as destination_type, dscl.dataplace_sub_component_type as destination,dscl.dataplace_sub_component_id as id from nabu.data_movement_details_physical dm inner join nabu.dataplace_physical dp on dp.dataplace_id=dm.destination_dataplace_id
inner join  nabu.dataplace_component_mapping_lookup dcml on dcml.dataplace_sub_component_id =dp.dataplace_sub_component_id
inner join nabu.dataplace_sub_component_lookup dscl on dcml.dataplace_sub_component_id =dscl.dataplace_sub_component_id
where dm.data_movement_id=261 and dp.valid_to_ts='9999-12-31 00:00:00' and dm.valid_to_ts ='9999-12-31 00:00:00'
)
select a.data_movement_id,a.source_type as source_metadata_category,b.destination_type as destination_metadata_category, a.source , b.destination  ,
 case when(a.source_type = 'file') then true else false end as is_source_filetype ,
 case when(a.source_type = 'salesforce') then true else false end as is_source_salesforce,
 case when(a.source_type = 'collection') then true else false end as is_source_mongodb,
 case when(b.destination_type = 'file') then true else false end as is_destination_filetype
,case when b.id in (7,11,25,27) then true else false end as is_ordinalpos_startwith_zero,
case when b.destination='redshift' then true else false end as is_destination_redshift
from CTE1 a
inner join
CTE2 b on a.data_movement_id=b.data_movement_id
""2023-11-15 15:36:47.841 [Thread-1786] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with pipeline_ts as(
select flow_ts, data_movement_id, job_type_id,
to_char(flow_ts::timestamp,'dd Month yyyy HH24:mi:ss ')||(SELECT abbrev  FROM pg_timezone_names WHERE name = current_setting('TIMEZONE')) as pipeline_run_time, flow_ts::timestamp(6) as pipeline_start_ts
from
(select *,ROW_NUMBER () OVER (order by flow_ts desc) rank from nabu.flow_status
where data_movement_id = 261
and status_code_id = 11
)a where rank=1) select flow_ts,data_movement_id,job_type_id,pipeline_run_time,pipeline_start_ts,
pipeline_start_ts :: time as pipeline_start_time, EXTRACT(second  FROM   pipeline_start_ts)  as pipeline_start_second,EXTRACT(minute  FROM    pipeline_start_ts)  as pipeline_start_minute,EXTRACT(hour FROM   pipeline_start_ts)  as pipeline_start_hour, EXTRACT(Day  FROM   pipeline_start_ts)  as pipeline_start_day,EXTRACT(month  FROM   pipeline_start_ts)  as pipeline_start_month,EXTRACT(year  FROM   pipeline_start_ts)  as pipeline_start_year,date(pipeline_start_ts) as pipeline_start_date from pipeline_ts;
""2023-11-15 15:36:48.067 [Thread-1786] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with flow_tables as (
select table_id,schema_id,table_name as source_object_name,upper(table_name) as source_object_name_uppercase,lower(table_name) as source_object_name_lowercase,
(b.advance_option_details->>'advanced_table_options')::json->>'new_table_name' as new_table_for_rename,
(b.advance_option_details->'advanced_table_options'->'columns_options'-> 'modified_columns')::json as modified_columns,
(b.advance_option_details->'advanced_table_options'->'columns_options'-> 'virtual_column')::json as virtual_column,
(b.advance_option_details->'advanced_table_options'->'reorder_columns')::json as reorder_columns,
schema_name as schema_name,dataplace_id,estimated_rows
from nabu.dataplace_table_metadata_physical a
left outer join nabu.advanced_options_object_details b
on a.table_id = b.object_id
where a.table_id in (37234)
and b.data_movement_id = 261
and a.valid_to_ts = '9999-12-31'
and b.valid_to_ts = '9999-12-31'
)
select source_object_name,source_object_name_uppercase,source_object_name_lowercase,
new_table_for_rename,modified_columns,virtual_column,reorder_columns
from flow_tables;
""2023-11-15 15:36:48.072 [Thread-1786] DEBUG com.modak.bots.DBOpsBot - to execute query timeTakenInMillis : 2038
""2023-11-15 15:36:48.072 [Thread-1786] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id bc98c972-baaf-4fc0-8920-c5549ebbc364 has finished process logic with message_id a489ee69-3503-4b6b-8101-2a8b49f47961 and thread_id 2193
""2023-11-15 15:36:48.072 [Thread-1786] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : true
""2023-11-15 15:36:48.072 [Thread-1786] INFO  com.modak.bots.basebot.AbstractBaseBot -  skipBotLogic == false && useIncomingData == true ..,so both inputData map and botLogic output map is send as output message
""2023-11-15 15:36:48.072 [Thread-1786] INFO  com.modak.bots.basebot.AbstractBaseBot - botLogicOutput : { "generate_variables" : "{\n    \"env_variables\": {},\n    \"rest_api_variables\": {},\n    \"user_variables\": {},\n    \"payload_variables\": {\n},\n}", "pipeline_run_timestamp" : [ { "flow_ts" : "2023-11-15 15:36:32.112299", "data_movement_id" : 261, "job_type_id" : 1, "pipeline_run_time" : "15 November  2023 15:36:32 UTC", "pipeline_start_ts" : "2023-11-15 15:36:32.112299", "pipeline_start_time" : "15:36:32", "pipeline_start_second" : 32.112299, "pipeline_start_minute" : 36.0, "pipeline_start_hour" : 15.0, "pipeline_start_day" : 15.0, "pipeline_start_month" : 11.0, "pipeline_start_year" : 2023.0, "pipeline_start_date" : "2023-11-15" } ], "object_name" : [ { "source_object_name" : "aaaa", "source_object_name_uppercase" : "AAAA", "source_object_name_lowercase" : "aaaa", "new_table_for_rename" : "", "modified_columns" : [], "virtual_column" : [], "reorder_columns" : [] } ], "fetch_source_type" : [ { "data_movement_id" : 261, "source_metadata_category" : "relational", "destination_metadata_category" : "file", "source" : "sql_server", "destination" : "adls_gen2", "is_source_filetype" : false, "is_source_salesforce" : false, "is_source_mongodb" : false, "is_destination_filetype" : true, "is_ordinalpos_startwith_zero" : false, "is_destination_redshift" : false } ] }
""2023-11-15 15:36:48.100 [Thread-1786] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "DBOpsBot", "bot_metadata": { "message_id": "97843105-4698-4d82-bd4e-8537da067a65", "parent_id": "a489ee69-3503-4b6b-8101-2a8b49f47961", "bot_id": "bc98c972-baaf-4fc0-8920-c5549ebbc364", "message_topic":"nabu_2_jdbc", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":17000625869931891, "initial_ts":1700062586993, "batch_id":17000625866627691, "batch_name":"Ingestion_20231115", "job_schedule_id":1567, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "2023-11-07 12:42:00.86365", "environment": "modak", "ignore_job_termination" : false, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot" ],"task_dependency":true}, "task_retry_intervals_secs": [ ], "message_context": "generating relative file path" }, "bot_tasks": [ { "task_name": "generating_relative_file_path", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "skipLogicPattern": "doNothing", "pre_task_logging_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "pre_log_template" }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "doNothingTemplate" }, "input_data":{ "query_input" : { "environment": "modak", "data_movement_id": "261", "data_movement_name": "ss_compass_adb_validation", "process_id": "17000625869931891", "batch_id": "17000625866627691", "batch_name": "Ingestion_20231115", "workflow_name": "artifact_generation", "flow_number": 1, "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDYyNjA0ODY3ODczNSwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0NTQwNSwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2MjYwNH0.TdlKYjNFZRULplibTKTBiTeNTShCsDicocUZq9KQkMiynWn2WsDoCNVj1Gnby5Zevba71EIlyJc7hK0-wksFFLDOu-AutbS3q-JSjcWr7zHFmWQ3NR6Xs_ycLsdTfh9HnCPt4R-GHKm9SOS5CzT6JBg08gb9cZtV2havzmaG4v9vckfKagGuftWnBKcsQNp2h9zB_EDYLVdDOUd_Aa8UHMklrT8W0SjKoDgbHVZ5T506nwQL-nXZYY0_YHP9KqDtPRiRq-k6db434A4pMx6BkTAG1z355WIuqa1fwRtrSB5HZQULpX85KD8FMpbt2gBBHWDn01TnO5_crpf0lv-SfQ", "end_point" : "http://dev-dha.humana.com:8889/fireshots/credentialsFetchWebService", "where_condition": "37234", "job_schedule_id": 1567, "job_type_id": "1", "job_scheduled_user_id": "Manaswini Chinthalapudi", "is_relative_file_path": false, "source_schema_name": "acuity-develop", "source_database_name": "development-db", "source_database_name_uppercase": "DEVELOPMENT-DB", "source_database_name_lowercase": "development-db", "source_schema_name_lowercase": "acuity-develop", "source_schema_name_uppercase": "ACUITY-DEVELOP", "relative_file_path": "", "ingestion_table_format": "", "suffix": "", "new_table_for_rename": "", "modified_columns": [ ], "virtual_column": [ ], "reorder_columns": [ ], "last_run_timestamp": "2023-11-07 12:42:00.86365" }, "variables": { "env_variables": {}, "rest_api_variables": {}, "user_variables": {}, "payload_variables": { }, }, "pipelineInfoMap": { "pipeline_id" : 261, "pipeline_name" : "ss_compass_adb_validation", "pipeline_lastrun_ts" : "2023-11-07 12:42:00.86365", "pipeline_run_id" : 17000625866627691, "source_schema_name" : "acuity-develop", "source_database_name": "development-db", "source_schema_name_lowercase" : "acuity-develop", "source_database_name_lowercase": "development-db", "source_schema_name_uppercase" : "ACUITY-DEVELOP", "source_database_name_uppercase": "DEVELOPMENT-DB", "pipeline_start_ts" : "2023-11-15 15:36:32.112299", "pipeline_start_year" : "2023.0", "pipeline_start_month" : "2023.0", "pipeline_start_day" : "15.0", "pipeline_start_date" : "2023-11-15", "pipeline_start_time" : "15:36:32", "pipeline_start_hour" : "15.0", "pipeline_start_minute" : "36.0", "pipeline_start_second" : "32.112299", "source_object_name": "aaaa", "source_object_name_lowercase":"aaaa", "source_object_name_uppercase":"AAAA", "file_name_with_extension" : "", "file_name_with_extension_uppercase" : "", "file_name_with_extension_lowercase" : "", "parent_folder_structure" : "", "parent_folder_structure_uppercase" : "", "parent_folder_structure_lowercase" : "" }, }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/ingestion_flow.stg", "template_name": "get_metadata_and_generate_almaren", "useIncomingData":true }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "task_status_success_msg", "useIncomingData":true } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "error_template_create_msg" } ] } ] }
""2023-11-15 15:36:48.102 [Thread-1786] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_jdbc
""2023-11-15 15:36:48.106 [Thread-1786] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_jdbc
""2023-11-15 15:36:48.106 [Thread-1786] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-15 15:36:48.115 [Thread-1786] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "abb9129b-18e7-4bb3-ab4b-bc48a1166935", "parent_id": "a489ee69-3503-4b6b-8101-2a8b49f47961", "bot_id": "bc98c972-baaf-4fc0-8920-c5549ebbc364", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":17000625869931891, "initial_ts":1700062586993, "batch_id":17000625866627691, "batch_name":"Ingestion_20231115", "job_schedule_id":1567, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "2023-11-07 12:42:00.86365", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"bc98c972-baaf-4fc0-8920-c5549ebbc364", "bot_name":"DBOpsBot", "process_context":"generating pipeline start timestamp", "task_name":"generating_relative_file_path", "process_id":"17000625869931891", "task_ts":1700062608072, "batch_id":"17000625866627691", "status_code_id": 6 } } ] }
""2023-11-15 15:36:48.117 [Thread-1786] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:36:48.120 [Thread-1786] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:36:48.120 [Thread-1786] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:48.120 [Thread-1786] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot finished processing message with id a489ee69-3503-4b6b-8101-2a8b49f47961
""2023-11-15 15:36:48.170 [Thread-1088] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id eb98777c-2746-4c23-b657-adabf0f68e34 has started processing message with message_id 97843105-4698-4d82-bd4e-8537da067a65 and thread_id 1330 
""2023-11-15 15:36:48.170 [Thread-1088] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:48.170 [Thread-1088] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=a489ee69-3503-4b6b-8101-2a8b49f47961, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=generating relative file path, message_id=97843105-4698-4d82-bd4e-8537da067a65, task_retry_intervals_secs=[], bot_id=bc98c972-baaf-4fc0-8920-c5549ebbc364, message_topic=nabu_2_jdbc, tags={process_id=17000625869931891, batch_id=17000625866627691, job_scheduled_user_id=Manaswini Chinthalapudi, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot], initial_ts=1700062586993, batch_name=Ingestion_20231115, environment=modak, job_schedule_id=1567, data_movement_id=261, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, task_dependency=true, ignore_job_termination=false}}
""2023-11-15 15:36:48.177 [Thread-2109] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id fbdedbfc-29c2-4920-8a17-84af9031800f has started processing message with message_id abb9129b-18e7-4bb3-ab4b-bc48a1166935 and thread_id 2570 
""2023-11-15 15:36:48.177 [Thread-2109] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:48.177 [Thread-2109] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=a489ee69-3503-4b6b-8101-2a8b49f47961, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=abb9129b-18e7-4bb3-ab4b-bc48a1166935, task_retry_intervals_secs=[], bot_id=bc98c972-baaf-4fc0-8920-c5549ebbc364, message_topic=nabu_2_taskmonitor, tags={process_id=17000625869931891, initial_ts=1700062586993, batch_name=Ingestion_20231115, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, TaskMonitorBot]}}
""2023-11-15 15:36:48.180 [Thread-1088] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
doNothing
""2023-11-15 15:36:48.187 [Thread-2109] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 17000625869931891, 'DBOpsBot', 'generating pipeline start timestamp', 'generating_relative_file_path', 6 , TO_TIMESTAMP(1700062608072::double precision / 1000) ,'bc98c972-baaf-4fc0-8920-c5549ebbc364');
""2023-11-15 15:36:48.190 [Thread-2109] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id fbdedbfc-29c2-4920-8a17-84af9031800f has started process logic with message_id abb9129b-18e7-4bb3-ab4b-bc48a1166935 and thread_id 2570
""2023-11-15 15:36:48.193 [Thread-1088] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 15:36:48.195 [Thread-1088] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:36:48.201 [Thread-1088] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:36:48.201 [Thread-1088] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : true
""2023-11-15 15:36:48.206 [Thread-2157] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 19c706d0-6de8-4b2b-8547-86efb990c03a has started processing message with message_id b19f1fd8-e6f0-4a3d-8251-a22822b00c4a and thread_id 2626 
""2023-11-15 15:36:48.206 [Thread-2157] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:48.206 [Thread-2157] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=97843105-4698-4d82-bd4e-8537da067a65, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=b19f1fd8-e6f0-4a3d-8251-a22822b00c4a, task_retry_intervals_secs=[], bot_id=eb98777c-2746-4c23-b657-adabf0f68e34, message_topic=nabu_2_taskmonitor, tags={process_id=17000625869931891, initial_ts=1700062586993, batch_name=Ingestion_20231115, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot, TaskMonitorBot]}}
""2023-11-15 15:36:48.595 [Thread-2109] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id fbdedbfc-29c2-4920-8a17-84af9031800f has finished process logic with message_id abb9129b-18e7-4bb3-ab4b-bc48a1166935 and thread_id 2570
""2023-11-15 15:36:48.595 [Thread-2109] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:48.595 [Thread-2109] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id abb9129b-18e7-4bb3-ab4b-bc48a1166935
""2023-11-15 15:36:48.621 [Thread-2157] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 17000625869931891, 'DBOpsBot', 'generating relative file path', 'generating_relative_file_path', 10 , TO_TIMESTAMP(1700062608170::double precision / 1000) ,'eb98777c-2746-4c23-b657-adabf0f68e34');
""2023-11-15 15:36:48.621 [Thread-2157] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 19c706d0-6de8-4b2b-8547-86efb990c03a has started process logic with message_id b19f1fd8-e6f0-4a3d-8251-a22822b00c4a and thread_id 2626
""2023-11-15 15:36:48.978 [Thread-2157] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 19c706d0-6de8-4b2b-8547-86efb990c03a has finished process logic with message_id b19f1fd8-e6f0-4a3d-8251-a22822b00c4a and thread_id 2626
""2023-11-15 15:36:48.978 [Thread-2157] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:48.978 [Thread-2157] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id b19f1fd8-e6f0-4a3d-8251-a22822b00c4a
""2023-11-15 15:36:49.439 [Thread-1088] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "DBOpsBot", "bot_metadata": { "message_id": "af56d8ab-458b-4c73-86bf-553c24550201", "parent_id": "97843105-4698-4d82-bd4e-8537da067a65", "bot_id": "eb98777c-2746-4c23-b657-adabf0f68e34", "message_topic":"nabu_2_jdbc", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":17000625869931891, "initial_ts":1700062586993, "batch_id":17000625866627691, "batch_name":"Ingestion_20231115", "job_schedule_id":1567, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "2023-11-07 12:42:00.86365", "environment": "modak", "ignore_job_termination" : false, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot", "KoshBot" ],"task_dependency":true}, "task_retry_intervals_secs": [ ], "message_context": "get_metadata_and_generate_almaren" }, "bot_tasks": [ { "task_name": "get_metadata_and_generate_almaren", "data_processor": { "classname": "com.modak.bots.processor.FilePathProcessor", "props": {} }, "skipLogicPattern": "doNothing", "pre_task_logging_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "pre_log_template" }, "app_template_details": { "template_group": "templates/artifact_ingestion/ingestion_templates.stg", "template_name": "table_metadata_query" }, "input_data": { "template_execution_type": "sequential", "useTransactionControl": true, "environment": "modak", "data_movement_id": "261", "data_movement_name": "ss_compass_adb_validation", "process_id": "17000625869931891", "batch_id": "17000625866627691", "batch_name": "Ingestion_20231115", "workflow_name": "artifact_generation", "flow_number": 1, "where_condition": "37234", "job_schedule_id": 1567, "job_type_id": "1", "job_scheduled_user_id": "Manaswini Chinthalapudi", "is_relative_file_path": false, "source_schema_name": "acuity-develop", "source_database_name": "development-db", "source_schema_name_uppercase": "ACUITY-DEVELOP", "source_database_name_uppercase": "DEVELOPMENT-DB", "source_schema_name_lowercase": "acuity-develop", "source_database_name_lowercase": "development-db", "relative_file_path": "", "last_run_timestamp": "2023-11-07 12:42:00.86365", "jwt_token":"eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDYyNjA0ODY3ODczNSwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0NTQwNSwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2MjYwNH0.TdlKYjNFZRULplibTKTBiTeNTShCsDicocUZq9KQkMiynWn2WsDoCNVj1Gnby5Zevba71EIlyJc7hK0-wksFFLDOu-AutbS3q-JSjcWr7zHFmWQ3NR6Xs_ycLsdTfh9HnCPt4R-GHKm9SOS5CzT6JBg08gb9cZtV2havzmaG4v9vckfKagGuftWnBKcsQNp2h9zB_EDYLVdDOUd_Aa8UHMklrT8W0SjKoDgbHVZ5T506nwQL-nXZYY0_YHP9KqDtPRiRq-k6db434A4pMx6BkTAG1z355WIuqa1fwRtrSB5HZQULpX85KD8FMpbt2gBBHWDn01TnO5_crpf0lv-SfQ", "end_point":"http://dev-dha.humana.com:8889/fireshots/credentialsFetchWebService", "processor_input": [ { "key": "relative_file_path", "value": "", "option_type": "file" }, { "key": "new_table_for_rename", "value": "", "option_type": "db" }, { "key": "modified_columns", "value": [ ], "value_type": "list", "keys_to_replace": [ { "path": "column_info.destination_column_name", "decryption": "" }, { "path": "column_info.source_casting_exp", "decryption": "BASE64" } ], "option_type": "db" }, { "key": "virtual_column", "value": [ ], "value_type": "list", "keys_to_replace": [ { "path": "column_name", "decryption": "" }, { "path": "spark_sql_expression", "decryption": "BASE64" } ], "option_type": "db" }, { "key": "reorder_columns", "value": [ ], "value_type": "list", "keys_to_replace": [ { "path": "column_name", "decryption": "" } ], "option_type": "db" }, { "key": "ingestion_table_format", "value": "", "option_type": "db" }, { "key": "suffix", "value": "", "option_type": "db" } ], "variables": { "env_variables": { }, "user_variables": { }, "payload_variables": { } }, "option_type":"", "pipelineInfoMap":{"source_database_name_lowercase" : "development-db","pipeline_start_time" : "15:36:32","parent_folder_structure_uppercase" : "","file_name_with_extension_lowercase" : "","pipeline_start_ts" : "2023-11-15 15:36:32.112299","source_object_name_uppercase" : "AAAA","pipeline_start_month" : "2023.0","pipeline_start_date" : "2023-11-15","pipeline_start_second" : "32.112299","pipeline_id" : "261","pipeline_run_id" : "17000625866627691","source_schema_name_lowercase" : "acuity-develop","pipeline_lastrun_ts" : "2023-11-07 12:42:00.86365","pipeline_start_hour" : "15.0","source_database_name_uppercase" : "DEVELOPMENT-DB","parent_folder_structure_lowercase" : "","source_object_name" : "aaaa","file_name_with_extension_uppercase" : "","parent_folder_structure" : "","pipeline_name" : "ss_compass_adb_validation","source_schema_name_uppercase" : "ACUITY-DEVELOP","source_schema_name" : "acuity-develop","pipeline_start_year" : "2023.0","source_object_name_lowercase" : "aaaa","source_database_name" : "development-db","pipeline_start_minute" : "36.0","pipeline_start_day" : "15.0","file_name_with_extension" : ""}, "retry_attempt" : 0 }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/ingestion_flow.stg", "template_name": "ingestion_deciding_msg" }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "task_status_success_msg" } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "error_template_create_msg" } ] } ] }
""2023-11-15 15:36:49.441 [Thread-1088] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_jdbc
""2023-11-15 15:36:49.444 [Thread-1088] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_jdbc
""2023-11-15 15:36:49.444 [Thread-1088] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : true
""2023-11-15 15:36:49.455 [Thread-1088] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "ac13ec46-3948-4d92-be7f-240dd66099fb", "parent_id": "97843105-4698-4d82-bd4e-8537da067a65", "bot_id": "eb98777c-2746-4c23-b657-adabf0f68e34", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":17000625869931891, "initial_ts":1700062586993, "batch_id":17000625866627691, "batch_name":"Ingestion_20231115", "job_schedule_id":1567, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "2023-11-07 12:42:00.86365", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"eb98777c-2746-4c23-b657-adabf0f68e34", "bot_name":"DBOpsBot", "process_context":"generating relative file path", "task_name":"generating_relative_file_path", "process_id":"17000625869931891", "task_ts":1700062608201, "batch_id":"17000625866627691", "status_code_id": 6 } } ] }
""2023-11-15 15:36:49.456 [Thread-1088] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:36:49.459 [Thread-1088] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:36:49.459 [Thread-1088] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:49.459 [Thread-1088] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot finished processing message with id 97843105-4698-4d82-bd4e-8537da067a65
""2023-11-15 15:36:49.473 [Thread-2109] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id fbdedbfc-29c2-4920-8a17-84af9031800f has started processing message with message_id ac13ec46-3948-4d92-be7f-240dd66099fb and thread_id 2570 
""2023-11-15 15:36:49.473 [Thread-2109] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:49.473 [Thread-2109] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=97843105-4698-4d82-bd4e-8537da067a65, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=ac13ec46-3948-4d92-be7f-240dd66099fb, task_retry_intervals_secs=[], bot_id=eb98777c-2746-4c23-b657-adabf0f68e34, message_topic=nabu_2_taskmonitor, tags={process_id=17000625869931891, initial_ts=1700062586993, batch_name=Ingestion_20231115, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot, TaskMonitorBot]}}
""2023-11-15 15:36:49.476 [Thread-2176] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id b006ad5b-9517-4ef8-87e2-7c6dea91f146 has started processing message with message_id af56d8ab-458b-4c73-86bf-553c24550201 and thread_id 2649 
""2023-11-15 15:36:49.476 [Thread-2176] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:49.476 [Thread-2176] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=97843105-4698-4d82-bd4e-8537da067a65, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=get_metadata_and_generate_almaren, message_id=af56d8ab-458b-4c73-86bf-553c24550201, task_retry_intervals_secs=[], bot_id=eb98777c-2746-4c23-b657-adabf0f68e34, message_topic=nabu_2_jdbc, tags={process_id=17000625869931891, batch_id=17000625866627691, job_scheduled_user_id=Manaswini Chinthalapudi, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot, KoshBot], initial_ts=1700062586993, batch_name=Ingestion_20231115, environment=modak, job_schedule_id=1567, data_movement_id=261, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, task_dependency=true, ignore_job_termination=false}}
""2023-11-15 15:36:49.477 [Thread-2176] INFO  com.modak.bots.processor.FilePathProcessor - Processed input data:
{ "process_id" : "17000625869931891", "flow_number" : 1, "source_database_name_lowercase" : "development-db", "batch_id" : "17000625866627691", "workflow_name" : "artifact_generation", "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDYyNjA0ODY3ODczNSwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0NTQwNSwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2MjYwNH0.TdlKYjNFZRULplibTKTBiTeNTShCsDicocUZq9KQkMiynWn2WsDoCNVj1Gnby5Zevba71EIlyJc7hK0-wksFFLDOu-AutbS3q-JSjcWr7zHFmWQ3NR6Xs_ycLsdTfh9HnCPt4R-GHKm9SOS5CzT6JBg08gb9cZtV2havzmaG4v9vckfKagGuftWnBKcsQNp2h9zB_EDYLVdDOUd_Aa8UHMklrT8W0SjKoDgbHVZ5T506nwQL-nXZYY0_YHP9KqDtPRiRq-k6db434A4pMx6BkTAG1z355WIuqa1fwRtrSB5HZQULpX85KD8FMpbt2gBBHWDn01TnO5_crpf0lv-SfQ", "end_point" : "http:\/\/dev-dha.humana.com:8889\/fireshots\/credentialsFetchWebService", "where_condition" : "37234", "reorder_columns" : [], "suffix" : "", "job_type_id" : "1", "ingestion_table_format" : "", "job_schedule_id" : 1567, "data_movement_name" : "ss_compass_adb_validation", "relative_file_path" : "", "retry_attempt" : 0, "source_schema_name_lowercase" : "acuity-develop", "currentBotMessageMap" : { "parent_id" : "97843105-4698-4d82-bd4e-8537da067a65", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "message_context" : "get_metadata_and_generate_almaren", "message_id" : "af56d8ab-458b-4c73-86bf-553c24550201", "task_retry_intervals_secs" : [], "bot_id" : "eb98777c-2746-4c23-b657-adabf0f68e34", "message_topic" : "nabu_2_jdbc", "tags" : { "process_id" : 17000625869931891, "batch_id" : 17000625866627691, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "tags" : [ "AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot", "KoshBot" ], "initial_ts" : 1700062586993, "batch_name" : "Ingestion_20231115", "environment" : "modak", "job_schedule_id" : 1567, "data_movement_id" : 261, "last_run_timestamp" : "2023-11-07 12:42:00.86365", "retry_attempt" : 0, "task_dependency" : true, "ignore_job_termination" : false } }, "variables" : { "env_variables" : {}, "user_variables" : {}, "payload_variables" : {} }, "source_database_name_uppercase" : "DEVELOPMENT-DB", "processor_input" : [ { "option_type" : "file", "value" : "", "key" : "relative_file_path" }, { "option_type" : "db", "value" : "", "key" : "new_table_for_rename" }, { "value_type" : "list", "keys_to_replace" : [ { "path" : "column_info.destination_column_name", "decryption" : "" }, { "path" : "column_info.source_casting_exp", "decryption" : "BASE64" } ], "option_type" : "db", "value" : [], "key" : "modified_columns" }, { "value_type" : "list", "keys_to_replace" : [ { "path" : "column_name", "decryption" : "" }, { "path" : "spark_sql_expression", "decryption" : "BASE64" } ], "option_type" : "db", "value" : [], "key" : "virtual_column" }, { "value_type" : "list", "keys_to_replace" : [ { "path" : "column_name", "decryption" : "" } ], "option_type" : "db", "value" : [], "key" : "reorder_columns" }, { "option_type" : "db", "value" : "", "key" : "ingestion_table_format" }, { "option_type" : "db", "value" : "", "key" : "suffix" } ], "option_type" : "", "job_scheduled_user_id" : "Manaswini Chinthalapudi", "pipelineInfoMap" : { "source_database_name_lowercase" : "development-db", "pipeline_start_time" : "15:36:32", "current_day_of_year" : 319, "parent_folder_structure_uppercase" : "", "file_name_with_extension_lowercase" : "", "current_day" : "15", "pipeline_start_ts" : "2023-11-15 15:36:32.112299", "source_object_name_uppercase" : "AAAA", "pipeline_start_month" : "11", "current_year" : "2023", "pipeline_start_date" : "2023-11-15", "current_second" : "49", "current_timestamp" : "2023-11-15 15:36:49", "pipeline_start_second" : "32", "pipeline_id" : "261", "pipeline_run_id" : "17000625866627691", "current_timestamp_iso" : "2023-11-15T15:36:49.476", "source_schema_name_lowercase" : "acuity-develop", "pipeline_lastrun_ts" : "2023-11-07 12:42:00.86365", "current_time" : "15:36:49", "pipeline_start_hour" : "15", "current_hour" : "15", "source_database_name_uppercase" : "DEVELOPMENT-DB", "current_week_of_month" : 3, "parent_folder_structure_lowercase" : "", "source_object_name" : "aaaa", "file_name_with_extension_uppercase" : "", "current_week_of_year" : 46, "parent_folder_structure" : "", "pipeline_name" : "ss_compass_adb_validation", "source_schema_name_uppercase" : "ACUITY-DEVELOP", "source_schema_name" : "acuity-develop", "pipeline_start_year" : "2023", "source_object_name_lowercase" : "aaaa", "current_date" : "2023-11-15", "source_database_name" : "development-db", "pipeline_start_minute" : "36", "current_minute" : "36", "current_month" : "11", "pipeline_start_day" : "15", "current_day_of_month" : 15, "file_name_with_extension" : "" }, "virtual_column" : [], "new_table_for_rename" : "", "source_schema_name_uppercase" : "ACUITY-DEVELOP", "source_schema_name" : "acuity-develop", "environment" : "modak", "batch_name" : "Ingestion_20231115", "source_database_name" : "development-db", "modified_columns" : [], "data_movement_id" : "261", "last_run_timestamp" : "2023-11-07 12:42:00.86365", "template_execution_type" : "sequential", "is_relative_file_path" : false, "useTransactionControl" : true }
""2023-11-15 15:36:49.485 [Thread-2109] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 17000625869931891, 'DBOpsBot', 'generating relative file path', 'generating_relative_file_path', 6 , TO_TIMESTAMP(1700062608201::double precision / 1000) ,'eb98777c-2746-4c23-b657-adabf0f68e34');
""2023-11-15 15:36:49.485 [Thread-2109] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id fbdedbfc-29c2-4920-8a17-84af9031800f has started process logic with message_id ac13ec46-3948-4d92-be7f-240dd66099fb and thread_id 2570
""2023-11-15 15:36:49.608 [Thread-2109] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id fbdedbfc-29c2-4920-8a17-84af9031800f has finished process logic with message_id ac13ec46-3948-4d92-be7f-240dd66099fb and thread_id 2570
""2023-11-15 15:36:49.608 [Thread-2109] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:49.608 [Thread-2109] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id ac13ec46-3948-4d92-be7f-240dd66099fb
""2023-11-15 15:36:49.833 [Thread-2176] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
{ "input_data": { "is_relative_file_path" : false, "data_movement_id" : 261, "flow_number" : 1, "where_condition":"37234", "process_id" : 17000625869931891, "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDYyNjA0ODY3ODczNSwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0NTQwNSwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2MjYwNH0.TdlKYjNFZRULplibTKTBiTeNTShCsDicocUZq9KQkMiynWn2WsDoCNVj1Gnby5Zevba71EIlyJc7hK0-wksFFLDOu-AutbS3q-JSjcWr7zHFmWQ3NR6Xs_ycLsdTfh9HnCPt4R-GHKm9SOS5CzT6JBg08gb9cZtV2havzmaG4v9vckfKagGuftWnBKcsQNp2h9zB_EDYLVdDOUd_Aa8UHMklrT8W0SjKoDgbHVZ5T506nwQL-nXZYY0_YHP9KqDtPRiRq-k6db434A4pMx6BkTAG1z355WIuqa1fwRtrSB5HZQULpX85KD8FMpbt2gBBHWDn01TnO5_crpf0lv-SfQ", "end_point" : "http://dev-dha.humana.com:8889/fireshots/credentialsFetchWebService", "batch_id": 17000625866627691, "batch_name": "Ingestion_20231115", "job_type_id": "1", "job_scheduled_user_id":"Manaswini Chinthalapudi", "job_schedule_id":1567, "variables": { "env_variables": { }, "user_variables": { }, "payload_variables": { } }, "relative_file_path":"", "ingestion_table_format":"", "suffix":"", "new_table_for_rename":"", "modified_columns":[ ], "virtual_column":[ ], "reorder_columns":[ ], "last_run_timestamp":"2023-11-07 12:42:00.86365", "source_database_name_uppercase":"DEVELOPMENT-DB", "source_database_name":"development-db", "source_database_name_lowercase":"development-db", "source_schema_name_lowercase":"acuity-develop", "source_schema_name_uppercase":"ACUITY-DEVELOP", "retry_attempt" : "0" }, "sequential_templates":[ { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "check_compute_engine_validity_data_movement", "query_output_key": "check_compute_engine_validity", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_pipeline_run_timestamp", "query_output_key": "pipeline_run_timestamp", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "fetch_source_type", "query_output_key": "fetch_source_type", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "fetching_script_inputs", "query_output_key": "spark_script_inputs", "query_type":"select", "env_values":["NABU_ENV"] }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_table_adv_opt_partition_details", "query_output_key": "table_adv_opt_details_partition_details", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_remove_duplicates_data", "query_output_key": "remove_duplicates_data", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_sort_columns_data", "query_output_key": "sort_columns_data", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_table_adv_opt_details", "query_output_key": "table_adv_opt_details", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "advanced_options_tables_flags", "query_output_key": "advanced_options_tables_flags", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "advanced_options_tables_flags_status", "query_output_key": "advanced_options_tables_flags_status", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "sort_by_columns_data", "query_output_key": "sort_by_columns_data", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "incremental_load_details", "query_output_key": "incremental_load_details", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_place_holders_with_default_and_max_values", "query_output_key": "place_holders_with_default_and_max_values", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "replace_place_holders_in_wherecondition_with_default_and_max_values", "query_output_key": "updated_wherecondition_replaced_with_default_and_max_values", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_incremental_max_columns_with_column_ids", "query_output_key": "incremental_max_columns_with_column_ids", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "generate_list_of_maps_of_incremental_columns", "query_output_key": "list_of_maps_of_incremental_columns", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_already_renamed_condition", "query_output_key": "get_already_renamed_condition", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_ingestion_information", "query_output_key": "table_metadata_output", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "is_cdc", "query_output_key": "is_cdc", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "cdc_schema_drift_new_table", "query_output_key": "cdc_schema_drift_new_table", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_cdc_type", "query_output_key": "get_cdc_type", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_cdc_info", "query_output_key": "get_cdc_info", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_prev_cdc_id", "query_output_key": "get_prev_cdc_id", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_new_cdc_id", "query_output_key": "get_new_cdc_id", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "update_cdc_xref", "query_output_key": "update_cdc_xref", "query_type":"update" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "insert_cdc_xref", "query_output_key": "insert_cdc_xref", "query_type":"insert" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_cdc_audit_cols", "query_output_key": "get_cdc_audit_cols", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_view_info", "query_output_key": "get_view_info", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_already_ingested_condition", "query_output_key": "get_already_ingested_condition", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_partition_information_test", "query_output_key": "table_partition_output", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "fetch_object_column_metadata", "query_output_key": "column_metadata_output", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "fetch_destination_transformation_query_details", "query_output_key": "destination_transformation_query_details_output", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "generate_primary_cols_output", "query_output_key": "generate_primary_cols_output", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_varchar_columns_destination", "query_output_key": "get_varchar_columns_destination", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_varchar_columns", "query_output_key": "get_varchar_columns", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_partition_cols", "query_output_key": "get_partition_cols", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_non_partition_cols", "query_output_key": "get_non_partition_cols", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "fetch_ingested_details", "query_output_key": "fetch_ingested_details", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "target_schemadrift_details", "query_output_key": "target_schemadrift_details", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "target_schemadrift_flag", "query_output_key": "target_schemadrift_flag", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_ingestion_mode", "query_output_key": "ingestion_mode", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_cdc_last_run_table", "query_output_key": "get_cdc_last_run_table", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "cdc_first_time", "query_output_key": "cdc_first_time", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "fetch_virtual_column_details", "query_output_key": "virtual_column_metadata_output", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_list_of_maps_of_partition_columns", "query_output_key": "get_list_of_maps_of_partition_columns", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "insert_into_process_id_table_map", "query_output_key": "insert_into_process_id_table_map", "query_type":"insert" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_spark_configs", "query_output_key": "get_spark_configs", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "generate_spark_configs_json", "query_output_key": "generate_spark_configs_json", "query_type":"json", "encryption_details" : { "encryption" : "yes", "encryption_type" : "BASE64" } }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "generate_extra_configs_json_ingestion", "query_output_key": "generate_extra_configs_json_ingestion", "query_type":"select", "env_values":["NABU_ENV"] }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "generate_extra_configs_json", "query_output_key": "generate_extra_configs_json", "query_type":"json", "env_values":["NABU_ENV"], "encryption_details" : { "encryption" : "yes", "encryption_type" : "BASE64" } }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "fetching_credential_inputs", "query_output_key": "fetching_credential_inputs", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "aes_encrypted_token", "query_output_key": "aes_encrypted_token", "query_type":"json", "encryption_details" : { "encryption" : "yes", "encryption_type" : "AES" } }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "generate_file_content_json", "query_output_key": "generate_file_content_json", "query_type":"json", "encryption_details" : { "encryption" : "yes", "encryption_type" : "BASE64" } }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "generate_base64_pipeline_timeout_json", "query_output_key": "generate_base64_pipeline_timeout_json", "query_type":"json", "encryption_details" : { "encryption" : "yes", "encryption_type" : "BASE64" } }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "generate_yeedu_metastore_credential", "query_output_key": "generate_yeedu_metastore_credential", "query_type":"json", "encryption_details" : { "encryption" : "yes", "encryption_type" : "BASE64" } }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "generate_credential_json", "query_output_key": "base64_encrypted_json_creds", "query_type":"json", "encryption_details" : { "encryption" : "yes", "encryption_type" : "BASE64" } }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "convert_base64_encrypted_json_creds_to_rsa", "query_output_key": "base64_rsa_compressed_encrypted_creds", "query_type":"json", "encryption_details" : { "encryption" : "yes", "encryption_type" : "RSA_BASE64" } }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "generate_source_input_json_for_checkpoint", "query_output_key": "input_json_for_checkpoint_status", "query_type":"json", "encryption_details" : { "encryption" : "yes", "encryption_type" : "BASE64" } }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "emr_input_json", "query_output_key": "emr_input_json", "query_type":"json", "encryption_details" : { "encryption" : "yes", "encryption_type" : "BASE64" } }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "yeedu_input_json", "query_output_key": "yeedu_input_json", "query_type":"json", "encryption_details" : { "encryption" : "yes", "encryption_type" : "BASE64" } }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "generate_almaren_artifact", "query_output_key": "encrypted_script", "query_type":"json", "env_values":["NABU_ENV"], "encryption_details" : { "encryption" : "yes", "encryption_type" : "GZIP_BASE64" } }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "insert_almaren_code", "query_output_key": "insert_almaren_code", "query_type":"insert" } ], "output_keys":["emr_input_json","yeedu_input_json","get_cdc_last_run_table","check_compute_engine_validity","get_list_of_maps_of_partition_columns","ingestion_mode","advanced_options_tables_flags_status","get_partition_cols","get_non_partition_cols","table_partition_output","fetch_source_type","table_metadata_output","get_already_ingested_condition","column_metadata_output","input_data","table_adv_opt_details","incremental_load_details", "place_holders_with_default_and_max_values", "updated_wherecondition_replaced_with_default_and_max_values", "incremental_max_columns_with_column_ids", "list_of_maps_of_incremental_columns", "base64_rsa_compressed_encrypted_creds","input_json_for_checkpoint_status","spark_script_inputs","remove_duplicates_data","sort_by_columns_data","destination_transformation_query_details_output","get_cdc_info","get_cdc_type","get_cdc_audit_cols","cdc_first_time","get_view_info","target_schemadrift_details","target_schemadrift_flag","cdc_schema_drift_new_table","get_spark_configs","generate_spark_configs_json", "generate_extra_configs_json","generate_file_content_json","fetching_credential_inputs","generate_yeedu_metastore_credential","generate_base64_pipeline_timeout_json","get_varchar_columns","get_varchar_columns_destination"] }
""2023-11-15 15:36:49.848 [Thread-2176] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 15:36:49.850 [Thread-2176] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:36:49.853 [Thread-2176] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:36:49.853 [Thread-2176] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id b006ad5b-9517-4ef8-87e2-7c6dea91f146 has started process logic with message_id af56d8ab-458b-4c73-86bf-553c24550201 and thread_id 2649
""2023-11-15 15:36:50.015 [Thread-2157] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 19c706d0-6de8-4b2b-8547-86efb990c03a has started processing message with message_id 0da2b880-5e20-4eb1-8d0f-9ffebc02c63b and thread_id 2626 
""2023-11-15 15:36:50.015 [Thread-2157] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:50.015 [Thread-2157] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=af56d8ab-458b-4c73-86bf-553c24550201, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=0da2b880-5e20-4eb1-8d0f-9ffebc02c63b, task_retry_intervals_secs=[], bot_id=b006ad5b-9517-4ef8-87e2-7c6dea91f146, message_topic=nabu_2_taskmonitor, tags={process_id=17000625869931891, initial_ts=1700062586993, batch_name=Ingestion_20231115, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot, KoshBot, TaskMonitorBot]}}
""2023-11-15 15:36:50.030 [Thread-2157] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 17000625869931891, 'DBOpsBot', 'get_metadata_and_generate_almaren', 'get_metadata_and_generate_almaren', 10 , TO_TIMESTAMP(1700062609476::double precision / 1000) ,'b006ad5b-9517-4ef8-87e2-7c6dea91f146');
""2023-11-15 15:36:50.030 [Thread-2157] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 19c706d0-6de8-4b2b-8547-86efb990c03a has started process logic with message_id 0da2b880-5e20-4eb1-8d0f-9ffebc02c63b and thread_id 2626
""2023-11-15 15:36:50.150 [Thread-2157] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 19c706d0-6de8-4b2b-8547-86efb990c03a has finished process logic with message_id 0da2b880-5e20-4eb1-8d0f-9ffebc02c63b and thread_id 2626
""2023-11-15 15:36:50.150 [Thread-2157] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:36:50.150 [Thread-2157] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 0da2b880-5e20-4eb1-8d0f-9ffebc02c63b
""2023-11-15 15:36:50.425 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select
case when ce.valid_to_ts = '9999-12-31' then true else false
end as is_valid_compute_engine
from nabu.data_movement_physical dmp
left outer join nabu.compute_engine ce
on dmp.compute_engine_id = ce.compute_engine_id
where dmp.data_movement_id = 261
and dmp.valid_to_ts ='9999-12-31'
""2023-11-15 15:36:51.092 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with pipeline_ts as(
select flow_ts, data_movement_id, job_type_id,
to_char(flow_ts::timestamp,'dd Month yyyy HH24:mi:ss ')||(SELECT abbrev  FROM pg_timezone_names WHERE name = current_setting('TIMEZONE')) as pipeline_run_time, flow_ts::timestamp(6) as pipeline_start_ts
from
(select *,ROW_NUMBER () OVER (order by flow_ts desc) rank from nabu.flow_status
where data_movement_id = 261
and status_code_id = 11
)a where rank=1) select flow_ts,data_movement_id,job_type_id,pipeline_run_time,pipeline_start_ts,
pipeline_start_ts :: time as pipeline_start_time, EXTRACT(second  FROM   pipeline_start_ts)  as pipeline_start_second,EXTRACT(minute  FROM    pipeline_start_ts)  as pipeline_start_minute,EXTRACT(hour FROM   pipeline_start_ts)  as pipeline_start_hour, EXTRACT(Day  FROM   pipeline_start_ts)  as pipeline_start_day,EXTRACT(month  FROM   pipeline_start_ts)  as pipeline_start_month,EXTRACT(year  FROM   pipeline_start_ts)  as pipeline_start_year,date(pipeline_start_ts) as pipeline_start_date from pipeline_ts;
""2023-11-15 15:36:51.361 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with CTE1 as (
select distinct dm.data_movement_id,dcml.metadata_category as source_type, dscl.dataplace_sub_component_type as source from nabu.data_movement_details_physical dm inner join nabu.dataplace_physical dp on dp.dataplace_id=dm.source_dataplace_id
inner join  nabu.dataplace_component_mapping_lookup dcml on dcml.dataplace_sub_component_id =dp.dataplace_sub_component_id
inner join nabu.dataplace_sub_component_lookup dscl on dcml.dataplace_sub_component_id =dscl.dataplace_sub_component_id
where dm.data_movement_id=261 and dp.valid_to_ts='9999-12-31 00:00:00' and dm.valid_to_ts ='9999-12-31 00:00:00'
),
CTE2 as (
select distinct dm.data_movement_id,dcml.metadata_category as destination_type, dscl.dataplace_sub_component_type as destination,dscl.dataplace_sub_component_id as id from nabu.data_movement_details_physical dm inner join nabu.dataplace_physical dp on dp.dataplace_id=dm.destination_dataplace_id
inner join  nabu.dataplace_component_mapping_lookup dcml on dcml.dataplace_sub_component_id =dp.dataplace_sub_component_id
inner join nabu.dataplace_sub_component_lookup dscl on dcml.dataplace_sub_component_id =dscl.dataplace_sub_component_id
where dm.data_movement_id=261 and dp.valid_to_ts='9999-12-31 00:00:00' and dm.valid_to_ts ='9999-12-31 00:00:00'
)
select a.data_movement_id,a.source_type as source_metadata_category,b.destination_type as destination_metadata_category, a.source , b.destination  ,
 case when(a.source_type = 'file') then true else false end as is_source_filetype ,
 case when(a.source_type = 'salesforce') then true else false end as is_source_salesforce,
 case when(a.source_type = 'collection') then true else false end as is_source_mongodb,
 case when(b.destination_type = 'file') then true else false end as is_destination_filetype
,case when b.id in (7,11,25,27) then true else false end as is_ordinalpos_startwith_zero,
case when b.destination='redshift' then true else false end as is_destination_redshift
from CTE1 a
inner join
CTE2 b on a.data_movement_id=b.data_movement_id
""2023-11-15 15:36:51.554 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with fetch_ssh_configuration as (
select  case when c.config_json->>'hostname' = '' or c.config_json->>'hostname' is null then 'null' else c.config_json->>'hostname' end as ssh_host,
        case when c.config_json->>'username' = '' or c.config_json->>'username' is null then 'null' else c.config_json->>'username' end as ssh_username,
        b.compute_engine_info->>'spark_version'  as spark_version,
        b.compute_engine_info->>'scala_version'  as scala_version,
        b.compute_engine_info->>'cluster_type' as cluster_ui,
        b.compute_engine_info->>'yeedu_rest_url' as rest_url,
case when b.compute_engine_info->>'cloud_provider'= '' or b.compute_engine_info->>'cloud_provider' is null  then 'null'
    else b.compute_engine_info->>'cloud_provider' end as cloud_type,
case when b.compute_engine_info->>'nabu_external_path'= '' or b.compute_engine_info->>'nabu_external_path' is null  then 'null'
    else b.compute_engine_info->>'nabu_external_path' end as spark_location,
b.compute_engine_info->>'s3_bucket_path' as s3_bucket_path,
case when b.compute_engine_info->>'cluster_library_path' is not null or b.compute_engine_info->>'cluster_library_path' != '' then trim(trailing '/' from (b.compute_engine_info->>'cluster_library_path'))
	else 'null' end as cluster_library_path ,
case when b.compute_engine_info->>'cluster_id' is not null or b.compute_engine_info->>'cluster_id' != ''  then b.compute_engine_info->>'cluster_id'
	else 'null' end as cluster_id ,
case when b.compute_engine_info->>'cluster' is not null or b.compute_engine_info->>'cluster' != '' then b.compute_engine_info->>'cluster'
	else 'null' end as dataproc_cluster ,
case when b.compute_engine_info->>'project' is not null or b.compute_engine_info->>'project' != '' then b.compute_engine_info->>'project'
	else 'null' end as dataproc_project ,
case when b.compute_engine_info->>'region' is not null or b.compute_engine_info->>'region' != '' then b.compute_engine_info->>'region'
	else 'null' end as region ,
	b.additional_info ->>'external_jars_map' as b64_external_jars_map,
	b.compute_engine_info->>'is_bucket_encrypted' as is_bucket_encrypted,
	b.compute_engine_info->>'execution_role' as execution_role,
	b.compute_engine_info->>'logGroupName' as logGroupName,
	b.compute_engine_info->>'release_label' as release_label,
	b.compute_engine_info->>'cloud_watch' as cloud_watch,
	b.compute_engine_info->>'s3logs' as s3logs,
        c.config_json->>'kerberos' as kerberos,
        a.data_movement_id , a.data_movement_name,b.engine_mapping_id,b.compute_engine_info
      from nabu.data_movement_physical a
inner join nabu.compute_engine b on a.compute_engine_id = b.compute_engine_id
inner join nabu.config c on  b.compute_engine_config_id = c.config_id
where a.data_movement_id =261 and a.valid_to_ts = '9999-12-31 00:00:00.000' and b.valid_to_ts = '9999-12-31 00:00:00.000'
)
select ssh_host,ssh_username,kerberos::boolean,d.spark_location,d.data_movement_name,d.cluster_library_path,lower(engine_sub_type) as engine_sub_type,d.spark_version,d.scala_version,d.cloud_type,d.cluster_ui,d.rest_url,
cluster_id,dataproc_project,region,dataproc_cluster,s3_bucket_path,is_bucket_encrypted,
execution_role,logGroupName,release_label,cloud_watch,s3logs,
case when engine_sub_type ~*'cdh|cdp' and kerberos ='false'
          then additional_properties ->> 'non_kerberos_sub_engine_path'
          else additional_properties ->> 'default_sub_engine_path' end as engine_path,replace(encode(compute_engine_info::text::bytea,'base64'),E'\n','') as compute_engine_info,
case when engine_sub_type ~*'cdh|cdp|insight|standalone' then spark_location||'/nabu-spark-bots/keys/privateKey'
     when engine_sub_type ~*'cde' then '/app/mount/privateKey'
     when lower(engine_sub_type) ~*'dataproc|glue|ec2' then 'privateKey'
     when lower(engine_sub_type) ~*'databricks cluster' then cluster_library_path||'/dev/nabu/17000625869931891/0/privateKey'
     when lower(engine_sub_type) ~*'databricks' then '/dbfs/tmp/dev/nabu/17000625869931891/0/privateKey'
     when lower(engine_sub_type) ~*'eks' then '/home/hadoop/privateKey'
     when lower(engine_sub_type) ~*'yeedu' then '/yeedu/object-storage-manager/privateKey'
     else null
     end as private_key_path,b64_external_jars_map
from fetch_ssh_configuration d
inner join nabu.engine_mapping_lookup e on d.engine_mapping_id = e.engine_mapping_id
inner join nabu.engine_sub_type_lookup f on f.engine_sub_type_id = e.engine_sub_type_id
""2023-11-15 15:36:51.769 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with advanced_option_details as(
    select object_id, data_movement_id, (advance_option_details->'advanced_table_options')::json as advanced_table_options
    from nabu.advanced_options_object_details aood
    where object_id = 37234 and
    data_movement_id = 261 and
    valid_to_ts='9999-12-31'
)
,parallel_hash_ingestion as(
    select ((advanced_table_options->'parallel_hash_ingestion')->>'enable')::boolean as is_parallel_hash_ingestion,
    ((advanced_table_options->'parallel_hash_ingestion')->>'max_connections')::int as hash_max_conns,
    ((advanced_table_options->'parallel_hash_ingestion')->>'int_column_name') as hash_int_column_name,
    object_id, data_movement_id
    from advanced_option_details
)
, parallel_ingestion as(
    select ((advanced_table_options->'parallel_ingestion')->>'enable')::boolean as is_parallel_ingestion,
    ((advanced_table_options->'parallel_ingestion')->>'max_connections')::int as max_conns,
    object_id, data_movement_id
    from advanced_option_details
)
select
a.object_id,a.data_movement_id,
is_parallel_ingestion,
is_parallel_hash_ingestion,
hash_int_column_name,
case when is_parallel_ingestion then max_conns
	when is_parallel_hash_ingestion then hash_max_conns
	else 2
end as maximum_parallel_connections
from advanced_option_details a
left outer join parallel_hash_ingestion b
on a.object_id = b.object_id
and a.data_movement_id = b.data_movement_id
left outer join parallel_ingestion c
on a.object_id = c.object_id
and a.data_movement_id = c.data_movement_id
""2023-11-15 15:36:51.987 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with duplicate_columns as(
select
case when((partition_columns ->>'renamed_column')='')
then (partition_columns ->>'column_name')
else
(partition_columns ->>'renamed_column')
end as partition_column_name,
(partition_columns ->>'column_name') as original_column_name
from(
select json_array_elements (advance_option_details ->'advanced_table_options'->'remove_duplicates'->'key_columns' )::json as partition_columns from nabu.advanced_options_object_details where data_movement_id =261 and
valid_to_ts ='9999-12-31' and object_id in (37234)
) jsonarray
),
valid_columns as(
select Exists(
SELECT array_element AS missing_elements
FROM (
  SELECT original_column_name AS array_element from duplicate_columns
) AS array_elements
WHERE array_element <> ALL (
SELECT column_name FROM nabu.dataplace_column_metadata_physical dcmp where table_id in (37234) and valid_to_ts = '9999-12-31'
)
)
)

select * from valid_columns, duplicate_columns
""2023-11-15 15:36:52.201 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with sort_columns as(
SELECT
(sort_columns ->>'column_name') as sort_column_name,
concat((sort_columns ->>'column_name'),'_tmp_rm') as sort_column_order_by_name,
(sort_columns ->> 'sort_by') as sort_order,
case when((sort_columns ->> 'sort_null_values')= '')
then (sort_columns ->>'')
else
(sort_columns->> 'sort_null_values')
end as sort_null_value,
(sort_columns ->>'column_name') as original_column_name
from
(
select
json_array_elements (advance_option_details ->'advanced_table_options'->'remove_duplicates'->'sort_columns' ) as sort_columns from nabu.advanced_options_object_details where data_movement_id =261 and
valid_to_ts ='9999-12-31' and object_id in (37234)
) sort
),
valid_columns as(
select Exists(
SELECT array_element AS missing_elements
FROM (
  SELECT original_column_name AS array_element from sort_columns
) AS array_elements
WHERE array_element <> ALL (
SELECT column_name FROM nabu.dataplace_column_metadata_physical dcmp where table_id in (37234) and valid_to_ts = '9999-12-31'
)
)
)

select * from valid_columns, sort_columns
""2023-11-15 15:36:52.413 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : Select *, (advance_option_details->'advanced_table_options'->>'dataplace_id')::int as dataplace_id from nabu.advanced_options_object_details where object_id =37234 and data_movement_id=261 and valid_to_ts='9999-12-31'
""2023-11-15 15:36:52.620 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select advance_option_details ->> 'advanced_option_flags'  as advanced_options_flags
from nabu.advanced_options_object_details
where data_movement_id= 261
and valid_to_ts ='9999-12-31'
and object_id in (37234)
""2023-11-15 15:36:52.814 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select * from json_to_record(
'{
"table_name": "aaaa",
"table_id": 37234,
"dataplace_id": 42,
"schema_id": 453,
"incremental_load": false,
"columns_options":  
																					 false 
,
"modified_columns": false,
"excluded_column_ids": false,
"virtual_column": false,
"reorder_columns": false,
"remove_duplicates": false,
"sort_by_columns": false,
"table_partitions": false,
"new_table_name": false,
"parallel_ingestion": false,
"parallel_hash_ingestion": false,
"CDC": false,
"ingest_using_query": false,
"ingestion_mode": true,
"enable_cache": false
}'
) as x(
incremental_load boolean ,
columns_options boolean ,
modified_columns boolean ,
excluded_column_ids boolean ,
virtual_column boolean ,
reorder_columns boolean ,
remove_duplicates boolean ,
sort_by_columns boolean ,
table_partitions boolean ,
new_table_name boolean ,
parallel_ingestion boolean ,
CDC boolean ,
ingest_using_query boolean ,
ingestion_mode boolean ,
enable_cache boolean 
)

""2023-11-15 15:36:53.024 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with sort_columns as(
select
columns_list ->>'order_by' as order_by,
case when((columns_list ->> 'sort_null_values')= '')
        then (columns_list ->>'')
    else concat('_',replace((columns_list->> 'sort_null_values'),' ','_'))
end as sort_null_value,
case when(columns_list ->>'renamed_column' ='')
        then columns_list ->>'column_name'
	else columns_list ->>'renamed_column'
end as final_column_name,
columns_list ->>'column_name' as original_column_name
from (
select
json_array_elements(((advance_option_details ->>'advanced_table_options')::json->>'sort_by_columns')::json) as columns_list
from nabu.advanced_options_object_details
where data_movement_id= 261 and valid_to_ts ='9999-12-31' and object_id in (37234)
)as advance_option_flags
),
valid_columns as(
select Exists(
SELECT array_element AS missing_elements
FROM (
  SELECT original_column_name AS array_element from sort_columns
) AS array_elements
WHERE array_element <> ALL (
SELECT column_name FROM nabu.dataplace_column_metadata_physical dcmp where table_id in (37234) and valid_to_ts = '9999-12-31'
)
)
)
select * from sort_columns,valid_columns
""2023-11-15 15:36:53.255 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select 1

""2023-11-15 15:36:53.457 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select 1

""2023-11-15 15:36:53.645 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select 1

""2023-11-15 15:36:53.837 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select 1

""2023-11-15 15:36:54.047 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select 1

""2023-11-15 15:36:54.244 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select
	case
		when a.object_id_count>0 then true
		else false
	end as table_renamed_exists
from
	(
            select
                count(*) as object_id_count
            from
                nabu.advanced_options_obj_checkpoint
            where
                advanced_option_obj_type_id = (
                select
                    advanced_options_obj_type_id
                from
                    nabu.advanced_options_obj_lookup
                where
                    advanced_options_obj_type = 'Renaming Table'
                )
                and
          object_id in (37234)
                and
          data_movement_id = 261
                and valid_to_ts = '9999-12-31'
   ) a
""2023-11-15 15:36:55.009 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with flow_tables as (
select table_id,schema_id,table_name,schema_name,dataplace_id,estimated_rows
from nabu.dataplace_table_metadata_physical
where table_id in (37234)
and valid_to_ts = '9999-12-31'
),
data_movement_schema_drift_table_ids as(
select * from(select data_movement_id, dataplace_id, schema_directory_id, object_id, cru_ts, row_number() over(partition by object_id order by cru_ts desc) as rownum
from nabu.data_movement_schema_drift_details
where data_movement_id = 261
and object_id in (37234))a
where rownum = 1
),
rename_table_advance_option as(
select a.data_movement_id ,a.object_id , '' as new_table_for_rename,
((a.advance_option_details->>'advanced_option_flags')::json->>'new_table_name')::boolean as rename_flag,
case when '' is null  then false
when '' = '' then false
else ((a.advance_option_details->>'advanced_option_flags')::json->>'new_table_name')::boolean end as rename_table_condition,
case when b.object_id is null then false else true end as already_ingested,
(select case when object_id_count = 0 then true else false end as already_renamed_flag from (
SELECT  count(*) as object_id_count
FROM nabu.advanced_options_obj_checkpoint
where
advanced_option_obj_type_id = (SELECT advanced_options_obj_type_id
FROM nabu.advanced_options_obj_lookup
WHERE advanced_options_obj_type = 'Renaming Table'
) and
object_id in (37234) and
data_movement_id = 261)a)
from nabu.advanced_options_object_details a
left join nabu.structured_jobtotable b
on a.data_movement_id =b.data_movement_id
and a.object_id =b.object_id
where
a.data_movement_id = 261
and a.object_id in (37234)
and a.valid_to_ts = '9999-12-31'
),
get_non_schema_drifted_table_ids as(
select a.dataplace_id,a.schema_id, a.dataplace_component_type_id,a.table_id
from nabu.dataplace_table_schema_drift_details a
inner join
data_movement_schema_drift_table_ids b
on a.table_id = b.object_id
and a.schema_id = b.schema_directory_id
and a.dataplace_id = b.dataplace_id
where a.valid_to_ts = '9999-12-31'
and a.crt_ts < b.cru_ts
and b.data_movement_id = 261
and table_id in (37234)
union
select a.dataplace_id,a.schema_id, a.dataplace_component_type_id,a.table_id
from nabu.dataplace_table_schema_drift_details a
inner join
nabu.structured_jobtotable b
on a.table_id = b.object_id
and a.dataplace_id = b.dataplace_id
where b.data_movement_id = 261
and a.valid_to_ts = '9999-12-31'
and table_id in (37234)
and b.cru_ts > a.crt_ts
and b.object_type = 'S'
union
select a.dataplace_id,a.schema_id, a.dataplace_component_type_id,a.table_id
from nabu.dataplace_table_schema_drift_details a
where table_id in (37234)
and a.valid_to_ts = '9999-12-31'
and table_id not in (select object_id as table_id from nabu.structured_jobtotable b
where b.data_movement_id = 261 and b.object_type = 'S'
)
),
dataplace_schema_drifted_tables as(
select * from nabu.dataplace_table_schema_drift_details dtsdd where dataplace_id in
(select source_dataplace_id from nabu.data_movement_details_physical dmdp
where data_movement_id = 261
and valid_to_ts = '9999-12-31')
and dtsdd.valid_to_ts = '9999-12-31'
),
flag_for_schema_drifted_tables as(
select a.table_id, a.schema_id,a.table_name,a.schema_id,a.dataplace_id,case when b.table_id is null and 1 != 6
and c.table_id is not null then true
else false
end as schema_drift_flag
from flow_tables a
left join
get_non_schema_drifted_table_ids b
on a.table_id = b.table_id
left join
dataplace_schema_drifted_tables c
on a.table_id = c.table_id
),
source_dataplace_details as (
select a.dataplace_id as source_dataplace_id,
case when 'file' = 'relational' then true else false end as is_create_table,
case when  (b.dataplace_sub_component_type='mysql') then true else false end as is_mysql,
case when  (b.dataplace_sub_component_type='bigquery') then true else false end as is_bigquery,
case when (b.dataplace_sub_component_type in ('db2_z_os','oracle')) then true else false end as is_needed_partition_name_without_column_name,
case when  (b.dataplace_sub_component_type='hive' or b.dataplace_sub_component_type='cloudera_hive') then ((dataplace_info->>'jdbc_info')::json)->>'jdbc_url'
else dataplace_info->>'host_name' end as source_url,
case when (b.dataplace_sub_component_type='hive' or b.dataplace_sub_component_type='cloudera_hive')  then trim(((dataplace_info->>'jdbc_info')::json)->>'database_name')
else trim(dataplace_info->>'database_name') end as source_db,
case when  (b.dataplace_sub_component_type='snowflake') then trim(dataplace_info->>'warehouse_name') end as warehouse_name,
case when  (lower(b.dataplace_sub_component_type)='sas') then dataplace_info->>'location_path' end as source_directory,
case when b.dataplace_sub_component_type = 'oracle' then dataplace_info->>'jdbc_url' end as oracle_jdbc_url,
case when b.dataplace_sub_component_type = 'hive' or b.dataplace_sub_component_type = 'cloudera_hive' then
(dataplace_info->>'jdbc_info')::json->>'database_name'
else dataplace_info->>'database_name' end as database_name,
case when ((b.dataplace_sub_component_type='hive' or b.dataplace_sub_component_type='cloudera_hive')) then true else false end as is_source_hive,
case when ((b.dataplace_sub_component_type='hive' or b.dataplace_sub_component_type='cloudera_hive') and dataplace_info->>'connection_mode' = 'Cluster mode') then true else false end as is_source_spark_hive,
lower(case when b.dataplace_sub_component_type  = 'cloudera_hive' then 'hive' else b.dataplace_sub_component_type end) as source_type,
case when dataplace_info->>'jdbc_url' like 'jdbc:sqlserver:%' then 'com.microsoft.sqlserver.jdbc.SQLServerDriver'
else b.additional_info ->>'jdbc_driver' end as source_jdbc_driver,
--b.additional_info->>'jdbc_driver' as source_jdbc_driver,
a.credential_id ,dataplace_info,
dataplace_info->>'project_id'  as project,
dataplace_info->>'bucket_name'  as bucket_name,
additional_info->>'default_credential' as source_default_credential_exists,
(dataplace_info->>'is_jdbc_url')::boolean as is_source_jdbc_url,
(dataplace_info->>'jdbc_url') as source_jdbc_url,
(dataplace_info->>'filesystem_info')::JSON->>'endpoint' as source_endpoint
from nabu.dataplace_physical a, nabu.dataplace_sub_component_lookup b
where a.dataplace_sub_component_id = b.dataplace_sub_component_id
and a.valid_to_ts = '9999-12-31'
and a.dataplace_id in (select dataplace_id from flow_tables)
),
source_credential_details as (
select a.*,b.credential_id as source_credential_id,b.credential_type_id as source_credential_type_id
from source_dataplace_details a left outer join nabu.credential_info b
on a.credential_id = b.credential_id
and b.valid_to_ts = '9999-12-31'
),
data_movement_details as (
select ingestion_table_format,valid_db_name,valid_schema_name,destination_dataplace_id ,destination_schema_directory_id ,intermediate_type,archive_files_path,is_archive_data,is_lazy_mode,is_record_process_enabled,file_format,pipeline_flow_timeout,
destination_file_format,source_dataplace_id, data_movement_id,verification_threshold, schema_drift_option, table_suffix, is_empty_suffix, table_timestamp from (
select destination_dataplace_id ,destination_schema_directory_id , source_dataplace_id, a.data_movement_id,
'' as ingestion_table_format,
((data_movement_additional_info->>'ingestion_table_format')::json->>'database_name')::boolean as valid_db_name,
((data_movement_additional_info->>'ingestion_table_format')::json->>'schema_name')::boolean as valid_schema_name,
(((data_movement_additional_info->>'flow_details')::json->>'archive_data')::json->>'archive_files_path') as archive_files_path,
(((data_movement_additional_info->>'flow_details')::json->>'archive_data')::json->>'file_format') as file_format,
(((data_movement_additional_info->>'flow_details')::json->>'archive_data')::json->>'enabled')::boolean as is_archive_data,
(((data_movement_additional_info->>'flow_details')::json->>'enable_cache'))::boolean as is_lazy_mode,
(((data_movement_additional_info->>'flow_details')::json->>'enable_count'))::boolean as is_record_process_enabled,
case
when d.metadata_category = 'file' or d.dataplace_sub_component_id =11 then 'parquet'
when lower(((dataplace_info->>'filesystem_info')::json)->>'file_system_type') is null and d.dataplace_sub_component_id not in (11) and  d.metadata_category in('relational','collection') then 'default'
when lower(((dataplace_info->>'filesystem_info')::json)->>'file_system_type') !='' and  d.metadata_category in('relational','collection') then 'parquet'
else
'parquet' end as destination_file_format,
case
when
coalesce(((data_movement_additional_info->'flow_details'->>'verification_details')::json->>'skip_verification'),'false')::boolean = 'false' then COALESCE(((data_movement_additional_info->'flow_details'->>'verification_details')::json->>'verification_threshold')::float/100,0.1)
else 1
end as verification_threshold,
case
when d.metadata_category = 'file' or d.dataplace_sub_component_id =11 then 'parquet'
when lower(((dataplace_info->>'filesystem_info')::json)->>'file_system_type') is null and d.dataplace_sub_component_id not in (11) and  d.metadata_category in('relational','collection') then 'default'
when lower(((dataplace_info->>'filesystem_info')::json)->>'file_system_type') !='' and  d.metadata_category in('relational','collection') then 'parquet'
else
'parquet' end as intermediate_type,
case when ((((data_movement_additional_info->>'flow_details')::json->>'schema_drift')::json)->>'advanced_options_sub_type') is null then 'drop_create_table'
else ((((data_movement_additional_info->>'flow_details')::json->>'schema_drift')::json)->>'advanced_options_sub_type') end as schema_drift_option,
('') as table_suffix,
coalesce((data_movement_additional_info->'flow_details'->>'flow_timeout')::int,(data_movement_additional_info->'flow_details'->>'pipeline_flow_timeout')::int,'72')  as pipeline_flow_timeout,
coalesce(TRIM(''), '') = '' as is_empty_suffix,
((((((data_movement_additional_info->>'flow_details')::json->>'schema_drift')::json)->>'config')::json)->>'timestamp')::text as table_timestamp
from nabu.data_movement_physical a
inner join  (select distinct  destination_dataplace_id ,destination_schema_directory_id , source_dataplace_id, data_movement_id  from nabu.data_movement_details_physical
where valid_to_ts = '9999-12-31' and data_movement_id = 261 )b on a.data_movement_id = b.data_movement_id
inner join nabu.dataplace_physical c on c.dataplace_id = b.destination_dataplace_id
inner join nabu.dataplace_component_mapping_lookup  d on d.dataplace_sub_component_id  = c.dataplace_sub_component_id
where d.dataplace_component_type_id =c.dataplace_component_type_id  and c.valid_to_ts = '9999-12-31'
)a
)
--select * from data_movement_details
,
source_details as (
select b.* ,new_table_for_rename,case when (coalesce(rename_table_condition,false) and (not already_renamed_flag))=true then true else false end as rename_table_condition,coalesce(already_ingested,false) as already_ingested
,c.rename_flag from
(select a.*,c.*
from flow_tables a
inner join data_movement_details c
on a.dataplace_id = c.source_dataplace_id
)b left join rename_table_advance_option c on
b.data_movement_id = c.data_movement_id
)
--select * from source_details
,
source_level_details as (
select *,
case when a.rename_flag = true then regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(new_table_for_rename,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '')
else regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace((coalesce(ingestion_table_format,'') || coalesce(db_name,'') || coalesce(source_schema_name,'') || table_name),'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') end as destination_table_name,
regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace((coalesce(ingestion_table_format,'') || coalesce(db_name,'') || coalesce(source_schema_name,'') || table_name),'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') as actual_destination_table_name,
regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace((coalesce(ingestion_table_format,'') || coalesce(db_name,'') || coalesce(source_schema_name,'') || table_name),'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') as source_table_name
--coalesce(ingestion_table_format,'') || coalesce(db_name,'') || coalesce(source_schema_name,'') || table_name as destination_table_name
from (
select b.*,a.*,
case when valid_db_name is true then database_name || '_' else '' end as db_name,
case when valid_schema_name is true then schema_name || '_' else '' end as source_schema_name
from source_credential_details a
inner join source_details b on a.source_dataplace_id = b.dataplace_id
)a
),
file_system_credentials as (
select c.credential_id,d.dataplace_id ,c.credential_name,c.credential_type_id, credential_type,extract(epoch from c.mod_ts) as credential_epoch from nabu.dataplace_physical d left outer join nabu.credential_info c
on (((dataplace_info->>'filesystem_info')::json)->>'credential_id')::integer = c.credential_id left join nabu.credential_type_lookup ct on c.credential_type_id = ct.credential_type_id
where d.dataplace_id in (select destination_dataplace_id from data_movement_details)
),
dest_dataplace_details as (
-- For the destination dataplace, get it's details
select a.dataplace_id as destination_dataplace_id,
case when  (b.dataplace_sub_component_type='hive' or b.dataplace_sub_component_type='cloudera_hive') then ((dataplace_info->>'jdbc_info')::json)->>'jdbc_url'
else dataplace_info->>'host_name' end as destination_url,
case when b.dataplace_sub_component_type = 'oracle' then dataplace_info->>'jdbc_url' end as destination_oracle_jdbc_url,
case
when ((b.dataplace_sub_component_type='hive' or b.dataplace_sub_component_type='cloudera_hive')
and dataplace_info->>'connection_mode' = 'Cluster mode') then ((dataplace_info->>'filesystem_info')::json)->>'ingestion_root_path'
when (b.dataplace_sub_component_type= 'azure_synapse') then ((dataplace_info->>'filesystem_info')::json)->>'ingestion_root_path'
when (b.dataplace_sub_component_type = 'bigquery') then dataplace_info->>'ingestion_root_path'
when (b.dataplace_sub_component_type = 'gcs') then dataplace_info->>'ingestion_root_path'
when (b.dataplace_sub_component_type = 'redshift') then ((dataplace_info->>'filesystem_info')::json)->>'ingestion_root_path'
when (b.dataplace_sub_component_type = 'snowflake') then ((dataplace_info->>'filesystem_info')::json)->>'ingestion_root_path'
when ((b.dataplace_sub_component_type = 'adls_gen2')) then ((dataplace_info->>'ingestion_root_path'))
when ((b.dataplace_sub_component_type = 's3')) then ((dataplace_info->>'ingestion_root_path'))
else null
end as path,
case when (b.dataplace_sub_component_type='hive' or b.dataplace_sub_component_type='cloudera_hive') then true else false end as is_destination_hive,
case when (b.dataplace_sub_component_type in ('s3','hdfs','adls_gen2')) then false else true end as apply_transformation,
case when (b.dataplace_sub_component_type in ('mysql','postgres','sql_server','oracle')) then true else false end as is_jdbcmode,
case
when ((b.dataplace_sub_component_type='hive' or b.dataplace_sub_component_type='cloudera_hive')
and dataplace_info->>'connection_mode' = 'Cluster mode') then ((dataplace_info->>'filesystem_info')::json)->>'endpoint'
else null
end as filesystem_endpoint,
case
when (b.dataplace_sub_component_type ='hive' or b.dataplace_sub_component_type='cloudera_hive')
and dataplace_info->>'connection_mode' = 'Cluster mode' then lower(((dataplace_info->>'filesystem_info')::json)->>'file_system_type')
when (b.dataplace_sub_component_type  = 'azure_synapse') then ((dataplace_info->>'filesystem_info')::json)->>'file_system_type'
when (b.dataplace_sub_component_type = 'bigquery') then 'gcs'
when (b.dataplace_sub_component_type  = 'redshift' and dmd.intermediate_type = 'parquet') then ((dataplace_info->>'filesystem_info')::json)->>'file_system_type'
when (b.dataplace_sub_component_type in('adls_gen2','s3','gcs','adls_gen1')) then b.additional_info->>'file_system_type'
when (b.dataplace_sub_component_type  = 'snowflake') then ((dataplace_info->>'filesystem_info')::json)->>'file_system_type'
else null
end as  file_system_type,
case
when (b.dataplace_sub_component_type ='hive' or b.dataplace_sub_component_type='cloudera_hive') and dataplace_info->>'connection_mode' = 'Cluster mode' and  lower(((dataplace_info->>'filesystem_info')::json)->>'file_system_type') = 's3a' then true else false end as is_apache_jdbc_driver,
case
when ((b.dataplace_sub_component_type = 'hive')) then ((dataplace_info->>'filesystem_info')::json)->>'credential_id'
when ((b.dataplace_sub_component_type  = 'azure_synapse')) then ((dataplace_info->>'filesystem_info')::json)->>'credential_id'
when ((b.dataplace_sub_component_type = 'bigquery')) then  cast(a.credential_id as text)
when ((b.dataplace_sub_component_type = 'redshift' and dmd.intermediate_type = 'parquet')) then ((dataplace_info->>'filesystem_info')::json)->>'credential_id'
when ((b.dataplace_sub_component_type = 'snowflake')) then ((dataplace_info->>'filesystem_info')::json)->>'credential_id'
else null end as filesystem_credential_id,
case
when ((b.dataplace_sub_component_type  = 'hive')) then cast(coalesce (fs.credential_type_id,'1') as text)
when ((b.dataplace_sub_component_type = 'azure_synapse')) then cast(fs.credential_type_id as text)
when ((b.dataplace_sub_component_type = 'bigquery')) then cast(ci.credential_type_id as text)
when ((b.dataplace_sub_component_type = 'redshift' and dmd.intermediate_type = 'parquet')) then cast(fs.credential_type_id as text)
when ((b.dataplace_sub_component_type = 'snowflake')) then cast(fs.credential_type_id as text)
else null end as filesystem_credential_type_id,
case
when ((b.dataplace_sub_component_type = 'azure_synapse')) then ((dataplace_info->>'filesystem_info')::json)->>'directory_name'
when ((b.dataplace_sub_component_type = 'snowflake')) then ((dataplace_info->>'filesystem_info')::json)->>'directory_name'
else null
end as adls_gen2_directory_name,
case
when ((b.dataplace_sub_component_type = 'redshift' and dmd.intermediate_type = 'parquet')) then ((dataplace_info->>'filesystem_info')::json)->>'bucket'
when ((b.dataplace_sub_component_type = 's3')) then dataplace_info->>'bucket'
when ((b.dataplace_sub_component_type = 'snowflake')) then ((dataplace_info->>'filesystem_info')::json)->>'bucket'
else null
end as s3_bucket,
case
when ((b.dataplace_sub_component_type = 'azure_synapse')) then ((dataplace_info->>'filesystem_info')::json)->>'container'
when ((b.dataplace_sub_component_type = 'adls_gen2')) then ((dataplace_info->>'container'))
when ((b.dataplace_sub_component_type = 'snowflake')) then ((dataplace_info->>'filesystem_info')::json)->>'container'
else null
end as adls_gen2_container,
case
when ((b.dataplace_sub_component_type = 'bigquery')) then dataplace_info->>'bucket_name'
when ((b.dataplace_sub_component_type = 'gcs')) then dataplace_info->>'bucket_name'
else null
end as gcs_bucket,
case
when ((b.dataplace_sub_component_type = 'azure_synapse')) then ((dataplace_info->>'filesystem_info')::json)->>'accountName'
when ((b.dataplace_sub_component_type = 'adls_gen2')) then ((dataplace_info->>'accountName'))
when ((b.dataplace_sub_component_type = 'adls_gen1')) then ((dataplace_info->>'data_lake_name'))
when ((b.dataplace_sub_component_type = 'snowflake')) then ((dataplace_info->>'filesystem_info')::json)->>'accountName'
else null
end as storage_account,
case when (b.dataplace_sub_component_type='hive' or b.dataplace_sub_component_type='cloudera_hive')  then ((dataplace_info->>'jdbc_info')::json)->>'database_name'
else dataplace_info->>'database_name' end as destination_db,
case when  (lower(b.dataplace_sub_component_type)='sas') then dataplace_info->>'location_path' end as destination_directory,
case when ((b.dataplace_sub_component_type='hive' or b.dataplace_sub_component_type='cloudera_hive') and dataplace_info->>'connection_mode' = 'Cluster mode') then true else false end as is_spark_hive,
lower(case when b.dataplace_sub_component_type  = 'cloudera_hive' then 'hive' else b.dataplace_sub_component_type end) as destination_type,
lower(case when ((b.dataplace_sub_component_type='hive' or b.dataplace_sub_component_type='cloudera_hive') and dataplace_info->>'connection_mode' = 'Cluster mode') then (select coalesce ((data_movement_additional_info->>'flow_details')::json->>'destination_file_format','parquet') from nabu.data_movement_physical dmp where data_movement_id=261) else b.dataplace_sub_component_type end) as target_type,
case when dataplace_info->>'jdbc_url' like 'jdbc:sqlserver:%' then 'com.microsoft.sqlserver.jdbc.SQLServerDriver'
else b.additional_info ->>'jdbc_driver' end as destination_jdbc_driver,
--b.additional_info->>'jdbc_driver' as destination_jdbc_driver,
b.dataplace_sub_component_id as destination_dataplace_sub_component_id,
a.credential_id as destination_credential_id,a.dataplace_component_type_id as destination_dataplace_component_type_id,
b.additional_info->>'default_credential' as dest_default_credential_exists,
(dataplace_info->>'filesystem_info')::JSON->>'endpoint' as destination_endpoint,
fs.credential_type as filesystem_credential_type,
fs.credential_epoch as filesystem_credential_epoch
from nabu.dataplace_physical a left join nabu.credential_info ci on a.credential_id = ci.credential_id  ,
 nabu.dataplace_sub_component_lookup b, file_system_credentials fs, data_movement_details dmd
where a.dataplace_sub_component_id = b.dataplace_sub_component_id
and a.valid_to_ts = '9999-12-31'
and a.dataplace_id in (select destination_dataplace_id from data_movement_details)
),
dest_credential_details as (
select a.*,b.credential_type_id as destination_credential_type_id,
case when (a.file_system_type = 's3a') then true else false end as is_file_system_type_s3a,
case when (a.filesystem_credential_type_id = '2' or a.filesystem_credential_id is null) then true else false end as is_filesystem_credential_type_aws,
case when (b.credential_type_id = 8 or b.credential_type_id =9) then 'kerberos'
when(b.credential_type_id = 17 or b.credential_type_id =18) then 'kerberos_file_content'
else 'auth_token' end as authentication_type,
b.credential_id ||'_'||extract(epoch from b.mod_ts::timestamp(0)) as credential_pattern,
ct.credential_type as destination_credential_type
from dest_dataplace_details a left outer join nabu.credential_info b
on a.destination_credential_id = b.credential_id
left join nabu.credential_type_lookup ct on b.credential_type_id = ct.credential_type_id
and b.valid_to_ts = '9999-12-31'
),
get_engine_type as (
select bcw.data_movement_engine_type as datamovement_engine_type,dmp.data_movement_id from nabu.data_movement_physical dmp
inner join nabu.bot_configuration_workflow bcw on dmp.workflow_id=bcw.workflow_id
where data_movement_id =261
),
intermediate_details as (
select intermediate_type,source_dataplace_id,archive_files_path,is_archive_data,is_lazy_mode,is_record_process_enabled,file_format,pipeline_flow_timeout from data_movement_details
)
select
true as is_destination_file,a.dataplace_id,a.schema_id,a.schema_name,a.table_id,
table_timestamp, table_suffix, h.schema_drift_flag,false as is_source_filetype,
case when schema_drift_option = 'new_table' and is_empty_suffix= false and table_timestamp <> '' and h.schema_drift_flag = true then concat(destination_table_name,'_',table_suffix,'_' ,to_char(current_timestamp ,table_timestamp))
when schema_drift_option = 'new_table' and is_empty_suffix= false and table_timestamp = '' and h.schema_drift_flag = true then concat(destination_table_name,'_',table_suffix)
when schema_drift_option = 'new_table' and is_empty_suffix= true and table_timestamp <> '' and h.schema_drift_flag = true then concat(destination_table_name,'_',to_char(current_timestamp ,table_timestamp))
else destination_table_name end as destination_table_name,
source_table_name as source_table_name,
case when schema_drift_option = 'bkp_table' and is_empty_suffix= false and table_timestamp <> '' and h.schema_drift_flag = true then concat(destination_table_name,'_',table_suffix,'_' ,to_char(current_timestamp ,table_timestamp))
when schema_drift_option = 'bkp_table' and is_empty_suffix= false and table_timestamp = '' and h.schema_drift_flag = true then concat(destination_table_name,'_',table_suffix)
when schema_drift_option = 'bkp_table' and is_empty_suffix= true and table_timestamp <> '' and h.schema_drift_flag = true then concat(destination_table_name,'_',to_char(current_timestamp ,table_timestamp))
else destination_table_name end as destination_backup_table_name,
project,a.table_name,source_url,source_credential_id,source_credential_type_id,source_jdbc_driver,source_type,
estimated_rows,a.schema_name as destination_schema_name,a.destination_schema_directory_id as destination_schema_id,
a.destination_dataplace_id,destination_dataplace_sub_component_id,rename_table_condition,already_ingested,
a.verification_threshold, destination_url,17000625869931891 as process_id,
17000625866627691 as batch_id,
'Ingestion_20231115' as batch_name,261 as data_movement_id,
'37234' as where_condition,trim(id.archive_files_path,'(\/)') as archive_files_path,id.is_archive_data,id.is_lazy_mode,id.is_record_process_enabled,id.file_format,
trim(path,'(\/)')as path,
case when trim(path,'(\/)')='' then false else true end as is_ingestion_root_path,
bucket_name,project,filesystem_endpoint,
case when (id.intermediate_type in ('default')) then true else false end as is_default,
file_system_type,destination_oracle_jdbc_url,oracle_jdbc_url,dest_default_credential_exists::boolean,source_default_credential_exists::boolean,
is_spark_hive, destination_db,destination_directory, destination_type,target_type, destination_file_format,destination_jdbc_driver,1 as flow_number,
source_directory, destination_credential_id,
trim('','(\/)') as relative_file_path,false as is_relative_file_path, destination_credential_type_id,destination_schema_directory_id,authentication_type,credential_pattern,is_apache_jdbc_driver,ingestion_table_format,source_db,warehouse_name,is_source_hive,is_source_spark_hive,
case when schema_drift_option = 'bkp_table' and h.schema_drift_flag = true
then true END as create_backup_table, schema_drift_option,destination_dataplace_component_type_id,
e.filesystem_credential_id,e.filesystem_credential_type_id,e.filesystem_credential_type,e.is_filesystem_credential_type_aws,e.is_file_system_type_s3a,
e.adls_gen2_directory_name,e.adls_gen2_container,e.storage_account,e.s3_bucket,e.gcs_bucket,is_mysql,is_bigquery,is_needed_partition_name_without_column_name,a.is_create_table,a.intermediate_type,g.datamovement_engine_type,is_jdbcmode,apply_transformation,is_destination_hive,
'eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDYyNjA0ODY3ODczNSwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0NTQwNSwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2MjYwNH0.TdlKYjNFZRULplibTKTBiTeNTShCsDicocUZq9KQkMiynWn2WsDoCNVj1Gnby5Zevba71EIlyJc7hK0-wksFFLDOu-AutbS3q-JSjcWr7zHFmWQ3NR6Xs_ycLsdTfh9HnCPt4R-GHKm9SOS5CzT6JBg08gb9cZtV2havzmaG4v9vckfKagGuftWnBKcsQNp2h9zB_EDYLVdDOUd_Aa8UHMklrT8W0SjKoDgbHVZ5T506nwQL-nXZYY0_YHP9KqDtPRiRq-k6db434A4pMx6BkTAG1z355WIuqa1fwRtrSB5HZQULpX85KD8FMpbt2gBBHWDn01TnO5_crpf0lv-SfQ' as jwt_token, 'http://dev-dha.humana.com:8889/fireshots/credentialsFetchWebService' as end_point,
case when source_endpoint is null then 's3.amazonaws.com' else source_endpoint end as source_endpoint,
case when destination_endpoint is null then 's3.amazonaws.com' else destination_endpoint end as destination_endpoint,
case when (e.filesystem_credential_type = 'Azure Active Directory' or destination_credential_type ='Azure Active Directory') then true else false end as is_azure_oauth,
case when (e.filesystem_credential_type = 'AWS IAM role attached to EC2 instance' or destination_credential_type ='AWS IAM role attached to EC2 instance')
then true else false end as is_aws_iam_attached_to_EC2_instance,
e.filesystem_credential_epoch,
a.is_source_jdbc_url, a.source_jdbc_url,id.pipeline_flow_timeout,
f.directory_name as destination_schema_name,upper(destination_table_name) as upper_case_destination_table_name,id.source_dataplace_id,g.datamovement_engine_type,id.intermediate_type,is_create_table
from nabu.dataplace_file_system_component f,
source_level_details a,  dest_credential_details e,get_engine_type g,
flag_for_schema_drifted_tables h, intermediate_details id
where a.destination_dataplace_id = e.destination_dataplace_id
and a.data_movement_id = 261
and f.dataplace_id = e.destination_dataplace_id
and a.destination_schema_directory_id = f.directory_id
and f.valid_to_ts = '9999-12-31'
and a.table_id = h.table_id
and a.data_movement_id = g.data_movement_id
""2023-11-15 15:36:55.242 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with cdc_columns as(
select array(
select (cdc_columns_list ) AS column_array
from(
select json_array_elements(advance_option_details->'advanced_table_options'->'CDC'->'columns_ids') as cdc_columns_list
from nabu.advanced_options_object_details where data_movement_id =261 and
valid_to_ts ='9999-12-31' and object_id in (37234)
) jsonarray
) as cdc_column_array
),
valid_columns as(
select Exists(
SELECT array_element AS missing_elements
FROM (
  SELECT unnest(cdc_column_array)::text AS array_element from cdc_columns
) AS array_elements
WHERE array_element <> ALL (
SELECT column_id::text FROM nabu.dataplace_column_metadata_physical dcmp where table_id in (37234) and valid_to_ts = '9999-12-31'
)
)
)
select * from valid_columns, cdc_columns
""2023-11-15 15:36:55.429 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select case when 'drop_create_table'='new_table' and false=true then true else false end as drift_new_table
""2023-11-15 15:36:55.618 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select case when (advance_option_details->'advanced_table_options'->'CDC'->>'add_audit_columns')::boolean
then true else false end as cdctype2,
'17000625869931891'||'_aaaa' as temp_path,
(advance_option_details->'advanced_option_flags'->>'CDC')::boolean as cdc_applied,
case when json_array_length(advance_option_details->'advanced_table_options'->'CDC'->'columns_ids')>0 then true else false end as is_primary
from nabu.advanced_options_object_details aood where data_movement_id =261 and object_id =37234 and valid_to_ts ='9999-12-31'
""2023-11-15 15:36:55.827 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select case when lower(advance_option_details->'advanced_table_options'->'CDC'->>'hash_type') like '%sha%' then 'sha2' else lower(advance_option_details->'advanced_table_options'->'CDC'->>'hash_type') end as hash_type,
(advance_option_details->'advanced_table_options'->'CDC'->>'add_audit_columns')::boolean as add_audit_columns,
(advance_option_details->'advanced_table_options'->'CDC'->>'create_view')::boolean as create_view,
advance_option_details->'advanced_table_options'->'CDC'->>'view_name' as view_name,
case when lower(advance_option_details->'advanced_table_options'->'CDC'->>'hash_type') like '%sha%' then true else false end as is_sha2,
regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(advance_option_details->'advanced_table_options'->'CDC'->'audit_columns'->>'start_date_column_name','=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') as start_date_column_name,
regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(advance_option_details->'advanced_table_options'->'CDC'->'audit_columns'->>'end_date_column_name','=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') as end_date_column_name,
regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(advance_option_details->'advanced_table_options'->'CDC'->'audit_columns'->>'process_id_column_name','=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') as job_id_column_name,
regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(advance_option_details->'advanced_table_options'->'CDC'->'audit_columns'->>'prev_process_id_column_name','=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') as prev_job_id_column_name
from nabu.advanced_options_object_details aood where data_movement_id =261 and object_id =37234 and valid_to_ts ='9999-12-31'
""2023-11-15 15:36:56.025 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select case when process_id=17000625869931891 then prev_process_id else process_id end as prev_process_id from
(
    select *,ROW_NUMBER () OVER (order by cdc_start_ts desc) rank
    from nabu.cdc_xref cx where data_movement_id =261 and object_id =37234
and cdc_end_ts!='9999-12-31'
)a where rank=1
""2023-11-15 15:36:56.219 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select 17000625869931891 as process_id,cast((extract(epoch from now())*10000) as bigint) as prev_process_id
""2023-11-15 15:36:56.426 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : 
""2023-11-15 15:36:56.619 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : 
""2023-11-15 15:36:56.814 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select a.field_name ,b.destination_datatype_name, true::boolean as is_auditcol from(
select regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(advance_option_details->'advanced_table_options'->'CDC'->'audit_columns'->>'start_date_column_name','=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') as field_name, 'string' as intermediate_datatype_name
from nabu.advanced_options_object_details aood where data_movement_id =261 and object_id =37234 and valid_to_ts ='9999-12-31'
union all
select regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(advance_option_details->'advanced_table_options'->'CDC'->'audit_columns'->>'end_date_column_name','=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') as field_name,'string' as intermediate_datatype_name
from nabu.advanced_options_object_details aood where data_movement_id =261 and object_id =37234 and valid_to_ts ='9999-12-31'
union all
select regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(advance_option_details->'advanced_table_options'->'CDC'->'audit_columns'->>'process_id_column_name','=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') as field_name,'long' as intermediate_datatype_name
from nabu.advanced_options_object_details aood where data_movement_id =261 and object_id =37234 and valid_to_ts ='9999-12-31'
union all
select regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(advance_option_details->'advanced_table_options'->'CDC'->'audit_columns'->>'prev_process_id_column_name','=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') as field_name,'long' as intermediate_datatype_name
from nabu.advanced_options_object_details aood where data_movement_id =261 and object_id =37234 and valid_to_ts ='9999-12-31'
)a inner join (
select intermediate_datatype_name ,destination_datatype_name  from nabu.datatype_mapping dm where source_type ='virtual' and destination_type ='adls_gen2' and intermediate_type='parquet'
)b
on a.intermediate_datatype_name=b.intermediate_datatype_name
""2023-11-15 15:36:57.001 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select 1 as id

""2023-11-15 15:36:57.196 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with ingested_object_count as(
select
	count(object_id) as count
from
	nabu.structured_jobtotable
where
	data_movement_id = 261
	and dataplace_id =
 42 and object_id = 37234 )
select
	case
		when count>0 then true
		else false
	end as already_ingested
from
	ingested_object_count
""2023-11-15 15:36:57.402 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with cte1 as(
select schema_name,table_name,partition_name,column_name,column_id,partition_function_name ,
case when partition_position is null then 1 else partition_position end as partition_position,sub_partition_name,
case when sub_partition_name is not null then true
else false
end as is_sub_partition
from
(select
t.schema_name,t.table_name,t.partition_name,t4.column_name,t4.column_id,t.partition_function_name , t.partition_position ,t2.sub_partition_name
from (select pi2.schema_name ,pi2.partition_name , pti.partition_function_name  , pi2.partition_position,
pti.partition_type,pti.table_id,pti.table_name
from nabu.partition_table_info pti
left join nabu.partitions_info pi2 on pti.table_id = pi2.table_id
where pti.table_id in (37234) and pti.valid_to_ts = '9999-12-31' and pi2.valid_to_ts = '9999-12-31' ) t
left join
(select sub_partition_name,spi.partition_name from nabu.sub_partitions_info spi
where spi.table_id in (37234) and spi.valid_to_ts = '9999-12-31') t2 on t.partition_name = t2.partition_name
left join (select column_name,column_id,pci.table_id from nabu.partition_column_info pci
where pci.table_id in (37234) and pci.valid_to_ts = '9999-12-31') t4 on t.table_id  = t4.table_id
)t3
)
select a.*,
case when is_int is true then a.partition_name else concat(column_name,'=', E'\'', split_part(partition_name, '=',2),E'\'') end as column_value
from(
select cte1.*, case when data_type like '%decimal%' or data_type like '%int%' then true else false end as is_int
from cte1,
nabu.dataplace_column_metadata_physical a where a.column_id = cte1.column_id and cte1.partition_name = partition_name
and a.valid_to_ts ='9999-12-31'
)    a

""2023-11-15 15:36:57.592 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with datatype_mapping as (
  	  		select
          		lower(source_type) as source_type ,
          		lower(intermediate_type) as intermediate_type ,
      		    false as is_create_table,
          		lower(destination_type) as destination_type ,
          		lower(source_datatype_name) as source_datatype_name ,
          		intermediate_datatype_name ,source_cast_type,
          		intermediate_cast_type ,
          		source_stg_function ,
          		destination_datatype_name,
          		intermediate_stg_function ,
          		lower(datamovement_engine_type) as datamovement_engine_type
          	from(
             select *,row_number() over (partition by source_type ,source_datatype_name ) as rno
             from nabu.datatype_mapping dmt
          	 where lower(source_type) =lower('sql_server') and
          	 lower(intermediate_type) = lower('parquet') and
    		 lower(destination_type) = 'bucket'
          	 )a
          	 where rno=1
  ),
  obj_details as(
    select advance_option_details from nabu.advanced_options_object_details where data_movement_id= 261 and valid_to_ts ='9999-12-31' and object_id in (37234)
  ),
  exculde_columns as(
    select unnest(string_to_array(btrim((column_options->>'excluded_column_ids'),'[||]'),','))::int as excluded_column_ids from
    (      select (advance_option_details->'advanced_table_options'->'columns_options')::JSON as column_options from obj_details  )a
    ),
  ignore_datatypes as(
       select coalesce (lower(ignore_data_types),' ') as data_types from (
       select replace((json_array_elements(data_movement_additional_info->'flow_details'->'ignore_data_types'))::text,'"','') as ignore_data_types
       from nabu.data_movement_physical
       where data_movement_id = 261 and valid_to_ts='9999-12-31'
       union
      select source_datatype_name as ignore_data_types
      from nabu.user_defined_trans_for_unsupported_datatype
      where advanced_options_sub_type_id =16 and data_movement_id = 261 and valid_to_ts='9999-12-31'
       )a
  ),
  column_metadata as (
  select a.*,
  		case when cdc.column_id is not null then true else false end as is_cdc_col,
          b.advanced_options_sub_type_id,
          b.additional_info
   from
    (
  	select
  		cmp.column_name,data_length,cmp.ordinal_position,
  		case when data_scale=0 then true else false end as data_scale_org,
  		case when data_scale is null then 0
  		    else data_scale
  		end as data_scale,data_precision,
  		lower(data_type) as metadata_datatype,
  		cmp.is_nullable,cmp.column_id,cmp.table_id,cmp.table_name,cmp.schema_name,
  		case
                when ('oracle' = lower('sql_server')) and data_type ~* 'time zone' and length(regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '')||'_utc') > 30
                then 'c_'||column_id
                when ('oracle' = lower('sql_server')) and length(regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '')) > 30
                then 'c_'||column_id
                when ('oracle' = lower('adls_gen2')) and length (column_name) > 30
                then 'c_'||column_id
          		else regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') end as field_name,
        regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') as field_name_replaced,
        case when ('oracle' = lower('sql_server')) and length(regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '')) > 30 and lower('adls_gen2') !='oracle'
            then true else false end as is_long_col_name,
  		case
  			when data_type ~* 'INTERVAL' then regexp_replace(lower(data_type),'[^A-Za-z ]', '', 'g')
  			when data_type like 'array%' and dp.dataplace_sub_component_id =7  then regexp_replace(lower(data_type), '^(\w+)\W.*','\1','g')
            when data_type like 'struct%' and dp.dataplace_sub_component_id =7 then regexp_replace(lower(data_type), '^(\w+)\W.*','\1','g')
            when data_type like 'map%' and dp.dataplace_sub_component_id =7 then regexp_replace(lower(data_type), '^(\w+)\W.*','\1','g')
            when data_type ~* 'varchar*' and dp.dataplace_sub_component_id =7 then 'varchar'
            when data_type ~* 'decimal*' and dp.dataplace_sub_component_id = 7 then 'decimal'
  			else lower(data_type)
  		end as data_type
  	from nabu.dataplace_column_metadata_physical cmp left outer join nabu.dataplace_physical dp on cmp.dataplace_id = dp.dataplace_id where cmp.table_id = 37234  and cmp.valid_to_ts='9999-12-31'
  and 
     data_type is not null
    and cmp.column_id not in (select excluded_column_ids from exculde_columns)
    ) a
    left outer join
         (
         select data_movement_id,
                 lower(source_datatype_name) AS source_datatype,
                 advanced_options_sub_type_id,
                 additional_info
          from nabu.user_defined_trans_for_unsupported_datatype
          where data_movement_id = 261
            and valid_to_ts='9999-12-31'
        ) b on a.data_type = b.source_datatype
        left outer join(
        select json_array_elements_text(advance_option_details->'advanced_table_options'->'CDC'->'columns_ids')::int as column_id
		from nabu.advanced_options_object_details aood where data_movement_id =261 and object_id =37234 and valid_to_ts ='9999-12-31'
        )cdc
        on a.column_id=cdc.column_id
   ),
   source_level_casting as(
      select (modified_columns ->>'column_id')::int as column_id,
      trim(convert_from(decode(modified_columns ->'column_info'->>'source_casting_exp','base64'), 'UTF8')) as sql_expr,
      lower(modified_columns ->'column_info'->>'destination_column_type') as destination_column_type,
      (modified_columns ->'column_info'->>'destination_column_name') as destination_column_name
      from(
        select json_array_elements(('[
]')) :: json as modified_columns from obj_details
      )modified_details
         ),
  initial_column_mapping as (
  select
  	a.column_name,a.data_type,a.data_length,a.ordinal_position,a.is_nullable,table_name,schema_name , a.metadata_datatype, a.column_id,a.table_id,
  	source_type,intermediate_type,datamovement_engine_type ,b.source_datatype_name,source_cast_type,b.intermediate_datatype_name,
  	case
  	           when(a.advanced_options_sub_type_id = 17) then 'UserText'
  	           when(a.advanced_options_sub_type_id = 31) then 'SQLServerStringConvert'
  	           when(a.advanced_options_sub_type_id = 14) then 'AsIs'
  	           when(a.advanced_options_sub_type_id = 15) then 'ReplaceWithNull'
  	else b.source_stg_function
  	end as source_stg_function,
  	case when (a.advanced_options_sub_type_id = 17) then a.additional_info ->> 'target_value' else null end as user_text,
  	a.data_scale,a.data_precision,data_scale_org,
  	    'adls_gen2' as destination_type,
  		b.intermediate_datatype_name as destination_datatype_name,
    	case when(a.advanced_options_sub_type_id in (14,15,17,31)) then 'AnyToString'
    	when b.intermediate_stg_function = 'AsIs' then 'parquet_AsIs' else b.intermediate_stg_function end as intermediate_stg_function,
    	case
    	    when (b.source_datatype_name in ('bit','datetimeoffset','time','datetime2','smalldatetime','datetime')) then concat(b.source_datatype_name,'_to_varchar')
    	    else null
    	 end as inconsistent_datatype,
  	a.field_name,a.field_name_replaced, a.is_long_col_name,
  	case when ( 'oracle' = lower('sql_server')) and length(a.field_name)>30
              then 'c_'||a.column_id
              else a.field_name
            end as intermediate_field_name, a.is_cdc_col
  from column_metadata as a left join datatype_mapping as b
  on a.data_type = b.source_datatype_name
  where a.ordinal_position is not null
 -- and b.datamovement_engine_type = lower('Spark')
  ),
  partition_columns as(
  select
  case when(columns_list->>'renamed_column' = '')
          then columns_list->>'column_name'
          else columns_list->>'renamed_column'
  end as final_column_name,
  (columns_list->>'column_id')::int as column_id
  from(
  select json_array_elements(((advance_option_details->>'advanced_table_options')::json->>'table_partitions')::json) as columns_list from nabu.advanced_options_object_details aood
  where data_movement_id= 261 and valid_to_ts ='9999-12-31' and object_id in (37234)
  )table_partitions_data
  )
  select false::boolean as is_virtual,a.column_id,
    case when slc.column_id is not null then true else false end as is_source_casting_enabled ,
    case when pc.column_id is not null then true else false end as is_partitioned_col, a.column_name,
    replace(a.column_name,'''','''''')as replaced_column_name,a.data_type,a.data_length,a.ordinal_position,a.is_nullable,table_name,schema_name ,false as is_mysql,
    false as is_bigquery,false as is_source_hive,
	a.source_type,a.source_datatype_name,source_cast_type,a.intermediate_datatype_name,a.table_id,
    case when slc.column_id is not null then
    (
    case
            when slc.sql_expr like '%)____%' then slc.sql_expr
            else concat (slc.sql_expr,' as ',slc.destination_column_name)
        end
    )
    --when (c.intermediate_stg_function = 'parquet_inconsistentInteger_convert' ) then 'AnyToStringConvert'
    else coalesce(c.source_stg_function,a.source_stg_function)
    end as source_stg_function,
	a.data_scale,
	case when slc.column_id is not null then
		(
		case when a.data_precision <= 38 then a.data_precision
			else 38
		end
		)
		else a.data_precision
	end as data_precision,
	case when (a.data_precision = 0 or a.data_precision is null) then true else false end as is_precision,
    case when a.data_scale <= 37 then true else false end as is_precision_scale,
    case when a.destination_type='redshift_relational' then true else false end as is_redshift_relational_destination,
    case when a.destination_type = 'oracle' then true else false end as is_oracle_destination,
    case when a.destination_datatype_name ~*'varchar|boolean' then true else false end as is_varchar,
	case  when slc.column_id is not null then
            (
            case
	        when slc.destination_column_type in('decimal','numeric') then
	        (
	        case when a.data_precision <=38 then concat(slc.destination_column_type,'(',a.data_precision,',',a.data_scale,')')
	        	else concat(slc.destination_column_type,'(38,',a.data_scale,')')
	        end
	        )
            when slc.destination_column_type in ('varchar','char') then
            (
            case
	            when data_length is null then concat( slc.destination_column_type,'(255)')
            	else concat( slc.destination_column_type,'(',a.data_length ,')')
            end
            )
            else (slc.destination_column_type)
            end
            )
            when c.destination_datatype_name ='STRING/DECIMAL'  then
            (
            case
            	 when a.data_precision =0 then concat('DECIMAL','(',38,',',a.data_scale,')')
            	 when a.data_precision <=38 and a.data_scale <=37 then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
                 else 'STRING'
            end
            )
            when c.destination_datatype_name ='STRING/DECIMAL/INTEGER'  then
            (
            CASE
         when (a.data_scale = 0 and (a.data_precision between 0 and 2)) then 'TINYINT'
         when (a.data_scale = 0 and (a.data_precision between 3 and 4)) then 'SMALLINT'
         when (a.data_scale = 0 and (a.data_precision between 5 and 9)) then 'INT'
         when (a.data_scale = 0 and (a.data_precision between 10 and 17)) then 'BIGINT'
         when (a.data_scale = 0 and (a.data_precision between 18 and 38)) then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
         when (a.data_scale <= 37 and (a.data_precision <= 38)) then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
         else 'STRING'
     end
	)
            when c.destination_datatype_name ='DoublePrecision/DECIMAL/INTEGER'  then
            (
                        case when (data_scale_org and data_precision is null) then 'integer'
                     when (a.data_scale = 0 and (a.data_precision between 0 and 2)) then 'TINYINT'
                     when (a.data_scale = 0 and (a.data_precision between 3 and 4)) then 'SMALLINT'
                     when (a.data_scale = 0 and (a.data_precision between 5 and 9)) then 'INT'
                     when (a.data_scale = 0 and (a.data_precision between 10 and 17)) then 'BIGINT'
                     when (a.data_scale = 0 and (a.data_precision between 18 and 38)) then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
                     when (a.data_scale <= 37 and (a.data_precision <= 38)) then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
                     else 'double precision'
                     end
            )
                when ('sql_server' = 'oracle') then
                (
                    case
                        when data_type ~* 'time zone' and c.option_number = 0 and 'azure_synapse' in('bigquery','redshift','azure_synapse','snowflake') then 'VARCHAR(50)'
                        when data_type ~* 'time zone' and c.option_number = 0 and 'azure_synapse' in('hive') then 'STRING'
                        else coalesce(c.destination_datatype_name,a.destination_datatype_name)
                    end
                )
                when ('sql_server' = 'postgres') then
                (
                    case
                        when data_type ~* 'timestamp with time zone' and c.option_number = 0 and 'azure_synapse' in('bigquery','redshift','azure_synapse','snowflake') then 'VARCHAR(50)'
                        when data_type ~* 'timestamp with time zone' and c.option_number = 0 and 'azure_synapse' in('hive') then 'STRING'
                        else coalesce(c.destination_datatype_name,a.destination_datatype_name)
                    end
                )
                when ('sql_server' = 'sql_server') then
                (
                    case
                        when data_type ~* 'datetimeoffset' and c.option_number = 0 and 'azure_synapse' in('bigquery','redshift','azure_synapse','snowflake') then 'VARCHAR(50)'
                        when data_type ~* 'datetimeoffset' and c.option_number = 0 and 'azure_synapse' in('hive') then 'STRING'
                        else coalesce(c.destination_datatype_name,a.destination_datatype_name)
                    end
                )
            else coalesce(c.destination_datatype_name,a.destination_datatype_name)
            end as destination_datatype_name,
    case when slc.column_id is not null then
            (
    		case when slc.destination_column_type in('double','double precision') then 'ParquetStringToDoubleConvert'
    			when slc.destination_column_type in('decimal','money','numeric','smallmoney','number') then 'ParquetStringToDecimalConvert'
    			when slc.destination_column_type in('int','integer','int64') then 'ParquetStringToIntConvert'
    			when slc.destination_column_type in('timestamp','datetime2') then 'ParquetStringToTimestampConvert'
    			when slc.destination_column_type = 'bigint' then 'ParquetStringToBigIntConvert'
    			when slc.destination_column_type = 'tinyint' then 'ParquetStringToTinyIntConvert'
    			when slc.destination_column_type = 'smallint' then 'ParquetStringToSmallIntConvert'
    			when slc.destination_column_type in('float','float64','real') then 'ParquetStringToFloatConvert'
    			when slc.destination_column_type in('char','nchar') then 'ParquetStringToCharConvert'
    			when slc.destination_column_type in('varchar','nvarchar') then 'ParquetStringToVarcharConvert'
    			when slc.destination_column_type in('binary','varbinary','bytes') then 'ParquetStringToBinaryConvert'
    			when slc.destination_column_type = 'date' then 'ParquetStringToDateConvert'
    			when slc.destination_column_type in('string','text') then 'AnyToString'
    			when slc.destination_column_type in('boolean','bool') then 'AnyToBoolean'
    			when slc.destination_column_type = 'array' then 'AnyToArray'
    			when slc.destination_column_type = 'map' then 'AnyToMap'
    			when slc.destination_column_type = 'struct' then 'AnyToStruct'
                else coalesce(c.intermediate_stg_function,a.intermediate_stg_function)
                end
            )
            when coalesce(c.intermediate_stg_function,a.intermediate_stg_function) = 'AsIs' then lower('parquet')||'_AsIs'
            when (c.intermediate_stg_function = 'parquet_inconsistentInteger_convert') then (
                case when (data_scale=0 and (data_precision between 0 and 2)) then 'ParquetStringToTinyIntConvert'
                 when (data_scale=0 and (data_precision between 3 and 4)) then 'ParquetStringToSmallIntConvert'
                 when (data_scale=0 and (data_precision between 5 and 9)) then 'ParquetStringToIntConvert'
                 when (data_scale=0 and (data_precision between 10 and 17)) then 'ParquetStringToBigIntConvert'
                 when (data_scale=0 and (data_precision between 18 and 38)) then 'ParquetStringToDecimalConvert'
                 when (data_scale <= 37 and (data_precision <= 38)) then a.intermediate_stg_function else 'parquet_AsIs'
                 end
            )
            when (c.intermediate_stg_function = 'parquet_inconsistentDouble_convert') then (
                case when (data_scale_org and data_precision is null) then 'ParquetStringToIntConvert'
				 when (data_scale=0 and (data_precision between 0 and 2)) then 'ParquetStringToTinyIntConvert'
                 when (data_scale=0 and (data_precision between 3 and 4)) then 'ParquetStringToSmallIntConvert'
                 when (data_scale=0 and (data_precision between 5 and 9)) then 'ParquetStringToIntConvert'
                 when (data_scale=0 and (data_precision between 10 and 17)) then 'ParquetStringToBigIntConvert'
                 when (data_scale=0 and (data_precision between 18 and 38)) then 'ParquetStringToDecimalConvert'
                 when (data_scale <= 37 and (data_precision <= 38)) then a.intermediate_stg_function else 'ParquetStringToDoubleConvert'
                 end
            )
            else coalesce(c.intermediate_stg_function,a.intermediate_stg_function)
            end as intermediate_stg_function,
        	a.inconsistent_datatype,

	--coalesce(c.destination_datatype_name,a.destination_datatype_name) as destination_datatype_name,
    --	case when coalesce(c.intermediate_stg_function,a.intermediate_stg_function) = 'AsIs' then lower('parquet')||'_AsIs'
    --    else coalesce(c.intermediate_stg_function,a.intermediate_stg_function) end as intermediate_stg_function,a.inconsistent_datatype,

	--renaming of columns options logic
	case
	    when a.is_long_col_name then 'c_'||a.column_id
	    when((true = false) and (true =false)  and a.column_id in (select column_id from source_level_casting) )
        then (select slc.destination_column_name from source_level_casting slc where slc.column_id = a.column_id)
	    when pc.column_id is not null then pc.final_column_name
	    else a.field_name
	end as field_name,
	case
    	    when((true = false) and (true =false)  and a.column_id in (select column_id from source_level_casting) )
            then (select slc.destination_column_name from source_level_casting slc where slc.column_id = a.column_id)
    	    when pc.column_id is not null then pc.final_column_name else a.field_name_replaced
    	    end as field_name_replaced,a.is_long_col_name,
	case
		when ('sql_server' = 'oracle') then
        (
            case
                when data_type ~* 'time zone' and c.option_number = 0 then true
                else false
            end
        )
		when ('sql_server' in ('postgres','redshift','redshift_relational') and a.destination_type!='hive') then
        (
        	case
                when data_type ~* 'timestamp with time zone' and c.option_number = 0 then true
                else false
            end
        )
        when ('sql_server' = 'sql_server') then
        (
        	case
                when data_type = 'datetimeoffset' and c.option_number = 0 then true
                else false
            end
        )
        else false
	end as isTimeZone , user_text, a.is_cdc_col
  from initial_column_mapping a left outer join (select a.*,lower(b.engine_type) as datamovement_engine_type from nabu.user_defined_trans_for_inconsistent_datatype a inner join nabu.engine_lookup b on a.engine_id = b.engine_id where data_movement_id = 261 and valid_to='9999-12-31' ) c
  on a.source_type = c.source_type
  and a.intermediate_type = c.intermediate_type
  and a.destination_type = c.destination_type
  and a.datamovement_engine_type = c.datamovement_engine_type
  and a.inconsistent_datatype = c.inconsistent_datatype
  left outer join partition_columns pc on a.column_id = pc.column_id
  left outer join source_level_casting slc on a.column_id = slc.column_id and slc.sql_expr !=''
union all
  select false::boolean as is_virtual,0 as column_id,
    false as is_source_casting_enabled ,
    false as is_partitioned_col, a.column_name,
    replace(a.column_name,'''','''''')as replaced_column_name,a.data_type,a.data_length,a.ordinal_position,a.is_nullable,table_name,schema_name ,false as is_mysql,
    false as is_bigquery,false as is_source_hive,
	a.source_type,a.source_datatype_name,source_cast_type,a.intermediate_datatype_name,a.table_id,
    c.source_stg_function,
	a.data_scale,
	a.data_precision,
	case when (a.data_precision = 0 or a.data_precision is null) then true else false end as is_precision,
    case when a.data_scale <= 37 then true else false end as is_precision_scale,
    case when a.destination_type='redshift_relational' then true else false end as is_redshift_relational_destination,
    case when a.destination_type = 'oracle' then true else false end as is_oracle_destination,
    case when c.destination_datatype_name ~*'varchar|boolean' then true else false end as is_varchar,
	c.destination_datatype_name,
    case when coalesce(c.intermediate_stg_function,a.intermediate_stg_function) = 'AsIs' then lower('parquet')||'_AsIs'
            when (c.intermediate_stg_function = 'parquet_inconsistentInteger_convert' and data_scale=0) then (
                case when (data_scale=0 and (data_precision between 0 and 2)) then 'ParquetStringToTinyIntConvert'
                 when (data_scale=0 and (data_precision between 3 and 4)) then 'ParquetStringToSmallIntConvert'
                 when (data_scale=0 and (data_precision between 5 and 9)) then 'ParquetStringToIntConvert'
                 when (data_scale=0 and (data_precision between 10 and 17)) then 'ParquetStringToBigIntConvert'
                 when (data_scale=0 and (data_precision between 18 and 38)) then 'ParquetStringToDecimalConvert'
                 when (data_scale <= 37 and (a.data_precision <= 38)) then a.intermediate_stg_function else 'parquet_AsIs'
                 end
            )
            else coalesce(c.intermediate_stg_function,a.intermediate_stg_function)
            end as intermediate_stg_function,
        	a.inconsistent_datatype,

	--c.destination_datatype_name,
    --c.intermediate_stg_function,
    --a.inconsistent_datatype,

	--renaming of columns options logic
		case
        	    when((true = false) and (true =false)  and a.column_id in (select column_id from source_level_casting) )
                then (select slc.destination_column_name||'_utc' from source_level_casting slc where slc.column_id = a.column_id)
        	    when pc.column_id is not null then pc.final_column_name||'_utc'
        	    else a.field_name||'_utc'
        	end as field_name,
        	case
            	    when((true = false) and (true =false)  and a.column_id in (select column_id from source_level_casting) )
                    then (select slc.destination_column_name||'_utc' from source_level_casting slc where slc.column_id = a.column_id)
            	    when pc.column_id is not null then pc.final_column_name else a.field_name_replaced||'_utc'
            	    end as field_name_replaced,a.is_long_col_name,
    false as isTimeZone , user_text, a.is_cdc_col
  from initial_column_mapping a left outer join (select a.*,lower(b.engine_type) as datamovement_engine_type from nabu.user_defined_trans_for_inconsistent_datatype a inner join nabu.engine_lookup b on a.engine_id = b.engine_id where data_movement_id = 261 and valid_to='9999-12-31' ) c
  on a.source_type = c.source_type
  and a.intermediate_type = c.intermediate_type
  and a.destination_type = c.destination_type
  and a.datamovement_engine_type = c.datamovement_engine_type
  and a.inconsistent_datatype = c.inconsistent_datatype
  left outer join partition_columns pc on a.column_id = pc.column_id
  left outer join source_level_casting slc on a.column_id = slc.column_id and slc.sql_expr !=''
  where(
	case
		when ('sql_server' = 'oracle') then
        (
            case
                when data_type ~* 'time zone' and c.option_number = 0 then true
                else false
            end
        )
		when ('sql_server'  in ('postgres','redshift','redshift_relational') and a.destination_type!='hive') then
        (
        	case
                when data_type ~* 'timestamp with time zone' and c.option_number = 0 then true
                else false
            end
        )
        when ('sql_server' = 'sql_server') then
        (
        	case
                when data_type = 'datetimeoffset' and c.option_number = 0 then true
                else false
            end
        )
        else false
	end ) = true
  group by a.column_name,a.column_id,pc.final_column_name,pc.column_id,a.data_type,a.data_length,a.ordinal_position,a.is_nullable,table_name,schema_name,a.source_type,a.source_datatype_name,source_cast_type,a.intermediate_datatype_name,a.inconsistent_datatype,a.table_id,c.source_stg_function,
  a.data_scale,a.data_precision,a.destination_type,is_varchar,c.destination_datatype_name,c.intermediate_stg_function,a.intermediate_stg_function,a.field_name,a.field_name_replaced,a.is_long_col_name,c.option_number,a.user_text,a.is_cdc_col
  order by ordinal_position
""2023-11-15 15:36:57.813 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with obj_details as(
         select advance_option_details from nabu.advanced_options_object_details where data_movement_id= 261 and valid_to_ts ='9999-12-31' and object_id in (37234)
),exculde_columns as(
   select unnest(string_to_array(btrim((column_options->>'excluded_column_ids'),'[||]'),','))::int as excluded_column_ids from
   ( select (advance_option_details->'advanced_table_options'->'columns_options')::JSON as column_options from obj_details )a
),
reorder_columns as (
    select * from (
        select reorder_json->>'column_name' as column_name,cast(reorder_json->>'column_id' as bigint) as column_id,
        cast(reorder_json->>'is_virtual' as boolean) as is_virtual,cast(reorder_json->>'order' as int) as reorder_position
      from (
      select json_array_elements(('[
]'))::json as reorder_json from obj_details)aa)RT
        where column_name not in ((select dcmp.column_name from nabu.dataplace_column_metadata_physical dcmp where column_id in (select * from exculde_columns) and valid_to_ts = '99991231') )
  ) ,
     virtual_columns as(
       select column_name,true as is_virtual,bb.virtual_intermediate_stg_function,bb.virtual_destination_datatype_name ,false as is_partitioned_col from
               (
                   ( select * from
                     (	 SELECT (jsonarray ->>'column_name')::text as column_name,(jsonarray ->>'column_type')::text as column_type,(jsonarray ->>'spark_sql_expression')::text as spark_sql_expression
                     	 from (  select json_array_elements(('[
]')) :: json as jsonarray from obj_details )x
                     )y
                   )z	left join (select datatype_name,spark_sql_datatype from nabu.spark_datatypes)d on d.datatype_name = z.column_type
               )aa
               inner join ( select intermediate_datatype_name,intermediate_stg_function as virtual_intermediate_stg_function , destination_datatype_name as virtual_destination_datatype_name from nabu.datatype_mapping
               where source_type= 'virtual' and
               lower(destination_type)=
 'bucket' and
               lower(intermediate_type) = lower('parquet') )bb  on bb.intermediate_datatype_name = aa.spark_sql_datatype
      )
    select *, row_number() over (order by ordinal_position) as ingested_colorder
  from
  --calling the column metadata query here
  ( with datatype_mapping as (
  	  		select
          		lower(source_type) as source_type ,
          		lower(intermediate_type) as intermediate_type ,
      		    false as is_create_table,
          		lower(destination_type) as destination_type ,
          		lower(source_datatype_name) as source_datatype_name ,
          		intermediate_datatype_name ,source_cast_type,
          		intermediate_cast_type ,
          		source_stg_function ,
          		destination_datatype_name,
          		intermediate_stg_function ,
          		lower(datamovement_engine_type) as datamovement_engine_type
          	from(
             select *,row_number() over (partition by source_type ,source_datatype_name ) as rno
             from nabu.datatype_mapping dmt
          	 where lower(source_type) =lower('sql_server') and
          	 lower(intermediate_type) = lower('parquet') and
    		 lower(destination_type) = 'bucket'
          	 )a
          	 where rno=1
  ),
  obj_details as(
    select advance_option_details from nabu.advanced_options_object_details where data_movement_id= 261 and valid_to_ts ='9999-12-31' and object_id in (37234)
  ),
  exculde_columns as(
    select unnest(string_to_array(btrim((column_options->>'excluded_column_ids'),'[||]'),','))::int as excluded_column_ids from
    (      select (advance_option_details->'advanced_table_options'->'columns_options')::JSON as column_options from obj_details  )a
    ),
  ignore_datatypes as(
       select coalesce (lower(ignore_data_types),' ') as data_types from (
       select replace((json_array_elements(data_movement_additional_info->'flow_details'->'ignore_data_types'))::text,'"','') as ignore_data_types
       from nabu.data_movement_physical
       where data_movement_id = 261 and valid_to_ts='9999-12-31'
       union
      select source_datatype_name as ignore_data_types
      from nabu.user_defined_trans_for_unsupported_datatype
      where advanced_options_sub_type_id =16 and data_movement_id = 261 and valid_to_ts='9999-12-31'
       )a
  ),
  column_metadata as (
  select a.*,
  		case when cdc.column_id is not null then true else false end as is_cdc_col,
          b.advanced_options_sub_type_id,
          b.additional_info
   from
    (
  	select
  		cmp.column_name,data_length,cmp.ordinal_position,
  		case when data_scale=0 then true else false end as data_scale_org,
  		case when data_scale is null then 0
  		    else data_scale
  		end as data_scale,data_precision,
  		lower(data_type) as metadata_datatype,
  		cmp.is_nullable,cmp.column_id,cmp.table_id,cmp.table_name,cmp.schema_name,
  		case
                when ('oracle' = lower('sql_server')) and data_type ~* 'time zone' and length(regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '')||'_utc') > 30
                then 'c_'||column_id
                when ('oracle' = lower('sql_server')) and length(regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '')) > 30
                then 'c_'||column_id
                when ('oracle' = lower('adls_gen2')) and length (column_name) > 30
                then 'c_'||column_id
          		else regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') end as field_name,
        regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') as field_name_replaced,
        case when ('oracle' = lower('sql_server')) and length(regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '')) > 30 and lower('adls_gen2') !='oracle'
            then true else false end as is_long_col_name,
  		case
  			when data_type ~* 'INTERVAL' then regexp_replace(lower(data_type),'[^A-Za-z ]', '', 'g')
  			when data_type like 'array%' and dp.dataplace_sub_component_id =7  then regexp_replace(lower(data_type), '^(\w+)\W.*','\1','g')
            when data_type like 'struct%' and dp.dataplace_sub_component_id =7 then regexp_replace(lower(data_type), '^(\w+)\W.*','\1','g')
            when data_type like 'map%' and dp.dataplace_sub_component_id =7 then regexp_replace(lower(data_type), '^(\w+)\W.*','\1','g')
            when data_type ~* 'varchar*' and dp.dataplace_sub_component_id =7 then 'varchar'
            when data_type ~* 'decimal*' and dp.dataplace_sub_component_id = 7 then 'decimal'
  			else lower(data_type)
  		end as data_type
  	from nabu.dataplace_column_metadata_physical cmp left outer join nabu.dataplace_physical dp on cmp.dataplace_id = dp.dataplace_id where cmp.table_id = 37234  and cmp.valid_to_ts='9999-12-31'
  and 
     data_type is not null
    and cmp.column_id not in (select excluded_column_ids from exculde_columns)
    ) a
    left outer join
         (
         select data_movement_id,
                 lower(source_datatype_name) AS source_datatype,
                 advanced_options_sub_type_id,
                 additional_info
          from nabu.user_defined_trans_for_unsupported_datatype
          where data_movement_id = 261
            and valid_to_ts='9999-12-31'
        ) b on a.data_type = b.source_datatype
        left outer join(
        select json_array_elements_text(advance_option_details->'advanced_table_options'->'CDC'->'columns_ids')::int as column_id
		from nabu.advanced_options_object_details aood where data_movement_id =261 and object_id =37234 and valid_to_ts ='9999-12-31'
        )cdc
        on a.column_id=cdc.column_id
   ),
   source_level_casting as(
      select (modified_columns ->>'column_id')::int as column_id,
      trim(convert_from(decode(modified_columns ->'column_info'->>'source_casting_exp','base64'), 'UTF8')) as sql_expr,
      lower(modified_columns ->'column_info'->>'destination_column_type') as destination_column_type,
      (modified_columns ->'column_info'->>'destination_column_name') as destination_column_name
      from(
        select json_array_elements(('[
]')) :: json as modified_columns from obj_details
      )modified_details
         ),
  initial_column_mapping as (
  select
  	a.column_name,a.data_type,a.data_length,a.ordinal_position,a.is_nullable,table_name,schema_name , a.metadata_datatype, a.column_id,a.table_id,
  	source_type,intermediate_type,datamovement_engine_type ,b.source_datatype_name,source_cast_type,b.intermediate_datatype_name,
  	case
  	           when(a.advanced_options_sub_type_id = 17) then 'UserText'
  	           when(a.advanced_options_sub_type_id = 31) then 'SQLServerStringConvert'
  	           when(a.advanced_options_sub_type_id = 14) then 'AsIs'
  	           when(a.advanced_options_sub_type_id = 15) then 'ReplaceWithNull'
  	else b.source_stg_function
  	end as source_stg_function,
  	case when (a.advanced_options_sub_type_id = 17) then a.additional_info ->> 'target_value' else null end as user_text,
  	a.data_scale,a.data_precision,data_scale_org,
  	    'adls_gen2' as destination_type,
  		b.intermediate_datatype_name as destination_datatype_name,
    	case when(a.advanced_options_sub_type_id in (14,15,17,31)) then 'AnyToString'
    	when b.intermediate_stg_function = 'AsIs' then 'parquet_AsIs' else b.intermediate_stg_function end as intermediate_stg_function,
    	case
    	    when (b.source_datatype_name in ('bit','datetimeoffset','time','datetime2','smalldatetime','datetime')) then concat(b.source_datatype_name,'_to_varchar')
    	    else null
    	 end as inconsistent_datatype,
  	a.field_name,a.field_name_replaced, a.is_long_col_name,
  	case when ( 'oracle' = lower('sql_server')) and length(a.field_name)>30
              then 'c_'||a.column_id
              else a.field_name
            end as intermediate_field_name, a.is_cdc_col
  from column_metadata as a left join datatype_mapping as b
  on a.data_type = b.source_datatype_name
  where a.ordinal_position is not null
 -- and b.datamovement_engine_type = lower('Spark')
  ),
  partition_columns as(
  select
  case when(columns_list->>'renamed_column' = '')
          then columns_list->>'column_name'
          else columns_list->>'renamed_column'
  end as final_column_name,
  (columns_list->>'column_id')::int as column_id
  from(
  select json_array_elements(((advance_option_details->>'advanced_table_options')::json->>'table_partitions')::json) as columns_list from nabu.advanced_options_object_details aood
  where data_movement_id= 261 and valid_to_ts ='9999-12-31' and object_id in (37234)
  )table_partitions_data
  )
  select false::boolean as is_virtual,a.column_id,
    case when slc.column_id is not null then true else false end as is_source_casting_enabled ,
    case when pc.column_id is not null then true else false end as is_partitioned_col, a.column_name,
    replace(a.column_name,'''','''''')as replaced_column_name,a.data_type,a.data_length,a.ordinal_position,a.is_nullable,table_name,schema_name ,false as is_mysql,
    false as is_bigquery,false as is_source_hive,
	a.source_type,a.source_datatype_name,source_cast_type,a.intermediate_datatype_name,a.table_id,
    case when slc.column_id is not null then
    (
    case
            when slc.sql_expr like '%)____%' then slc.sql_expr
            else concat (slc.sql_expr,' as ',slc.destination_column_name)
        end
    )
    --when (c.intermediate_stg_function = 'parquet_inconsistentInteger_convert' ) then 'AnyToStringConvert'
    else coalesce(c.source_stg_function,a.source_stg_function)
    end as source_stg_function,
	a.data_scale,
	case when slc.column_id is not null then
		(
		case when a.data_precision <= 38 then a.data_precision
			else 38
		end
		)
		else a.data_precision
	end as data_precision,
	case when (a.data_precision = 0 or a.data_precision is null) then true else false end as is_precision,
    case when a.data_scale <= 37 then true else false end as is_precision_scale,
    case when a.destination_type='redshift_relational' then true else false end as is_redshift_relational_destination,
    case when a.destination_type = 'oracle' then true else false end as is_oracle_destination,
    case when a.destination_datatype_name ~*'varchar|boolean' then true else false end as is_varchar,
	case  when slc.column_id is not null then
            (
            case
	        when slc.destination_column_type in('decimal','numeric') then
	        (
	        case when a.data_precision <=38 then concat(slc.destination_column_type,'(',a.data_precision,',',a.data_scale,')')
	        	else concat(slc.destination_column_type,'(38,',a.data_scale,')')
	        end
	        )
            when slc.destination_column_type in ('varchar','char') then
            (
            case
	            when data_length is null then concat( slc.destination_column_type,'(255)')
            	else concat( slc.destination_column_type,'(',a.data_length ,')')
            end
            )
            else (slc.destination_column_type)
            end
            )
            when c.destination_datatype_name ='STRING/DECIMAL'  then
            (
            case
            	 when a.data_precision =0 then concat('DECIMAL','(',38,',',a.data_scale,')')
            	 when a.data_precision <=38 and a.data_scale <=37 then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
                 else 'STRING'
            end
            )
            when c.destination_datatype_name ='STRING/DECIMAL/INTEGER'  then
            (
            CASE
         when (a.data_scale = 0 and (a.data_precision between 0 and 2)) then 'TINYINT'
         when (a.data_scale = 0 and (a.data_precision between 3 and 4)) then 'SMALLINT'
         when (a.data_scale = 0 and (a.data_precision between 5 and 9)) then 'INT'
         when (a.data_scale = 0 and (a.data_precision between 10 and 17)) then 'BIGINT'
         when (a.data_scale = 0 and (a.data_precision between 18 and 38)) then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
         when (a.data_scale <= 37 and (a.data_precision <= 38)) then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
         else 'STRING'
     end
	)
            when c.destination_datatype_name ='DoublePrecision/DECIMAL/INTEGER'  then
            (
                        case when (data_scale_org and data_precision is null) then 'integer'
                     when (a.data_scale = 0 and (a.data_precision between 0 and 2)) then 'TINYINT'
                     when (a.data_scale = 0 and (a.data_precision between 3 and 4)) then 'SMALLINT'
                     when (a.data_scale = 0 and (a.data_precision between 5 and 9)) then 'INT'
                     when (a.data_scale = 0 and (a.data_precision between 10 and 17)) then 'BIGINT'
                     when (a.data_scale = 0 and (a.data_precision between 18 and 38)) then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
                     when (a.data_scale <= 37 and (a.data_precision <= 38)) then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
                     else 'double precision'
                     end
            )
                when ('sql_server' = 'oracle') then
                (
                    case
                        when data_type ~* 'time zone' and c.option_number = 0 and 'azure_synapse' in('bigquery','redshift','azure_synapse','snowflake') then 'VARCHAR(50)'
                        when data_type ~* 'time zone' and c.option_number = 0 and 'azure_synapse' in('hive') then 'STRING'
                        else coalesce(c.destination_datatype_name,a.destination_datatype_name)
                    end
                )
                when ('sql_server' = 'postgres') then
                (
                    case
                        when data_type ~* 'timestamp with time zone' and c.option_number = 0 and 'azure_synapse' in('bigquery','redshift','azure_synapse','snowflake') then 'VARCHAR(50)'
                        when data_type ~* 'timestamp with time zone' and c.option_number = 0 and 'azure_synapse' in('hive') then 'STRING'
                        else coalesce(c.destination_datatype_name,a.destination_datatype_name)
                    end
                )
                when ('sql_server' = 'sql_server') then
                (
                    case
                        when data_type ~* 'datetimeoffset' and c.option_number = 0 and 'azure_synapse' in('bigquery','redshift','azure_synapse','snowflake') then 'VARCHAR(50)'
                        when data_type ~* 'datetimeoffset' and c.option_number = 0 and 'azure_synapse' in('hive') then 'STRING'
                        else coalesce(c.destination_datatype_name,a.destination_datatype_name)
                    end
                )
            else coalesce(c.destination_datatype_name,a.destination_datatype_name)
            end as destination_datatype_name,
    case when slc.column_id is not null then
            (
    		case when slc.destination_column_type in('double','double precision') then 'ParquetStringToDoubleConvert'
    			when slc.destination_column_type in('decimal','money','numeric','smallmoney','number') then 'ParquetStringToDecimalConvert'
    			when slc.destination_column_type in('int','integer','int64') then 'ParquetStringToIntConvert'
    			when slc.destination_column_type in('timestamp','datetime2') then 'ParquetStringToTimestampConvert'
    			when slc.destination_column_type = 'bigint' then 'ParquetStringToBigIntConvert'
    			when slc.destination_column_type = 'tinyint' then 'ParquetStringToTinyIntConvert'
    			when slc.destination_column_type = 'smallint' then 'ParquetStringToSmallIntConvert'
    			when slc.destination_column_type in('float','float64','real') then 'ParquetStringToFloatConvert'
    			when slc.destination_column_type in('char','nchar') then 'ParquetStringToCharConvert'
    			when slc.destination_column_type in('varchar','nvarchar') then 'ParquetStringToVarcharConvert'
    			when slc.destination_column_type in('binary','varbinary','bytes') then 'ParquetStringToBinaryConvert'
    			when slc.destination_column_type = 'date' then 'ParquetStringToDateConvert'
    			when slc.destination_column_type in('string','text') then 'AnyToString'
    			when slc.destination_column_type in('boolean','bool') then 'AnyToBoolean'
    			when slc.destination_column_type = 'array' then 'AnyToArray'
    			when slc.destination_column_type = 'map' then 'AnyToMap'
    			when slc.destination_column_type = 'struct' then 'AnyToStruct'
                else coalesce(c.intermediate_stg_function,a.intermediate_stg_function)
                end
            )
            when coalesce(c.intermediate_stg_function,a.intermediate_stg_function) = 'AsIs' then lower('parquet')||'_AsIs'
            when (c.intermediate_stg_function = 'parquet_inconsistentInteger_convert') then (
                case when (data_scale=0 and (data_precision between 0 and 2)) then 'ParquetStringToTinyIntConvert'
                 when (data_scale=0 and (data_precision between 3 and 4)) then 'ParquetStringToSmallIntConvert'
                 when (data_scale=0 and (data_precision between 5 and 9)) then 'ParquetStringToIntConvert'
                 when (data_scale=0 and (data_precision between 10 and 17)) then 'ParquetStringToBigIntConvert'
                 when (data_scale=0 and (data_precision between 18 and 38)) then 'ParquetStringToDecimalConvert'
                 when (data_scale <= 37 and (data_precision <= 38)) then a.intermediate_stg_function else 'parquet_AsIs'
                 end
            )
            when (c.intermediate_stg_function = 'parquet_inconsistentDouble_convert') then (
                case when (data_scale_org and data_precision is null) then 'ParquetStringToIntConvert'
				 when (data_scale=0 and (data_precision between 0 and 2)) then 'ParquetStringToTinyIntConvert'
                 when (data_scale=0 and (data_precision between 3 and 4)) then 'ParquetStringToSmallIntConvert'
                 when (data_scale=0 and (data_precision between 5 and 9)) then 'ParquetStringToIntConvert'
                 when (data_scale=0 and (data_precision between 10 and 17)) then 'ParquetStringToBigIntConvert'
                 when (data_scale=0 and (data_precision between 18 and 38)) then 'ParquetStringToDecimalConvert'
                 when (data_scale <= 37 and (data_precision <= 38)) then a.intermediate_stg_function else 'ParquetStringToDoubleConvert'
                 end
            )
            else coalesce(c.intermediate_stg_function,a.intermediate_stg_function)
            end as intermediate_stg_function,
        	a.inconsistent_datatype,

	--coalesce(c.destination_datatype_name,a.destination_datatype_name) as destination_datatype_name,
    --	case when coalesce(c.intermediate_stg_function,a.intermediate_stg_function) = 'AsIs' then lower('parquet')||'_AsIs'
    --    else coalesce(c.intermediate_stg_function,a.intermediate_stg_function) end as intermediate_stg_function,a.inconsistent_datatype,

	--renaming of columns options logic
	case
	    when a.is_long_col_name then 'c_'||a.column_id
	    when((true = false) and (true =false)  and a.column_id in (select column_id from source_level_casting) )
        then (select slc.destination_column_name from source_level_casting slc where slc.column_id = a.column_id)
	    when pc.column_id is not null then pc.final_column_name
	    else a.field_name
	end as field_name,
	case
    	    when((true = false) and (true =false)  and a.column_id in (select column_id from source_level_casting) )
            then (select slc.destination_column_name from source_level_casting slc where slc.column_id = a.column_id)
    	    when pc.column_id is not null then pc.final_column_name else a.field_name_replaced
    	    end as field_name_replaced,a.is_long_col_name,
	case
		when ('sql_server' = 'oracle') then
        (
            case
                when data_type ~* 'time zone' and c.option_number = 0 then true
                else false
            end
        )
		when ('sql_server' in ('postgres','redshift','redshift_relational') and a.destination_type!='hive') then
        (
        	case
                when data_type ~* 'timestamp with time zone' and c.option_number = 0 then true
                else false
            end
        )
        when ('sql_server' = 'sql_server') then
        (
        	case
                when data_type = 'datetimeoffset' and c.option_number = 0 then true
                else false
            end
        )
        else false
	end as isTimeZone , user_text, a.is_cdc_col
  from initial_column_mapping a left outer join (select a.*,lower(b.engine_type) as datamovement_engine_type from nabu.user_defined_trans_for_inconsistent_datatype a inner join nabu.engine_lookup b on a.engine_id = b.engine_id where data_movement_id = 261 and valid_to='9999-12-31' ) c
  on a.source_type = c.source_type
  and a.intermediate_type = c.intermediate_type
  and a.destination_type = c.destination_type
  and a.datamovement_engine_type = c.datamovement_engine_type
  and a.inconsistent_datatype = c.inconsistent_datatype
  left outer join partition_columns pc on a.column_id = pc.column_id
  left outer join source_level_casting slc on a.column_id = slc.column_id and slc.sql_expr !=''
union all
  select false::boolean as is_virtual,0 as column_id,
    false as is_source_casting_enabled ,
    false as is_partitioned_col, a.column_name,
    replace(a.column_name,'''','''''')as replaced_column_name,a.data_type,a.data_length,a.ordinal_position,a.is_nullable,table_name,schema_name ,false as is_mysql,
    false as is_bigquery,false as is_source_hive,
	a.source_type,a.source_datatype_name,source_cast_type,a.intermediate_datatype_name,a.table_id,
    c.source_stg_function,
	a.data_scale,
	a.data_precision,
	case when (a.data_precision = 0 or a.data_precision is null) then true else false end as is_precision,
    case when a.data_scale <= 37 then true else false end as is_precision_scale,
    case when a.destination_type='redshift_relational' then true else false end as is_redshift_relational_destination,
    case when a.destination_type = 'oracle' then true else false end as is_oracle_destination,
    case when c.destination_datatype_name ~*'varchar|boolean' then true else false end as is_varchar,
	c.destination_datatype_name,
    case when coalesce(c.intermediate_stg_function,a.intermediate_stg_function) = 'AsIs' then lower('parquet')||'_AsIs'
            when (c.intermediate_stg_function = 'parquet_inconsistentInteger_convert' and data_scale=0) then (
                case when (data_scale=0 and (data_precision between 0 and 2)) then 'ParquetStringToTinyIntConvert'
                 when (data_scale=0 and (data_precision between 3 and 4)) then 'ParquetStringToSmallIntConvert'
                 when (data_scale=0 and (data_precision between 5 and 9)) then 'ParquetStringToIntConvert'
                 when (data_scale=0 and (data_precision between 10 and 17)) then 'ParquetStringToBigIntConvert'
                 when (data_scale=0 and (data_precision between 18 and 38)) then 'ParquetStringToDecimalConvert'
                 when (data_scale <= 37 and (a.data_precision <= 38)) then a.intermediate_stg_function else 'parquet_AsIs'
                 end
            )
            else coalesce(c.intermediate_stg_function,a.intermediate_stg_function)
            end as intermediate_stg_function,
        	a.inconsistent_datatype,

	--c.destination_datatype_name,
    --c.intermediate_stg_function,
    --a.inconsistent_datatype,

	--renaming of columns options logic
		case
        	    when((true = false) and (true =false)  and a.column_id in (select column_id from source_level_casting) )
                then (select slc.destination_column_name||'_utc' from source_level_casting slc where slc.column_id = a.column_id)
        	    when pc.column_id is not null then pc.final_column_name||'_utc'
        	    else a.field_name||'_utc'
        	end as field_name,
        	case
            	    when((true = false) and (true =false)  and a.column_id in (select column_id from source_level_casting) )
                    then (select slc.destination_column_name||'_utc' from source_level_casting slc where slc.column_id = a.column_id)
            	    when pc.column_id is not null then pc.final_column_name else a.field_name_replaced||'_utc'
            	    end as field_name_replaced,a.is_long_col_name,
    false as isTimeZone , user_text, a.is_cdc_col
  from initial_column_mapping a left outer join (select a.*,lower(b.engine_type) as datamovement_engine_type from nabu.user_defined_trans_for_inconsistent_datatype a inner join nabu.engine_lookup b on a.engine_id = b.engine_id where data_movement_id = 261 and valid_to='9999-12-31' ) c
  on a.source_type = c.source_type
  and a.intermediate_type = c.intermediate_type
  and a.destination_type = c.destination_type
  and a.datamovement_engine_type = c.datamovement_engine_type
  and a.inconsistent_datatype = c.inconsistent_datatype
  left outer join partition_columns pc on a.column_id = pc.column_id
  left outer join source_level_casting slc on a.column_id = slc.column_id and slc.sql_expr !=''
  where(
	case
		when ('sql_server' = 'oracle') then
        (
            case
                when data_type ~* 'time zone' and c.option_number = 0 then true
                else false
            end
        )
		when ('sql_server'  in ('postgres','redshift','redshift_relational') and a.destination_type!='hive') then
        (
        	case
                when data_type ~* 'timestamp with time zone' and c.option_number = 0 then true
                else false
            end
        )
        when ('sql_server' = 'sql_server') then
        (
        	case
                when data_type = 'datetimeoffset' and c.option_number = 0 then true
                else false
            end
        )
        else false
	end ) = true
  group by a.column_name,a.column_id,pc.final_column_name,pc.column_id,a.data_type,a.data_length,a.ordinal_position,a.is_nullable,table_name,schema_name,a.source_type,a.source_datatype_name,source_cast_type,a.intermediate_datatype_name,a.inconsistent_datatype,a.table_id,c.source_stg_function,
  a.data_scale,a.data_precision,a.destination_type,is_varchar,c.destination_datatype_name,c.intermediate_stg_function,a.intermediate_stg_function,a.field_name,a.field_name_replaced,a.is_long_col_name,c.option_number,a.user_text,a.is_cdc_col
  order by ordinal_position)a

""2023-11-15 15:36:58.030 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with obj_details as(
         select advance_option_details from nabu.advanced_options_object_details where data_movement_id= 261 and valid_to_ts ='9999-12-31' and object_id in (37234)
),exculde_columns as(
   select unnest(string_to_array(btrim((column_options->>'excluded_column_ids'),'[||]'),','))::int as excluded_column_ids from
   ( select (advance_option_details->'advanced_table_options'->'columns_options')::JSON as column_options from obj_details )a
),
reorder_columns as (
    select * from (
        select reorder_json->>'column_name' as column_name,cast(reorder_json->>'column_id' as bigint) as column_id,
        cast(reorder_json->>'is_virtual' as boolean) as is_virtual,cast(reorder_json->>'order' as int) as reorder_position
      from (
      select json_array_elements(('[
]'))::json as reorder_json from obj_details)aa)RT
        where column_name not in ((select column_name from nabu.dataplace_column_metadata_physical dtmp where column_id in (select * from exculde_columns) ) )
  ) ,
     virtual_columns as(
       select column_name,true as is_virtual,bb.virtual_intermediate_stg_function,bb.virtual_destination_datatype_name ,false as is_partitioned_col from
               (
                   ( select * from
                     (	 SELECT (jsonarray ->>'column_name')::text as column_name,(jsonarray ->>'column_type')::text as column_type,(jsonarray ->>'spark_sql_expression')::text as spark_sql_expression
                     	 from (  select json_array_elements(('[
]')) :: json as jsonarray from obj_details )x
                     )y
                   )z	left join (select datatype_name,spark_sql_datatype from nabu.spark_datatypes)d on d.datatype_name = z.column_type
               )aa
               inner join ( select intermediate_datatype_name,intermediate_stg_function as virtual_intermediate_stg_function , destination_datatype_name as virtual_destination_datatype_name from nabu.datatype_mapping
               where source_type= 'virtual' and lower(destination_type)=lower('adls_gen2') and
               lower(intermediate_type) = lower('parquet') )bb  on bb.intermediate_datatype_name = aa.spark_sql_datatype
      ),
  cdc_cols as (
    select *, row_number() over (order by ordinal_position) as ingested_colorder
  from
  --calling the column metadata query here
  ( with datatype_mapping as (
  	  		select
          		lower(source_type) as source_type ,
          		lower(intermediate_type) as intermediate_type ,
      		    false as is_create_table,
          		lower(destination_type) as destination_type ,
          		lower(source_datatype_name) as source_datatype_name ,
          		intermediate_datatype_name ,source_cast_type,
          		intermediate_cast_type ,
          		source_stg_function ,
          		destination_datatype_name,
          		intermediate_stg_function ,
          		lower(datamovement_engine_type) as datamovement_engine_type
          	from(
             select *,row_number() over (partition by source_type ,source_datatype_name ) as rno
             from nabu.datatype_mapping dmt
          	 where lower(source_type) =lower('sql_server') and
          	 lower(intermediate_type) = lower('parquet') and
    		 lower(destination_type) = 'bucket'
          	 )a
          	 where rno=1
  ),
  obj_details as(
    select advance_option_details from nabu.advanced_options_object_details where data_movement_id= 261 and valid_to_ts ='9999-12-31' and object_id in (37234)
  ),
  exculde_columns as(
    select unnest(string_to_array(btrim((column_options->>'excluded_column_ids'),'[||]'),','))::int as excluded_column_ids from
    (      select (advance_option_details->'advanced_table_options'->'columns_options')::JSON as column_options from obj_details  )a
    ),
  ignore_datatypes as(
       select coalesce (lower(ignore_data_types),' ') as data_types from (
       select replace((json_array_elements(data_movement_additional_info->'flow_details'->'ignore_data_types'))::text,'"','') as ignore_data_types
       from nabu.data_movement_physical
       where data_movement_id = 261 and valid_to_ts='9999-12-31'
       union
      select source_datatype_name as ignore_data_types
      from nabu.user_defined_trans_for_unsupported_datatype
      where advanced_options_sub_type_id =16 and data_movement_id = 261 and valid_to_ts='9999-12-31'
       )a
  ),
  column_metadata as (
  select a.*,
  		case when cdc.column_id is not null then true else false end as is_cdc_col,
          b.advanced_options_sub_type_id,
          b.additional_info
   from
    (
  	select
  		cmp.column_name,data_length,cmp.ordinal_position,
  		case when data_scale=0 then true else false end as data_scale_org,
  		case when data_scale is null then 0
  		    else data_scale
  		end as data_scale,data_precision,
  		lower(data_type) as metadata_datatype,
  		cmp.is_nullable,cmp.column_id,cmp.table_id,cmp.table_name,cmp.schema_name,
  		case
                when ('oracle' = lower('sql_server')) and data_type ~* 'time zone' and length(regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '')||'_utc') > 30
                then 'c_'||column_id
                when ('oracle' = lower('sql_server')) and length(regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '')) > 30
                then 'c_'||column_id
                when ('oracle' = lower('adls_gen2')) and length (column_name) > 30
                then 'c_'||column_id
          		else regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') end as field_name,
        regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') as field_name_replaced,
        case when ('oracle' = lower('sql_server')) and length(regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '')) > 30 and lower('adls_gen2') !='oracle'
            then true else false end as is_long_col_name,
  		case
  			when data_type ~* 'INTERVAL' then regexp_replace(lower(data_type),'[^A-Za-z ]', '', 'g')
  			when data_type like 'array%' and dp.dataplace_sub_component_id =7  then regexp_replace(lower(data_type), '^(\w+)\W.*','\1','g')
            when data_type like 'struct%' and dp.dataplace_sub_component_id =7 then regexp_replace(lower(data_type), '^(\w+)\W.*','\1','g')
            when data_type like 'map%' and dp.dataplace_sub_component_id =7 then regexp_replace(lower(data_type), '^(\w+)\W.*','\1','g')
            when data_type ~* 'varchar*' and dp.dataplace_sub_component_id =7 then 'varchar'
            when data_type ~* 'decimal*' and dp.dataplace_sub_component_id = 7 then 'decimal'
  			else lower(data_type)
  		end as data_type
  	from nabu.dataplace_column_metadata_physical cmp left outer join nabu.dataplace_physical dp on cmp.dataplace_id = dp.dataplace_id where cmp.table_id = 37234  and cmp.valid_to_ts='9999-12-31'
  and 
     data_type is not null
    and cmp.column_id not in (select excluded_column_ids from exculde_columns)
    ) a
    left outer join
         (
         select data_movement_id,
                 lower(source_datatype_name) AS source_datatype,
                 advanced_options_sub_type_id,
                 additional_info
          from nabu.user_defined_trans_for_unsupported_datatype
          where data_movement_id = 261
            and valid_to_ts='9999-12-31'
        ) b on a.data_type = b.source_datatype
        left outer join(
        select json_array_elements_text(advance_option_details->'advanced_table_options'->'CDC'->'columns_ids')::int as column_id
		from nabu.advanced_options_object_details aood where data_movement_id =261 and object_id =37234 and valid_to_ts ='9999-12-31'
        )cdc
        on a.column_id=cdc.column_id
   ),
   source_level_casting as(
      select (modified_columns ->>'column_id')::int as column_id,
      trim(convert_from(decode(modified_columns ->'column_info'->>'source_casting_exp','base64'), 'UTF8')) as sql_expr,
      lower(modified_columns ->'column_info'->>'destination_column_type') as destination_column_type,
      (modified_columns ->'column_info'->>'destination_column_name') as destination_column_name
      from(
        select json_array_elements(('[
]')) :: json as modified_columns from obj_details
      )modified_details
         ),
  initial_column_mapping as (
  select
  	a.column_name,a.data_type,a.data_length,a.ordinal_position,a.is_nullable,table_name,schema_name , a.metadata_datatype, a.column_id,a.table_id,
  	source_type,intermediate_type,datamovement_engine_type ,b.source_datatype_name,source_cast_type,b.intermediate_datatype_name,
  	case
  	           when(a.advanced_options_sub_type_id = 17) then 'UserText'
  	           when(a.advanced_options_sub_type_id = 31) then 'SQLServerStringConvert'
  	           when(a.advanced_options_sub_type_id = 14) then 'AsIs'
  	           when(a.advanced_options_sub_type_id = 15) then 'ReplaceWithNull'
  	else b.source_stg_function
  	end as source_stg_function,
  	case when (a.advanced_options_sub_type_id = 17) then a.additional_info ->> 'target_value' else null end as user_text,
  	a.data_scale,a.data_precision,data_scale_org,
  	    'adls_gen2' as destination_type,
  		b.intermediate_datatype_name as destination_datatype_name,
    	case when(a.advanced_options_sub_type_id in (14,15,17,31)) then 'AnyToString'
    	when b.intermediate_stg_function = 'AsIs' then 'parquet_AsIs' else b.intermediate_stg_function end as intermediate_stg_function,
    	case
    	    when (b.source_datatype_name in ('bit','datetimeoffset','time','datetime2','smalldatetime','datetime')) then concat(b.source_datatype_name,'_to_varchar')
    	    else null
    	 end as inconsistent_datatype,
  	a.field_name,a.field_name_replaced, a.is_long_col_name,
  	case when ( 'oracle' = lower('sql_server')) and length(a.field_name)>30
              then 'c_'||a.column_id
              else a.field_name
            end as intermediate_field_name, a.is_cdc_col
  from column_metadata as a left join datatype_mapping as b
  on a.data_type = b.source_datatype_name
  where a.ordinal_position is not null
 -- and b.datamovement_engine_type = lower('Spark')
  ),
  partition_columns as(
  select
  case when(columns_list->>'renamed_column' = '')
          then columns_list->>'column_name'
          else columns_list->>'renamed_column'
  end as final_column_name,
  (columns_list->>'column_id')::int as column_id
  from(
  select json_array_elements(((advance_option_details->>'advanced_table_options')::json->>'table_partitions')::json) as columns_list from nabu.advanced_options_object_details aood
  where data_movement_id= 261 and valid_to_ts ='9999-12-31' and object_id in (37234)
  )table_partitions_data
  )
  select false::boolean as is_virtual,a.column_id,
    case when slc.column_id is not null then true else false end as is_source_casting_enabled ,
    case when pc.column_id is not null then true else false end as is_partitioned_col, a.column_name,
    replace(a.column_name,'''','''''')as replaced_column_name,a.data_type,a.data_length,a.ordinal_position,a.is_nullable,table_name,schema_name ,false as is_mysql,
    false as is_bigquery,false as is_source_hive,
	a.source_type,a.source_datatype_name,source_cast_type,a.intermediate_datatype_name,a.table_id,
    case when slc.column_id is not null then
    (
    case
            when slc.sql_expr like '%)____%' then slc.sql_expr
            else concat (slc.sql_expr,' as ',slc.destination_column_name)
        end
    )
    --when (c.intermediate_stg_function = 'parquet_inconsistentInteger_convert' ) then 'AnyToStringConvert'
    else coalesce(c.source_stg_function,a.source_stg_function)
    end as source_stg_function,
	a.data_scale,
	case when slc.column_id is not null then
		(
		case when a.data_precision <= 38 then a.data_precision
			else 38
		end
		)
		else a.data_precision
	end as data_precision,
	case when (a.data_precision = 0 or a.data_precision is null) then true else false end as is_precision,
    case when a.data_scale <= 37 then true else false end as is_precision_scale,
    case when a.destination_type='redshift_relational' then true else false end as is_redshift_relational_destination,
    case when a.destination_type = 'oracle' then true else false end as is_oracle_destination,
    case when a.destination_datatype_name ~*'varchar|boolean' then true else false end as is_varchar,
	case  when slc.column_id is not null then
            (
            case
	        when slc.destination_column_type in('decimal','numeric') then
	        (
	        case when a.data_precision <=38 then concat(slc.destination_column_type,'(',a.data_precision,',',a.data_scale,')')
	        	else concat(slc.destination_column_type,'(38,',a.data_scale,')')
	        end
	        )
            when slc.destination_column_type in ('varchar','char') then
            (
            case
	            when data_length is null then concat( slc.destination_column_type,'(255)')
            	else concat( slc.destination_column_type,'(',a.data_length ,')')
            end
            )
            else (slc.destination_column_type)
            end
            )
            when c.destination_datatype_name ='STRING/DECIMAL'  then
            (
            case
            	 when a.data_precision =0 then concat('DECIMAL','(',38,',',a.data_scale,')')
            	 when a.data_precision <=38 and a.data_scale <=37 then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
                 else 'STRING'
            end
            )
            when c.destination_datatype_name ='STRING/DECIMAL/INTEGER'  then
            (
            CASE
         when (a.data_scale = 0 and (a.data_precision between 0 and 2)) then 'TINYINT'
         when (a.data_scale = 0 and (a.data_precision between 3 and 4)) then 'SMALLINT'
         when (a.data_scale = 0 and (a.data_precision between 5 and 9)) then 'INT'
         when (a.data_scale = 0 and (a.data_precision between 10 and 17)) then 'BIGINT'
         when (a.data_scale = 0 and (a.data_precision between 18 and 38)) then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
         when (a.data_scale <= 37 and (a.data_precision <= 38)) then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
         else 'STRING'
     end
	)
            when c.destination_datatype_name ='DoublePrecision/DECIMAL/INTEGER'  then
            (
                        case when (data_scale_org and data_precision is null) then 'integer'
                     when (a.data_scale = 0 and (a.data_precision between 0 and 2)) then 'TINYINT'
                     when (a.data_scale = 0 and (a.data_precision between 3 and 4)) then 'SMALLINT'
                     when (a.data_scale = 0 and (a.data_precision between 5 and 9)) then 'INT'
                     when (a.data_scale = 0 and (a.data_precision between 10 and 17)) then 'BIGINT'
                     when (a.data_scale = 0 and (a.data_precision between 18 and 38)) then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
                     when (a.data_scale <= 37 and (a.data_precision <= 38)) then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
                     else 'double precision'
                     end
            )
                when ('sql_server' = 'oracle') then
                (
                    case
                        when data_type ~* 'time zone' and c.option_number = 0 and 'azure_synapse' in('bigquery','redshift','azure_synapse','snowflake') then 'VARCHAR(50)'
                        when data_type ~* 'time zone' and c.option_number = 0 and 'azure_synapse' in('hive') then 'STRING'
                        else coalesce(c.destination_datatype_name,a.destination_datatype_name)
                    end
                )
                when ('sql_server' = 'postgres') then
                (
                    case
                        when data_type ~* 'timestamp with time zone' and c.option_number = 0 and 'azure_synapse' in('bigquery','redshift','azure_synapse','snowflake') then 'VARCHAR(50)'
                        when data_type ~* 'timestamp with time zone' and c.option_number = 0 and 'azure_synapse' in('hive') then 'STRING'
                        else coalesce(c.destination_datatype_name,a.destination_datatype_name)
                    end
                )
                when ('sql_server' = 'sql_server') then
                (
                    case
                        when data_type ~* 'datetimeoffset' and c.option_number = 0 and 'azure_synapse' in('bigquery','redshift','azure_synapse','snowflake') then 'VARCHAR(50)'
                        when data_type ~* 'datetimeoffset' and c.option_number = 0 and 'azure_synapse' in('hive') then 'STRING'
                        else coalesce(c.destination_datatype_name,a.destination_datatype_name)
                    end
                )
            else coalesce(c.destination_datatype_name,a.destination_datatype_name)
            end as destination_datatype_name,
    case when slc.column_id is not null then
            (
    		case when slc.destination_column_type in('double','double precision') then 'ParquetStringToDoubleConvert'
    			when slc.destination_column_type in('decimal','money','numeric','smallmoney','number') then 'ParquetStringToDecimalConvert'
    			when slc.destination_column_type in('int','integer','int64') then 'ParquetStringToIntConvert'
    			when slc.destination_column_type in('timestamp','datetime2') then 'ParquetStringToTimestampConvert'
    			when slc.destination_column_type = 'bigint' then 'ParquetStringToBigIntConvert'
    			when slc.destination_column_type = 'tinyint' then 'ParquetStringToTinyIntConvert'
    			when slc.destination_column_type = 'smallint' then 'ParquetStringToSmallIntConvert'
    			when slc.destination_column_type in('float','float64','real') then 'ParquetStringToFloatConvert'
    			when slc.destination_column_type in('char','nchar') then 'ParquetStringToCharConvert'
    			when slc.destination_column_type in('varchar','nvarchar') then 'ParquetStringToVarcharConvert'
    			when slc.destination_column_type in('binary','varbinary','bytes') then 'ParquetStringToBinaryConvert'
    			when slc.destination_column_type = 'date' then 'ParquetStringToDateConvert'
    			when slc.destination_column_type in('string','text') then 'AnyToString'
    			when slc.destination_column_type in('boolean','bool') then 'AnyToBoolean'
    			when slc.destination_column_type = 'array' then 'AnyToArray'
    			when slc.destination_column_type = 'map' then 'AnyToMap'
    			when slc.destination_column_type = 'struct' then 'AnyToStruct'
                else coalesce(c.intermediate_stg_function,a.intermediate_stg_function)
                end
            )
            when coalesce(c.intermediate_stg_function,a.intermediate_stg_function) = 'AsIs' then lower('parquet')||'_AsIs'
            when (c.intermediate_stg_function = 'parquet_inconsistentInteger_convert') then (
                case when (data_scale=0 and (data_precision between 0 and 2)) then 'ParquetStringToTinyIntConvert'
                 when (data_scale=0 and (data_precision between 3 and 4)) then 'ParquetStringToSmallIntConvert'
                 when (data_scale=0 and (data_precision between 5 and 9)) then 'ParquetStringToIntConvert'
                 when (data_scale=0 and (data_precision between 10 and 17)) then 'ParquetStringToBigIntConvert'
                 when (data_scale=0 and (data_precision between 18 and 38)) then 'ParquetStringToDecimalConvert'
                 when (data_scale <= 37 and (data_precision <= 38)) then a.intermediate_stg_function else 'parquet_AsIs'
                 end
            )
            when (c.intermediate_stg_function = 'parquet_inconsistentDouble_convert') then (
                case when (data_scale_org and data_precision is null) then 'ParquetStringToIntConvert'
				 when (data_scale=0 and (data_precision between 0 and 2)) then 'ParquetStringToTinyIntConvert'
                 when (data_scale=0 and (data_precision between 3 and 4)) then 'ParquetStringToSmallIntConvert'
                 when (data_scale=0 and (data_precision between 5 and 9)) then 'ParquetStringToIntConvert'
                 when (data_scale=0 and (data_precision between 10 and 17)) then 'ParquetStringToBigIntConvert'
                 when (data_scale=0 and (data_precision between 18 and 38)) then 'ParquetStringToDecimalConvert'
                 when (data_scale <= 37 and (data_precision <= 38)) then a.intermediate_stg_function else 'ParquetStringToDoubleConvert'
                 end
            )
            else coalesce(c.intermediate_stg_function,a.intermediate_stg_function)
            end as intermediate_stg_function,
        	a.inconsistent_datatype,

	--coalesce(c.destination_datatype_name,a.destination_datatype_name) as destination_datatype_name,
    --	case when coalesce(c.intermediate_stg_function,a.intermediate_stg_function) = 'AsIs' then lower('parquet')||'_AsIs'
    --    else coalesce(c.intermediate_stg_function,a.intermediate_stg_function) end as intermediate_stg_function,a.inconsistent_datatype,

	--renaming of columns options logic
	case
	    when a.is_long_col_name then 'c_'||a.column_id
	    when((true = false) and (true =false)  and a.column_id in (select column_id from source_level_casting) )
        then (select slc.destination_column_name from source_level_casting slc where slc.column_id = a.column_id)
	    when pc.column_id is not null then pc.final_column_name
	    else a.field_name
	end as field_name,
	case
    	    when((true = false) and (true =false)  and a.column_id in (select column_id from source_level_casting) )
            then (select slc.destination_column_name from source_level_casting slc where slc.column_id = a.column_id)
    	    when pc.column_id is not null then pc.final_column_name else a.field_name_replaced
    	    end as field_name_replaced,a.is_long_col_name,
	case
		when ('sql_server' = 'oracle') then
        (
            case
                when data_type ~* 'time zone' and c.option_number = 0 then true
                else false
            end
        )
		when ('sql_server' in ('postgres','redshift','redshift_relational') and a.destination_type!='hive') then
        (
        	case
                when data_type ~* 'timestamp with time zone' and c.option_number = 0 then true
                else false
            end
        )
        when ('sql_server' = 'sql_server') then
        (
        	case
                when data_type = 'datetimeoffset' and c.option_number = 0 then true
                else false
            end
        )
        else false
	end as isTimeZone , user_text, a.is_cdc_col
  from initial_column_mapping a left outer join (select a.*,lower(b.engine_type) as datamovement_engine_type from nabu.user_defined_trans_for_inconsistent_datatype a inner join nabu.engine_lookup b on a.engine_id = b.engine_id where data_movement_id = 261 and valid_to='9999-12-31' ) c
  on a.source_type = c.source_type
  and a.intermediate_type = c.intermediate_type
  and a.destination_type = c.destination_type
  and a.datamovement_engine_type = c.datamovement_engine_type
  and a.inconsistent_datatype = c.inconsistent_datatype
  left outer join partition_columns pc on a.column_id = pc.column_id
  left outer join source_level_casting slc on a.column_id = slc.column_id and slc.sql_expr !=''
union all
  select false::boolean as is_virtual,0 as column_id,
    false as is_source_casting_enabled ,
    false as is_partitioned_col, a.column_name,
    replace(a.column_name,'''','''''')as replaced_column_name,a.data_type,a.data_length,a.ordinal_position,a.is_nullable,table_name,schema_name ,false as is_mysql,
    false as is_bigquery,false as is_source_hive,
	a.source_type,a.source_datatype_name,source_cast_type,a.intermediate_datatype_name,a.table_id,
    c.source_stg_function,
	a.data_scale,
	a.data_precision,
	case when (a.data_precision = 0 or a.data_precision is null) then true else false end as is_precision,
    case when a.data_scale <= 37 then true else false end as is_precision_scale,
    case when a.destination_type='redshift_relational' then true else false end as is_redshift_relational_destination,
    case when a.destination_type = 'oracle' then true else false end as is_oracle_destination,
    case when c.destination_datatype_name ~*'varchar|boolean' then true else false end as is_varchar,
	c.destination_datatype_name,
    case when coalesce(c.intermediate_stg_function,a.intermediate_stg_function) = 'AsIs' then lower('parquet')||'_AsIs'
            when (c.intermediate_stg_function = 'parquet_inconsistentInteger_convert' and data_scale=0) then (
                case when (data_scale=0 and (data_precision between 0 and 2)) then 'ParquetStringToTinyIntConvert'
                 when (data_scale=0 and (data_precision between 3 and 4)) then 'ParquetStringToSmallIntConvert'
                 when (data_scale=0 and (data_precision between 5 and 9)) then 'ParquetStringToIntConvert'
                 when (data_scale=0 and (data_precision between 10 and 17)) then 'ParquetStringToBigIntConvert'
                 when (data_scale=0 and (data_precision between 18 and 38)) then 'ParquetStringToDecimalConvert'
                 when (data_scale <= 37 and (a.data_precision <= 38)) then a.intermediate_stg_function else 'parquet_AsIs'
                 end
            )
            else coalesce(c.intermediate_stg_function,a.intermediate_stg_function)
            end as intermediate_stg_function,
        	a.inconsistent_datatype,

	--c.destination_datatype_name,
    --c.intermediate_stg_function,
    --a.inconsistent_datatype,

	--renaming of columns options logic
		case
        	    when((true = false) and (true =false)  and a.column_id in (select column_id from source_level_casting) )
                then (select slc.destination_column_name||'_utc' from source_level_casting slc where slc.column_id = a.column_id)
        	    when pc.column_id is not null then pc.final_column_name||'_utc'
        	    else a.field_name||'_utc'
        	end as field_name,
        	case
            	    when((true = false) and (true =false)  and a.column_id in (select column_id from source_level_casting) )
                    then (select slc.destination_column_name||'_utc' from source_level_casting slc where slc.column_id = a.column_id)
            	    when pc.column_id is not null then pc.final_column_name else a.field_name_replaced||'_utc'
            	    end as field_name_replaced,a.is_long_col_name,
    false as isTimeZone , user_text, a.is_cdc_col
  from initial_column_mapping a left outer join (select a.*,lower(b.engine_type) as datamovement_engine_type from nabu.user_defined_trans_for_inconsistent_datatype a inner join nabu.engine_lookup b on a.engine_id = b.engine_id where data_movement_id = 261 and valid_to='9999-12-31' ) c
  on a.source_type = c.source_type
  and a.intermediate_type = c.intermediate_type
  and a.destination_type = c.destination_type
  and a.datamovement_engine_type = c.datamovement_engine_type
  and a.inconsistent_datatype = c.inconsistent_datatype
  left outer join partition_columns pc on a.column_id = pc.column_id
  left outer join source_level_casting slc on a.column_id = slc.column_id and slc.sql_expr !=''
  where(
	case
		when ('sql_server' = 'oracle') then
        (
            case
                when data_type ~* 'time zone' and c.option_number = 0 then true
                else false
            end
        )
		when ('sql_server'  in ('postgres','redshift','redshift_relational') and a.destination_type!='hive') then
        (
        	case
                when data_type ~* 'timestamp with time zone' and c.option_number = 0 then true
                else false
            end
        )
        when ('sql_server' = 'sql_server') then
        (
        	case
                when data_type = 'datetimeoffset' and c.option_number = 0 then true
                else false
            end
        )
        else false
	end ) = true
  group by a.column_name,a.column_id,pc.final_column_name,pc.column_id,a.data_type,a.data_length,a.ordinal_position,a.is_nullable,table_name,schema_name,a.source_type,a.source_datatype_name,source_cast_type,a.intermediate_datatype_name,a.inconsistent_datatype,a.table_id,c.source_stg_function,
  a.data_scale,a.data_precision,a.destination_type,is_varchar,c.destination_datatype_name,c.intermediate_stg_function,a.intermediate_stg_function,a.field_name,a.field_name_replaced,a.is_long_col_name,c.option_number,a.user_text,a.is_cdc_col
  order by ordinal_position)a
 )
 select * from cdc_cols where is_cdc_col=true
""2023-11-15 15:36:58.234 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with cte1 as (
select data_type,column_name,table_id,data_length
from nabu.dataplace_column_metadata_physical dcmp
where dataplace_id=5
and table_name='aaaa'
and (data_type ~* 'varchar|character varying|boolean')
and valid_to_ts ='9999-12-31'
),
cte2 as(
select distinct column_name as field_name,
CASE
                        when data_type='boolean' then 'boolean'
                        when (data_length between 1 and 65535) then concat('VARCHAR','(',data_length,')')
                        when 'adls_gen2' = 'oracle' then 'varchar(4000)'
                        else 'varchar(65535)'
                end as destination_datatype_name from cte1
)
select * from cte2;
""2023-11-15 15:36:58.407 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query :     select field_name,destination_datatype_name from(select
        column_data->>'field_name' as field_name,
        column_data->>'source_field_name' as source_field_name,
        column_data->>'column_name' as column_name,
        column_data->>'column_id' as column_id,
        column_data->>'source_datatype_name' as source_datatype_name,
        (column_data->>'ingested_colorder')::int as ingested_colorder,
        column_data->>'destination_datatype_name' as destination_datatype_name,
        (column_data->>'is_partitioned_col')::boolean as is_partitioned_col,
        column_data->>'data_length' as data_length,
        column_data->>'data_scale' as data_scale,
        column_data->>'data_precision' as data_precision,
        (column_data->>'is_virtual')::boolean as is_virtual,
        (column_data->>'is_varchar')::boolean as is_varchar
    from(select json_array_elements(('[{
    "field_name": "entity_id",
    "source_field_name": "entity_id",
    "column_name": "entity_id",
    "column_id": "956158",
    "source_datatype_name": "varchar",
    "ingested_colorder": "1",
    "destination_datatype_name": "string",
    "data_length": "255",
    "data_scale": "0",
    "data_precision": "0",
    "is_partitioned_col":  false ,
    "is_virtual":  false ,
    "is_varchar" :  false 
},{
    "field_name": "entity_type",
    "source_field_name": "entity_type",
    "column_name": "entity_type",
    "column_id": "956159",
    "source_datatype_name": "varchar",
    "ingested_colorder": "2",
    "destination_datatype_name": "string",
    "data_length": "255",
    "data_scale": "0",
    "data_precision": "0",
    "is_partitioned_col":  false ,
    "is_virtual":  false ,
    "is_varchar" :  false 
}]')::json) as column_data)column_metadata
   )partition_col_data where is_varchar = true
    order by ingested_colorder

""2023-11-15 15:36:58.583 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query :     select field_name,source_field_name,column_name,column_id, source_datatype_name,ingested_colorder, destination_datatype_name, is_partitioned_col,is_virtual,false :: boolean as is_auditcol, row_number() over (order by column_name)+5 as pos,data_length,data_scale,data_precision
from(select
        column_data->>'field_name' as field_name,
        column_data->>'source_field_name' as source_field_name,
        column_data->>'column_name' as column_name,
        column_data->>'column_id' as column_id,
        column_data->>'source_datatype_name' as source_datatype_name,
        (column_data->>'ingested_colorder')::int as ingested_colorder,
        column_data->>'destination_datatype_name' as destination_datatype_name,
        (column_data->>'is_partitioned_col')::boolean as is_partitioned_col,
        column_data->>'data_length' as data_length,
        column_data->>'data_scale' as data_scale,
        column_data->>'data_precision' as data_precision,
        (column_data->>'is_virtual')::boolean as is_virtual,
        (column_data->>'is_varchar')::boolean as is_varchar
    from(select json_array_elements(('[{
    "field_name": "entity_id",
    "source_field_name": "entity_id",
    "column_name": "entity_id",
    "column_id": "956158",
    "source_datatype_name": "varchar",
    "ingested_colorder": "1",
    "destination_datatype_name": "string",
    "data_length": "255",
    "data_scale": "0",
    "data_precision": "0",
    "is_partitioned_col":  false ,
    "is_virtual":  false ,
    "is_varchar" :  false 
},{
    "field_name": "entity_type",
    "source_field_name": "entity_type",
    "column_name": "entity_type",
    "column_id": "956159",
    "source_datatype_name": "varchar",
    "ingested_colorder": "2",
    "destination_datatype_name": "string",
    "data_length": "255",
    "data_scale": "0",
    "data_precision": "0",
    "is_partitioned_col":  false ,
    "is_virtual":  false ,
    "is_varchar" :  false 
}]')::json) as column_data)column_metadata
   )partition_col_data where is_partitioned_col = true and is_virtual = false
    order by ingested_colorder

""2023-11-15 15:36:58.769 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query :     select field_name,source_field_name,column_name,column_id, source_datatype_name,ingested_colorder, destination_datatype_name, is_partitioned_col,is_virtual,false :: boolean as is_auditcol,data_length,data_scale,data_precision
from(select
        column_data->>'field_name' as field_name,
        column_data->>'source_field_name' as source_field_name,
        column_data->>'column_name' as column_name,
        column_data->>'column_id' as column_id,
        column_data->>'source_datatype_name' as source_datatype_name,
        (column_data->>'ingested_colorder')::int as ingested_colorder,
        column_data->>'destination_datatype_name' as destination_datatype_name,
        (column_data->>'is_partitioned_col')::boolean as is_partitioned_col,
        column_data->>'data_length' as data_length,
        column_data->>'data_scale' as data_scale,
        column_data->>'data_precision' as data_precision,
        (column_data->>'is_virtual')::boolean as is_virtual,
        (column_data->>'is_varchar')::boolean as is_varchar
    from(select json_array_elements(('[{
    "field_name": "entity_id",
    "source_field_name": "entity_id",
    "column_name": "entity_id",
    "column_id": "956158",
    "source_datatype_name": "varchar",
    "ingested_colorder": "1",
    "destination_datatype_name": "string",
    "data_length": "255",
    "data_scale": "0",
    "data_precision": "0",
    "is_partitioned_col":  false ,
    "is_virtual":  false ,
    "is_varchar" :  false 
},{
    "field_name": "entity_type",
    "source_field_name": "entity_type",
    "column_name": "entity_type",
    "column_id": "956159",
    "source_datatype_name": "varchar",
    "ingested_colorder": "2",
    "destination_datatype_name": "string",
    "data_length": "255",
    "data_scale": "0",
    "data_precision": "0",
    "is_partitioned_col":  false ,
    "is_virtual":  false ,
    "is_varchar" :  false 
}]')::json) as column_data)column_metadata
    )partition_col_data where is_partitioned_col = false
    order by ingested_colorder

""2023-11-15 15:36:58.954 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select table_name,table_id from
nabu.dataplace_table_metadata_physical where dataplace_id = 5
and schema_id = 3
and table_name = 'aaaa'  and valid_to_ts = '9999-12-31'
""2023-11-15 15:36:59.369 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select false as schema_drifted,false as target_schemadrift_ignore_table,false as target_schemadrift_backup_table,false as target_schemadrift_new_table,
'aaaa' as destination_table_name,
'aaaa' as backup_table_name

""2023-11-15 15:36:59.560 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with cte_for_newtable_opt as (
--This cte is for the subsequent run after targetdrift with schema drift 3rd option
select case when num > 0 then true else false end as nextrun_after_targetdrift from
(
        select count(*) as num from nabu.data_movement_schema_drift_details dmsdd where (data_movement_id,process_id) =
	(
             select t.data_movement_id,t.process_id from (
		select data_movement_id,process_id from nabu.flow_task_status a where batch_id in
            (select batch_id from nabu.flow_status fs2 where data_movement_id =261 and status_code_id =12 order by flow_ts desc limit 1)
            and object_id = 37234 and status_code_id = 15 order by flow_task_ts desc limit 1)  t
	)
	and advanced_options_sub_type_id = 6
)a
),
target_drift_flag as (
select false as schema_drifted
)
select case when (not schema_drifted and nextrun_after_targetdrift) then true else false end as nextrun_after_targetdrift
from cte_for_newtable_opt,target_drift_flag
""2023-11-15 15:36:59.747 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select
	data_movement_id ,
	case
	    when (false or false ) then 'Overwrite'
		when lower((advance_option_details->'advanced_table_options'->>'ingestion_mode')::json->>'mode')= 'drop & re-create' then 'Overwrite'
		else (advance_option_details->'advanced_table_options'->>'ingestion_mode')::json->>'mode'
	end as save_mode,
	case
	    when (false or false or
	    false ) then 'overwrite'
		when lower((advance_option_details->'advanced_table_options'->>'ingestion_mode')::json->>'mode')= 'drop & re-create' then 'overwrite'
		else lower((advance_option_details->'advanced_table_options'->>'ingestion_mode')::json->>'mode')
	end as mode,
	(advance_option_details->'advanced_option_flags'->>'ingestion_mode')::bool as ingestion_mode_key,
	case
	    when (false or false or
	    false) then true
		when lower((advance_option_details->'advanced_table_options'->>'ingestion_mode')::json->>'mode') = 'drop & re-create' then true
		else false
	end as drop_create_condition
from
	nabu.advanced_options_object_details
where
	data_movement_id = 261
	and
valid_to_ts = '9999-12-31'
	and
object_id = 37234
""2023-11-15 15:36:59.951 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with last_run_details as(
    select case when coalesce(additional_info->>'table_name','')!='aaaa' then true
    else false end as cdc_first,
    coalesce(additional_info->>'table_name','') as last_run_table_name
    from (
        select *,ROW_NUMBER () OVER (order by valid_from_ts desc) rank
        from nabu.advanced_options_obj_checkpoint aooc
        where data_movement_id =261
        and source_dataplace_id = 42 
        and advanced_option_obj_type_id =8
        and object_id =37234
        and valid_to_ts ='9999-12-31'
    )a where rank=1
),
prev_target_path as(
    select
    file_absolute_path from nabu.dataplace_file_metadata
    where directory_id = 3
    and file_id = (select destination_table_id from
                     (select row_number() over(partition by data_movement_id order by crt_ts desc)r, destination_table_id,file_absolute_path from nabu.data_entity_lineage del
                     inner join nabu.dataplace_file_metadata dtmp
                     on del.destination_table_id = dtmp.file_id inner join last_run_details lrd
                     on lrd.last_run_table_name= dtmp.file_name where dataplace_id = 5 and data_movement_id=261)a
                     where r=1)
    and file_name = (select last_run_table_name from last_run_details)
    and dataplace_id = 5
    and valid_to_ts ='9999-12-31'
)
select
case when (select prev_target_path from prev_target_path) is null then true
	else (select cdc_first from last_run_details)
end as cdc_first,
(select * from prev_target_path) as prev_target_path,
'abfss://dataproc@idea15pisplznonprodsa2.dfs.core.windows.net/261/42/development-db/acuity-develop/aaaa.parquet' as target_path,
'/261/42/development-db/acuity-develop/aaaa.parquet' as relative_path
""2023-11-15 15:37:00.145 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select case when false = true then true
when false = true then true
when (
select coalesce(additional_info->>'schema_drift_newtable','false')::bool as drifted_table  from
(
    select *,ROW_NUMBER () OVER (order by valid_from_ts desc) rank from nabu.advanced_options_obj_checkpoint aooc
where data_movement_id =261
and source_dataplace_id = 42 
     and advanced_option_obj_type_id =8 and object_id =37234
    and valid_to_ts ='9999-12-31'
)a where rank=1
)=true then true
when (
true
)=true then true
when count(*)>0 then false else true end as cdc_first_time from nabu.advanced_options_obj_checkpoint
where data_movement_id =261
and source_dataplace_id = 42 
and object_id =37234
and advanced_option_obj_type_id =8
and valid_to_ts ='9999-12-31'
""2023-11-15 15:37:00.360 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query :  select decoded_expression|| ' as ' || column_name || '' as spark_expression from
(
    select *,lower(convert_from(decode(spark_sql_expression,'base64'), 'UTF8')) as decoded_expression from
	(
	    SELECT (jsonarray ->>'column_name')::text as column_name,(jsonarray ->>'column_type')::text as column_type,(jsonarray ->>'spark_sql_expression')::text as spark_sql_expression
	from
	(   select json_array_elements(('[
]')) :: json as jsonarray
		from nabu.advanced_options_object_details
		where data_movement_id =261 and object_id=37234 and valid_to_ts ='9999-12-31')a)b)c

""2023-11-15 15:37:00.548 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select 'null' 
""2023-11-15 15:37:00.741 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query :  INSERT INTO nabu.process_id_table_map (data_movement_id, process_id, object_id, process_started_ts, batch_id, batch_name) VALUES
 (261, 17000625869931891, 37234, current_timestamp, 17000625866627691, 'Ingestion_20231115')
 
""2023-11-15 15:37:00.936 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with get_compute_engine_id as (
select compute_engine_id,0 as retry_attempt from nabu.data_movement_physical dmp
where data_movement_id = 261 and valid_to_ts = '9999-12-31 00:00:00.000'
),
get_max_priority_number as (
select cescd.compute_engine_id, max(spark_configuration_priority_number) as max_priority_number
from nabu.compute_engine_spark_config_details cescd
inner join get_compute_engine_id gcei
on cescd.compute_engine_id = gcei.compute_engine_id
where valid_to_ts = '9999-12-31 00:00:00.000'
group by cescd.compute_engine_id
),
get_priority_number as (
select gmpn.compute_engine_id,
case when gmpn.max_priority_number  >  gcei.retry_attempt then gcei.retry_attempt+1 else gmpn.max_priority_number end as priority_number
from get_max_priority_number gmpn, get_compute_engine_id gcei
),
extra_configs as(
select cescd.compute_engine_id, cescd.spark_configuration_type_id,cescd.spark_configuration_priority_json as config_json, cescd.spark_configuration_priority_json->>'default_configs' as spark_configs_json,
(cescd.spark_configuration_priority_json->>'default_configs')::json->>'fetch_size' as fetch_size,
(cescd.spark_configuration_priority_json->>'default_configs')::json->>'solr_batch_size' as solr_batch_size,
(cescd.spark_configuration_priority_json->>'default_configs')::json->>'cluster_name' as cluster_id,
cescd.spark_configuration_priority_json->>'extra_configs' as extra_configs
from nabu.compute_engine_spark_config_details cescd
inner join get_priority_number gpn
on cescd.compute_engine_id = gpn.compute_engine_id
and cescd.spark_configuration_priority_number = gpn.priority_number
where cescd.valid_to_ts = '9999-12-31 00:00:00.000'
)
select compute_engine_id,cluster_id, config_json, spark_configuration_type_id, spark_configs_json,(concat('{"spark.nabu.fetch_size": "',fetch_size ,'", "spark.nabu.solr_batch_size": "', solr_batch_size,'"}')::jsonb || extra_configs::jsonb) ::json as extra_configs_json from extra_configs
""2023-11-15 15:37:01.131 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : {
    "solr_batch_size":"10000","parallel_threads":"10","fetch_size":"10000"
    }
""2023-11-15 15:37:01.343 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select '{"spark.nabu.fetch_size": "10000", "spark.nabu.solr_batch_size": "10000"}' ::jsonb
  || '{
    "spark.nabu.compute_engine":"azure_databricks",
    "spark.nabu.compute_engine_libs_path":"/dbfs/tmp/dev/nabu/17000625869931891/0/application.conf",
    "spark.driver.nabu_privateKey":"/dbfs/tmp/dev/nabu/17000625869931891/0/privateKey",
    "spark.nabu.application_name":"nabu-sparkbot-ingestion",
    "spark.driver.source_aws_endPoint": "s3.amazonaws.com",
    "spark.driver.target_aws_endPoint": "s3.amazonaws.com"
}'::jsonb
 as configs_json
""2023-11-15 15:37:01.542 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : {
"extraConfigMap": {"spark.nabu.fetch_size": "10000", "spark.nabu.compute_engine": "azure_databricks", "spark.nabu.solr_batch_size": "10000", "spark.nabu.application_name": "nabu-sparkbot-ingestion", "spark.driver.nabu_privateKey": "/dbfs/tmp/dev/nabu/17000625869931891/0/privateKey", "spark.driver.source_aws_endPoint": "s3.amazonaws.com", "spark.driver.target_aws_endPoint": "s3.amazonaws.com", "spark.nabu.compute_engine_libs_path": "/dbfs/tmp/dev/nabu/17000625869931891/0/application.conf"}
}
""2023-11-15 15:37:01.714 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with fetch_ssh_configuration as (
select b.credential_id as spark_credential_id,(b.additional_info ->> 'hive_credential_id')::int as metastore_credential_id
      from nabu.data_movement_physical a
inner join nabu.compute_engine b on a.compute_engine_id = b.compute_engine_id
inner join nabu.config c on  b.compute_engine_config_id = c.config_id
where a.data_movement_id =261
and a.valid_to_ts ='9999-12-31'
 and b.valid_to_ts ='9999-12-31'
)
select fsc.spark_credential_id,fsc.metastore_credential_id,ci.credential_type_id ,ctl.credential_type,fsc.spark_credential_id||'_'||extract(epoch from mod_ts::timestamp(0)) as credential_pattern ,
(select credential_type_id from nabu.credential_info ci2 where ci2.credential_id = fsc.metastore_credential_id) as metastore_credential_type_id
from fetch_ssh_configuration fsc
inner join nabu.credential_info ci on fsc.spark_credential_id=ci.credential_id
inner join nabu.credential_type_lookup ctl  on ci.credential_type_id =ctl.credential_type_id;
""2023-11-15 15:37:01.912 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDYyNjA0ODY3ODczNSwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0NTQwNSwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2MjYwNH0.TdlKYjNFZRULplibTKTBiTeNTShCsDicocUZq9KQkMiynWn2WsDoCNVj1Gnby5Zevba71EIlyJc7hK0-wksFFLDOu-AutbS3q-JSjcWr7zHFmWQ3NR6Xs_ycLsdTfh9HnCPt4R-GHKm9SOS5CzT6JBg08gb9cZtV2havzmaG4v9vckfKagGuftWnBKcsQNp2h9zB_EDYLVdDOUd_Aa8UHMklrT8W0SjKoDgbHVZ5T506nwQL-nXZYY0_YHP9KqDtPRiRq-k6db434A4pMx6BkTAG1z355WIuqa1fwRtrSB5HZQULpX85KD8FMpbt2gBBHWDn01TnO5_crpf0lv-SfQ
""2023-11-15 15:37:02.097 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : {
  "credential_id": "41",
  "credential_type_id": "15",
  "credential_type": "File Content",
  "token": "c6950582a12b558ab648cdb72008173b2e8428fb55daad74015225691eec78ee7b5c4e34312ded70ae5e7ee483b7d7ea0c23e24e458ed1f54da3ccd7dbcfe870a61e5c9c5087e7fb6dc16b6f8f5e4beda56924e8849eb539a63b6f38c3180f8697dc1cfa6112331019464b5b60b979b936bf5171a9962c1ca54f8ec842067a848b923c69d299c6b7524c0954293040309a1f8fd39f782d1bd8643f32a65fa357056ebdf0d549e20f0f1a056e8126382396c9fd54c3aae9d828c6f55e73a2c6459a02d5524ea234c20d9eef46d15fedba5bf95e6bb830facdcaae1706fca6180bdb0035a93e24d5754f7d2f8c3358bbabae89db329bf363df0c148c59aaeef4cdffbd8790903054d6b54abf2f9357eda0e4ff31ab0717ed4fbbc1f546958444a9c1530db1983945ca1f88970ee7ce0b07758510a8d1b2c7045f7e0c41221244d87518bfb119f0c0b2a212d57657cd43af5abc44d9957591911bdeaf6279d43a1972138852d3deb81e018cfd2bec4120b1aef24d56e31c2cae6a7c88bd139b4403015672e6b8d53f28d233fb06dc5df67eb6519e9e44ed90e4bbfb8b576c9afa7ddfab17af219bf8135de1f8e6fa3ff46e1aac969afc1f4c5625d0c60754fc1bbc34ad63e58a4f7be97566f4139a9a4bbf0bb13da9b1344019eef083bb055a2fe10fffc739a29adbbda333b84edde86b5b764297d19f0c17689967de022a1db9d14caa7c8018b52c8be6f31071738c9c5711c924229124db620111efe61cde95d9ffdd044057965765c4a031e6fb2aaaa9ef7e1750c756bea2a1ca38da5b6d2231137b0d3df9445847a43eba37a67a0229",
  "credential_endpoint_url": "http://dev-dha.humana.com:8889/fireshots/credentialsFetchWebService",
  "file_path": "1567_261_17000625866627691",
  "credential_file_pattern" : "41_1699342575"
}
""2023-11-15 15:37:02.293 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : {
"pipeline_timeout" : 23
}
""2023-11-15 15:37:02.483 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : {
  "credential_id": "",
  "credential_type_id": "",
  "token": "c6950582a12b558ab648cdb72008173b2e8428fb55daad74015225691eec78ee7b5c4e34312ded70ae5e7ee483b7d7ea0c23e24e458ed1f54da3ccd7dbcfe870a61e5c9c5087e7fb6dc16b6f8f5e4beda56924e8849eb539a63b6f38c3180f8697dc1cfa6112331019464b5b60b979b936bf5171a9962c1ca54f8ec842067a848b923c69d299c6b7524c0954293040309a1f8fd39f782d1bd8643f32a65fa357056ebdf0d549e20f0f1a056e8126382396c9fd54c3aae9d828c6f55e73a2c6459a02d5524ea234c20d9eef46d15fedba5bf95e6bb830facdcaae1706fca6180bdb0035a93e24d5754f7d2f8c3358bbabae89db329bf363df0c148c59aaeef4cdffbd8790903054d6b54abf2f9357eda0e4ff31ab0717ed4fbbc1f546958444a9c1530db1983945ca1f88970ee7ce0b07758510a8d1b2c7045f7e0c41221244d87518bfb119f0c0b2a212d57657cd43af5abc44d9957591911bdeaf6279d43a1972138852d3deb81e018cfd2bec4120b1aef24d56e31c2cae6a7c88bd139b4403015672e6b8d53f28d233fb06dc5df67eb6519e9e44ed90e4bbfb8b576c9afa7ddfab17af219bf8135de1f8e6fa3ff46e1aac969afc1f4c5625d0c60754fc1bbc34ad63e58a4f7be97566f4139a9a4bbf0bb13da9b1344019eef083bb055a2fe10fffc739a29adbbda333b84edde86b5b764297d19f0c17689967de022a1db9d14caa7c8018b52c8be6f31071738c9c5711c924229124db620111efe61cde95d9ffdd044057965765c4a031e6fb2aaaa9ef7e1750c756bea2a1ca38da5b6d2231137b0d3df9445847a43eba37a67a0229",
  "credential_endpoint_url": "http://dev-dha.humana.com:8889/fireshots/credentialsFetchWebService"
}
""2023-11-15 15:37:02.663 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : {
  "sourceCredentials": {
    "token": "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDYyNjA0ODY3ODczNSwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0NTQwNSwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2MjYwNH0.TdlKYjNFZRULplibTKTBiTeNTShCsDicocUZq9KQkMiynWn2WsDoCNVj1Gnby5Zevba71EIlyJc7hK0-wksFFLDOu-AutbS3q-JSjcWr7zHFmWQ3NR6Xs_ycLsdTfh9HnCPt4R-GHKm9SOS5CzT6JBg08gb9cZtV2havzmaG4v9vckfKagGuftWnBKcsQNp2h9zB_EDYLVdDOUd_Aa8UHMklrT8W0SjKoDgbHVZ5T506nwQL-nXZYY0_YHP9KqDtPRiRq-k6db434A4pMx6BkTAG1z355WIuqa1fwRtrSB5HZQULpX85KD8FMpbt2gBBHWDn01TnO5_crpf0lv-SfQ",
    "credential_id": 37 ,
    "credential_type_id": 1 ,
    "end_point": "http://dev-dha.humana.com:8889/fireshots/credentialsFetchWebService"
  },
  "targetCredentials":{
    "token": "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDYyNjA0ODY3ODczNSwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0NTQwNSwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2MjYwNH0.TdlKYjNFZRULplibTKTBiTeNTShCsDicocUZq9KQkMiynWn2WsDoCNVj1Gnby5Zevba71EIlyJc7hK0-wksFFLDOu-AutbS3q-JSjcWr7zHFmWQ3NR6Xs_ycLsdTfh9HnCPt4R-GHKm9SOS5CzT6JBg08gb9cZtV2havzmaG4v9vckfKagGuftWnBKcsQNp2h9zB_EDYLVdDOUd_Aa8UHMklrT8W0SjKoDgbHVZ5T506nwQL-nXZYY0_YHP9KqDtPRiRq-k6db434A4pMx6BkTAG1z355WIuqa1fwRtrSB5HZQULpX85KD8FMpbt2gBBHWDn01TnO5_crpf0lv-SfQ",
    "credential_id": 2 ,
    "credential_type_id": 5 ,
    "end_point": "http://dev-dha.humana.com:8889/fireshots/credentialsFetchWebService"
  }  }
""2023-11-15 15:37:02.841 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : ewogICJzb3VyY2VDcmVkZW50aWFscyI6IHsKICAgICJ0b2tlbiI6ICJleUpoYkdjaU9pSlNVekkxTmlKOS5leUpwYzNNaU9pSkdTVkpGVTBoUFZGTmZRVkJRVEVsRFFWUkpUMDRpTENKelpYTnphVzl1WDJsa0lqb3hOekF3TURZeU5qQTBPRFkzT0Rjek5Td2ljbVZ4ZFdWemRHVmtYM1Z6WlhKZmFXUWlPaUpOWVc1aGMzZHBibWtnUTJocGJuUm9ZV3hoY0hWa2FTSXNJbVY0Y0NJNk1UY3dNREUwTlRRd05Td2lkWE5sY2tsa0lqb2lZbTkwY3kxemNuWXRZV05qYjNWdWRDSXNJbWxoZENJNk1UY3dNREEyTWpZd05IMC5UZGxLWWpORlpSVUxwbGliVEtUQmlUZU5UU2hDc0RpY29jVVpxOUtRa01peW5XbjJXc0RvQ05WajFHbmJ5NVpldmJhNzFFSWx5SmM3aEswLXdrc0ZGTERPdS1BdXRiUzNxLUpTamNXcjd6SEZtV1EzTlI2WHNfeWNMc2RUZmg5SG5DUHQ0Ui1HSEttOVNPUzVDelQ2SkJnMDhnYjljWnRWMmhhdnptYUc0djl2Y2tmS2FnR3VmdFduQktjc1FOcDJoOXpCX0VEWUxWZERPVWRfQWE4VUhNa2xyVDhXMFNqS29EZ2JIVlo1VDUwNm53UUwtblhaWVkwX1lIUDlLcUR0UFJpUnEtazZkYjQzNEE0cE14NkJrVEFHMXozNTVXSXVxYTFmd1J0clNCNUhaUVVMcFg4NUtEOEZNcGJ0MmdCQkhXRG4wMVRuTzVfY3JwZjBsdi1TZlEiLAogICAgImNyZWRlbnRpYWxfaWQiOiAzNyAsCiAgICAiY3JlZGVudGlhbF90eXBlX2lkIjogMSAsCiAgICAiZW5kX3BvaW50IjogImh0dHA6Ly9kZXYtZGhhLmh1bWFuYS5jb206ODg4OS9maXJlc2hvdHMvY3JlZGVudGlhbHNGZXRjaFdlYlNlcnZpY2UiCiAgfSwKICAidGFyZ2V0Q3JlZGVudGlhbHMiOnsKICAgICJ0b2tlbiI6ICJleUpoYkdjaU9pSlNVekkxTmlKOS5leUpwYzNNaU9pSkdTVkpGVTBoUFZGTmZRVkJRVEVsRFFWUkpUMDRpTENKelpYTnphVzl1WDJsa0lqb3hOekF3TURZeU5qQTBPRFkzT0Rjek5Td2ljbVZ4ZFdWemRHVmtYM1Z6WlhKZmFXUWlPaUpOWVc1aGMzZHBibWtnUTJocGJuUm9ZV3hoY0hWa2FTSXNJbVY0Y0NJNk1UY3dNREUwTlRRd05Td2lkWE5sY2tsa0lqb2lZbTkwY3kxemNuWXRZV05qYjNWdWRDSXNJbWxoZENJNk1UY3dNREEyTWpZd05IMC5UZGxLWWpORlpSVUxwbGliVEtUQmlUZU5UU2hDc0RpY29jVVpxOUtRa01peW5XbjJXc0RvQ05WajFHbmJ5NVpldmJhNzFFSWx5SmM3aEswLXdrc0ZGTERPdS1BdXRiUzNxLUpTamNXcjd6SEZtV1EzTlI2WHNfeWNMc2RUZmg5SG5DUHQ0Ui1HSEttOVNPUzVDelQ2SkJnMDhnYjljWnRWMmhhdnptYUc0djl2Y2tmS2FnR3VmdFduQktjc1FOcDJoOXpCX0VEWUxWZERPVWRfQWE4VUhNa2xyVDhXMFNqS29EZ2JIVlo1VDUwNm53UUwtblhaWVkwX1lIUDlLcUR0UFJpUnEtazZkYjQzNEE0cE14NkJrVEFHMXozNTVXSXVxYTFmd1J0clNCNUhaUVVMcFg4NUtEOEZNcGJ0MmdCQkhXRG4wMVRuTzVfY3JwZjBsdi1TZlEiLAogICAgImNyZWRlbnRpYWxfaWQiOiAyICwKICAgICJjcmVkZW50aWFsX3R5cGVfaWQiOiA1ICwKICAgICJlbmRfcG9pbnQiOiAiaHR0cDovL2Rldi1kaGEuaHVtYW5hLmNvbTo4ODg5L2ZpcmVzaG90cy9jcmVkZW50aWFsc0ZldGNoV2ViU2VydmljZSIKICB9ICB9
""2023-11-15 15:37:03.026 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : {
"processId":17000625869931891,
"dataplaceId":42,
"tableId":37234,
"datamovementId":261,
"jobScheduledUserId":"Manaswini Chinthalapudi",
"jobScheduleId":1567,
"batchId":17000625866627691,
"lastRunTimestamp":"2023-11-07 12:42:00.86365",
"retryNum": "0"
}
""2023-11-15 15:37:03.214 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : {
  "cluster_id": "0922-003138-orn9r0te",
  "cluster_region": "null",
  "compute_eng_creds_json": "ewogICJjcmVkZW50aWFsX2lkIjogIjQxIiwKICAiY3JlZGVudGlhbF90eXBlX2lkIjogIjE1IiwKICAiY3JlZGVudGlhbF90eXBlIjogIkZpbGUgQ29udGVudCIsCiAgInRva2VuIjogImM2OTUwNTgyYTEyYjU1OGFiNjQ4Y2RiNzIwMDgxNzNiMmU4NDI4ZmI1NWRhYWQ3NDAxNTIyNTY5MWVlYzc4ZWU3YjVjNGUzNDMxMmRlZDcwYWU1ZTdlZTQ4M2I3ZDdlYTBjMjNlMjRlNDU4ZWQxZjU0ZGEzY2NkN2RiY2ZlODcwYTYxZTVjOWM1MDg3ZTdmYjZkYzE2YjZmOGY1ZTRiZWRhNTY5MjRlODg0OWViNTM5YTYzYjZmMzhjMzE4MGY4Njk3ZGMxY2ZhNjExMjMzMTAxOTQ2NGI1YjYwYjk3OWI5MzZiZjUxNzFhOTk2MmMxY2E1NGY4ZWM4NDIwNjdhODQ4YjkyM2M2OWQyOTljNmI3NTI0YzA5NTQyOTMwNDAzMDlhMWY4ZmQzOWY3ODJkMWJkODY0M2YzMmE2NWZhMzU3MDU2ZWJkZjBkNTQ5ZTIwZjBmMWEwNTZlODEyNjM4MjM5NmM5ZmQ1NGMzYWFlOWQ4MjhjNmY1NWU3M2EyYzY0NTlhMDJkNTUyNGVhMjM0YzIwZDllZWY0NmQxNWZlZGJhNWJmOTVlNmJiODMwZmFjZGNhYWUxNzA2ZmNhNjE4MGJkYjAwMzVhOTNlMjRkNTc1NGY3ZDJmOGMzMzU4YmJhYmFlODlkYjMyOWJmMzYzZGYwYzE0OGM1OWFhZWVmNGNkZmZiZDg3OTA5MDMwNTRkNmI1NGFiZjJmOTM1N2VkYTBlNGZmMzFhYjA3MTdlZDRmYmJjMWY1NDY5NTg0NDRhOWMxNTMwZGIxOTgzOTQ1Y2ExZjg4OTcwZWU3Y2UwYjA3NzU4NTEwYThkMWIyYzcwNDVmN2UwYzQxMjIxMjQ0ZDg3NTE4YmZiMTE5ZjBjMGIyYTIxMmQ1NzY1N2NkNDNhZjVhYmM0NGQ5OTU3NTkxOTExYmRlYWY2Mjc5ZDQzYTE5NzIxMzg4NTJkM2RlYjgxZTAxOGNmZDJiZWM0MTIwYjFhZWYyNGQ1NmUzMWMyY2FlNmE3Yzg4YmQxMzliNDQwMzAxNTY3MmU2YjhkNTNmMjhkMjMzZmIwNmRjNWRmNjdlYjY1MTllOWU0NGVkOTBlNGJiZmI4YjU3NmM5YWZhN2RkZmFiMTdhZjIxOWJmODEzNWRlMWY4ZTZmYTNmZjQ2ZTFhYWM5NjlhZmMxZjRjNTYyNWQwYzYwNzU0ZmMxYmJjMzRhZDYzZTU4YTRmN2JlOTc1NjZmNDEzOWE5YTRiYmYwYmIxM2RhOWIxMzQ0MDE5ZWVmMDgzYmIwNTVhMmZlMTBmZmZjNzM5YTI5YWRiYmRhMzMzYjg0ZWRkZTg2YjViNzY0Mjk3ZDE5ZjBjMTc2ODk5NjdkZTAyMmExZGI5ZDE0Y2FhN2M4MDE4YjUyYzhiZTZmMzEwNzE3MzhjOWM1NzExYzkyNDIyOTEyNGRiNjIwMTExZWZlNjFjZGU5NWQ5ZmZkZDA0NDA1Nzk2NTc2NWM0YTAzMWU2ZmIyYWFhYTllZjdlMTc1MGM3NTZiZWEyYTFjYTM4ZGE1YjZkMjIzMTEzN2IwZDNkZjk0NDU4NDdhNDNlYmEzN2E2N2EwMjI5IiwKICAiY3JlZGVudGlhbF9lbmRwb2ludF91cmwiOiAiaHR0cDovL2Rldi1kaGEuaHVtYW5hLmNvbTo4ODg5L2ZpcmVzaG90cy9jcmVkZW50aWFsc0ZldGNoV2ViU2VydmljZSIsCiAgImZpbGVfcGF0aCI6ICIxNTY3XzI2MV8xNzAwMDYyNTg2NjYyNzY5MSIsCiAgImNyZWRlbnRpYWxfZmlsZV9wYXR0ZXJuIiA6ICI0MV8xNjk5MzQyNTc1Igp9",
  "s3_path": "",
  "b64_input_json": "ewoicHJvY2Vzc0lkIjoxNzAwMDYyNTg2OTkzMTg5MSwKImRhdGFwbGFjZUlkIjo0MiwKInRhYmxlSWQiOjM3MjM0LAoiZGF0YW1vdmVtZW50SWQiOjI2MSwKImpvYlNjaGVkdWxlZFVzZXJJZCI6Ik1hbmFzd2luaSBDaGludGhhbGFwdWRpIiwKImpvYlNjaGVkdWxlSWQiOjE1NjcsCiJiYXRjaElkIjoxNzAwMDYyNTg2NjYyNzY5MSwKImxhc3RSdW5UaW1lc3RhbXAiOiIyMDIzLTExLTA3IDEyOjQyOjAwLjg2MzY1IiwKInJldHJ5TnVtIjogIjAiCn0=",
  "extra_config": "ewoiZXh0cmFDb25maWdNYXAiOiB7InNwYXJrLm5hYnUuZmV0Y2hfc2l6ZSI6ICIxMDAwMCIsICJzcGFyay5uYWJ1LmNvbXB1dGVfZW5naW5lIjogImF6dXJlX2RhdGFicmlja3MiLCAic3BhcmsubmFidS5zb2xyX2JhdGNoX3NpemUiOiAiMTAwMDAiLCAic3BhcmsubmFidS5hcHBsaWNhdGlvbl9uYW1lIjogIm5hYnUtc3Bhcmtib3QtaW5nZXN0aW9uIiwgInNwYXJrLmRyaXZlci5uYWJ1X3ByaXZhdGVLZXkiOiAiL2RiZnMvdG1wL2Rldi9uYWJ1LzE3MDAwNjI1ODY5OTMxODkxLzAvcHJpdmF0ZUtleSIsICJzcGFyay5kcml2ZXIuc291cmNlX2F3c19lbmRQb2ludCI6ICJzMy5hbWF6b25hd3MuY29tIiwgInNwYXJrLmRyaXZlci50YXJnZXRfYXdzX2VuZFBvaW50IjogInMzLmFtYXpvbmF3cy5jb20iLCAic3BhcmsubmFidS5jb21wdXRlX2VuZ2luZV9saWJzX3BhdGgiOiAiL2RiZnMvdG1wL2Rldi9uYWJ1LzE3MDAwNjI1ODY5OTMxODkxLzAvYXBwbGljYXRpb24uY29uZiJ9Cn0=",
  "batch_id": 17000625866627691,
  "retry_num": "0",
  "spark_configs": "ewogICAgInNvbHJfYmF0Y2hfc2l6ZSI6IjEwMDAwIiwicGFyYWxsZWxfdGhyZWFkcyI6IjEwIiwiZmV0Y2hfc2l6ZSI6IjEwMDAwIgogICAgfQ==",
  "is_bucket_encrypted": "",
  "b64_external_jars_map" : ""
}
""2023-11-15 15:37:03.413 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : {
"cluster_id": "",
"b64_input_json": "ewoicHJvY2Vzc0lkIjoxNzAwMDYyNTg2OTkzMTg5MSwKImRhdGFwbGFjZUlkIjo0MiwKInRhYmxlSWQiOjM3MjM0LAoiZGF0YW1vdmVtZW50SWQiOjI2MSwKImpvYlNjaGVkdWxlZFVzZXJJZCI6Ik1hbmFzd2luaSBDaGludGhhbGFwdWRpIiwKImpvYlNjaGVkdWxlSWQiOjE1NjcsCiJiYXRjaElkIjoxNzAwMDYyNTg2NjYyNzY5MSwKImxhc3RSdW5UaW1lc3RhbXAiOiIyMDIzLTExLTA3IDEyOjQyOjAwLjg2MzY1IiwKInJldHJ5TnVtIjogIjAiCn0=",
"extra_config": "ewoiZXh0cmFDb25maWdNYXAiOiB7InNwYXJrLm5hYnUuZmV0Y2hfc2l6ZSI6ICIxMDAwMCIsICJzcGFyay5uYWJ1LmNvbXB1dGVfZW5naW5lIjogImF6dXJlX2RhdGFicmlja3MiLCAic3BhcmsubmFidS5zb2xyX2JhdGNoX3NpemUiOiAiMTAwMDAiLCAic3BhcmsubmFidS5hcHBsaWNhdGlvbl9uYW1lIjogIm5hYnUtc3Bhcmtib3QtaW5nZXN0aW9uIiwgInNwYXJrLmRyaXZlci5uYWJ1X3ByaXZhdGVLZXkiOiAiL2RiZnMvdG1wL2Rldi9uYWJ1LzE3MDAwNjI1ODY5OTMxODkxLzAvcHJpdmF0ZUtleSIsICJzcGFyay5kcml2ZXIuc291cmNlX2F3c19lbmRQb2ludCI6ICJzMy5hbWF6b25hd3MuY29tIiwgInNwYXJrLmRyaXZlci50YXJnZXRfYXdzX2VuZFBvaW50IjogInMzLmFtYXpvbmF3cy5jb20iLCAic3BhcmsubmFidS5jb21wdXRlX2VuZ2luZV9saWJzX3BhdGgiOiAiL2RiZnMvdG1wL2Rldi9uYWJ1LzE3MDAwNjI1ODY5OTMxODkxLzAvYXBwbGljYXRpb24uY29uZiJ9Cn0=",
"compute_eng_creds_json" : "ewogICJjcmVkZW50aWFsX2lkIjogIjQxIiwKICAiY3JlZGVudGlhbF90eXBlX2lkIjogIjE1IiwKICAiY3JlZGVudGlhbF90eXBlIjogIkZpbGUgQ29udGVudCIsCiAgInRva2VuIjogImM2OTUwNTgyYTEyYjU1OGFiNjQ4Y2RiNzIwMDgxNzNiMmU4NDI4ZmI1NWRhYWQ3NDAxNTIyNTY5MWVlYzc4ZWU3YjVjNGUzNDMxMmRlZDcwYWU1ZTdlZTQ4M2I3ZDdlYTBjMjNlMjRlNDU4ZWQxZjU0ZGEzY2NkN2RiY2ZlODcwYTYxZTVjOWM1MDg3ZTdmYjZkYzE2YjZmOGY1ZTRiZWRhNTY5MjRlODg0OWViNTM5YTYzYjZmMzhjMzE4MGY4Njk3ZGMxY2ZhNjExMjMzMTAxOTQ2NGI1YjYwYjk3OWI5MzZiZjUxNzFhOTk2MmMxY2E1NGY4ZWM4NDIwNjdhODQ4YjkyM2M2OWQyOTljNmI3NTI0YzA5NTQyOTMwNDAzMDlhMWY4ZmQzOWY3ODJkMWJkODY0M2YzMmE2NWZhMzU3MDU2ZWJkZjBkNTQ5ZTIwZjBmMWEwNTZlODEyNjM4MjM5NmM5ZmQ1NGMzYWFlOWQ4MjhjNmY1NWU3M2EyYzY0NTlhMDJkNTUyNGVhMjM0YzIwZDllZWY0NmQxNWZlZGJhNWJmOTVlNmJiODMwZmFjZGNhYWUxNzA2ZmNhNjE4MGJkYjAwMzVhOTNlMjRkNTc1NGY3ZDJmOGMzMzU4YmJhYmFlODlkYjMyOWJmMzYzZGYwYzE0OGM1OWFhZWVmNGNkZmZiZDg3OTA5MDMwNTRkNmI1NGFiZjJmOTM1N2VkYTBlNGZmMzFhYjA3MTdlZDRmYmJjMWY1NDY5NTg0NDRhOWMxNTMwZGIxOTgzOTQ1Y2ExZjg4OTcwZWU3Y2UwYjA3NzU4NTEwYThkMWIyYzcwNDVmN2UwYzQxMjIxMjQ0ZDg3NTE4YmZiMTE5ZjBjMGIyYTIxMmQ1NzY1N2NkNDNhZjVhYmM0NGQ5OTU3NTkxOTExYmRlYWY2Mjc5ZDQzYTE5NzIxMzg4NTJkM2RlYjgxZTAxOGNmZDJiZWM0MTIwYjFhZWYyNGQ1NmUzMWMyY2FlNmE3Yzg4YmQxMzliNDQwMzAxNTY3MmU2YjhkNTNmMjhkMjMzZmIwNmRjNWRmNjdlYjY1MTllOWU0NGVkOTBlNGJiZmI4YjU3NmM5YWZhN2RkZmFiMTdhZjIxOWJmODEzNWRlMWY4ZTZmYTNmZjQ2ZTFhYWM5NjlhZmMxZjRjNTYyNWQwYzYwNzU0ZmMxYmJjMzRhZDYzZTU4YTRmN2JlOTc1NjZmNDEzOWE5YTRiYmYwYmIxM2RhOWIxMzQ0MDE5ZWVmMDgzYmIwNTVhMmZlMTBmZmZjNzM5YTI5YWRiYmRhMzMzYjg0ZWRkZTg2YjViNzY0Mjk3ZDE5ZjBjMTc2ODk5NjdkZTAyMmExZGI5ZDE0Y2FhN2M4MDE4YjUyYzhiZTZmMzEwNzE3MzhjOWM1NzExYzkyNDIyOTEyNGRiNjIwMTExZWZlNjFjZGU5NWQ5ZmZkZDA0NDA1Nzk2NTc2NWM0YTAzMWU2ZmIyYWFhYTllZjdlMTc1MGM3NTZiZWEyYTFjYTM4ZGE1YjZkMjIzMTEzN2IwZDNkZjk0NDU4NDdhNDNlYmEzN2E2N2EwMjI5IiwKICAiY3JlZGVudGlhbF9lbmRwb2ludF91cmwiOiAiaHR0cDovL2Rldi1kaGEuaHVtYW5hLmNvbTo4ODg5L2ZpcmVzaG90cy9jcmVkZW50aWFsc0ZldGNoV2ViU2VydmljZSIsCiAgImZpbGVfcGF0aCI6ICIxNTY3XzI2MV8xNzAwMDYyNTg2NjYyNzY5MSIsCiAgImNyZWRlbnRpYWxfZmlsZV9wYXR0ZXJuIiA6ICI0MV8xNjk5MzQyNTc1Igp9",
"cluster_ui": "",
"retry_num": "0",
"spark_configs": "ewogICAgInNvbHJfYmF0Y2hfc2l6ZSI6IjEwMDAwIiwicGFyYWxsZWxfdGhyZWFkcyI6IjEwIiwiZmV0Y2hfc2l6ZSI6IjEwMDAwIgogICAgfQ==",
"b64_hive_creds_json": "ewogICJjcmVkZW50aWFsX2lkIjogIiIsCiAgImNyZWRlbnRpYWxfdHlwZV9pZCI6ICIiLAogICJ0b2tlbiI6ICJjNjk1MDU4MmExMmI1NThhYjY0OGNkYjcyMDA4MTczYjJlODQyOGZiNTVkYWFkNzQwMTUyMjU2OTFlZWM3OGVlN2I1YzRlMzQzMTJkZWQ3MGFlNWU3ZWU0ODNiN2Q3ZWEwYzIzZTI0ZTQ1OGVkMWY1NGRhM2NjZDdkYmNmZTg3MGE2MWU1YzljNTA4N2U3ZmI2ZGMxNmI2ZjhmNWU0YmVkYTU2OTI0ZTg4NDllYjUzOWE2M2I2ZjM4YzMxODBmODY5N2RjMWNmYTYxMTIzMzEwMTk0NjRiNWI2MGI5NzliOTM2YmY1MTcxYTk5NjJjMWNhNTRmOGVjODQyMDY3YTg0OGI5MjNjNjlkMjk5YzZiNzUyNGMwOTU0MjkzMDQwMzA5YTFmOGZkMzlmNzgyZDFiZDg2NDNmMzJhNjVmYTM1NzA1NmViZGYwZDU0OWUyMGYwZjFhMDU2ZTgxMjYzODIzOTZjOWZkNTRjM2FhZTlkODI4YzZmNTVlNzNhMmM2NDU5YTAyZDU1MjRlYTIzNGMyMGQ5ZWVmNDZkMTVmZWRiYTViZjk1ZTZiYjgzMGZhY2RjYWFlMTcwNmZjYTYxODBiZGIwMDM1YTkzZTI0ZDU3NTRmN2QyZjhjMzM1OGJiYWJhZTg5ZGIzMjliZjM2M2RmMGMxNDhjNTlhYWVlZjRjZGZmYmQ4NzkwOTAzMDU0ZDZiNTRhYmYyZjkzNTdlZGEwZTRmZjMxYWIwNzE3ZWQ0ZmJiYzFmNTQ2OTU4NDQ0YTljMTUzMGRiMTk4Mzk0NWNhMWY4ODk3MGVlN2NlMGIwNzc1ODUxMGE4ZDFiMmM3MDQ1ZjdlMGM0MTIyMTI0NGQ4NzUxOGJmYjExOWYwYzBiMmEyMTJkNTc2NTdjZDQzYWY1YWJjNDRkOTk1NzU5MTkxMWJkZWFmNjI3OWQ0M2ExOTcyMTM4ODUyZDNkZWI4MWUwMThjZmQyYmVjNDEyMGIxYWVmMjRkNTZlMzFjMmNhZTZhN2M4OGJkMTM5YjQ0MDMwMTU2NzJlNmI4ZDUzZjI4ZDIzM2ZiMDZkYzVkZjY3ZWI2NTE5ZTllNDRlZDkwZTRiYmZiOGI1NzZjOWFmYTdkZGZhYjE3YWYyMTliZjgxMzVkZTFmOGU2ZmEzZmY0NmUxYWFjOTY5YWZjMWY0YzU2MjVkMGM2MDc1NGZjMWJiYzM0YWQ2M2U1OGE0ZjdiZTk3NTY2ZjQxMzlhOWE0YmJmMGJiMTNkYTliMTM0NDAxOWVlZjA4M2JiMDU1YTJmZTEwZmZmYzczOWEyOWFkYmJkYTMzM2I4NGVkZGU4NmI1Yjc2NDI5N2QxOWYwYzE3Njg5OTY3ZGUwMjJhMWRiOWQxNGNhYTdjODAxOGI1MmM4YmU2ZjMxMDcxNzM4YzljNTcxMWM5MjQyMjkxMjRkYjYyMDExMWVmZTYxY2RlOTVkOWZmZGQwNDQwNTc5NjU3NjVjNGEwMzFlNmZiMmFhYWE5ZWY3ZTE3NTBjNzU2YmVhMmExY2EzOGRhNWI2ZDIyMzExMzdiMGQzZGY5NDQ1ODQ3YTQzZWJhMzdhNjdhMDIyOSIsCiAgImNyZWRlbnRpYWxfZW5kcG9pbnRfdXJsIjogImh0dHA6Ly9kZXYtZGhhLmh1bWFuYS5jb206ODg4OS9maXJlc2hvdHMvY3JlZGVudGlhbHNGZXRjaFdlYlNlcnZpY2UiCn0=",
"batch_id":17000625866627691,
"process_id" :17000625869931891,
"rest_url": "",
"b64_external_jars_map" : ""
}
""2023-11-15 15:37:03.598 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : 

import scala.util.{Try, Failure, Success}
import org.apache.log4j.{Level, Logger, LogManager}
import com.modak.common._
import com.modak.common.authenticateCredentials._
import com.modak.common.advanceTableOptions._
import com.modak.common.token._
import com.modak.common.token.Token._
import com.modak.checkpoint._
import com.modak.utils._
import io.circe.generic.auto._
import io.circe.syntax._
import org.apache.spark.sql._
import org.apache.spark.sql.functions._
import org.apache.spark.storage._
import org.apache.spark.sql.SaveMode
import com.modak.partitionUtils.HashPartitionJDBCUtils
import scala.collection.JavaConverters._
import java.util
import com.github.music.of.the.ainur.almaren.builder.Core.Implicit
import com.github.music.of.the.ainur.almaren.Almaren
import com.modak.common.curation._
    val logger = LogManager.getLogger("com.Artifact")
    logger.setLevel(Level.INFO)
    val almaren = Almaren("nabu-sparkbot-ingestion")
    val spark = almaren.spark.getOrCreate()
    spark.conf.set("spark.driver.nabu_credentials", "rO0ABXVyAAJbQqzzF/gGCFTgAgAAeHAAAAEAFBBvYZ7Mim3fI+Np05VO+EHuf5PxldceVzCwdbLhn99OYytVbAynQS5Ral29GY9WQevohqFq0pptfWmC6Hdze1ChYqC3VXBhBj3fvqRQZTXN3/gYsSGTxp+834hmfUfQbU0RQ7RnV0wV7zyS1QELwx0d2MbPVdCF1bxRqXdtOn1A4aNwc7Ia7/cZJEKIjKPAUohAvgCyjsGHSbHQx98WKhSwSU60Sa2dauo11GJkO6jT0fdAUjMDuRgiri0JjVTof4u/gV/qzwHpGu/AH/Q/dG8vOv1Stjm43HFpaHjBb2lqw0+JUBuIAqO1SbZmHe1FSy4p09C5Z0pkxSxmLBMQXXVxAH4AAAAAA5D7uBN32zcbCqrcmzijqQfhpAWVqmvEcLxsLpAXN0MnSpwYDURX1Bzr/vmU9PmJjV114yRnCLXxwgtmVebwcXQpDixTHpTKVjL/CtOTvSkauTybzdVq1nm6iSti+tUV5IX7blC5I+JVJZcJyd6c83OK54FmVswIUe6LEaVCSaMlYzQNpKT7IKYurmTruiz7hrCJ9ZdIk+fUYt2inQ9BMkqscwFr97n+VE9s/5MPmsbtG7JCzBniT5ePLh9BIr6dWLfZjG+MKsijpwhUINj3sG/IbsCtqQuNLGxFV6nZObarxX/8NiFDOwXitmggN2ZBe0ggcLzMHBDILWwaxnGsByVdmKFxN5DozkOUQM1FX0euvznFtk/Vd7mu6sTeISNvvpempQuPOLzUew2SfynpCR8gqBp0N4E7JYBYpfeuk4wDcX7y6q7xb+p/Ir2i90Y+AJxMfcXIH7bDQ8H24cSg2pvx1mIZU9btojRD00BaME1dgJOOI42T1jALDSOWIUSxS84qQ1blakpHAKfp4OFgT6XNQNN1mteDjRcLlLxkTP2azXBeWL3/1Ix9/2WLHgbeP4rQG27yM6n+YYQU2OTqKr8nJ7HPbwfY3tiagpKX7VpRnoTq/he0Db7UxxzVEN12/Pj8fJUjLXTAfoworuhlYo0AaSYMMt2lIr9gB2FRiH1+RELLTrt/0tGUjMaOLWL6WU8IZj749J9MUYQ6dTnmQHwUKWsaImYLZIPp5HDwC/8etfQBMqqYUfn8Mm/McmjKX7AHB48J4X9BBW4n42bLVwBwBxoIzRoQOVAK95be5uR7X9PQ7mqGpjK6KTWPgSj34dg94SCzm40mhvwW0d+KatJ3Bl/mXsYXzDK6k7vqIQuuYlm8IVvlScQZSrXMJkQK3kVYlZMnpEM47cgs5s/AtFNRgD3tIRl28PZBvAoU2RdxpEGJCp97LugjtPmQVwPqHtxZQ2eBAWvcT7prIgNQJgKLvMWSb0S42rDhrEaV3vRYjxxZh2a8odrvFve7mNJjYRvscpOOljnliNBnVW703kNQVjIlNiOu6WezpphGFNzd434k1Fom9cQub82hQgHeGssWwjEmL4lCCtT4rRHxouyik36/v4js9JSVh4RlgXvGR2daW7KTzqW/GquJUbJjVarT2iljzwahdM08Mbj9T1uxcDycIuEskdEp6pmFVTMgzRYNjAZbWMGnhdKRWYozgis=")
    spark.conf.set("spark.driver.nabu_privateKey", "/dbfs/tmp/dev/nabu/17000625869931891/0/privateKey")
    spark.conf.set("spark.driver.nabu_inputjson", "ewoicHJvY2Vzc0lkIjoxNzAwMDYyNTg2OTkzMTg5MSwKImRhdGFwbGFjZUlkIjo0MiwKInRhYmxlSWQiOjM3MjM0LAoiZGF0YW1vdmVtZW50SWQiOjI2MSwKImpvYlNjaGVkdWxlZFVzZXJJZCI6Ik1hbmFzd2luaSBDaGludGhhbGFwdWRpIiwKImpvYlNjaGVkdWxlSWQiOjE1NjcsCiJiYXRjaElkIjoxNzAwMDYyNTg2NjYyNzY5MSwKImxhc3RSdW5UaW1lc3RhbXAiOiIyMDIzLTExLTA3IDEyOjQyOjAwLjg2MzY1IiwKInJldHJ5TnVtIjogIjAiCn0=")
    val inputJson = Token.parsedInputJson
    val datamovementId = inputJson.datamovementId
    val jobScheduleId = inputJson.jobScheduleId
    val jobScheduledUserId = inputJson.jobScheduledUserId
    val batchId = inputJson.batchId
    val processId = inputJson.processId
    val lastRunTimestamp = inputJson.lastRunTimestamp
    val pipelineName = "ss_compass_adb_validation"
    val pipelineRunTimestamp = "2023-11-15 15:36:32.112299"
    val pipelinesourceschemaname = "acuity-develop"
    val pipelinesourcdatabasename = "development-db"
    val pipelinesourcedatabasenamelowercase = "development-db"
    val pipelinesourceschemanamelowercase = "acuity-develop"
    val pipelinesourceschemanameuppercase = "ACUITY-DEVELOP"
    val pipelinesourcedatabasenameuppercase = "DEVELOPMENT-DB"


    val checkpoint = Checkpoint(inputJson.processId, inputJson.dataplaceId, None, None, Some(inputJson.datamovementId))
    checkpoint.startDataMovement(inputJson.tableId)
    val systemVarMap: util.HashMap[String, AnyRef] = new util.HashMap[String,AnyRef]
    systemVarMap.put("pipeline_id",datamovementId.toString)
    systemVarMap.put("pipeline_name",pipelineName)
    systemVarMap.put("pipeline_lastrun_ts",lastRunTimestamp)
    systemVarMap.put("pipeline_start_ts",pipelineRunTimestamp)
    systemVarMap.put("pipeline_run_id",batchId.toString)
    systemVarMap.put("source_schema_name",pipelinesourceschemaname)
    systemVarMap.put("source_database_name",pipelinesourcdatabasename)
    systemVarMap.put("source_database_name_lowercase",pipelinesourcedatabasenamelowercase)
    systemVarMap.put("source_schema_name_lowercase",pipelinesourceschemanamelowercase)
    systemVarMap.put("source_schema_name_uppercase",pipelinesourceschemanameuppercase)
    systemVarMap.put("source_database_name_uppercase",pipelinesourcedatabasenameuppercase)


    CurationJavaUtils.populateDateVariables(systemVarMap)
  Try {

    val localVarMap : util.HashMap[String, AnyRef] = new util.HashMap[String,AnyRef]
          Util.setUpSparkConfiguration(s"fs.azure.account.key.${AzureGen2.target("rO0ABXVyAAJbQqzzF/gGCFTgAgAAeHAAAAEAFBBvYZ7Mim3fI+Np05VO+EHuf5PxldceVzCwdbLhn99OYytVbAynQS5Ral29GY9WQevohqFq0pptfWmC6Hdze1ChYqC3VXBhBj3fvqRQZTXN3/gYsSGTxp+834hmfUfQbU0RQ7RnV0wV7zyS1QELwx0d2MbPVdCF1bxRqXdtOn1A4aNwc7Ia7/cZJEKIjKPAUohAvgCyjsGHSbHQx98WKhSwSU60Sa2dauo11GJkO6jT0fdAUjMDuRgiri0JjVTof4u/gV/qzwHpGu/AH/Q/dG8vOv1Stjm43HFpaHjBb2lqw0+JUBuIAqO1SbZmHe1FSy4p09C5Z0pkxSxmLBMQXXVxAH4AAAAAA5D7uBN32zcbCqrcmzijqQfhpAWVqmvEcLxsLpAXN0MnSpwYDURX1Bzr/vmU9PmJjV114yRnCLXxwgtmVebwcXQpDixTHpTKVjL/CtOTvSkauTybzdVq1nm6iSti+tUV5IX7blC5I+JVJZcJyd6c83OK54FmVswIUe6LEaVCSaMlYzQNpKT7IKYurmTruiz7hrCJ9ZdIk+fUYt2inQ9BMkqscwFr97n+VE9s/5MPmsbtG7JCzBniT5ePLh9BIr6dWLfZjG+MKsijpwhUINj3sG/IbsCtqQuNLGxFV6nZObarxX/8NiFDOwXitmggN2ZBe0ggcLzMHBDILWwaxnGsByVdmKFxN5DozkOUQM1FX0euvznFtk/Vd7mu6sTeISNvvpempQuPOLzUew2SfynpCR8gqBp0N4E7JYBYpfeuk4wDcX7y6q7xb+p/Ir2i90Y+AJxMfcXIH7bDQ8H24cSg2pvx1mIZU9btojRD00BaME1dgJOOI42T1jALDSOWIUSxS84qQ1blakpHAKfp4OFgT6XNQNN1mteDjRcLlLxkTP2azXBeWL3/1Ix9/2WLHgbeP4rQG27yM6n+YYQU2OTqKr8nJ7HPbwfY3tiagpKX7VpRnoTq/he0Db7UxxzVEN12/Pj8fJUjLXTAfoworuhlYo0AaSYMMt2lIr9gB2FRiH1+RELLTrt/0tGUjMaOLWL6WU8IZj749J9MUYQ6dTnmQHwUKWsaImYLZIPp5HDwC/8etfQBMqqYUfn8Mm/McmjKX7AHB48J4X9BBW4n42bLVwBwBxoIzRoQOVAK95be5uR7X9PQ7mqGpjK6KTWPgSj34dg94SCzm40mhvwW0d+KatJ3Bl/mXsYXzDK6k7vqIQuuYlm8IVvlScQZSrXMJkQK3kVYlZMnpEM47cgs5s/AtFNRgD3tIRl28PZBvAoU2RdxpEGJCp97LugjtPmQVwPqHtxZQ2eBAWvcT7prIgNQJgKLvMWSb0S42rDhrEaV3vRYjxxZh2a8odrvFve7mNJjYRvscpOOljnliNBnVW703kNQVjIlNiOu6WezpphGFNzd434k1Fom9cQub82hQgHeGssWwjEmL4lCCtT4rRHxouyik36/v4js9JSVh4RlgXvGR2daW7KTzqW/GquJUbJjVarT2iljzwahdM08Mbj9T1uxcDycIuEskdEp6pmFVTMgzRYNjAZbWMGnhdKRWYozgis=","/dbfs/tmp/dev/nabu/17000625869931891/0/privateKey").accountname}.dfs.core.windows.net", AzureGen2.target("rO0ABXVyAAJbQqzzF/gGCFTgAgAAeHAAAAEAFBBvYZ7Mim3fI+Np05VO+EHuf5PxldceVzCwdbLhn99OYytVbAynQS5Ral29GY9WQevohqFq0pptfWmC6Hdze1ChYqC3VXBhBj3fvqRQZTXN3/gYsSGTxp+834hmfUfQbU0RQ7RnV0wV7zyS1QELwx0d2MbPVdCF1bxRqXdtOn1A4aNwc7Ia7/cZJEKIjKPAUohAvgCyjsGHSbHQx98WKhSwSU60Sa2dauo11GJkO6jT0fdAUjMDuRgiri0JjVTof4u/gV/qzwHpGu/AH/Q/dG8vOv1Stjm43HFpaHjBb2lqw0+JUBuIAqO1SbZmHe1FSy4p09C5Z0pkxSxmLBMQXXVxAH4AAAAAA5D7uBN32zcbCqrcmzijqQfhpAWVqmvEcLxsLpAXN0MnSpwYDURX1Bzr/vmU9PmJjV114yRnCLXxwgtmVebwcXQpDixTHpTKVjL/CtOTvSkauTybzdVq1nm6iSti+tUV5IX7blC5I+JVJZcJyd6c83OK54FmVswIUe6LEaVCSaMlYzQNpKT7IKYurmTruiz7hrCJ9ZdIk+fUYt2inQ9BMkqscwFr97n+VE9s/5MPmsbtG7JCzBniT5ePLh9BIr6dWLfZjG+MKsijpwhUINj3sG/IbsCtqQuNLGxFV6nZObarxX/8NiFDOwXitmggN2ZBe0ggcLzMHBDILWwaxnGsByVdmKFxN5DozkOUQM1FX0euvznFtk/Vd7mu6sTeISNvvpempQuPOLzUew2SfynpCR8gqBp0N4E7JYBYpfeuk4wDcX7y6q7xb+p/Ir2i90Y+AJxMfcXIH7bDQ8H24cSg2pvx1mIZU9btojRD00BaME1dgJOOI42T1jALDSOWIUSxS84qQ1blakpHAKfp4OFgT6XNQNN1mteDjRcLlLxkTP2azXBeWL3/1Ix9/2WLHgbeP4rQG27yM6n+YYQU2OTqKr8nJ7HPbwfY3tiagpKX7VpRnoTq/he0Db7UxxzVEN12/Pj8fJUjLXTAfoworuhlYo0AaSYMMt2lIr9gB2FRiH1+RELLTrt/0tGUjMaOLWL6WU8IZj749J9MUYQ6dTnmQHwUKWsaImYLZIPp5HDwC/8etfQBMqqYUfn8Mm/McmjKX7AHB48J4X9BBW4n42bLVwBwBxoIzRoQOVAK95be5uR7X9PQ7mqGpjK6KTWPgSj34dg94SCzm40mhvwW0d+KatJ3Bl/mXsYXzDK6k7vqIQuuYlm8IVvlScQZSrXMJkQK3kVYlZMnpEM47cgs5s/AtFNRgD3tIRl28PZBvAoU2RdxpEGJCp97LugjtPmQVwPqHtxZQ2eBAWvcT7prIgNQJgKLvMWSb0S42rDhrEaV3vRYjxxZh2a8odrvFve7mNJjYRvscpOOljnliNBnVW703kNQVjIlNiOu6WezpphGFNzd434k1Fom9cQub82hQgHeGssWwjEmL4lCCtT4rRHxouyik36/v4js9JSVh4RlgXvGR2daW7KTzqW/GquJUbJjVarT2iljzwahdM08Mbj9T1uxcDycIuEskdEp6pmFVTMgzRYNjAZbWMGnhdKRWYozgis=","/dbfs/tmp/dev/nabu/17000625869931891/0/privateKey").accountkey)

    val targetPathStatus = CurationUtils.getOutputPathStatus(spark,"abfss://dataproc@idea15pisplznonprodsa2.dfs.core.windows.net/261/42/development-db/acuity-develop/aaaa.parquet")
    val sourceDf = almaren.builder
                    .sourceJdbc("jdbc:sqlserver://hyp-acu-development-5de0.database.windows.net:1433;database=development-db;sslProtocol=TLSv1.2;encrypt=true","com.microsoft.sqlserver.jdbc.SQLServerDriver",
                    CurationJavaUtils.replaceSystemVariables("""SELECT
            |  
"entity_id" as "entity_id"
 ,
        |  
"entity_type" as "entity_type"
 
            | from "acuity-develop".[aaaa] """,systemVarMap,localVarMap,"DB").stripMargin,
                    Some(Ldap.source("rO0ABXVyAAJbQqzzF/gGCFTgAgAAeHAAAAEAFBBvYZ7Mim3fI+Np05VO+EHuf5PxldceVzCwdbLhn99OYytVbAynQS5Ral29GY9WQevohqFq0pptfWmC6Hdze1ChYqC3VXBhBj3fvqRQZTXN3/gYsSGTxp+834hmfUfQbU0RQ7RnV0wV7zyS1QELwx0d2MbPVdCF1bxRqXdtOn1A4aNwc7Ia7/cZJEKIjKPAUohAvgCyjsGHSbHQx98WKhSwSU60Sa2dauo11GJkO6jT0fdAUjMDuRgiri0JjVTof4u/gV/qzwHpGu/AH/Q/dG8vOv1Stjm43HFpaHjBb2lqw0+JUBuIAqO1SbZmHe1FSy4p09C5Z0pkxSxmLBMQXXVxAH4AAAAAA5D7uBN32zcbCqrcmzijqQfhpAWVqmvEcLxsLpAXN0MnSpwYDURX1Bzr/vmU9PmJjV114yRnCLXxwgtmVebwcXQpDixTHpTKVjL/CtOTvSkauTybzdVq1nm6iSti+tUV5IX7blC5I+JVJZcJyd6c83OK54FmVswIUe6LEaVCSaMlYzQNpKT7IKYurmTruiz7hrCJ9ZdIk+fUYt2inQ9BMkqscwFr97n+VE9s/5MPmsbtG7JCzBniT5ePLh9BIr6dWLfZjG+MKsijpwhUINj3sG/IbsCtqQuNLGxFV6nZObarxX/8NiFDOwXitmggN2ZBe0ggcLzMHBDILWwaxnGsByVdmKFxN5DozkOUQM1FX0euvznFtk/Vd7mu6sTeISNvvpempQuPOLzUew2SfynpCR8gqBp0N4E7JYBYpfeuk4wDcX7y6q7xb+p/Ir2i90Y+AJxMfcXIH7bDQ8H24cSg2pvx1mIZU9btojRD00BaME1dgJOOI42T1jALDSOWIUSxS84qQ1blakpHAKfp4OFgT6XNQNN1mteDjRcLlLxkTP2azXBeWL3/1Ix9/2WLHgbeP4rQG27yM6n+YYQU2OTqKr8nJ7HPbwfY3tiagpKX7VpRnoTq/he0Db7UxxzVEN12/Pj8fJUjLXTAfoworuhlYo0AaSYMMt2lIr9gB2FRiH1+RELLTrt/0tGUjMaOLWL6WU8IZj749J9MUYQ6dTnmQHwUKWsaImYLZIPp5HDwC/8etfQBMqqYUfn8Mm/McmjKX7AHB48J4X9BBW4n42bLVwBwBxoIzRoQOVAK95be5uR7X9PQ7mqGpjK6KTWPgSj34dg94SCzm40mhvwW0d+KatJ3Bl/mXsYXzDK6k7vqIQuuYlm8IVvlScQZSrXMJkQK3kVYlZMnpEM47cgs5s/AtFNRgD3tIRl28PZBvAoU2RdxpEGJCp97LugjtPmQVwPqHtxZQ2eBAWvcT7prIgNQJgKLvMWSb0S42rDhrEaV3vRYjxxZh2a8odrvFve7mNJjYRvscpOOljnliNBnVW703kNQVjIlNiOu6WezpphGFNzd434k1Fom9cQub82hQgHeGssWwjEmL4lCCtT4rRHxouyik36/v4js9JSVh4RlgXvGR2daW7KTzqW/GquJUbJjVarT2iljzwahdM08Mbj9T1uxcDycIuEskdEp6pmFVTMgzRYNjAZbWMGnhdKRWYozgis=","/dbfs/tmp/dev/nabu/17000625869931891/0/privateKey").username), Some(Ldap.source("rO0ABXVyAAJbQqzzF/gGCFTgAgAAeHAAAAEAFBBvYZ7Mim3fI+Np05VO+EHuf5PxldceVzCwdbLhn99OYytVbAynQS5Ral29GY9WQevohqFq0pptfWmC6Hdze1ChYqC3VXBhBj3fvqRQZTXN3/gYsSGTxp+834hmfUfQbU0RQ7RnV0wV7zyS1QELwx0d2MbPVdCF1bxRqXdtOn1A4aNwc7Ia7/cZJEKIjKPAUohAvgCyjsGHSbHQx98WKhSwSU60Sa2dauo11GJkO6jT0fdAUjMDuRgiri0JjVTof4u/gV/qzwHpGu/AH/Q/dG8vOv1Stjm43HFpaHjBb2lqw0+JUBuIAqO1SbZmHe1FSy4p09C5Z0pkxSxmLBMQXXVxAH4AAAAAA5D7uBN32zcbCqrcmzijqQfhpAWVqmvEcLxsLpAXN0MnSpwYDURX1Bzr/vmU9PmJjV114yRnCLXxwgtmVebwcXQpDixTHpTKVjL/CtOTvSkauTybzdVq1nm6iSti+tUV5IX7blC5I+JVJZcJyd6c83OK54FmVswIUe6LEaVCSaMlYzQNpKT7IKYurmTruiz7hrCJ9ZdIk+fUYt2inQ9BMkqscwFr97n+VE9s/5MPmsbtG7JCzBniT5ePLh9BIr6dWLfZjG+MKsijpwhUINj3sG/IbsCtqQuNLGxFV6nZObarxX/8NiFDOwXitmggN2ZBe0ggcLzMHBDILWwaxnGsByVdmKFxN5DozkOUQM1FX0euvznFtk/Vd7mu6sTeISNvvpempQuPOLzUew2SfynpCR8gqBp0N4E7JYBYpfeuk4wDcX7y6q7xb+p/Ir2i90Y+AJxMfcXIH7bDQ8H24cSg2pvx1mIZU9btojRD00BaME1dgJOOI42T1jALDSOWIUSxS84qQ1blakpHAKfp4OFgT6XNQNN1mteDjRcLlLxkTP2azXBeWL3/1Ix9/2WLHgbeP4rQG27yM6n+YYQU2OTqKr8nJ7HPbwfY3tiagpKX7VpRnoTq/he0Db7UxxzVEN12/Pj8fJUjLXTAfoworuhlYo0AaSYMMt2lIr9gB2FRiH1+RELLTrt/0tGUjMaOLWL6WU8IZj749J9MUYQ6dTnmQHwUKWsaImYLZIPp5HDwC/8etfQBMqqYUfn8Mm/McmjKX7AHB48J4X9BBW4n42bLVwBwBxoIzRoQOVAK95be5uR7X9PQ7mqGpjK6KTWPgSj34dg94SCzm40mhvwW0d+KatJ3Bl/mXsYXzDK6k7vqIQuuYlm8IVvlScQZSrXMJkQK3kVYlZMnpEM47cgs5s/AtFNRgD3tIRl28PZBvAoU2RdxpEGJCp97LugjtPmQVwPqHtxZQ2eBAWvcT7prIgNQJgKLvMWSb0S42rDhrEaV3vRYjxxZh2a8odrvFve7mNJjYRvscpOOljnliNBnVW703kNQVjIlNiOu6WezpphGFNzd434k1Fom9cQub82hQgHeGssWwjEmL4lCCtT4rRHxouyik36/v4js9JSVh4RlgXvGR2daW7KTzqW/GquJUbJjVarT2iljzwahdM08Mbj9T1uxcDycIuEskdEp6pmFVTMgzRYNjAZbWMGnhdKRWYozgis=","/dbfs/tmp/dev/nabu/17000625869931891/0/privateKey").password), Map("fetchsize" -> Constants.DB.fetchSize))
                    .batch.persist(StorageLevel.MEMORY_AND_DISK)
    val cnt = sourceDf.count
    val sourceMetrics = Metrics.collect
          Util.setUpSparkConfiguration(s"fs.azure.account.key.${AzureGen2.target("rO0ABXVyAAJbQqzzF/gGCFTgAgAAeHAAAAEAFBBvYZ7Mim3fI+Np05VO+EHuf5PxldceVzCwdbLhn99OYytVbAynQS5Ral29GY9WQevohqFq0pptfWmC6Hdze1ChYqC3VXBhBj3fvqRQZTXN3/gYsSGTxp+834hmfUfQbU0RQ7RnV0wV7zyS1QELwx0d2MbPVdCF1bxRqXdtOn1A4aNwc7Ia7/cZJEKIjKPAUohAvgCyjsGHSbHQx98WKhSwSU60Sa2dauo11GJkO6jT0fdAUjMDuRgiri0JjVTof4u/gV/qzwHpGu/AH/Q/dG8vOv1Stjm43HFpaHjBb2lqw0+JUBuIAqO1SbZmHe1FSy4p09C5Z0pkxSxmLBMQXXVxAH4AAAAAA5D7uBN32zcbCqrcmzijqQfhpAWVqmvEcLxsLpAXN0MnSpwYDURX1Bzr/vmU9PmJjV114yRnCLXxwgtmVebwcXQpDixTHpTKVjL/CtOTvSkauTybzdVq1nm6iSti+tUV5IX7blC5I+JVJZcJyd6c83OK54FmVswIUe6LEaVCSaMlYzQNpKT7IKYurmTruiz7hrCJ9ZdIk+fUYt2inQ9BMkqscwFr97n+VE9s/5MPmsbtG7JCzBniT5ePLh9BIr6dWLfZjG+MKsijpwhUINj3sG/IbsCtqQuNLGxFV6nZObarxX/8NiFDOwXitmggN2ZBe0ggcLzMHBDILWwaxnGsByVdmKFxN5DozkOUQM1FX0euvznFtk/Vd7mu6sTeISNvvpempQuPOLzUew2SfynpCR8gqBp0N4E7JYBYpfeuk4wDcX7y6q7xb+p/Ir2i90Y+AJxMfcXIH7bDQ8H24cSg2pvx1mIZU9btojRD00BaME1dgJOOI42T1jALDSOWIUSxS84qQ1blakpHAKfp4OFgT6XNQNN1mteDjRcLlLxkTP2azXBeWL3/1Ix9/2WLHgbeP4rQG27yM6n+YYQU2OTqKr8nJ7HPbwfY3tiagpKX7VpRnoTq/he0Db7UxxzVEN12/Pj8fJUjLXTAfoworuhlYo0AaSYMMt2lIr9gB2FRiH1+RELLTrt/0tGUjMaOLWL6WU8IZj749J9MUYQ6dTnmQHwUKWsaImYLZIPp5HDwC/8etfQBMqqYUfn8Mm/McmjKX7AHB48J4X9BBW4n42bLVwBwBxoIzRoQOVAK95be5uR7X9PQ7mqGpjK6KTWPgSj34dg94SCzm40mhvwW0d+KatJ3Bl/mXsYXzDK6k7vqIQuuYlm8IVvlScQZSrXMJkQK3kVYlZMnpEM47cgs5s/AtFNRgD3tIRl28PZBvAoU2RdxpEGJCp97LugjtPmQVwPqHtxZQ2eBAWvcT7prIgNQJgKLvMWSb0S42rDhrEaV3vRYjxxZh2a8odrvFve7mNJjYRvscpOOljnliNBnVW703kNQVjIlNiOu6WezpphGFNzd434k1Fom9cQub82hQgHeGssWwjEmL4lCCtT4rRHxouyik36/v4js9JSVh4RlgXvGR2daW7KTzqW/GquJUbJjVarT2iljzwahdM08Mbj9T1uxcDycIuEskdEp6pmFVTMgzRYNjAZbWMGnhdKRWYozgis=","/dbfs/tmp/dev/nabu/17000625869931891/0/privateKey").accountname}.dfs.core.windows.net", AzureGen2.target("rO0ABXVyAAJbQqzzF/gGCFTgAgAAeHAAAAEAFBBvYZ7Mim3fI+Np05VO+EHuf5PxldceVzCwdbLhn99OYytVbAynQS5Ral29GY9WQevohqFq0pptfWmC6Hdze1ChYqC3VXBhBj3fvqRQZTXN3/gYsSGTxp+834hmfUfQbU0RQ7RnV0wV7zyS1QELwx0d2MbPVdCF1bxRqXdtOn1A4aNwc7Ia7/cZJEKIjKPAUohAvgCyjsGHSbHQx98WKhSwSU60Sa2dauo11GJkO6jT0fdAUjMDuRgiri0JjVTof4u/gV/qzwHpGu/AH/Q/dG8vOv1Stjm43HFpaHjBb2lqw0+JUBuIAqO1SbZmHe1FSy4p09C5Z0pkxSxmLBMQXXVxAH4AAAAAA5D7uBN32zcbCqrcmzijqQfhpAWVqmvEcLxsLpAXN0MnSpwYDURX1Bzr/vmU9PmJjV114yRnCLXxwgtmVebwcXQpDixTHpTKVjL/CtOTvSkauTybzdVq1nm6iSti+tUV5IX7blC5I+JVJZcJyd6c83OK54FmVswIUe6LEaVCSaMlYzQNpKT7IKYurmTruiz7hrCJ9ZdIk+fUYt2inQ9BMkqscwFr97n+VE9s/5MPmsbtG7JCzBniT5ePLh9BIr6dWLfZjG+MKsijpwhUINj3sG/IbsCtqQuNLGxFV6nZObarxX/8NiFDOwXitmggN2ZBe0ggcLzMHBDILWwaxnGsByVdmKFxN5DozkOUQM1FX0euvznFtk/Vd7mu6sTeISNvvpempQuPOLzUew2SfynpCR8gqBp0N4E7JYBYpfeuk4wDcX7y6q7xb+p/Ir2i90Y+AJxMfcXIH7bDQ8H24cSg2pvx1mIZU9btojRD00BaME1dgJOOI42T1jALDSOWIUSxS84qQ1blakpHAKfp4OFgT6XNQNN1mteDjRcLlLxkTP2azXBeWL3/1Ix9/2WLHgbeP4rQG27yM6n+YYQU2OTqKr8nJ7HPbwfY3tiagpKX7VpRnoTq/he0Db7UxxzVEN12/Pj8fJUjLXTAfoworuhlYo0AaSYMMt2lIr9gB2FRiH1+RELLTrt/0tGUjMaOLWL6WU8IZj749J9MUYQ6dTnmQHwUKWsaImYLZIPp5HDwC/8etfQBMqqYUfn8Mm/McmjKX7AHB48J4X9BBW4n42bLVwBwBxoIzRoQOVAK95be5uR7X9PQ7mqGpjK6KTWPgSj34dg94SCzm40mhvwW0d+KatJ3Bl/mXsYXzDK6k7vqIQuuYlm8IVvlScQZSrXMJkQK3kVYlZMnpEM47cgs5s/AtFNRgD3tIRl28PZBvAoU2RdxpEGJCp97LugjtPmQVwPqHtxZQ2eBAWvcT7prIgNQJgKLvMWSb0S42rDhrEaV3vRYjxxZh2a8odrvFve7mNJjYRvscpOOljnliNBnVW703kNQVjIlNiOu6WezpphGFNzd434k1Fom9cQub82hQgHeGssWwjEmL4lCCtT4rRHxouyik36/v4js9JSVh4RlgXvGR2daW7KTzqW/GquJUbJjVarT2iljzwahdM08Mbj9T1uxcDycIuEskdEp6pmFVTMgzRYNjAZbWMGnhdKRWYozgis=","/dbfs/tmp/dev/nabu/17000625869931891/0/privateKey").accountkey)


    almaren.builder
        .sourceDataFrame(sourceDf)
        .alias("SOURCE_INTERMEDIATE_TABLE")
 .sql("""
           SELECT
           | `entity_id` as `entity_id`,
         | `entity_type` as `entity_type`
           from SOURCE_INTERMEDIATE_TABLE

 """.stripMargin)
        .batch.write
        .format("parquet")
        .mode("overwrite")
        .option("parquet.block.size", 64 * 1024 * 1024)
        .option("maxRecordsPerFile", 1000000)
        .option("path","abfss://dataproc@idea15pisplznonprodsa2.dfs.core.windows.net/261/42/development-db/acuity-develop/aaaa.parquet").save()
    val targetMetrics = Metrics.collect
    val metrics = MetricsType(sourceMetrics.bytesRead,sourceMetrics.recordsRead,targetMetrics.bytesWritten,targetMetrics.recordsWritten)
    (metrics,cnt)
  } match {
    case Success(s) =>
        logger.info(s"Success ${inputJson.tableId}")
        checkpoint.endDatamovementWithSuccess(inputJson.tableId, verificationStatus = true, s._1)
        checkpoint.insertDataMovementMetrics(inputJson.tableId, s._1,s._2)
    case Failure(f) =>
        logger.error(s"Failed ${inputJson.tableId}")
        logger.error(s"Error while ingestion", f)
        checkpoint.endDatamovementWithError(inputJson.tableId, f.getLocalizedMessage, verificationStatus = false)
        throw f
  }


""2023-11-15 15:37:03.798 [Thread-2176] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : insert into nabu.pipeline_spark_job_details
(pipeline_id,batch_id,process_id,almaren_code,input_json,additional_info,job_type_id,retry_num,crt_ts)
values (261,17000625866627691,17000625869931891,'H4sIAAAAAAAAAO18SXerurbuD3odCpO93HiNYCMwNnIQKkA9QN7GRmASV5hffydOslaSvfY+59x3G++OkYaHKxBTU7P4vqlitu26InUvZRtvSwtXhe+dVUq6Yub8wYPQWc1cPxP6qNJQw2eqBN7LFA9/xr/uK+ywXTXomgl8kIlzLKzSyHfOH9TnlhTX48LrL9JSutxdt9SftlSgcybge2ssc2Fe4X5j4eNLkTinwiJVfnP2hWXC58k5vf56TmZNT6vGvEgfvawauF6Yl2LnVCDvQQrHyAWulM/nZcPr1+/oWN6cP2eNPpX+9KZmLrRrnAsxrTNxPI/tweczyF6rBmSyOMtEeJRselW+vhRt9O883yisk4b3f/2cllxyi59X+v39x9/2P/f5PrfdSw79+IfrTJDzax+7Yrw/DfcwFi3oQZeN3kMf4dofn/qTix8gm75lFjuXtj4rH00+P2t6kzenKn0E8ozXuFXZHOEdHf/t6xppFg2GsZiev8h5KZvynKVulVmVXrX4mqXhC7wb0GYlQaaPsn6xsQGedYP+D6W4npmFLMnGcWF/p6exbSMf7dpy+JvOFlmKDwzage93+ZKazGKTw+d++CDnkFnomCWjTfZHKV77sqq7CmxmDu1ZEtqG1/BZJ+P/b770+NWGVKf8ysx2zkmluMtuzkWCHY26A1+Dexbw3p9A5tGudgr8T/r8tqox6Iydk/EZvoYxjr/2t4U+HpRYnIuUD7mIzoWVwbiCfhvUFS200aBjIdBNisk5fn/G9l/a+B78v7r7xGjnu8ftYuZambhuC/BnafHbYm589u0d2F5KosJS8L44LJq7fG7Zkk42aK9mi+6tnePbNefS4sZbzDi8vZ8T5vj0Vi8XM7g2kFUxcyFGmWBf/Dw+82cfdttd0aCdSsxX27DCi5qZXdGALPY47pPdMj5sx3Zg3I6L4NXexjY+6PrdrkbZn8oag56QIZPtu6zv/4MtOA3Yqlaz7e7d3mUQdqoZdexUWcv/zOxQw7iB/nVVBNFuNXvclfWPa8zCjLfajVm3Yyl62NTZRRpqTjRpY6HcWPBFzBD8z11ShzOldY4N6AvFTZKc1uX80eT1jxfCKlPuebzx+xpil9jU2JZ+GOX+xFmzqdykRGQ1cgqNKOZhVcwXDjFrh5tIq2Z6KJnso8CFWCfTgkVW4pMHSdE8R7qPByyEFx7i5jDIVvZMo5yjah3dpq1IMSUmmZSz4yQayKEQkkuNdpy6CaMqKXR2VWZmb1pNI44QDdQk8uMbFWHMGzIne7TboLAXPjGoNeljSiraqj02dIVv072oO5QY+jkxXZeL6SFOZRvb+rk01IJZ4YKlW2eN1CpH2GYmsyKEq6ghlRI/+oipZW78sHIdX2VD4P4Ok4AnEuJcTt1lriUDnzBUMm35btpvWrUoPWWuDLRYmd5FeuVE1VMr4uDnjWFERuXDmC/yOtxFTd+r4fEl0XymmHZL9qMHefKCVTpikm4ouUZzPcf8cC3904TZ1Yl6IWa8gvGu3GRO3Ndx9UwyV2ZcT4ao7fZZjfuywadNA33kqMkD6Lcp+yKVKDP6SWn015iD7j3zzGzXFoxwprd93Ha3lS1PnOq4YN0z33s9DnRS1DgSQWVLm5x4w3fKwhlLXS9PK5YELktM+Uxn07nypkxp/JKlnG1E+CAR2INwTrjRVPn1i0JcYKYzbIXHeODh0uhEort90uoaN9EkMqYrsAS/4HJQhuaSyogIJGITV1T0cqPRuvRODMZ1JVJ+Kzi5QSx7wFZ1i42DIxoS5rdTw7k2okafGdUzKk494BCbtAsHW5MXXjOnvP0wKXdPpRUaZFDL2O5mRaMZFjym/taJa33DDUmpL/O8Ll8oO0Hs667KqjjEj+fIxsHK0LvSwAbo16R1H2w8iOSNk1MrrMq2ylZDtc6Z9KitMoihJ8Ar60h3M0ldiG842tTmIq5JSJGys7Q6ExvPNlzWBTv5G29iEn/6kBtTzpjRE729ypRbm8bxlX+88Ca2i5RZpUl0wvEaot1VQtxmKchv9A9ccDvSuNkI5xqbi4m00aycu2vsMTvReiZSt4H2XnCgvMzc2hsqe2xXu6X9eEnSBdh1fRXJyU3aCssGZwnb2llNyNrb3rCPqRzCq2q3fcF0DrayU/70mdXxNfLCijLWS18tqTEN8Txkkehc6hFKTRVyjids2ILOvD5r+grwCMSlU1POyRNpFMO6WjPmrCNhGpKRZ9bgqPD6SW6SOGrQA8QPzY3rsBpQuJnXl0irKPHVTvJHo9QoiPbKoVSelyY4JWc3apI+sReToj7YCXLBbqWMIHZDPrkm0G/euknRTFmZTA8wLl62V3wTVA+85uuILi7MP0xk3fG87jPuoaawFeQ0fiiQvkQeqpipMU3jW+Hp21qoWVTLJGfbfmmGiHo9g/x3iQKIFhAzMjaNQHaLm2yS8O4ZD7GT7DUGWyVga6xoTJIEiiemGjKmT4L1ecLdK2aVp4zosva5ATFxRlPUC86bYl/hIpnizDKfx77ErJrhebXEaLTfMMX+BHwgjHirZsoIJ4WhH1gzJdSUbjLUZtYwU/GFLeY6hhh7Kpm65vXRSkySMl/RfB8Z0i8djPB8M8Yt3zyoVqUQd18SCxnJHs+K2fQkAixF0HnJIF8gW/QJ+IPi+ljQKuStPDILE6HxTXjmMjfRKrJOQog+p2CbhBkGtnBbDnyAeGmQ2kmkEQ/Kg5gzX0wY6maqRhdOw0QGFVw/+uqjg43elFZnMN8k0L+4ZJWxQR2JGj6LubIyM7bLIAyl4ZCkUSsaSMxNvItQZERt6OVBiDKeDUqHMm+riWi2t4xWF8i3Fmmlxpa5TppOslYOme0+Uat/Lpq+o3V45pD9ozl+oRqJvNZH2ugnRWUq0w5idBVAHx7kHLKdf+xJMz2tBSaAnyZRUxFpVBr8fOC2eibCjLDfz2ObMByESRJUF5XqLh8ia2VnRt5GTqKxyOckKXyVqVolY07ig1rxoOv5bRqUKV9yEY45qCp1fAOc+Qz5p8p9gqN5hbPm4PA5Mjc+9jYCh4oBhrMIKufyWjApuGe2G9ABbTpXNGFKmTrDvSumlSzsDrBfNF3s3rHSG54ecVeT3bHVcha+45caOIE1Yq47ZuLT6/g9SyE+WdxZAE9b7IC7NHJYQQ4pZ9NaptnlFV/96PHwCHkuu2G6tda0HiK6daLkx3Vlu7c8lSMHW8m0/om33vERYMsz4NxBpvFh8Y73GzLeM+JFwI2hmVr6XAaAwVuQe7c4LmahVta0y4xqqXR945AvI79/SUR32XjOQ5wqTJB2KGCnqJ6y3O4w90vIF9gGDHFiTVUTQ0I8VH6uO174pzBvflyp0OP/Z/hfFml1BO8iOZs+U4pxXhtX6qFLzruA7F3JB+AXvikU6gD5uBTwU0etLoxqkyrjFAJ2tsBH1nmDAt6cam5XRwEMdKO7LKm7PDZqKxHHPvfDE2m7GnCEmXE8Iz4KioDXxKoOo3zKAl9u3TBP1WrE+ID7wF67ipjyRSI1KRBOmdBPec16+H0P+axLGg0QNXzOGD/mgJkKu1pvamRTRuSGOQxi/zrXoJ+2k5i9ywvPG3DC4HkQ0MBGgd/Ad5Avi8f2GVzPSLipe0bSKuKeNySMoA3oh6Xj86F9vwN9mw+Cojd5nWXhk0Wy56zQ0hjHR4I80N682D9+sMs7hgcu4prK6wbA5dunxGVvHHq0iUEKEn74/+N9NdhoBVwauIGpi5aEcgZt+682k9xtxvnrNY8fcL/fXTKNR35dK9HrRMTj8z/Kc86b6Q7i4AHkMAuf/+P9EnGw5/B3cjwXVkhHbisDDryRcPDBGzzvY392IOs+93Q98hDg+lfgi8vSGmsSI9/Chy/Xg59O7/WX38kNMfQCPGAoDV1/5mhoUCg0Cw08SEBE8hH49F/kPQIfNljLz9zXJ3iGkYENfmyn9DXglh44FV/Df3qUGfx4SC24H3h8aeM/M0F2qQ2y+nochzvv+ps2EiUcBvx15GdVkT5Cfx530f7xFt2MPkqMHiePPaaHAe8PQ7Sb9JDjbxBv/q69obD5bez/qPPizkPfZBz5ptDGJjEhjkkNnPW62H7kgm5X+uA/Y63EmpqAxe82lDUIbNEBW2J32eSdk/aX0h/tKj5Jf/GvZPnSDj8CJtHQflVa/+02P/UP+mKD/e1h7P67fYX30dbNCuI7jDuHvDg+B2ROwEZmoRubPOSoPhGPC8L6JzZbfLLJPHXhOfoMNgM5MdyDrYPtot0o09+06REuAXNNY8r4ms9ML94tlrOPcvqjTPil9Kdg43dbn3+siS0/2+5Hvzj+Lh6Ufl+B7sBPr1vaQB5Kfr0za3qSSfXJl6SPRvu/AJ8/jbVEaLd7z2ej/jPrdC0gV6mZM/rTTXn3PuPCBp0L4Pyzz+2N+rjHktmnODhswM9A9wLiHs7Sx4fFmPvGugf4bO6ZVYlOVAUhjH95XHjovOGhltoY9QH6Lrdvtdp7LYsKdBUmcBzgUvLWu0WrEymkeq9dfHnWXUeACX6NH592crY4/qbvIP/0XY7uP2jv1Qd3/a/f2N2f/pM27nEJcPw5tckAbf02Tv3CGhrGgwPvRbdRH6txDMYazS8/+nOMN2VL/lRjTeaDP/w/tTnKZ0Ec3/U/Y/pY72U24BvhtP+yrTdfTO17bjllv9Pdu3+lb9eIf0uX73Hjz9dxBb4Ln+9+mSyOf40vX3w3+YknHdCbBq5flTXY5WzMVXcc9yoTn/6KdW+yp1Z/Uda73//uWf8YH//tfr3Hr9S6t/Hnp5j4L/X3P/NMlbrX/+CZZhm4//Ez/zJ+fPqxnU+2/G5PH+65j8lHOcEml2/Pnv+s777Wtd9r5NfCdgEDoZHfj7h+lK27z5Gk0eGrLd9tHJHbJnH/+BzL+8tYQ3+/bjE//EPcum5j4Tis4U065grf0erm3uc5VnUF/QCelLrFu1+tfsXEVzt9f6HXODryHp669M57jJELyU6O+nzFJofyFjbQz2rT8ptMHMgRMF7jnEtz0ptkUm8M9DDOfRHQX7RzDOh/+8pfwqfIQzOBpBMztMw06jdt568sFcSgLWmgFn7XiTfW+xCKmZzFrZRir3AujEHW9QttH6+Yy6elwRdKZCYLKoi9WAPHmQMX2FG/Oq+pfhKpNngTuhvhEDbwBHDBbc2UXHNFIMdf8gD5JQVsGJCGW+Yc11W9aVgfW5UsWTRwXc1yL3yOLGmVPAR+TzK6jy7S1AMzFNsEjy/reWTkvtlwIUmm2ZVpz2aNI6JACWx3DhsQgdxvb+ZuDbh/x5CsYyPrs7ZKSl7VypueI+YZGXNsYOphRstLZnZLwoBv1ac45vySe8CjDOwAtwsShHcJQpM1rdLEqqgyMcd7l2Y0hJjALxFFQdKcnnDTsciHZ3H+DJzEZI3qyqa+At8X3J82OGDQj+xSpp2dBG6gkqmbzKZkZZFgHcgntUdU+d0Jz/GCtG6V+N0s24fHMi2vS6PjccvDOEVPEcc70ZgLSZHP7Noo549OPPA8CtyXDcKTgvUzylEG4z2J2dZ4reMiF7PYVixcR0P4kFnhvATfKtKuy1tEZFNdY65EKUyLCBxtAhyVHgLdu7jQ+KpM7XEeZhELH8rd1Co4EDbfXOY6A6xLwAecOUXVRFnKgLirs1btBUJX4usJ96or904ir6+X2CZPPJA0t5DJA73bNESUFJ0LKjvwk25pE873PBRztSu8yEyS05IDL82MzpFzuV/P8VMClkAaU5S2CrlgFvWAF9aYZsw8irQjtHVXfK7CxNQQV0wG+a7b7NWhrPFyzbsa+O2L1FyqOWAE7Tlxbb6UEPOUIQGzq/PSlGidRhfgoHGR4p3ySjup8UPcOB2fc828/rBmYVjuZc2NvhFNFywNc1Va+rkM1IEzvc73eCC3aZi1eK4CRBRzImJXgArlWdRTyFnhRMx+TGijfeJNbeFroxCqpfswjxt2lZba06DDiRd6CetTZaFJUashbrUAfr8ibbXGjFw2YHecIxwxmUU+N1XbnUlLXlamrLFlmrjFTDJNaQv+BPGvRMhk3jTaaK7VEFLZAv70cLL2VR+Dj9M9QdjoZKwh/zXczAdiEx9n2K6tkqpJtjtdV4a+RU3tRKh+iVk3oULuhacX2Ao9RqtFtCd7ZpW3MpCTSJih0MzJxvlkHXrR3J3BOKFIkDapp08JjW98jp5j1nvMmKYJ53SDogkGnUUQuzNxukJcWsn20aCGbPlcZlSjNd2jE8RzD9rcU7+PNv6JsXlYbSB+SK6i6PajT9KtsxrClHpVmzU8xkFIAJXZG2ZYxQ7gIkd8rMOU7HRb+84SG1UMdtsIOs6borb0Thk25RVs+8ID75L7DOx5YfO0mmyATdO9d1uZ7vPal0suukgg4spmahd2aOZ+L4vBdTOOJWWmETU92Itu433os0YvouSUQIyKeBAaq8E1iAkxQ6AnilSEteJrT+f5vjTW7OBQziWjYGu+A52sbM5OaWmhsOA6ErWOyzlfkEDNV0OllS8J2HNfcjDwZgJjY1yowCeIaxk20CLex5NkTzKw3xkfyBnPwx1F0o5bNdv403CjwwtjUxGzo4NFqHHKE2xuHYY8u0hRUPrdCtcnxk23ZRbwXZ+0a0pobI9xyz3lAWSswa2XxqlS3mGIm+ul4NUgePVAvKOVD8oqmSYq5bLwjUnCpVUgvGe8o6WuMMRRkgz4hWt9FLUJtskxeNBe2pFZ3qau8uQa4qoX2SRkDeQW5OaQq9zCZDfWkAlcH4CvXsGPIyXUs0IuCCttFqCFCqqc0VDHNUpVgxm23Vsi1JqxrgUKb1GuaAZxHXRyI351G+eHIlsmQnSTDeoOUeNNCovcVC0tSdWJ1t2z4KEF+OpKjekxb5xjzpxZoUd29zjkhkN404WF53TUZha3+ANgoAMx5HrTxEY0kBfw20tB9Z6lfLeehwcm1EIyNZSmsvOan+icHGMDG3xObqyuJoCvnFwcBwwxGPvdsGYd5c3WYE3fikAGbA85iUO8MslDycsLsZGZaL4bcxDEHBY1+pi3nZ2Jqqb0EewjfF7zuFdptSeB3icpR6V1qkn6CPHC9McpBGl3iWDOc8y7HTfMoGiqOjHDVIjpg7T08AR4+X+kBvsB07xycQO4LbTZvK4lUMBhJeBlwECAVePdaua6dyzElC72i5G33uRr7fhGwfdiXYkN5L2kCQnk3Aeym7bEwD73lQuYx5WsuudFwpAf16El+MGmQp8Ae4RLwwGZuaC3E0oC3mDuTgqfAHeQD5BF66zuD8W+dqipHYXkLk71mfEIcj46RnsdCKpTJrhVWFVPWg/wjmtIrU7xIBcy6HTE8EGkaB6ZMosbwDx73KgWJeAHTHiTAbCZLE0c8KC6Loct+Fl1gpzVMBHyCIUEm+GZ712b79XDhkc9g4cre3uVc8Dj2hXSwz7EzwlrUSYD8lTsIf/7aK2syE6EZ68snCc1XyWiWzEPcZDTVY2ab0Q3EKOiWV2RzbyecON0YLainGZXZnk3wOhmMXg9MboXOshnPncbCffntekpHrY5YO7I657Bbi5yT0zoh1jZgEuN6kpsdgE8cmHJtCZDZVE76yHnPxc0HhJPXjNWPcfN4lYEyI5mkPdZaCYM9XRANNPdKfFZTzR2cPB4XbPIFHv3mtsV3fhmBDEP3BXG20ML/Ipj3ZhyD9t8BvjxtmnwLrYRcBPzIRddz4Q8AL5JeQt5pOaQa6uBBq4Lur9S4VDI45Ignog5mm3axUU1Jl9z9zT6UUQ9A3D8OTb6bBOoVvmmkCK0M7MipUe6DSKLEpEV+H60At+lJrGYBfGQE8iDXc1bry8aw8rHefvkZHCemQnf2lnTzzGrXxItl6LBy42IrQzGnhpHE3vyxFtsQ37UuO5RxuWcWQgXSD8w5lwTM7YTdpKA/0+QU8w8Pdh5EM6Tvc6lp1+WluQiHedxHAKxH+c2GjJb+eW+tiEXCkL1sBo4Bkw3QK4OAAPMN3V4znlsSu5G+VzPknRhSchPUnfP5HbCiY0BO7p2jnhIm8NQGuUlEeEAGK+HeLamnpoQnVmF7p6AN982aHtZQywkNXlSZtWB3lppTG6iDnXkqzYz+gfKqhnxdMRtVW18JyiN0OENOSWGnNA99wob7M7khAL2FXMXOKJ8KGpp5LepkHN1UlQO3OchMxxLtcBrU5co7j4BluIyLW/Mkk7RunO2r9qShdfImxiEqqVgoSx98FBxNJRB9oA/Hdx69sZfvEA8g9wddmvqyqWBlhvPbGCswwQwKkHeJJkvjAyQVtS61maOTgnv+FqERmF1CZk/XuMGYUIRSNk9UaM2Ih33eY0iQFpP3NCcgQ2v56AzOtbd0EvpVW5iySv2pr40Y0t4DqH1pC9SoonfJaCnI9jrC0ePwA07iB88pfPoEjE9WSc/boBJF9IKNRtzBitv2NYYN5MXAU7JaQj4G63KfXVO9mrB/NCWuh7GdT/SdlfQb1Gi8FyYpF9ZlY48ssMmn2yCThA26aPdNM73VQM55RnwPouFvChrelOiOgrx4xoLRAUzMWDrI9iLI43FjeiwS+beC6s5UCXIn7MfVwXRAmJGRY0eZJcpp1UomoON53q5ZiYX3ANbI+eCQ942+YrbuEqECZSnC1nwaCYesePbj4lMScPAnssUgYHL89ozTyvD3BcQ16AvbuItjLV3MATYb6xLo9jHN4jdQhkhYJ7qkqRdUpjoiddotaZ8Jyk32V5l4OsE8HNPbPc5GeSKIxVLEz9Dzq7lUBvMwA8Qt66FqCxlllc5O62Apy8jIzyuLDMrTZ1tarLCzdGGuB6CP5hC9CfAdUI1Pc1MlDMbqCfrXhg7DrkpZYE6DLaJKKCpzFIDBg4Sp8SnOmzJHBsJDyG3VDH4ixWLKY90WG8CF0Esnpfz2qYBb/OWxKAzoUy3TwIyERpiNgtdbss9cKJrWesW8PNSGqdI1WbKrMWVDfGtrAnwI+BRe2wxrZ83gJVywNNrf1qXrfRVw+yCOcD3dKJavC+96VPhd+fC12vgRYIP5TWyTmvAWs/JOL/IpibgWL1pIUZ7yqcQ9/DI2wfkF5bhQP/NbL+95Qi1ic+D0sbAcTpUsKtReID4UGyUOlwAJjU3Qr9EQ3ZRe/JcDnrJTHnAKDxKs7KIuRhzUoqNE9u0KF0Zqles4xlgs7GGw0eO53cPwJ8O0jOuYB+7fK9ZlPJJZkA8NrRJUvwiPX7FrXsiGqC2UA+ggzX4aJ5phYnlwL3g1qYGvgWcfjAAeywu0h/rMVOjSB8v49zIyhrX0rFLREEX80cr2rMJBowQDd4EguElmn2du67PmcB7wHSAXcYaTr38OJ/yjmeYj4wcWBncBxj4cbrwMPBadF/bycfaUBCdx+uozY2xDvf5+uptHv26ywTIa0cPq9tr/fM+B2e4HcheRZRf8xRfiwDG1LrPUdQl5PtVQ8aaE8gY6lWruqIhF2VH56LhwFsWFuA4A2LCz/mb1/kEs8520yqzeaeC+vRz3mgGv0GSXrVuVbbIHDHcl3WOr/VHRpovax1/rit91c/vX6v3+i7rAItGh0Vzf38Y1/aO85njesf17sclD/R1JdBefZh3epXbMCVwvFXzq678tc/rvQe4PfrjV62STX8zL/YH2PORgX6VP90X1nXKvZ6qvXeO9iddNPi2SV3jKR3XmDGwpfBtDbbeg96HwpIG9KUvAqzB98b1Bs9ga/uVHtPI22/1+1qExfGfdBL/rB86ywyw9ru9lA2/Qq4BPPuhVt7oCjCILm/b3WIXUuCnKDbj5dc2/4TXbBeO89UwvvrPXMS7hY+Gcf3Dx99Ark+yfb0PXleZLLZZGm0XzX3tKeCqqQG60eM84F/6FVy3sg0vRfIItowB4xBnJYiGcT0W9uNupU93+0rh/wXo5S/zF19qu6D3cS6vG9dxQ98B943+ps+rtzn0377QuM6YHahPxnmFt3o3+66xftdYv2us3zXW7xrrd431u8b6XWP9/7nGao5Y+G29xPEbz3zjmW88841nvvHMN575xjPfeOZ/IZ65ZqC5cQ5CzgDPjOuQZ9sdxCEjs6ohTzu92D2ennbuuP99XP98VkF0Jt7i/HYNHa9Zvq8d/f3rnDUIrt2ex7XhELMHNYOc7k9v4/7x9/3flHFMzVCmBloTNPUSjlef6ps+PqtxL8OHOuc4tz3Od39aR/+2HpIKPtal9q81X1OPa5ozOxr3Jh0LyArqS52Kv65THGRKeIle9yzF4z6mRre/9sRXw2LUefO6VhDe99CeWbTxObe4s9qRP+K0g+dDxhWT26oFXNio173j3/vBv/eDf+8H/94P/r0f/Hs/+Pd+8O/94P/j+8Gvu5VFdrKNLso3r/BZq930vtd6NXigi8cr3i/M9Txz1jTq1/O6Xw2Pl/J+ls2472OcQ190vzANue8j+TNxamhzxE3jvgk7F04N/gUYyAFcsxj3qn3vm/iugX3XwL5rYN81sO8a2HcN7LsG9r+tBvZz38RYw/mwV/bn+YOrBnxL9ND+4mOd6/xeayLjejYmbyNeWn6oT73Xr15fznhWRjWuD2MjX6wxSg295h5PKOMQbxGw+ymLWRiR5H5m4v1czeVssXs/1+HDOirgLZAVvq61Cq7bzP+5FqyT/uN9fdiX3z6veft8z339WAZ9L2/u9n62akqc1CYOxPG/rCl7XU/mAmfkSWzwP4FzQx9CTBgJY05QahI3rnt03yO8W+y+rhX7op/X/fQzx4ZrDPn5P+B04Sm748q/rn98u2Y8A1QvZ+F4nsFN2YBrffb1GsC7r/uBP7RzBo57yawjjKd+GPevL+aZsZgdthF9vOHZ4/Ni7l2jfdx97P+qeTs7djyPUqAJa/i4zrMuTVeXtewKf1yb+NiPuHt8/ZMcyt+O6xir0ZbL4XBZve7Nv591Efu6lsLrcep2pe0eN5AXita9QV+HjC7+aY/PJdpngPHj250L3Nf5ufdzHlaCAFf46/kh8FuVCe88rnkFzjLi+3F9X6Uadvi81vStrvmrrjqeU4FlOu7Vxnd5Cr/Xmf3pTJvT+//3M0Tf67PmaFvs8Ne6rbPbpESXZqgzER9/8/9NirHfZADdV3LWv3EP8kGO0AE/Bx4HthAQXex+c00L7Y/cJsDpaHdw/U+7XPo/+3fMLMe4/x4YWxjvsZ693VzfzwkZzz34dWbyMog66OP/+Wgv7+enrsa9782PcT/6z+sXM/LHpzOBWnJfS5oI8us8pfvL/XxeMMQm+XoeyenneSTofubsL1k+n5FivJ57rOvVzB3Ps+0k6PJtjSvwAGSo9D6W4zkc4znQ41m3/Sfb/XxeyxnkGM9FMl5j4K+zRH6N09+dj3LdjucER0k/PuP268yVuy5/nkW99LN/0CW/gY/cQN87Mp576/P6P9Dlz/NoQf5bYS/GMUElxLRy59q5r49yPHfpw7myoI/mn3QB/a7JlzNVuKWN3HuT8+/Holnd/el1je04pyK98bwkPJ6PDP4mx7Odm9dzryHm6A/r2X3wreB+xsOHmE4O8Dx74WfQX3cK8ff//hed5nmdAFwAAA==','ewoicHJvY2Vzc0lkIjoxNzAwMDYyNTg2OTkzMTg5MSwKImRhdGFwbGFjZUlkIjo0MiwKInRhYmxlSWQiOjM3MjM0LAoiZGF0YW1vdmVtZW50SWQiOjI2MSwKImpvYlNjaGVkdWxlZFVzZXJJZCI6Ik1hbmFzd2luaSBDaGludGhhbGFwdWRpIiwKImpvYlNjaGVkdWxlSWQiOjE1NjcsCiJiYXRjaElkIjoxNzAwMDYyNTg2NjYyNzY5MSwKImxhc3RSdW5UaW1lc3RhbXAiOiIyMDIzLTExLTA3IDEyOjQyOjAwLjg2MzY1IiwKInJldHJ5TnVtIjogIjAiCn0=',null,1,0,current_timestamp)
""2023-11-15 15:37:03.807 [Thread-2176] DEBUG com.modak.bots.DBOpsBot - to execute query timeTakenInMillis : 13953
""2023-11-15 15:37:03.807 [Thread-2176] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id b006ad5b-9517-4ef8-87e2-7c6dea91f146 has finished process logic with message_id af56d8ab-458b-4c73-86bf-553c24550201 and thread_id 2649
""2023-11-15 15:37:03.807 [Thread-2176] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-15 15:37:04.041 [Thread-2176] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "DBOpsBot", "bot_metadata": { "message_id": "6595c16c-9675-4ed2-8674-08d9d8e09b79", "parent_id": "af56d8ab-458b-4c73-86bf-553c24550201", "bot_id": "b006ad5b-9517-4ef8-87e2-7c6dea91f146", "message_topic":"nabu_2_jdbc", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":17000625869931891, "initial_ts":1700062586993, "batch_id":17000625866627691, "batch_name":"Ingestion_20231115", "job_schedule_id":1567, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "2023-11-07 12:42:00.86365", "environment": "modak", "ignore_job_termination" : false, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot", "KoshBot", "DBOpsBot" ],"task_dependency":true}, "task_retry_intervals_secs": [ ], "message_context": "ingestion_deciding" }, "bot_tasks": [ { "task_name": "ingestion_deciding_msg", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "doNothingTemplate" }, "input_data": { "template_execution_type": "single", "query_type":"json", "query_input": { "target_schemadrift_flag" : [ { "nextrun_after_targetdrift" : false } ], "input_json_for_checkpoint_status" : "ewoicHJvY2Vzc0lkIjoxNzAwMDYyNTg2OTkzMTg5MSwKImRhdGFwbGFjZUlkIjo0MiwKInRhYmxlSWQiOjM3MjM0LAoiZGF0YW1vdmVtZW50SWQiOjI2MSwKImpvYlNjaGVkdWxlZFVzZXJJZCI6Ik1hbmFzd2luaSBDaGludGhhbGFwdWRpIiwKImpvYlNjaGVkdWxlSWQiOjE1NjcsCiJiYXRjaElkIjoxNzAwMDYyNTg2NjYyNzY5MSwKImxhc3RSdW5UaW1lc3RhbXAiOiIyMDIzLTExLTA3IDEyOjQyOjAwLjg2MzY1IiwKInJldHJ5TnVtIjogIjAiCn0=", "get_cdc_last_run_table" : [ { "cdc_first" : true, "prev_target_path" : null, "target_path" : "abfss:\/\/dataproc@idea15pisplznonprodsa2.dfs.core.windows.net\/261\/42\/development-db\/acuity-develop\/aaaa.parquet", "relative_path" : "\/261\/42\/development-db\/acuity-develop\/aaaa.parquet" } ], "get_cdc_type" : [ { "cdctype2" : false, "temp_path" : "17000625869931891_aaaa", "cdc_applied" : false, "is_primary" : false } ], "generate_yeedu_metastore_credential" : "ewogICJjcmVkZW50aWFsX2lkIjogIiIsCiAgImNyZWRlbnRpYWxfdHlwZV9pZCI6ICIiLAogICJ0b2tlbiI6ICJjNjk1MDU4MmExMmI1NThhYjY0OGNkYjcyMDA4MTczYjJlODQyOGZiNTVkYWFkNzQwMTUyMjU2OTFlZWM3OGVlN2I1YzRlMzQzMTJkZWQ3MGFlNWU3ZWU0ODNiN2Q3ZWEwYzIzZTI0ZTQ1OGVkMWY1NGRhM2NjZDdkYmNmZTg3MGE2MWU1YzljNTA4N2U3ZmI2ZGMxNmI2ZjhmNWU0YmVkYTU2OTI0ZTg4NDllYjUzOWE2M2I2ZjM4YzMxODBmODY5N2RjMWNmYTYxMTIzMzEwMTk0NjRiNWI2MGI5NzliOTM2YmY1MTcxYTk5NjJjMWNhNTRmOGVjODQyMDY3YTg0OGI5MjNjNjlkMjk5YzZiNzUyNGMwOTU0MjkzMDQwMzA5YTFmOGZkMzlmNzgyZDFiZDg2NDNmMzJhNjVmYTM1NzA1NmViZGYwZDU0OWUyMGYwZjFhMDU2ZTgxMjYzODIzOTZjOWZkNTRjM2FhZTlkODI4YzZmNTVlNzNhMmM2NDU5YTAyZDU1MjRlYTIzNGMyMGQ5ZWVmNDZkMTVmZWRiYTViZjk1ZTZiYjgzMGZhY2RjYWFlMTcwNmZjYTYxODBiZGIwMDM1YTkzZTI0ZDU3NTRmN2QyZjhjMzM1OGJiYWJhZTg5ZGIzMjliZjM2M2RmMGMxNDhjNTlhYWVlZjRjZGZmYmQ4NzkwOTAzMDU0ZDZiNTRhYmYyZjkzNTdlZGEwZTRmZjMxYWIwNzE3ZWQ0ZmJiYzFmNTQ2OTU4NDQ0YTljMTUzMGRiMTk4Mzk0NWNhMWY4ODk3MGVlN2NlMGIwNzc1ODUxMGE4ZDFiMmM3MDQ1ZjdlMGM0MTIyMTI0NGQ4NzUxOGJmYjExOWYwYzBiMmEyMTJkNTc2NTdjZDQzYWY1YWJjNDRkOTk1NzU5MTkxMWJkZWFmNjI3OWQ0M2ExOTcyMTM4ODUyZDNkZWI4MWUwMThjZmQyYmVjNDEyMGIxYWVmMjRkNTZlMzFjMmNhZTZhN2M4OGJkMTM5YjQ0MDMwMTU2NzJlNmI4ZDUzZjI4ZDIzM2ZiMDZkYzVkZjY3ZWI2NTE5ZTllNDRlZDkwZTRiYmZiOGI1NzZjOWFmYTdkZGZhYjE3YWYyMTliZjgxMzVkZTFmOGU2ZmEzZmY0NmUxYWFjOTY5YWZjMWY0YzU2MjVkMGM2MDc1NGZjMWJiYzM0YWQ2M2U1OGE0ZjdiZTk3NTY2ZjQxMzlhOWE0YmJmMGJiMTNkYTliMTM0NDAxOWVlZjA4M2JiMDU1YTJmZTEwZmZmYzczOWEyOWFkYmJkYTMzM2I4NGVkZGU4NmI1Yjc2NDI5N2QxOWYwYzE3Njg5OTY3ZGUwMjJhMWRiOWQxNGNhYTdjODAxOGI1MmM4YmU2ZjMxMDcxNzM4YzljNTcxMWM5MjQyMjkxMjRkYjYyMDExMWVmZTYxY2RlOTVkOWZmZGQwNDQwNTc5NjU3NjVjNGEwMzFlNmZiMmFhYWE5ZWY3ZTE3NTBjNzU2YmVhMmExY2EzOGRhNWI2ZDIyMzExMzdiMGQzZGY5NDQ1ODQ3YTQzZWJhMzdhNjdhMDIyOSIsCiAgImNyZWRlbnRpYWxfZW5kcG9pbnRfdXJsIjogImh0dHA6Ly9kZXYtZGhhLmh1bWFuYS5jb206ODg4OS9maXJlc2hvdHMvY3JlZGVudGlhbHNGZXRjaFdlYlNlcnZpY2UiCn0=", "table_metadata_output" : [ { "is_destination_file" : true, "dataplace_id" : 42, "schema_id" : 453, "schema_name" : "acuity-develop", "table_id" : 37234, "table_timestamp" : "", "table_suffix" : "", "schema_drift_flag" : false, "is_source_filetype" : false, "destination_table_name" : "aaaa", "source_table_name" : "aaaa", "destination_backup_table_name" : "aaaa", "table_name" : "aaaa", "source_url" : null, "source_credential_id" : 37, "source_credential_type_id" : 1, "source_jdbc_driver" : "com.microsoft.sqlserver.jdbc.SQLServerDriver", "source_type" : "sql_server", "estimated_rows" : 4914, "destination_schema_id" : 3, "destination_dataplace_id" : 5, "destination_dataplace_sub_component_id" : 18, "rename_table_condition" : false, "already_ingested" : true, "verification_threshold" : 0.1, "destination_url" : null, "process_id" : 17000625869931891, "batch_id" : 17000625866627691, "batch_name" : "Ingestion_20231115", "data_movement_id" : 261, "where_condition" : "37234", "archive_files_path" : "", "is_archive_data" : false, "is_lazy_mode" : false, "is_record_process_enabled" : true, "file_format" : "", "path" : "", "is_ingestion_root_path" : false, "bucket_name" : null, "project" : null, "filesystem_endpoint" : null, "is_default" : false, "file_system_type" : "abfss", "destination_oracle_jdbc_url" : null, "oracle_jdbc_url" : null, "dest_default_credential_exists" : false, "source_default_credential_exists" : false, "is_spark_hive" : false, "destination_db" : null, "destination_directory" : null, "destination_type" : "adls_gen2", "target_type" : "adls_gen2", "destination_file_format" : "parquet", "destination_jdbc_driver" : null, "flow_number" : 1, "source_directory" : null, "destination_credential_id" : 2, "relative_file_path" : "", "is_relative_file_path" : false, "destination_credential_type_id" : 5, "destination_schema_directory_id" : 3, "authentication_type" : "auth_token", "credential_pattern" : "2_1686574260", "is_apache_jdbc_driver" : false, "ingestion_table_format" : "", "source_db" : "development-db", "warehouse_name" : null, "is_source_hive" : false, "is_source_spark_hive" : false, "create_backup_table" : null, "schema_drift_option" : "drop_create_table", "destination_dataplace_component_type_id" : 3, "filesystem_credential_id" : null, "filesystem_credential_type_id" : null, "filesystem_credential_type" : null, "is_filesystem_credential_type_aws" : true, "is_file_system_type_s3a" : false, "adls_gen2_directory_name" : null, "adls_gen2_container" : "dataproc", "storage_account" : "idea15pisplznonprodsa2", "s3_bucket" : null, "gcs_bucket" : null, "is_mysql" : false, "is_bigquery" : false, "is_needed_partition_name_without_column_name" : false, "is_jdbcmode" : false, "apply_transformation" : false, "is_destination_hive" : false, "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDYyNjA0ODY3ODczNSwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0NTQwNSwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2MjYwNH0.TdlKYjNFZRULplibTKTBiTeNTShCsDicocUZq9KQkMiynWn2WsDoCNVj1Gnby5Zevba71EIlyJc7hK0-wksFFLDOu-AutbS3q-JSjcWr7zHFmWQ3NR6Xs_ycLsdTfh9HnCPt4R-GHKm9SOS5CzT6JBg08gb9cZtV2havzmaG4v9vckfKagGuftWnBKcsQNp2h9zB_EDYLVdDOUd_Aa8UHMklrT8W0SjKoDgbHVZ5T506nwQL-nXZYY0_YHP9KqDtPRiRq-k6db434A4pMx6BkTAG1z355WIuqa1fwRtrSB5HZQULpX85KD8FMpbt2gBBHWDn01TnO5_crpf0lv-SfQ", "end_point" : "http:\/\/dev-dha.humana.com:8889\/fireshots\/credentialsFetchWebService", "source_endpoint" : "s3.amazonaws.com", "destination_endpoint" : "s3.amazonaws.com", "is_azure_oauth" : false, "is_aws_iam_attached_to_ec2_instance" : false, "filesystem_credential_epoch" : null, "is_source_jdbc_url" : true, "source_jdbc_url" : "jdbc:sqlserver:\/\/hyp-acu-development-5de0.database.windows.net:1433;database=development-db;sslProtocol=TLSv1.2;encrypt=true", "pipeline_flow_timeout" : 23, "destination_schema_name" : "dataproc", "upper_case_destination_table_name" : "AAAA", "source_dataplace_id" : 42, "datamovement_engine_type" : "Spark", "intermediate_type" : "parquet", "is_create_table" : false } ], "get_cdc_audit_cols" : [], "get_list_of_maps_of_partition_columns" : [ { "?column?" : "null" } ], "get_cdc_info" : [ { "hash_type" : "", "add_audit_columns" : false, "create_view" : false, "view_name" : "v_aaaa", "is_sha2" : false, "start_date_column_name" : "valid_from_ts", "end_date_column_name" : "valid_to_ts", "job_id_column_name" : "process_id", "prev_job_id_column_name" : "prev_process_id" } ], "get_spark_configs" : [ { "compute_engine_id" : 11, "cluster_id" : null, "config_json" : { "extra_configs" : {}, "default_configs" : { "solr_batch_size" : "10000", "parallel_threads" : "10", "fetch_size" : "10000" } }, "spark_configuration_type_id" : 1, "spark_configs_json" : "{\n \"solr_batch_size\":\"10000\",\"parallel_threads\":\"10\",\"fetch_size\":\"10000\"\n }", "extra_configs_json" : { "spark.nabu.fetch_size" : "10000", "spark.nabu.solr_batch_size" : "10000" } } ], "advanced_options_tables_flags_status" : [ { "incremental_load" : false, "columns_options" : false, "modified_columns" : false, "excluded_column_ids" : false, "virtual_column" : false, "reorder_columns" : false, "remove_duplicates" : false, "sort_by_columns" : false, "table_partitions" : false, "new_table_name" : false, "parallel_ingestion" : false, "cdc" : null, "ingest_using_query" : false, "ingestion_mode" : true, "enable_cache" : false } ], "yeedu_input_json" : "ewoiY2x1c3Rlcl9pZCI6ICIiLAoiYjY0X2lucHV0X2pzb24iOiAiZXdvaWNISnZZMlZ6YzBsa0lqb3hOekF3TURZeU5UZzJPVGt6TVRnNU1Td0tJbVJoZEdGd2JHRmpaVWxrSWpvME1pd0tJblJoWW14bFNXUWlPak0zTWpNMExBb2laR0YwWVcxdmRtVnRaVzUwU1dRaU9qSTJNU3dLSW1wdllsTmphR1ZrZFd4bFpGVnpaWEpKWkNJNklrMWhibUZ6ZDJsdWFTQkRhR2x1ZEdoaGJHRndkV1JwSWl3S0ltcHZZbE5qYUdWa2RXeGxTV1FpT2pFMU5qY3NDaUppWVhSamFFbGtJam94TnpBd01EWXlOVGcyTmpZeU56WTVNU3dLSW14aGMzUlNkVzVVYVcxbGMzUmhiWEFpT2lJeU1ESXpMVEV4TFRBM0lERXlPalF5T2pBd0xqZzJNelkxSWl3S0luSmxkSEo1VG5WdElqb2dJakFpQ24wPSIsCiJleHRyYV9jb25maWciOiAiZXdvaVpYaDBjbUZEYjI1bWFXZE5ZWEFpT2lCN0luTndZWEpyTG01aFluVXVabVYwWTJoZmMybDZaU0k2SUNJeE1EQXdNQ0lzSUNKemNHRnlheTV1WVdKMUxtTnZiWEIxZEdWZlpXNW5hVzVsSWpvZ0ltRjZkWEpsWDJSaGRHRmljbWxqYTNNaUxDQWljM0JoY21zdWJtRmlkUzV6YjJ4eVgySmhkR05vWDNOcGVtVWlPaUFpTVRBd01EQWlMQ0FpYzNCaGNtc3VibUZpZFM1aGNIQnNhV05oZEdsdmJsOXVZVzFsSWpvZ0ltNWhZblV0YzNCaGNtdGliM1F0YVc1blpYTjBhVzl1SWl3Z0luTndZWEpyTG1SeWFYWmxjaTV1WVdKMVgzQnlhWFpoZEdWTFpYa2lPaUFpTDJSaVpuTXZkRzF3TDJSbGRpOXVZV0oxTHpFM01EQXdOakkxT0RZNU9UTXhPRGt4THpBdmNISnBkbUYwWlV0bGVTSXNJQ0p6Y0dGeWF5NWtjbWwyWlhJdWMyOTFjbU5sWDJGM2MxOWxibVJRYjJsdWRDSTZJQ0p6TXk1aGJXRjZiMjVoZDNNdVkyOXRJaXdnSW5Od1lYSnJMbVJ5YVhabGNpNTBZWEpuWlhSZllYZHpYMlZ1WkZCdmFXNTBJam9nSW5NekxtRnRZWHB2Ym1GM2N5NWpiMjBpTENBaWMzQmhjbXN1Ym1GaWRTNWpiMjF3ZFhSbFgyVnVaMmx1WlY5c2FXSnpYM0JoZEdnaU9pQWlMMlJpWm5NdmRHMXdMMlJsZGk5dVlXSjFMekUzTURBd05qSTFPRFk1T1RNeE9Ea3hMekF2WVhCd2JHbGpZWFJwYjI0dVkyOXVaaUo5Q24wPSIsCiJjb21wdXRlX2VuZ19jcmVkc19qc29uIiA6ICJld29nSUNKamNtVmtaVzUwYVdGc1gybGtJam9nSWpReElpd0tJQ0FpWTNKbFpHVnVkR2xoYkY5MGVYQmxYMmxrSWpvZ0lqRTFJaXdLSUNBaVkzSmxaR1Z1ZEdsaGJGOTBlWEJsSWpvZ0lrWnBiR1VnUTI5dWRHVnVkQ0lzQ2lBZ0luUnZhMlZ1SWpvZ0ltTTJPVFV3TlRneVlURXlZalUxT0dGaU5qUTRZMlJpTnpJd01EZ3hOek5pTW1VNE5ESTRabUkxTldSaFlXUTNOREF4TlRJeU5UWTVNV1ZsWXpjNFpXVTNZalZqTkdVek5ETXhNbVJsWkRjd1lXVTFaVGRsWlRRNE0ySTNaRGRsWVRCak1qTmxNalJsTkRVNFpXUXhaalUwWkdFelkyTmtOMlJpWTJabE9EY3dZVFl4WlRWak9XTTFNRGczWlRkbVlqWmtZekUyWWpabU9HWTFaVFJpWldSaE5UWTVNalJsT0RnME9XVmlOVE01WVRZellqWm1NemhqTXpFNE1HWTROamszWkdNeFkyWmhOakV4TWpNek1UQXhPVFEyTkdJMVlqWXdZamszT1dJNU16WmlaalV4TnpGaE9UazJNbU14WTJFMU5HWTRaV000TkRJd05qZGhPRFE0WWpreU0yTTJPV1F5T1Rsak5tSTNOVEkwWXpBNU5UUXlPVE13TkRBek1EbGhNV1k0Wm1Rek9XWTNPREprTVdKa09EWTBNMll6TW1FMk5XWmhNelUzTURVMlpXSmtaakJrTlRRNVpUSXdaakJtTVdFd05UWmxPREV5TmpNNE1qTTVObU01Wm1RMU5HTXpZV0ZsT1dRNE1qaGpObVkxTldVM00yRXlZelkwTlRsaE1ESmtOVFV5TkdWaE1qTTBZekl3WkRsbFpXWTBObVF4TldabFpHSmhOV0ptT1RWbE5tSmlPRE13Wm1GalpHTmhZV1V4TnpBMlptTmhOakU0TUdKa1lqQXdNelZoT1RObE1qUmtOVGMxTkdZM1pESm1PR016TXpVNFltSmhZbUZsT0Rsa1lqTXlPV0ptTXpZelpHWXdZekUwT0dNMU9XRmhaV1ZtTkdOa1ptWmlaRGczT1RBNU1ETXdOVFJrTm1JMU5HRmlaakptT1RNMU4yVmtZVEJsTkdabU16RmhZakEzTVRkbFpEUm1ZbUpqTVdZMU5EWTVOVGcwTkRSaE9XTXhOVE13WkdJeE9UZ3pPVFExWTJFeFpqZzRPVGN3WldVM1kyVXdZakEzTnpVNE5URXdZVGhrTVdJeVl6Y3dORFZtTjJVd1l6UXhNakl4TWpRMFpEZzNOVEU0WW1aaU1URTVaakJqTUdJeVlUSXhNbVExTnpZMU4yTmtORE5oWmpWaFltTTBOR1E1T1RVM05Ua3hPVEV4WW1SbFlXWTJNamM1WkRRellURTVOekl4TXpnNE5USmtNMlJsWWpneFpUQXhPR05tWkRKaVpXTTBNVEl3WWpGaFpXWXlOR1ExTm1Vek1XTXlZMkZsTm1FM1l6ZzRZbVF4TXpsaU5EUXdNekF4TlRZM01tVTJZamhrTlRObU1qaGtNak16Wm1Jd05tUmpOV1JtTmpkbFlqWTFNVGxsT1dVME5HVmtPVEJsTkdKaVptSTRZalUzTm1NNVlXWmhOMlJrWm1GaU1UZGhaakl4T1dKbU9ERXpOV1JsTVdZNFpUWm1ZVE5tWmpRMlpURmhZV001TmpsaFptTXhaalJqTlRZeU5XUXdZell3TnpVMFptTXhZbUpqTXpSaFpEWXpaVFU0WVRSbU4ySmxPVGMxTmpabU5ERXpPV0U1WVRSaVltWXdZbUl4TTJSaE9XSXhNelEwTURFNVpXVm1NRGd6WW1Jd05UVmhNbVpsTVRCbVptWmpOek01WVRJNVlXUmlZbVJoTXpNellqZzBaV1JrWlRnMllqVmlOelkwTWprM1pERTVaakJqTVRjMk9EazVOamRrWlRBeU1tRXhaR0k1WkRFMFkyRmhOMk00TURFNFlqVXlZemhpWlRabU16RXdOekUzTXpoak9XTTFOekV4WXpreU5ESXlPVEV5TkdSaU5qSXdNVEV4WldabE5qRmpaR1U1TldRNVptWmtaREEwTkRBMU56azJOVGMyTldNMFlUQXpNV1UyWm1JeVlXRmhZVGxsWmpkbE1UYzFNR00zTlRaaVpXRXlZVEZqWVRNNFpHRTFZalprTWpJek1URXpOMkl3WkROa1pqazBORFU0TkRkaE5ETmxZbUV6TjJFMk4yRXdNakk1SWl3S0lDQWlZM0psWkdWdWRHbGhiRjlsYm1Sd2IybHVkRjkxY213aU9pQWlhSFIwY0RvdkwyUmxkaTFrYUdFdWFIVnRZVzVoTG1OdmJUbzRPRGc1TDJacGNtVnphRzkwY3k5amNtVmtaVzUwYVdGc2MwWmxkR05vVjJWaVUyVnlkbWxqWlNJc0NpQWdJbVpwYkdWZmNHRjBhQ0k2SUNJeE5UWTNYekkyTVY4eE56QXdNRFl5TlRnMk5qWXlOelk1TVNJc0NpQWdJbU55WldSbGJuUnBZV3hmWm1sc1pWOXdZWFIwWlhKdUlpQTZJQ0kwTVY4eE5qazVNelF5TlRjMUlncDkiLAoiY2x1c3Rlcl91aSI6ICIiLAoicmV0cnlfbnVtIjogIjAiLAoic3BhcmtfY29uZmlncyI6ICJld29nSUNBZ0luTnZiSEpmWW1GMFkyaGZjMmw2WlNJNklqRXdNREF3SWl3aWNHRnlZV3hzWld4ZmRHaHlaV0ZrY3lJNklqRXdJaXdpWm1WMFkyaGZjMmw2WlNJNklqRXdNREF3SWdvZ0lDQWdmUT09IiwKImI2NF9oaXZlX2NyZWRzX2pzb24iOiAiZXdvZ0lDSmpjbVZrWlc1MGFXRnNYMmxrSWpvZ0lpSXNDaUFnSW1OeVpXUmxiblJwWVd4ZmRIbHdaVjlwWkNJNklDSWlMQW9nSUNKMGIydGxiaUk2SUNKak5qazFNRFU0TW1FeE1tSTFOVGhoWWpZME9HTmtZamN5TURBNE1UY3pZakpsT0RReU9HWmlOVFZrWVdGa056UXdNVFV5TWpVMk9URmxaV00zT0dWbE4ySTFZelJsTXpRek1USmtaV1EzTUdGbE5XVTNaV1UwT0ROaU4yUTNaV0V3WXpJelpUSTBaVFExT0dWa01XWTFOR1JoTTJOalpEZGtZbU5tWlRnM01HRTJNV1UxWXpsak5UQTROMlUzWm1JMlpHTXhObUkyWmpobU5XVTBZbVZrWVRVMk9USTBaVGc0TkRsbFlqVXpPV0UyTTJJMlpqTTRZek14T0RCbU9EWTVOMlJqTVdObVlUWXhNVEl6TXpFd01UazBOalJpTldJMk1HSTVOemxpT1RNMlltWTFNVGN4WVRrNU5qSmpNV05oTlRSbU9HVmpPRFF5TURZM1lUZzBPR0k1TWpOak5qbGtNams1WXpaaU56VXlOR013T1RVME1qa3pNRFF3TXpBNVlURm1PR1prTXpsbU56Z3laREZpWkRnMk5ETm1NekpoTmpWbVlUTTFOekExTm1WaVpHWXdaRFUwT1dVeU1HWXdaakZoTURVMlpUZ3hNall6T0RJek9UWmpPV1prTlRSak0yRmhaVGxrT0RJNFl6Wm1OVFZsTnpOaE1tTTJORFU1WVRBeVpEVTFNalJsWVRJek5HTXlNR1E1WldWbU5EWmtNVFZtWldSaVlUVmlaamsxWlRaaVlqZ3pNR1poWTJSallXRmxNVGN3Tm1aallUWXhPREJpWkdJd01ETTFZVGt6WlRJMFpEVTNOVFJtTjJReVpqaGpNek0xT0dKaVlXSmhaVGc1WkdJek1qbGlaak0yTTJSbU1HTXhORGhqTlRsaFlXVmxaalJqWkdabVltUTROemt3T1RBek1EVTBaRFppTlRSaFltWXlaamt6TlRkbFpHRXdaVFJtWmpNeFlXSXdOekUzWldRMFptSmlZekZtTlRRMk9UVTRORFEwWVRsak1UVXpNR1JpTVRrNE16azBOV05oTVdZNE9EazNNR1ZsTjJObE1HSXdOemMxT0RVeE1HRTRaREZpTW1NM01EUTFaamRsTUdNME1USXlNVEkwTkdRNE56VXhPR0ptWWpFeE9XWXdZekJpTW1FeU1USmtOVGMyTlRkalpEUXpZV1kxWVdKak5EUmtPVGsxTnpVNU1Ua3hNV0prWldGbU5qSTNPV1EwTTJFeE9UY3lNVE00T0RVeVpETmtaV0k0TVdVd01UaGpabVF5WW1Wak5ERXlNR0l4WVdWbU1qUmtOVFpsTXpGak1tTmhaVFpoTjJNNE9HSmtNVE01WWpRME1ETXdNVFUyTnpKbE5tSTRaRFV6WmpJNFpESXpNMlppTURaa1l6VmtaalkzWldJMk5URTVaVGxsTkRSbFpEa3daVFJpWW1aaU9HSTFOelpqT1dGbVlUZGtaR1poWWpFM1lXWXlNVGxpWmpneE16VmtaVEZtT0dVMlptRXpabVkwTm1VeFlXRmpPVFk1WVdaak1XWTBZelUyTWpWa01HTTJNRGMxTkdaak1XSmlZek0wWVdRMk0yVTFPR0UwWmpkaVpUazNOVFkyWmpReE16bGhPV0UwWW1KbU1HSmlNVE5rWVRsaU1UTTBOREF4T1dWbFpqQTRNMkppTURVMVlUSm1aVEV3Wm1abVl6Y3pPV0V5T1dGa1ltSmtZVE16TTJJNE5HVmtaR1U0Tm1JMVlqYzJOREk1TjJReE9XWXdZekUzTmpnNU9UWTNaR1V3TWpKaE1XUmlPV1F4TkdOaFlUZGpPREF4T0dJMU1tTTRZbVUyWmpNeE1EY3hOek00WXpsak5UY3hNV001TWpReU1qa3hNalJrWWpZeU1ERXhNV1ZtWlRZeFkyUmxPVFZrT1dabVpHUXdORFF3TlRjNU5qVTNOalZqTkdFd016RmxObVppTW1GaFlXRTVaV1kzWlRFM05UQmpOelUyWW1WaE1tRXhZMkV6T0dSaE5XSTJaREl5TXpFeE16ZGlNR1F6WkdZNU5EUTFPRFEzWVRRelpXSmhNemRoTmpkaE1ESXlPU0lzQ2lBZ0ltTnlaV1JsYm5ScFlXeGZaVzVrY0c5cGJuUmZkWEpzSWpvZ0ltaDBkSEE2THk5a1pYWXRaR2hoTG1oMWJXRnVZUzVqYjIwNk9EZzRPUzltYVhKbGMyaHZkSE12WTNKbFpHVnVkR2xoYkhOR1pYUmphRmRsWWxObGNuWnBZMlVpQ24wPSIsCiJiYXRjaF9pZCI6MTcwMDA2MjU4NjY2Mjc2OTEsCiJwcm9jZXNzX2lkIiA6MTcwMDA2MjU4Njk5MzE4OTEsCiJyZXN0X3VybCI6ICIiLAoiYjY0X2V4dGVybmFsX2phcnNfbWFwIiA6ICIiCn0=", "ingestion_mode" : [ { "data_movement_id" : 261, "save_mode" : "Overwrite", "mode" : "overwrite", "ingestion_mode_key" : true, "drop_create_condition" : true } ], "generate_extra_configs_json" : "ewoiZXh0cmFDb25maWdNYXAiOiB7InNwYXJrLm5hYnUuZmV0Y2hfc2l6ZSI6ICIxMDAwMCIsICJzcGFyay5uYWJ1LmNvbXB1dGVfZW5naW5lIjogImF6dXJlX2RhdGFicmlja3MiLCAic3BhcmsubmFidS5zb2xyX2JhdGNoX3NpemUiOiAiMTAwMDAiLCAic3BhcmsubmFidS5hcHBsaWNhdGlvbl9uYW1lIjogIm5hYnUtc3Bhcmtib3QtaW5nZXN0aW9uIiwgInNwYXJrLmRyaXZlci5uYWJ1X3ByaXZhdGVLZXkiOiAiL2RiZnMvdG1wL2Rldi9uYWJ1LzE3MDAwNjI1ODY5OTMxODkxLzAvcHJpdmF0ZUtleSIsICJzcGFyay5kcml2ZXIuc291cmNlX2F3c19lbmRQb2ludCI6ICJzMy5hbWF6b25hd3MuY29tIiwgInNwYXJrLmRyaXZlci50YXJnZXRfYXdzX2VuZFBvaW50IjogInMzLmFtYXpvbmF3cy5jb20iLCAic3BhcmsubmFidS5jb21wdXRlX2VuZ2luZV9saWJzX3BhdGgiOiAiL2RiZnMvdG1wL2Rldi9uYWJ1LzE3MDAwNjI1ODY5OTMxODkxLzAvYXBwbGljYXRpb24uY29uZiJ9Cn0=", "incremental_load_details" : [ { "?column?" : 1 } ], "place_holders_with_default_and_max_values" : [ { "?column?" : 1 } ], "incremental_max_columns_with_column_ids" : [ { "?column?" : 1 } ], "remove_duplicates_data" : [], "cdc_first_time" : [ { "cdc_first_time" : true } ], "generate_base64_pipeline_timeout_json" : "ewoicGlwZWxpbmVfdGltZW91dCIgOiAyMwp9", "table_partition_output" : [], "fetch_source_type" : [ { "data_movement_id" : 261, "source_metadata_category" : "relational", "destination_metadata_category" : "file", "source" : "sql_server", "destination" : "adls_gen2", "is_source_filetype" : false, "is_source_salesforce" : false, "is_source_mongodb" : false, "is_destination_filetype" : true, "is_ordinalpos_startwith_zero" : false, "is_destination_redshift" : false } ], "destination_transformation_query_details_output" : [ { "is_virtual" : false, "column_id" : 956158, "is_source_casting_enabled" : false, "is_partitioned_col" : false, "column_name" : "entity_id", "replaced_column_name" : "entity_id", "data_type" : "varchar", "data_length" : 255, "ordinal_position" : 1, "is_nullable" : false, "table_name" : "aaaa", "schema_name" : "acuity-develop", "is_mysql" : false, "is_bigquery" : false, "is_source_hive" : false, "source_type" : "sql_server", "source_datatype_name" : "varchar", "source_cast_type" : "AsIs", "intermediate_datatype_name" : "string", "table_id" : 37234, "source_stg_function" : "AsIs", "data_scale" : 0, "data_precision" : 0, "is_precision" : true, "is_precision_scale" : true, "is_redshift_relational_destination" : false, "is_oracle_destination" : false, "is_varchar" : false, "destination_datatype_name" : "string", "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "field_name" : "entity_id", "field_name_replaced" : "entity_id", "is_long_col_name" : false, "istimezone" : false, "user_text" : null, "is_cdc_col" : false, "ingested_colorder" : 1 }, { "is_virtual" : false, "column_id" : 956159, "is_source_casting_enabled" : false, "is_partitioned_col" : false, "column_name" : "entity_type", "replaced_column_name" : "entity_type", "data_type" : "varchar", "data_length" : 255, "ordinal_position" : 2, "is_nullable" : false, "table_name" : "aaaa", "schema_name" : "acuity-develop", "is_mysql" : false, "is_bigquery" : false, "is_source_hive" : false, "source_type" : "sql_server", "source_datatype_name" : "varchar", "source_cast_type" : "AsIs", "intermediate_datatype_name" : "string", "table_id" : 37234, "source_stg_function" : "AsIs", "data_scale" : 0, "data_precision" : 0, "is_precision" : true, "is_precision_scale" : true, "is_redshift_relational_destination" : false, "is_oracle_destination" : false, "is_varchar" : false, "destination_datatype_name" : "string", "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "field_name" : "entity_type", "field_name_replaced" : "entity_type", "is_long_col_name" : false, "istimezone" : false, "user_text" : null, "is_cdc_col" : false, "ingested_colorder" : 2 } ], "get_varchar_columns_destination" : [], "input_data" : { "flow_number" : 1, "process_id" : 17000625869931891, "source_database_name_lowercase" : "development-db", "batch_id" : 17000625866627691, "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDYyNjA0ODY3ODczNSwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0NTQwNSwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2MjYwNH0.TdlKYjNFZRULplibTKTBiTeNTShCsDicocUZq9KQkMiynWn2WsDoCNVj1Gnby5Zevba71EIlyJc7hK0-wksFFLDOu-AutbS3q-JSjcWr7zHFmWQ3NR6Xs_ycLsdTfh9HnCPt4R-GHKm9SOS5CzT6JBg08gb9cZtV2havzmaG4v9vckfKagGuftWnBKcsQNp2h9zB_EDYLVdDOUd_Aa8UHMklrT8W0SjKoDgbHVZ5T506nwQL-nXZYY0_YHP9KqDtPRiRq-k6db434A4pMx6BkTAG1z355WIuqa1fwRtrSB5HZQULpX85KD8FMpbt2gBBHWDn01TnO5_crpf0lv-SfQ", "end_point" : "http:\/\/dev-dha.humana.com:8889\/fireshots\/credentialsFetchWebService", "where_condition" : "37234", "suffix" : "", "reorder_columns" : [], "job_type_id" : "1", "ingestion_table_format" : "", "job_schedule_id" : 1567, "relative_file_path" : "", "retry_attempt" : "0", "source_schema_name_lowercase" : "acuity-develop", "variables" : { "env_variables" : {}, "user_variables" : {}, "payload_variables" : {} }, "source_database_name_uppercase" : "DEVELOPMENT-DB", "job_scheduled_user_id" : "Manaswini Chinthalapudi", "virtual_column" : [], "new_table_for_rename" : "", "source_schema_name_uppercase" : "ACUITY-DEVELOP", "batch_name" : "Ingestion_20231115", "modified_columns" : [], "source_database_name" : "development-db", "data_movement_id" : 261, "last_run_timestamp" : "2023-11-07 12:42:00.86365", "is_relative_file_path" : false }, "table_adv_opt_details" : [ { "object_id" : 37234, "data_movement_id" : 261, "advance_option_details" : { "advanced_table_options" : { "columns_options" : { "modified_columns" : [], "virtual_column" : [], "excluded_column_ids" : [] }, "CDC" : { "audit_columns" : { "prev_process_id_column_name" : "prev_process_id", "end_date_column_name" : "valid_to_ts", "process_id_column_name" : "process_id", "start_date_column_name" : "valid_from_ts" }, "CDC_process_type" : "", "add_audit_columns" : false, "columns_ids" : [], "CDC_type" : "", "create_view" : false, "hash_type" : "", "view_name" : "v_aaaa" }, "sort_by_columns" : [], "incremental_load" : { "condition_values" : [], "where_clause" : "" }, "parallel_ingestion" : { "max_connections" : 1, "enable" : false }, "remove_duplicates" : { "sort_columns" : [], "key_columns" : [] }, "table_id" : 37234, "reorder_columns" : [], "table_name" : "aaaa", "parallel_hash_ingestion" : { "max_connections" : 8, "enable" : false }, "dataplace_id" : 42, "ingestion_mode" : { "mode" : "Drop & Re-create", "enable" : true }, "enable_cache" : { "enable" : false }, "ingest_using_query" : { "enable" : false, "sql_query" : "" }, "schema_id" : 453, "new_table_name" : "", "table_partitions" : [] }, "advanced_option_flags" : { "columns_options" : false, "CDC" : false, "sort_by_columns" : false, "incremental_load" : false, "parallel_ingestion" : false, "remove_duplicates" : false, "virtual_column" : false, "table_id" : 37234, "reorder_columns" : false, "table_name" : "aaaa", "parallel_hash_ingestion" : false, "dataplace_id" : 42, "modified_columns" : false, "ingestion_mode" : true, "enable_cache" : false, "ingest_using_query" : false, "schema_id" : 453, "new_table_name" : false, "excluded_column_ids" : false, "table_partitions" : false } }, "valid_from_ts" : "2023-11-15 09:31:16.466337", "valid_to_ts" : "9999-12-31 00:00:00.0", "cru_ts" : "2023-11-15 09:31:16.466337", "cru_by" : "Venkata Yeedi", "dataplace_id" : 42 } ], "check_compute_engine_validity" : [ { "is_valid_compute_engine" : true } ], "get_non_partition_cols" : [ { "field_name" : "entity_id", "source_field_name" : "entity_id", "column_name" : "entity_id", "column_id" : "956158", "source_datatype_name" : "varchar", "ingested_colorder" : 1, "destination_datatype_name" : "string", "is_partitioned_col" : false, "is_virtual" : false, "is_auditcol" : false, "data_length" : "255", "data_scale" : "0", "data_precision" : "0" }, { "field_name" : "entity_type", "source_field_name" : "entity_type", "column_name" : "entity_type", "column_id" : "956159", "source_datatype_name" : "varchar", "ingested_colorder" : 2, "destination_datatype_name" : "string", "is_partitioned_col" : false, "is_virtual" : false, "is_auditcol" : false, "data_length" : "255", "data_scale" : "0", "data_precision" : "0" } ], "get_partition_cols" : [], "list_of_maps_of_incremental_columns" : [ { "?column?" : 1 } ], "spark_script_inputs" : [ { "ssh_host" : "null", "ssh_username" : "null", "kerberos" : null, "spark_location" : "null", "data_movement_name" : "ss_compass_adb_validation", "cluster_library_path" : "\/dbfs\/tmp", "engine_sub_type" : "azure databricks", "spark_version" : "3.1", "scala_version" : "2.12", "cloud_type" : "null", "cluster_ui" : null, "rest_url" : null, "cluster_id" : "0922-003138-orn9r0te", "dataproc_project" : "null", "region" : "null", "dataproc_cluster" : "null", "s3_bucket_path" : null, "is_bucket_encrypted" : null, "execution_role" : null, "loggroupname" : null, "release_label" : null, "cloud_watch" : null, "s3logs" : null, "engine_path" : "azure_databricks", "compute_engine_info" : "ewoiY2x1c3Rlcl9pZCI6IjA5MjItMDAzMTM4LW9ybjlyMHRlIiwic3BhcmtfdmVyc2lvbl92YWx1ZSI6IjNfMSIsInNjYWxhX3ZlcnNpb25fdmFsdWUiOiIyXzEyIiwiY3JlZGVudGlhbHNfZmlsZXBhdGgiOiIiLCJjbHVzdGVyX2xpYnJhcnlfcGF0aCI6Ii9kYmZzL3RtcCIsInNwYXJrX3ZlcnNpb24iOiIzLjEiLCJzY2FsYV92ZXJzaW9uIjoiMi4xMiIKfQ==", "private_key_path" : "\/dbfs\/tmp\/dev\/nabu\/17000625869931891\/0\/privateKey", "b64_external_jars_map" : null } ], "column_metadata_output" : [ { "is_virtual" : false, "column_id" : 956158, "is_source_casting_enabled" : false, "is_partitioned_col" : false, "column_name" : "entity_id", "replaced_column_name" : "entity_id", "data_type" : "varchar", "data_length" : 255, "ordinal_position" : 1, "is_nullable" : false, "table_name" : "aaaa", "schema_name" : "acuity-develop", "is_mysql" : false, "is_bigquery" : false, "is_source_hive" : false, "source_type" : "sql_server", "source_datatype_name" : "varchar", "source_cast_type" : "AsIs", "intermediate_datatype_name" : "string", "table_id" : 37234, "source_stg_function" : "AsIs", "data_scale" : 0, "data_precision" : 0, "is_precision" : true, "is_precision_scale" : true, "is_redshift_relational_destination" : false, "is_oracle_destination" : false, "is_varchar" : false, "destination_datatype_name" : "string", "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "field_name" : "entity_id", "field_name_replaced" : "entity_id", "is_long_col_name" : false, "istimezone" : false, "user_text" : null, "is_cdc_col" : false }, { "is_virtual" : false, "column_id" : 956159, "is_source_casting_enabled" : false, "is_partitioned_col" : false, "column_name" : "entity_type", "replaced_column_name" : "entity_type", "data_type" : "varchar", "data_length" : 255, "ordinal_position" : 2, "is_nullable" : false, "table_name" : "aaaa", "schema_name" : "acuity-develop", "is_mysql" : false, "is_bigquery" : false, "is_source_hive" : false, "source_type" : "sql_server", "source_datatype_name" : "varchar", "source_cast_type" : "AsIs", "intermediate_datatype_name" : "string", "table_id" : 37234, "source_stg_function" : "AsIs", "data_scale" : 0, "data_precision" : 0, "is_precision" : true, "is_precision_scale" : true, "is_redshift_relational_destination" : false, "is_oracle_destination" : false, "is_varchar" : false, "destination_datatype_name" : "string", "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "field_name" : "entity_type", "field_name_replaced" : "entity_type", "is_long_col_name" : false, "istimezone" : false, "user_text" : null, "is_cdc_col" : false } ], "updated_wherecondition_replaced_with_default_and_max_values" : [ { "?column?" : 1 } ], "cdc_schema_drift_new_table" : [ { "drift_new_table" : false } ], "emr_input_json" : "ewogICJjbHVzdGVyX2lkIjogIjA5MjItMDAzMTM4LW9ybjlyMHRlIiwKICAiY2x1c3Rlcl9yZWdpb24iOiAibnVsbCIsCiAgImNvbXB1dGVfZW5nX2NyZWRzX2pzb24iOiAiZXdvZ0lDSmpjbVZrWlc1MGFXRnNYMmxrSWpvZ0lqUXhJaXdLSUNBaVkzSmxaR1Z1ZEdsaGJGOTBlWEJsWDJsa0lqb2dJakUxSWl3S0lDQWlZM0psWkdWdWRHbGhiRjkwZVhCbElqb2dJa1pwYkdVZ1EyOXVkR1Z1ZENJc0NpQWdJblJ2YTJWdUlqb2dJbU0yT1RVd05UZ3lZVEV5WWpVMU9HRmlOalE0WTJSaU56SXdNRGd4TnpOaU1tVTROREk0Wm1JMU5XUmhZV1EzTkRBeE5USXlOVFk1TVdWbFl6YzRaV1UzWWpWak5HVXpORE14TW1SbFpEY3dZV1UxWlRkbFpUUTRNMkkzWkRkbFlUQmpNak5sTWpSbE5EVTRaV1F4WmpVMFpHRXpZMk5rTjJSaVkyWmxPRGN3WVRZeFpUVmpPV00xTURnM1pUZG1ZalprWXpFMllqWm1PR1kxWlRSaVpXUmhOVFk1TWpSbE9EZzBPV1ZpTlRNNVlUWXpZalptTXpoak16RTRNR1k0TmprM1pHTXhZMlpoTmpFeE1qTXpNVEF4T1RRMk5HSTFZall3WWprM09XSTVNelppWmpVeE56RmhPVGsyTW1NeFkyRTFOR1k0WldNNE5ESXdOamRoT0RRNFlqa3lNMk0yT1dReU9UbGpObUkzTlRJMFl6QTVOVFF5T1RNd05EQXpNRGxoTVdZNFptUXpPV1kzT0RKa01XSmtPRFkwTTJZek1tRTJOV1poTXpVM01EVTJaV0prWmpCa05UUTVaVEl3WmpCbU1XRXdOVFpsT0RFeU5qTTRNak01Tm1NNVptUTFOR016WVdGbE9XUTRNamhqTm1ZMU5XVTNNMkV5WXpZME5UbGhNREprTlRVeU5HVmhNak0wWXpJd1pEbGxaV1kwTm1ReE5XWmxaR0poTldKbU9UVmxObUppT0RNd1ptRmpaR05oWVdVeE56QTJabU5oTmpFNE1HSmtZakF3TXpWaE9UTmxNalJrTlRjMU5HWTNaREptT0dNek16VTRZbUpoWW1GbE9EbGtZak15T1dKbU16WXpaR1l3WXpFME9HTTFPV0ZoWldWbU5HTmtabVppWkRnM09UQTVNRE13TlRSa05tSTFOR0ZpWmpKbU9UTTFOMlZrWVRCbE5HWm1NekZoWWpBM01UZGxaRFJtWW1Kak1XWTFORFk1TlRnME5EUmhPV014TlRNd1pHSXhPVGd6T1RRMVkyRXhaamc0T1Rjd1pXVTNZMlV3WWpBM056VTROVEV3WVRoa01XSXlZemN3TkRWbU4yVXdZelF4TWpJeE1qUTBaRGczTlRFNFltWmlNVEU1WmpCak1HSXlZVEl4TW1RMU56WTFOMk5rTkROaFpqVmhZbU0wTkdRNU9UVTNOVGt4T1RFeFltUmxZV1kyTWpjNVpEUXpZVEU1TnpJeE16ZzROVEprTTJSbFlqZ3haVEF4T0dObVpESmlaV00wTVRJd1lqRmhaV1l5TkdRMU5tVXpNV015WTJGbE5tRTNZemc0WW1ReE16bGlORFF3TXpBeE5UWTNNbVUyWWpoa05UTm1NamhrTWpNelptSXdObVJqTldSbU5qZGxZalkxTVRsbE9XVTBOR1ZrT1RCbE5HSmlabUk0WWpVM05tTTVZV1poTjJSa1ptRmlNVGRoWmpJeE9XSm1PREV6TldSbE1XWTRaVFptWVRObVpqUTJaVEZoWVdNNU5qbGhabU14WmpSak5UWXlOV1F3WXpZd056VTBabU14WW1Kak16UmhaRFl6WlRVNFlUUm1OMkpsT1RjMU5qWm1OREV6T1dFNVlUUmlZbVl3WW1JeE0yUmhPV0l4TXpRME1ERTVaV1ZtTURnelltSXdOVFZoTW1abE1UQm1abVpqTnpNNVlUSTVZV1JpWW1SaE16TXpZamcwWldSa1pUZzJZalZpTnpZME1qazNaREU1WmpCak1UYzJPRGs1Tmpka1pUQXlNbUV4WkdJNVpERTBZMkZoTjJNNE1ERTRZalV5WXpoaVpUWm1NekV3TnpFM016aGpPV00xTnpFeFl6a3lOREl5T1RFeU5HUmlOakl3TVRFeFpXWmxOakZqWkdVNU5XUTVabVprWkRBME5EQTFOemsyTlRjMk5XTTBZVEF6TVdVMlptSXlZV0ZoWVRsbFpqZGxNVGMxTUdNM05UWmlaV0V5WVRGallUTTRaR0UxWWpaa01qSXpNVEV6TjJJd1pETmtaamswTkRVNE5EZGhORE5sWW1Fek4yRTJOMkV3TWpJNUlpd0tJQ0FpWTNKbFpHVnVkR2xoYkY5bGJtUndiMmx1ZEY5MWNtd2lPaUFpYUhSMGNEb3ZMMlJsZGkxa2FHRXVhSFZ0WVc1aExtTnZiVG80T0RnNUwyWnBjbVZ6YUc5MGN5OWpjbVZrWlc1MGFXRnNjMFpsZEdOb1YyVmlVMlZ5ZG1salpTSXNDaUFnSW1acGJHVmZjR0YwYUNJNklDSXhOVFkzWHpJMk1WOHhOekF3TURZeU5UZzJOall5TnpZNU1TSXNDaUFnSW1OeVpXUmxiblJwWVd4ZlptbHNaVjl3WVhSMFpYSnVJaUE2SUNJME1WOHhOams1TXpReU5UYzFJZ3A5IiwKICAiczNfcGF0aCI6ICIiLAogICJiNjRfaW5wdXRfanNvbiI6ICJld29pY0hKdlkyVnpjMGxrSWpveE56QXdNRFl5TlRnMk9Ua3pNVGc1TVN3S0ltUmhkR0Z3YkdGalpVbGtJam8wTWl3S0luUmhZbXhsU1dRaU9qTTNNak0wTEFvaVpHRjBZVzF2ZG1WdFpXNTBTV1FpT2pJMk1Td0tJbXB2WWxOamFHVmtkV3hsWkZWelpYSkpaQ0k2SWsxaGJtRnpkMmx1YVNCRGFHbHVkR2hoYkdGd2RXUnBJaXdLSW1wdllsTmphR1ZrZFd4bFNXUWlPakUxTmpjc0NpSmlZWFJqYUVsa0lqb3hOekF3TURZeU5UZzJOall5TnpZNU1Td0tJbXhoYzNSU2RXNVVhVzFsYzNSaGJYQWlPaUl5TURJekxURXhMVEEzSURFeU9qUXlPakF3TGpnMk16WTFJaXdLSW5KbGRISjVUblZ0SWpvZ0lqQWlDbjA9IiwKICAiZXh0cmFfY29uZmlnIjogImV3b2laWGgwY21GRGIyNW1hV2ROWVhBaU9pQjdJbk53WVhKckxtNWhZblV1Wm1WMFkyaGZjMmw2WlNJNklDSXhNREF3TUNJc0lDSnpjR0Z5YXk1dVlXSjFMbU52YlhCMWRHVmZaVzVuYVc1bElqb2dJbUY2ZFhKbFgyUmhkR0ZpY21samEzTWlMQ0FpYzNCaGNtc3VibUZpZFM1emIyeHlYMkpoZEdOb1gzTnBlbVVpT2lBaU1UQXdNREFpTENBaWMzQmhjbXN1Ym1GaWRTNWhjSEJzYVdOaGRHbHZibDl1WVcxbElqb2dJbTVoWW5VdGMzQmhjbXRpYjNRdGFXNW5aWE4wYVc5dUlpd2dJbk53WVhKckxtUnlhWFpsY2k1dVlXSjFYM0J5YVhaaGRHVkxaWGtpT2lBaUwyUmlabk12ZEcxd0wyUmxkaTl1WVdKMUx6RTNNREF3TmpJMU9EWTVPVE14T0RreEx6QXZjSEpwZG1GMFpVdGxlU0lzSUNKemNHRnlheTVrY21sMlpYSXVjMjkxY21ObFgyRjNjMTlsYm1SUWIybHVkQ0k2SUNKek15NWhiV0Y2YjI1aGQzTXVZMjl0SWl3Z0luTndZWEpyTG1SeWFYWmxjaTUwWVhKblpYUmZZWGR6WDJWdVpGQnZhVzUwSWpvZ0luTXpMbUZ0WVhwdmJtRjNjeTVqYjIwaUxDQWljM0JoY21zdWJtRmlkUzVqYjIxd2RYUmxYMlZ1WjJsdVpWOXNhV0p6WDNCaGRHZ2lPaUFpTDJSaVpuTXZkRzF3TDJSbGRpOXVZV0oxTHpFM01EQXdOakkxT0RZNU9UTXhPRGt4THpBdllYQndiR2xqWVhScGIyNHVZMjl1WmlKOUNuMD0iLAogICJiYXRjaF9pZCI6IDE3MDAwNjI1ODY2NjI3NjkxLAogICJyZXRyeV9udW0iOiAiMCIsCiAgInNwYXJrX2NvbmZpZ3MiOiAiZXdvZ0lDQWdJbk52YkhKZlltRjBZMmhmYzJsNlpTSTZJakV3TURBd0lpd2ljR0Z5WVd4c1pXeGZkR2h5WldGa2N5STZJakV3SWl3aVptVjBZMmhmYzJsNlpTSTZJakV3TURBd0lnb2dJQ0FnZlE9PSIsCiAgImlzX2J1Y2tldF9lbmNyeXB0ZWQiOiAiIiwKICAiYjY0X2V4dGVybmFsX2phcnNfbWFwIiA6ICIiCn0=", "base64_rsa_compressed_encrypted_creds" : "rO0ABXVyAAJbQqzzF\/gGCFTgAgAAeHAAAAEAFBBvYZ7Mim3fI+Np05VO+EHuf5PxldceVzCwdbLhn99OYytVbAynQS5Ral29GY9WQevohqFq0pptfWmC6Hdze1ChYqC3VXBhBj3fvqRQZTXN3\/gYsSGTxp+834hmfUfQbU0RQ7RnV0wV7zyS1QELwx0d2MbPVdCF1bxRqXdtOn1A4aNwc7Ia7\/cZJEKIjKPAUohAvgCyjsGHSbHQx98WKhSwSU60Sa2dauo11GJkO6jT0fdAUjMDuRgiri0JjVTof4u\/gV\/qzwHpGu\/AH\/Q\/dG8vOv1Stjm43HFpaHjBb2lqw0+JUBuIAqO1SbZmHe1FSy4p09C5Z0pkxSxmLBMQXXVxAH4AAAAAA5D7uBN32zcbCqrcmzijqQfhpAWVqmvEcLxsLpAXN0MnSpwYDURX1Bzr\/vmU9PmJjV114yRnCLXxwgtmVebwcXQpDixTHpTKVjL\/CtOTvSkauTybzdVq1nm6iSti+tUV5IX7blC5I+JVJZcJyd6c83OK54FmVswIUe6LEaVCSaMlYzQNpKT7IKYurmTruiz7hrCJ9ZdIk+fUYt2inQ9BMkqscwFr97n+VE9s\/5MPmsbtG7JCzBniT5ePLh9BIr6dWLfZjG+MKsijpwhUINj3sG\/IbsCtqQuNLGxFV6nZObarxX\/8NiFDOwXitmggN2ZBe0ggcLzMHBDILWwaxnGsByVdmKFxN5DozkOUQM1FX0euvznFtk\/Vd7mu6sTeISNvvpempQuPOLzUew2SfynpCR8gqBp0N4E7JYBYpfeuk4wDcX7y6q7xb+p\/Ir2i90Y+AJxMfcXIH7bDQ8H24cSg2pvx1mIZU9btojRD00BaME1dgJOOI42T1jALDSOWIUSxS84qQ1blakpHAKfp4OFgT6XNQNN1mteDjRcLlLxkTP2azXBeWL3\/1Ix9\/2WLHgbeP4rQG27yM6n+YYQU2OTqKr8nJ7HPbwfY3tiagpKX7VpRnoTq\/he0Db7UxxzVEN12\/Pj8fJUjLXTAfoworuhlYo0AaSYMMt2lIr9gB2FRiH1+RELLTrt\/0tGUjMaOLWL6WU8IZj749J9MUYQ6dTnmQHwUKWsaImYLZIPp5HDwC\/8etfQBMqqYUfn8Mm\/McmjKX7AHB48J4X9BBW4n42bLVwBwBxoIzRoQOVAK95be5uR7X9PQ7mqGpjK6KTWPgSj34dg94SCzm40mhvwW0d+KatJ3Bl\/mXsYXzDK6k7vqIQuuYlm8IVvlScQZSrXMJkQK3kVYlZMnpEM47cgs5s\/AtFNRgD3tIRl28PZBvAoU2RdxpEGJCp97LugjtPmQVwPqHtxZQ2eBAWvcT7prIgNQJgKLvMWSb0S42rDhrEaV3vRYjxxZh2a8odrvFve7mNJjYRvscpOOljnliNBnVW703kNQVjIlNiOu6WezpphGFNzd434k1Fom9cQub82hQgHeGssWwjEmL4lCCtT4rRHxouyik36\/v4js9JSVh4RlgXvGR2daW7KTzqW\/GquJUbJjVarT2iljzwahdM08Mbj9T1uxcDycIuEskdEp6pmFVTMgzRYNjAZbWMGnhdKRWYozgis=", "target_schemadrift_details" : [ { "schema_drifted" : false, "target_schemadrift_ignore_table" : false, "target_schemadrift_backup_table" : false, "target_schemadrift_new_table" : false, "destination_table_name" : "aaaa", "backup_table_name" : "aaaa" } ], "generate_file_content_json" : "ewogICJjcmVkZW50aWFsX2lkIjogIjQxIiwKICAiY3JlZGVudGlhbF90eXBlX2lkIjogIjE1IiwKICAiY3JlZGVudGlhbF90eXBlIjogIkZpbGUgQ29udGVudCIsCiAgInRva2VuIjogImM2OTUwNTgyYTEyYjU1OGFiNjQ4Y2RiNzIwMDgxNzNiMmU4NDI4ZmI1NWRhYWQ3NDAxNTIyNTY5MWVlYzc4ZWU3YjVjNGUzNDMxMmRlZDcwYWU1ZTdlZTQ4M2I3ZDdlYTBjMjNlMjRlNDU4ZWQxZjU0ZGEzY2NkN2RiY2ZlODcwYTYxZTVjOWM1MDg3ZTdmYjZkYzE2YjZmOGY1ZTRiZWRhNTY5MjRlODg0OWViNTM5YTYzYjZmMzhjMzE4MGY4Njk3ZGMxY2ZhNjExMjMzMTAxOTQ2NGI1YjYwYjk3OWI5MzZiZjUxNzFhOTk2MmMxY2E1NGY4ZWM4NDIwNjdhODQ4YjkyM2M2OWQyOTljNmI3NTI0YzA5NTQyOTMwNDAzMDlhMWY4ZmQzOWY3ODJkMWJkODY0M2YzMmE2NWZhMzU3MDU2ZWJkZjBkNTQ5ZTIwZjBmMWEwNTZlODEyNjM4MjM5NmM5ZmQ1NGMzYWFlOWQ4MjhjNmY1NWU3M2EyYzY0NTlhMDJkNTUyNGVhMjM0YzIwZDllZWY0NmQxNWZlZGJhNWJmOTVlNmJiODMwZmFjZGNhYWUxNzA2ZmNhNjE4MGJkYjAwMzVhOTNlMjRkNTc1NGY3ZDJmOGMzMzU4YmJhYmFlODlkYjMyOWJmMzYzZGYwYzE0OGM1OWFhZWVmNGNkZmZiZDg3OTA5MDMwNTRkNmI1NGFiZjJmOTM1N2VkYTBlNGZmMzFhYjA3MTdlZDRmYmJjMWY1NDY5NTg0NDRhOWMxNTMwZGIxOTgzOTQ1Y2ExZjg4OTcwZWU3Y2UwYjA3NzU4NTEwYThkMWIyYzcwNDVmN2UwYzQxMjIxMjQ0ZDg3NTE4YmZiMTE5ZjBjMGIyYTIxMmQ1NzY1N2NkNDNhZjVhYmM0NGQ5OTU3NTkxOTExYmRlYWY2Mjc5ZDQzYTE5NzIxMzg4NTJkM2RlYjgxZTAxOGNmZDJiZWM0MTIwYjFhZWYyNGQ1NmUzMWMyY2FlNmE3Yzg4YmQxMzliNDQwMzAxNTY3MmU2YjhkNTNmMjhkMjMzZmIwNmRjNWRmNjdlYjY1MTllOWU0NGVkOTBlNGJiZmI4YjU3NmM5YWZhN2RkZmFiMTdhZjIxOWJmODEzNWRlMWY4ZTZmYTNmZjQ2ZTFhYWM5NjlhZmMxZjRjNTYyNWQwYzYwNzU0ZmMxYmJjMzRhZDYzZTU4YTRmN2JlOTc1NjZmNDEzOWE5YTRiYmYwYmIxM2RhOWIxMzQ0MDE5ZWVmMDgzYmIwNTVhMmZlMTBmZmZjNzM5YTI5YWRiYmRhMzMzYjg0ZWRkZTg2YjViNzY0Mjk3ZDE5ZjBjMTc2ODk5NjdkZTAyMmExZGI5ZDE0Y2FhN2M4MDE4YjUyYzhiZTZmMzEwNzE3MzhjOWM1NzExYzkyNDIyOTEyNGRiNjIwMTExZWZlNjFjZGU5NWQ5ZmZkZDA0NDA1Nzk2NTc2NWM0YTAzMWU2ZmIyYWFhYTllZjdlMTc1MGM3NTZiZWEyYTFjYTM4ZGE1YjZkMjIzMTEzN2IwZDNkZjk0NDU4NDdhNDNlYmEzN2E2N2EwMjI5IiwKICAiY3JlZGVudGlhbF9lbmRwb2ludF91cmwiOiAiaHR0cDovL2Rldi1kaGEuaHVtYW5hLmNvbTo4ODg5L2ZpcmVzaG90cy9jcmVkZW50aWFsc0ZldGNoV2ViU2VydmljZSIsCiAgImZpbGVfcGF0aCI6ICIxNTY3XzI2MV8xNzAwMDYyNTg2NjYyNzY5MSIsCiAgImNyZWRlbnRpYWxfZmlsZV9wYXR0ZXJuIiA6ICI0MV8xNjk5MzQyNTc1Igp9", "get_view_info" : [ { "id" : 1 } ], "get_already_ingested_condition" : [ { "already_ingested" : true } ], "sort_by_columns_data" : [], "fetching_credential_inputs" : [ { "spark_credential_id" : 41, "metastore_credential_id" : null, "credential_type_id" : 15, "credential_type" : "File Content", "credential_pattern" : "41_1699342575", "metastore_credential_type_id" : null } ], "get_varchar_columns" : [], "generate_spark_configs_json" : "ewogICAgInNvbHJfYmF0Y2hfc2l6ZSI6IjEwMDAwIiwicGFyYWxsZWxfdGhyZWFkcyI6IjEwIiwiZmV0Y2hfc2l6ZSI6IjEwMDAwIgogICAgfQ==" } }, "skipLogicPattern" : "doNothing", "output_message_templates": [ { "template_group": "templates/artifact_ingestion/ingestion_flow.stg", "template_name": "spark_buffer_msg", "useIncomingData":true }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "task_status_success_msg" } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "error_template_create_msg" } ] } ] }
""2023-11-15 15:37:04.054 [Thread-2176] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_jdbc
""2023-11-15 15:37:04.059 [Thread-2176] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_jdbc
""2023-11-15 15:37:04.060 [Thread-2176] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-15 15:37:04.072 [Thread-2176] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "0289beec-3140-4e61-adff-a3d22291d8dd", "parent_id": "af56d8ab-458b-4c73-86bf-553c24550201", "bot_id": "b006ad5b-9517-4ef8-87e2-7c6dea91f146", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":17000625869931891, "initial_ts":1700062586993, "batch_id":17000625866627691, "batch_name":"Ingestion_20231115", "job_schedule_id":1567, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "2023-11-07 12:42:00.86365", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot", "KoshBot", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"b006ad5b-9517-4ef8-87e2-7c6dea91f146", "bot_name":"DBOpsBot", "process_context":"get_metadata_and_generate_almaren", "task_name":"get_metadata_and_generate_almaren", "process_id":"17000625869931891", "task_ts":1700062623807, "batch_id":"17000625866627691", "status_code_id": 6 } } ] }
""2023-11-15 15:37:04.073 [Thread-2176] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:37:04.075 [Thread-1984] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id b878e324-4b30-4eeb-9a2a-3f769c50e67c has started processing message with message_id 6595c16c-9675-4ed2-8674-08d9d8e09b79 and thread_id 2425 
""2023-11-15 15:37:04.076 [Thread-1984] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:37:04.076 [Thread-1984] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=af56d8ab-458b-4c73-86bf-553c24550201, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=ingestion_deciding, message_id=6595c16c-9675-4ed2-8674-08d9d8e09b79, task_retry_intervals_secs=[], bot_id=b006ad5b-9517-4ef8-87e2-7c6dea91f146, message_topic=nabu_2_jdbc, tags={process_id=17000625869931891, batch_id=17000625866627691, job_scheduled_user_id=Manaswini Chinthalapudi, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot, KoshBot, DBOpsBot], initial_ts=1700062586993, batch_name=Ingestion_20231115, environment=modak, job_schedule_id=1567, data_movement_id=261, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, task_dependency=true, ignore_job_termination=false}}
""2023-11-15 15:37:04.078 [Thread-2176] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:37:04.078 [Thread-2176] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:37:04.078 [Thread-2176] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot finished processing message with id af56d8ab-458b-4c73-86bf-553c24550201
""2023-11-15 15:37:04.084 [Thread-72] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id f7d73d2d-2eb8-429c-be8b-b1af129bd3da has started processing message with message_id 0289beec-3140-4e61-adff-a3d22291d8dd and thread_id 145 
""2023-11-15 15:37:04.084 [Thread-72] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:37:04.084 [Thread-72] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=af56d8ab-458b-4c73-86bf-553c24550201, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=0289beec-3140-4e61-adff-a3d22291d8dd, task_retry_intervals_secs=[], bot_id=b006ad5b-9517-4ef8-87e2-7c6dea91f146, message_topic=nabu_2_taskmonitor, tags={process_id=17000625869931891, initial_ts=1700062586993, batch_name=Ingestion_20231115, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot, KoshBot, TaskMonitorBot]}}
""2023-11-15 15:37:04.088 [Thread-1984] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
doNothing
""2023-11-15 15:37:04.089 [Thread-1984] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : true
""2023-11-15 15:37:04.096 [Thread-72] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 17000625869931891, 'DBOpsBot', 'get_metadata_and_generate_almaren', 'get_metadata_and_generate_almaren', 6 , TO_TIMESTAMP(1700062623807::double precision / 1000) ,'b006ad5b-9517-4ef8-87e2-7c6dea91f146');
""2023-11-15 15:37:04.096 [Thread-72] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id f7d73d2d-2eb8-429c-be8b-b1af129bd3da has started process logic with message_id 0289beec-3140-4e61-adff-a3d22291d8dd and thread_id 145
""2023-11-15 15:37:04.478 [Thread-72] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id f7d73d2d-2eb8-429c-be8b-b1af129bd3da has finished process logic with message_id 0289beec-3140-4e61-adff-a3d22291d8dd and thread_id 145
""2023-11-15 15:37:04.478 [Thread-72] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:37:04.478 [Thread-72] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 0289beec-3140-4e61-adff-a3d22291d8dd
""2023-11-15 15:37:04.735 [Thread-1984] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "DBOpsBot", "bot_metadata": { "message_id": "f9af8fe7-d4e3-4a83-8400-4c22ce532ac9", "parent_id": "6595c16c-9675-4ed2-8674-08d9d8e09b79", "bot_id": "b878e324-4b30-4eeb-9a2a-3f769c50e67c", "message_topic":"nabu_2_jdbc", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":17000625869931891, "initial_ts":1700062586993, "batch_id":17000625866627691, "batch_name":"Ingestion_20231115", "job_schedule_id":1567, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "2023-11-07 12:42:00.86365", "environment": "modak", "ignore_job_termination" : false, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot", "KoshBot", "DBOpsBot", "DBOpsBot" ],"task_dependency":true}, "task_retry_intervals_secs": [ ], "message_context": "spark_buffer_msg" }, "bot_tasks": [ { "task_name": "spark_buffer_msg", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "doNothingTemplate" }, "input_data": { "templateData": { "query_input" : { "target_schemadrift_flag" : [ { "nextrun_after_targetdrift" : false } ], "input_json_for_checkpoint_status" : "ewoicHJvY2Vzc0lkIjoxNzAwMDYyNTg2OTkzMTg5MSwKImRhdGFwbGFjZUlkIjo0MiwKInRhYmxlSWQiOjM3MjM0LAoiZGF0YW1vdmVtZW50SWQiOjI2MSwKImpvYlNjaGVkdWxlZFVzZXJJZCI6Ik1hbmFzd2luaSBDaGludGhhbGFwdWRpIiwKImpvYlNjaGVkdWxlSWQiOjE1NjcsCiJiYXRjaElkIjoxNzAwMDYyNTg2NjYyNzY5MSwKImxhc3RSdW5UaW1lc3RhbXAiOiIyMDIzLTExLTA3IDEyOjQyOjAwLjg2MzY1IiwKInJldHJ5TnVtIjogIjAiCn0=", "get_cdc_last_run_table" : [ { "prev_target_path" : null, "cdc_first" : true, "relative_path" : "\/261\/42\/development-db\/acuity-develop\/aaaa.parquet", "target_path" : "abfss:\/\/dataproc@idea15pisplznonprodsa2.dfs.core.windows.net\/261\/42\/development-db\/acuity-develop\/aaaa.parquet" } ], "get_cdc_type" : [ { "cdc_applied" : false, "is_primary" : false, "cdctype2" : false, "temp_path" : "17000625869931891_aaaa" } ], "generate_yeedu_metastore_credential" : "ewogICJjcmVkZW50aWFsX2lkIjogIiIsCiAgImNyZWRlbnRpYWxfdHlwZV9pZCI6ICIiLAogICJ0b2tlbiI6ICJjNjk1MDU4MmExMmI1NThhYjY0OGNkYjcyMDA4MTczYjJlODQyOGZiNTVkYWFkNzQwMTUyMjU2OTFlZWM3OGVlN2I1YzRlMzQzMTJkZWQ3MGFlNWU3ZWU0ODNiN2Q3ZWEwYzIzZTI0ZTQ1OGVkMWY1NGRhM2NjZDdkYmNmZTg3MGE2MWU1YzljNTA4N2U3ZmI2ZGMxNmI2ZjhmNWU0YmVkYTU2OTI0ZTg4NDllYjUzOWE2M2I2ZjM4YzMxODBmODY5N2RjMWNmYTYxMTIzMzEwMTk0NjRiNWI2MGI5NzliOTM2YmY1MTcxYTk5NjJjMWNhNTRmOGVjODQyMDY3YTg0OGI5MjNjNjlkMjk5YzZiNzUyNGMwOTU0MjkzMDQwMzA5YTFmOGZkMzlmNzgyZDFiZDg2NDNmMzJhNjVmYTM1NzA1NmViZGYwZDU0OWUyMGYwZjFhMDU2ZTgxMjYzODIzOTZjOWZkNTRjM2FhZTlkODI4YzZmNTVlNzNhMmM2NDU5YTAyZDU1MjRlYTIzNGMyMGQ5ZWVmNDZkMTVmZWRiYTViZjk1ZTZiYjgzMGZhY2RjYWFlMTcwNmZjYTYxODBiZGIwMDM1YTkzZTI0ZDU3NTRmN2QyZjhjMzM1OGJiYWJhZTg5ZGIzMjliZjM2M2RmMGMxNDhjNTlhYWVlZjRjZGZmYmQ4NzkwOTAzMDU0ZDZiNTRhYmYyZjkzNTdlZGEwZTRmZjMxYWIwNzE3ZWQ0ZmJiYzFmNTQ2OTU4NDQ0YTljMTUzMGRiMTk4Mzk0NWNhMWY4ODk3MGVlN2NlMGIwNzc1ODUxMGE4ZDFiMmM3MDQ1ZjdlMGM0MTIyMTI0NGQ4NzUxOGJmYjExOWYwYzBiMmEyMTJkNTc2NTdjZDQzYWY1YWJjNDRkOTk1NzU5MTkxMWJkZWFmNjI3OWQ0M2ExOTcyMTM4ODUyZDNkZWI4MWUwMThjZmQyYmVjNDEyMGIxYWVmMjRkNTZlMzFjMmNhZTZhN2M4OGJkMTM5YjQ0MDMwMTU2NzJlNmI4ZDUzZjI4ZDIzM2ZiMDZkYzVkZjY3ZWI2NTE5ZTllNDRlZDkwZTRiYmZiOGI1NzZjOWFmYTdkZGZhYjE3YWYyMTliZjgxMzVkZTFmOGU2ZmEzZmY0NmUxYWFjOTY5YWZjMWY0YzU2MjVkMGM2MDc1NGZjMWJiYzM0YWQ2M2U1OGE0ZjdiZTk3NTY2ZjQxMzlhOWE0YmJmMGJiMTNkYTliMTM0NDAxOWVlZjA4M2JiMDU1YTJmZTEwZmZmYzczOWEyOWFkYmJkYTMzM2I4NGVkZGU4NmI1Yjc2NDI5N2QxOWYwYzE3Njg5OTY3ZGUwMjJhMWRiOWQxNGNhYTdjODAxOGI1MmM4YmU2ZjMxMDcxNzM4YzljNTcxMWM5MjQyMjkxMjRkYjYyMDExMWVmZTYxY2RlOTVkOWZmZGQwNDQwNTc5NjU3NjVjNGEwMzFlNmZiMmFhYWE5ZWY3ZTE3NTBjNzU2YmVhMmExY2EzOGRhNWI2ZDIyMzExMzdiMGQzZGY5NDQ1ODQ3YTQzZWJhMzdhNjdhMDIyOSIsCiAgImNyZWRlbnRpYWxfZW5kcG9pbnRfdXJsIjogImh0dHA6Ly9kZXYtZGhhLmh1bWFuYS5jb206ODg4OS9maXJlc2hvdHMvY3JlZGVudGlhbHNGZXRjaFdlYlNlcnZpY2UiCn0=", "table_metadata_output" : [ { "end_point" : "http:\/\/dev-dha.humana.com:8889\/fireshots\/credentialsFetchWebService", "is_filesystem_credential_type_aws" : true, "table_name" : "aaaa", "s3_bucket" : null, "path" : "", "is_lazy_mode" : false, "destination_type" : "adls_gen2", "archive_files_path" : "", "rename_table_condition" : false, "adls_gen2_directory_name" : null, "is_archive_data" : false, "destination_db" : null, "bucket_name" : null, "source_type" : "sql_server", "credential_pattern" : "2_1686574260", "is_destination_hive" : false, "estimated_rows" : 4914, "destination_file_format" : "parquet", "warehouse_name" : null, "filesystem_credential_type" : null, "is_aws_iam_attached_to_ec2_instance" : false, "is_bigquery" : false, "is_source_filetype" : false, "source_jdbc_url" : "jdbc:sqlserver:\/\/hyp-acu-development-5de0.database.windows.net:1433;database=development-db;sslProtocol=TLSv1.2;encrypt=true", "flow_number" : 1, "batch_id" : 17000625866627691, "destination_url" : null, "filesystem_credential_type_id" : null, "schema_drift_flag" : false, "is_mysql" : false, "filesystem_credential_id" : null, "destination_directory" : null, "source_credential_type_id" : 1, "destination_backup_table_name" : "aaaa", "destination_table_name" : "aaaa", "destination_dataplace_sub_component_id" : 18, "is_azure_oauth" : false, "gcs_bucket" : null, "source_directory" : null, "is_file_system_type_s3a" : false, "destination_schema_directory_id" : 3, "intermediate_type" : "parquet", "is_source_jdbc_url" : true, "is_source_spark_hive" : false, "batch_name" : "Ingestion_20231115", "source_endpoint" : "s3.amazonaws.com", "upper_case_destination_table_name" : "AAAA", "source_credential_id" : 37, "destination_credential_type_id" : 5, "adls_gen2_container" : "dataproc", "source_default_credential_exists" : false, "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDYyNjA0ODY3ODczNSwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0NTQwNSwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2MjYwNH0.TdlKYjNFZRULplibTKTBiTeNTShCsDicocUZq9KQkMiynWn2WsDoCNVj1Gnby5Zevba71EIlyJc7hK0-wksFFLDOu-AutbS3q-JSjcWr7zHFmWQ3NR6Xs_ycLsdTfh9HnCPt4R-GHKm9SOS5CzT6JBg08gb9cZtV2havzmaG4v9vckfKagGuftWnBKcsQNp2h9zB_EDYLVdDOUd_Aa8UHMklrT8W0SjKoDgbHVZ5T506nwQL-nXZYY0_YHP9KqDtPRiRq-k6db434A4pMx6BkTAG1z355WIuqa1fwRtrSB5HZQULpX85KD8FMpbt2gBBHWDn01TnO5_crpf0lv-SfQ", "project" : null, "source_table_name" : "aaaa", "table_id" : 37234, "authentication_type" : "auth_token", "source_url" : null, "destination_endpoint" : "s3.amazonaws.com", "schema_id" : 453, "datamovement_engine_type" : "Spark", "relative_file_path" : "", "filesystem_credential_epoch" : null, "is_needed_partition_name_without_column_name" : false, "table_suffix" : "", "schema_name" : "acuity-develop", "is_record_process_enabled" : true, "is_default" : false, "is_jdbcmode" : false, "table_timestamp" : "", "verification_threshold" : 0.1, "pipeline_flow_timeout" : 23, "dest_default_credential_exists" : false, "process_id" : 17000625869931891, "is_destination_file" : true, "where_condition" : "37234", "source_dataplace_id" : 42, "file_system_type" : "abfss", "is_ingestion_root_path" : false, "is_source_hive" : false, "destination_oracle_jdbc_url" : null, "schema_drift_option" : "drop_create_table", "ingestion_table_format" : "", "already_ingested" : true, "destination_dataplace_id" : 5, "destination_credential_id" : 2, "file_format" : "", "create_backup_table" : null, "destination_dataplace_component_type_id" : 3, "source_jdbc_driver" : "com.microsoft.sqlserver.jdbc.SQLServerDriver", "destination_schema_name" : "dataproc", "source_db" : "development-db", "apply_transformation" : false, "target_type" : "adls_gen2", "oracle_jdbc_url" : null, "destination_schema_id" : 3, "dataplace_id" : 42, "filesystem_endpoint" : null, "is_spark_hive" : false, "destination_jdbc_driver" : null, "data_movement_id" : 261, "storage_account" : "idea15pisplznonprodsa2", "is_relative_file_path" : false, "is_create_table" : false, "is_apache_jdbc_driver" : false } ], "get_cdc_audit_cols" : [], "get_list_of_maps_of_partition_columns" : [ { "?column?" : "null" } ], "get_cdc_info" : [ { "job_id_column_name" : "process_id", "prev_job_id_column_name" : "prev_process_id", "is_sha2" : false, "add_audit_columns" : false, "end_date_column_name" : "valid_to_ts", "create_view" : false, "start_date_column_name" : "valid_from_ts", "hash_type" : "", "view_name" : "v_aaaa" } ], "get_spark_configs" : [ { "cluster_id" : null, "config_json" : { "extra_configs" : {}, "default_configs" : { "solr_batch_size" : "10000", "parallel_threads" : "10", "fetch_size" : "10000" } }, "spark_configuration_type_id" : 1, "spark_configs_json" : "{\n \"solr_batch_size\":\"10000\",\"parallel_threads\":\"10\",\"fetch_size\":\"10000\"\n }", "compute_engine_id" : 11, "extra_configs_json" : { "spark.nabu.fetch_size" : "10000", "spark.nabu.solr_batch_size" : "10000" } } ], "advanced_options_tables_flags_status" : [ { "columns_options" : false, "cdc" : null, "sort_by_columns" : false, "incremental_load" : false, "parallel_ingestion" : false, "remove_duplicates" : false, "virtual_column" : false, "reorder_columns" : false, "modified_columns" : false, "ingestion_mode" : true, "enable_cache" : false, "ingest_using_query" : false, "new_table_name" : false, "excluded_column_ids" : false, "table_partitions" : false } ], "yeedu_input_json" : "ewoiY2x1c3Rlcl9pZCI6ICIiLAoiYjY0X2lucHV0X2pzb24iOiAiZXdvaWNISnZZMlZ6YzBsa0lqb3hOekF3TURZeU5UZzJPVGt6TVRnNU1Td0tJbVJoZEdGd2JHRmpaVWxrSWpvME1pd0tJblJoWW14bFNXUWlPak0zTWpNMExBb2laR0YwWVcxdmRtVnRaVzUwU1dRaU9qSTJNU3dLSW1wdllsTmphR1ZrZFd4bFpGVnpaWEpKWkNJNklrMWhibUZ6ZDJsdWFTQkRhR2x1ZEdoaGJHRndkV1JwSWl3S0ltcHZZbE5qYUdWa2RXeGxTV1FpT2pFMU5qY3NDaUppWVhSamFFbGtJam94TnpBd01EWXlOVGcyTmpZeU56WTVNU3dLSW14aGMzUlNkVzVVYVcxbGMzUmhiWEFpT2lJeU1ESXpMVEV4TFRBM0lERXlPalF5T2pBd0xqZzJNelkxSWl3S0luSmxkSEo1VG5WdElqb2dJakFpQ24wPSIsCiJleHRyYV9jb25maWciOiAiZXdvaVpYaDBjbUZEYjI1bWFXZE5ZWEFpT2lCN0luTndZWEpyTG01aFluVXVabVYwWTJoZmMybDZaU0k2SUNJeE1EQXdNQ0lzSUNKemNHRnlheTV1WVdKMUxtTnZiWEIxZEdWZlpXNW5hVzVsSWpvZ0ltRjZkWEpsWDJSaGRHRmljbWxqYTNNaUxDQWljM0JoY21zdWJtRmlkUzV6YjJ4eVgySmhkR05vWDNOcGVtVWlPaUFpTVRBd01EQWlMQ0FpYzNCaGNtc3VibUZpZFM1aGNIQnNhV05oZEdsdmJsOXVZVzFsSWpvZ0ltNWhZblV0YzNCaGNtdGliM1F0YVc1blpYTjBhVzl1SWl3Z0luTndZWEpyTG1SeWFYWmxjaTV1WVdKMVgzQnlhWFpoZEdWTFpYa2lPaUFpTDJSaVpuTXZkRzF3TDJSbGRpOXVZV0oxTHpFM01EQXdOakkxT0RZNU9UTXhPRGt4THpBdmNISnBkbUYwWlV0bGVTSXNJQ0p6Y0dGeWF5NWtjbWwyWlhJdWMyOTFjbU5sWDJGM2MxOWxibVJRYjJsdWRDSTZJQ0p6TXk1aGJXRjZiMjVoZDNNdVkyOXRJaXdnSW5Od1lYSnJMbVJ5YVhabGNpNTBZWEpuWlhSZllYZHpYMlZ1WkZCdmFXNTBJam9nSW5NekxtRnRZWHB2Ym1GM2N5NWpiMjBpTENBaWMzQmhjbXN1Ym1GaWRTNWpiMjF3ZFhSbFgyVnVaMmx1WlY5c2FXSnpYM0JoZEdnaU9pQWlMMlJpWm5NdmRHMXdMMlJsZGk5dVlXSjFMekUzTURBd05qSTFPRFk1T1RNeE9Ea3hMekF2WVhCd2JHbGpZWFJwYjI0dVkyOXVaaUo5Q24wPSIsCiJjb21wdXRlX2VuZ19jcmVkc19qc29uIiA6ICJld29nSUNKamNtVmtaVzUwYVdGc1gybGtJam9nSWpReElpd0tJQ0FpWTNKbFpHVnVkR2xoYkY5MGVYQmxYMmxrSWpvZ0lqRTFJaXdLSUNBaVkzSmxaR1Z1ZEdsaGJGOTBlWEJsSWpvZ0lrWnBiR1VnUTI5dWRHVnVkQ0lzQ2lBZ0luUnZhMlZ1SWpvZ0ltTTJPVFV3TlRneVlURXlZalUxT0dGaU5qUTRZMlJpTnpJd01EZ3hOek5pTW1VNE5ESTRabUkxTldSaFlXUTNOREF4TlRJeU5UWTVNV1ZsWXpjNFpXVTNZalZqTkdVek5ETXhNbVJsWkRjd1lXVTFaVGRsWlRRNE0ySTNaRGRsWVRCak1qTmxNalJsTkRVNFpXUXhaalUwWkdFelkyTmtOMlJpWTJabE9EY3dZVFl4WlRWak9XTTFNRGczWlRkbVlqWmtZekUyWWpabU9HWTFaVFJpWldSaE5UWTVNalJsT0RnME9XVmlOVE01WVRZellqWm1NemhqTXpFNE1HWTROamszWkdNeFkyWmhOakV4TWpNek1UQXhPVFEyTkdJMVlqWXdZamszT1dJNU16WmlaalV4TnpGaE9UazJNbU14WTJFMU5HWTRaV000TkRJd05qZGhPRFE0WWpreU0yTTJPV1F5T1Rsak5tSTNOVEkwWXpBNU5UUXlPVE13TkRBek1EbGhNV1k0Wm1Rek9XWTNPREprTVdKa09EWTBNMll6TW1FMk5XWmhNelUzTURVMlpXSmtaakJrTlRRNVpUSXdaakJtTVdFd05UWmxPREV5TmpNNE1qTTVObU01Wm1RMU5HTXpZV0ZsT1dRNE1qaGpObVkxTldVM00yRXlZelkwTlRsaE1ESmtOVFV5TkdWaE1qTTBZekl3WkRsbFpXWTBObVF4TldabFpHSmhOV0ptT1RWbE5tSmlPRE13Wm1GalpHTmhZV1V4TnpBMlptTmhOakU0TUdKa1lqQXdNelZoT1RObE1qUmtOVGMxTkdZM1pESm1PR016TXpVNFltSmhZbUZsT0Rsa1lqTXlPV0ptTXpZelpHWXdZekUwT0dNMU9XRmhaV1ZtTkdOa1ptWmlaRGczT1RBNU1ETXdOVFJrTm1JMU5HRmlaakptT1RNMU4yVmtZVEJsTkdabU16RmhZakEzTVRkbFpEUm1ZbUpqTVdZMU5EWTVOVGcwTkRSaE9XTXhOVE13WkdJeE9UZ3pPVFExWTJFeFpqZzRPVGN3WldVM1kyVXdZakEzTnpVNE5URXdZVGhrTVdJeVl6Y3dORFZtTjJVd1l6UXhNakl4TWpRMFpEZzNOVEU0WW1aaU1URTVaakJqTUdJeVlUSXhNbVExTnpZMU4yTmtORE5oWmpWaFltTTBOR1E1T1RVM05Ua3hPVEV4WW1SbFlXWTJNamM1WkRRellURTVOekl4TXpnNE5USmtNMlJsWWpneFpUQXhPR05tWkRKaVpXTTBNVEl3WWpGaFpXWXlOR1ExTm1Vek1XTXlZMkZsTm1FM1l6ZzRZbVF4TXpsaU5EUXdNekF4TlRZM01tVTJZamhrTlRObU1qaGtNak16Wm1Jd05tUmpOV1JtTmpkbFlqWTFNVGxsT1dVME5HVmtPVEJsTkdKaVptSTRZalUzTm1NNVlXWmhOMlJrWm1GaU1UZGhaakl4T1dKbU9ERXpOV1JsTVdZNFpUWm1ZVE5tWmpRMlpURmhZV001TmpsaFptTXhaalJqTlRZeU5XUXdZell3TnpVMFptTXhZbUpqTXpSaFpEWXpaVFU0WVRSbU4ySmxPVGMxTmpabU5ERXpPV0U1WVRSaVltWXdZbUl4TTJSaE9XSXhNelEwTURFNVpXVm1NRGd6WW1Jd05UVmhNbVpsTVRCbVptWmpOek01WVRJNVlXUmlZbVJoTXpNellqZzBaV1JrWlRnMllqVmlOelkwTWprM1pERTVaakJqTVRjMk9EazVOamRrWlRBeU1tRXhaR0k1WkRFMFkyRmhOMk00TURFNFlqVXlZemhpWlRabU16RXdOekUzTXpoak9XTTFOekV4WXpreU5ESXlPVEV5TkdSaU5qSXdNVEV4WldabE5qRmpaR1U1TldRNVptWmtaREEwTkRBMU56azJOVGMyTldNMFlUQXpNV1UyWm1JeVlXRmhZVGxsWmpkbE1UYzFNR00zTlRaaVpXRXlZVEZqWVRNNFpHRTFZalprTWpJek1URXpOMkl3WkROa1pqazBORFU0TkRkaE5ETmxZbUV6TjJFMk4yRXdNakk1SWl3S0lDQWlZM0psWkdWdWRHbGhiRjlsYm1Sd2IybHVkRjkxY213aU9pQWlhSFIwY0RvdkwyUmxkaTFrYUdFdWFIVnRZVzVoTG1OdmJUbzRPRGc1TDJacGNtVnphRzkwY3k5amNtVmtaVzUwYVdGc2MwWmxkR05vVjJWaVUyVnlkbWxqWlNJc0NpQWdJbVpwYkdWZmNHRjBhQ0k2SUNJeE5UWTNYekkyTVY4eE56QXdNRFl5TlRnMk5qWXlOelk1TVNJc0NpQWdJbU55WldSbGJuUnBZV3hmWm1sc1pWOXdZWFIwWlhKdUlpQTZJQ0kwTVY4eE5qazVNelF5TlRjMUlncDkiLAoiY2x1c3Rlcl91aSI6ICIiLAoicmV0cnlfbnVtIjogIjAiLAoic3BhcmtfY29uZmlncyI6ICJld29nSUNBZ0luTnZiSEpmWW1GMFkyaGZjMmw2WlNJNklqRXdNREF3SWl3aWNHRnlZV3hzWld4ZmRHaHlaV0ZrY3lJNklqRXdJaXdpWm1WMFkyaGZjMmw2WlNJNklqRXdNREF3SWdvZ0lDQWdmUT09IiwKImI2NF9oaXZlX2NyZWRzX2pzb24iOiAiZXdvZ0lDSmpjbVZrWlc1MGFXRnNYMmxrSWpvZ0lpSXNDaUFnSW1OeVpXUmxiblJwWVd4ZmRIbHdaVjlwWkNJNklDSWlMQW9nSUNKMGIydGxiaUk2SUNKak5qazFNRFU0TW1FeE1tSTFOVGhoWWpZME9HTmtZamN5TURBNE1UY3pZakpsT0RReU9HWmlOVFZrWVdGa056UXdNVFV5TWpVMk9URmxaV00zT0dWbE4ySTFZelJsTXpRek1USmtaV1EzTUdGbE5XVTNaV1UwT0ROaU4yUTNaV0V3WXpJelpUSTBaVFExT0dWa01XWTFOR1JoTTJOalpEZGtZbU5tWlRnM01HRTJNV1UxWXpsak5UQTROMlUzWm1JMlpHTXhObUkyWmpobU5XVTBZbVZrWVRVMk9USTBaVGc0TkRsbFlqVXpPV0UyTTJJMlpqTTRZek14T0RCbU9EWTVOMlJqTVdObVlUWXhNVEl6TXpFd01UazBOalJpTldJMk1HSTVOemxpT1RNMlltWTFNVGN4WVRrNU5qSmpNV05oTlRSbU9HVmpPRFF5TURZM1lUZzBPR0k1TWpOak5qbGtNams1WXpaaU56VXlOR013T1RVME1qa3pNRFF3TXpBNVlURm1PR1prTXpsbU56Z3laREZpWkRnMk5ETm1NekpoTmpWbVlUTTFOekExTm1WaVpHWXdaRFUwT1dVeU1HWXdaakZoTURVMlpUZ3hNall6T0RJek9UWmpPV1prTlRSak0yRmhaVGxrT0RJNFl6Wm1OVFZsTnpOaE1tTTJORFU1WVRBeVpEVTFNalJsWVRJek5HTXlNR1E1WldWbU5EWmtNVFZtWldSaVlUVmlaamsxWlRaaVlqZ3pNR1poWTJSallXRmxNVGN3Tm1aallUWXhPREJpWkdJd01ETTFZVGt6WlRJMFpEVTNOVFJtTjJReVpqaGpNek0xT0dKaVlXSmhaVGc1WkdJek1qbGlaak0yTTJSbU1HTXhORGhqTlRsaFlXVmxaalJqWkdabVltUTROemt3T1RBek1EVTBaRFppTlRSaFltWXlaamt6TlRkbFpHRXdaVFJtWmpNeFlXSXdOekUzWldRMFptSmlZekZtTlRRMk9UVTRORFEwWVRsak1UVXpNR1JpTVRrNE16azBOV05oTVdZNE9EazNNR1ZsTjJObE1HSXdOemMxT0RVeE1HRTRaREZpTW1NM01EUTFaamRsTUdNME1USXlNVEkwTkdRNE56VXhPR0ptWWpFeE9XWXdZekJpTW1FeU1USmtOVGMyTlRkalpEUXpZV1kxWVdKak5EUmtPVGsxTnpVNU1Ua3hNV0prWldGbU5qSTNPV1EwTTJFeE9UY3lNVE00T0RVeVpETmtaV0k0TVdVd01UaGpabVF5WW1Wak5ERXlNR0l4WVdWbU1qUmtOVFpsTXpGak1tTmhaVFpoTjJNNE9HSmtNVE01WWpRME1ETXdNVFUyTnpKbE5tSTRaRFV6WmpJNFpESXpNMlppTURaa1l6VmtaalkzWldJMk5URTVaVGxsTkRSbFpEa3daVFJpWW1aaU9HSTFOelpqT1dGbVlUZGtaR1poWWpFM1lXWXlNVGxpWmpneE16VmtaVEZtT0dVMlptRXpabVkwTm1VeFlXRmpPVFk1WVdaak1XWTBZelUyTWpWa01HTTJNRGMxTkdaak1XSmlZek0wWVdRMk0yVTFPR0UwWmpkaVpUazNOVFkyWmpReE16bGhPV0UwWW1KbU1HSmlNVE5rWVRsaU1UTTBOREF4T1dWbFpqQTRNMkppTURVMVlUSm1aVEV3Wm1abVl6Y3pPV0V5T1dGa1ltSmtZVE16TTJJNE5HVmtaR1U0Tm1JMVlqYzJOREk1TjJReE9XWXdZekUzTmpnNU9UWTNaR1V3TWpKaE1XUmlPV1F4TkdOaFlUZGpPREF4T0dJMU1tTTRZbVUyWmpNeE1EY3hOek00WXpsak5UY3hNV001TWpReU1qa3hNalJrWWpZeU1ERXhNV1ZtWlRZeFkyUmxPVFZrT1dabVpHUXdORFF3TlRjNU5qVTNOalZqTkdFd016RmxObVppTW1GaFlXRTVaV1kzWlRFM05UQmpOelUyWW1WaE1tRXhZMkV6T0dSaE5XSTJaREl5TXpFeE16ZGlNR1F6WkdZNU5EUTFPRFEzWVRRelpXSmhNemRoTmpkaE1ESXlPU0lzQ2lBZ0ltTnlaV1JsYm5ScFlXeGZaVzVrY0c5cGJuUmZkWEpzSWpvZ0ltaDBkSEE2THk5a1pYWXRaR2hoTG1oMWJXRnVZUzVqYjIwNk9EZzRPUzltYVhKbGMyaHZkSE12WTNKbFpHVnVkR2xoYkhOR1pYUmphRmRsWWxObGNuWnBZMlVpQ24wPSIsCiJiYXRjaF9pZCI6MTcwMDA2MjU4NjY2Mjc2OTEsCiJwcm9jZXNzX2lkIiA6MTcwMDA2MjU4Njk5MzE4OTEsCiJyZXN0X3VybCI6ICIiLAoiYjY0X2V4dGVybmFsX2phcnNfbWFwIiA6ICIiCn0=", "ingestion_mode" : [ { "mode" : "overwrite", "save_mode" : "Overwrite", "data_movement_id" : 261, "ingestion_mode_key" : true, "drop_create_condition" : true } ], "generate_extra_configs_json" : "ewoiZXh0cmFDb25maWdNYXAiOiB7InNwYXJrLm5hYnUuZmV0Y2hfc2l6ZSI6ICIxMDAwMCIsICJzcGFyay5uYWJ1LmNvbXB1dGVfZW5naW5lIjogImF6dXJlX2RhdGFicmlja3MiLCAic3BhcmsubmFidS5zb2xyX2JhdGNoX3NpemUiOiAiMTAwMDAiLCAic3BhcmsubmFidS5hcHBsaWNhdGlvbl9uYW1lIjogIm5hYnUtc3Bhcmtib3QtaW5nZXN0aW9uIiwgInNwYXJrLmRyaXZlci5uYWJ1X3ByaXZhdGVLZXkiOiAiL2RiZnMvdG1wL2Rldi9uYWJ1LzE3MDAwNjI1ODY5OTMxODkxLzAvcHJpdmF0ZUtleSIsICJzcGFyay5kcml2ZXIuc291cmNlX2F3c19lbmRQb2ludCI6ICJzMy5hbWF6b25hd3MuY29tIiwgInNwYXJrLmRyaXZlci50YXJnZXRfYXdzX2VuZFBvaW50IjogInMzLmFtYXpvbmF3cy5jb20iLCAic3BhcmsubmFidS5jb21wdXRlX2VuZ2luZV9saWJzX3BhdGgiOiAiL2RiZnMvdG1wL2Rldi9uYWJ1LzE3MDAwNjI1ODY5OTMxODkxLzAvYXBwbGljYXRpb24uY29uZiJ9Cn0=", "incremental_load_details" : [ { "?column?" : 1 } ], "place_holders_with_default_and_max_values" : [ { "?column?" : 1 } ], "incremental_max_columns_with_column_ids" : [ { "?column?" : 1 } ], "remove_duplicates_data" : [], "cdc_first_time" : [ { "cdc_first_time" : true } ], "generate_base64_pipeline_timeout_json" : "ewoicGlwZWxpbmVfdGltZW91dCIgOiAyMwp9", "table_partition_output" : [], "fetch_source_type" : [ { "is_source_filetype" : false, "is_destination_redshift" : false, "data_movement_id" : 261, "source_metadata_category" : "relational", "destination" : "adls_gen2", "is_source_salesforce" : false, "is_destination_filetype" : true, "source" : "sql_server", "is_source_mongodb" : false, "is_ordinalpos_startwith_zero" : false, "destination_metadata_category" : "file" } ], "destination_transformation_query_details_output" : [ { "is_virtual" : false, "data_precision" : 0, "is_nullable" : false, "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "table_id" : 37234, "is_precision_scale" : true, "table_name" : "aaaa", "intermediate_datatype_name" : "string", "is_mysql" : false, "is_source_hive" : false, "is_partitioned_col" : false, "ingested_colorder" : 1, "user_text" : null, "field_name_replaced" : "entity_id", "is_long_col_name" : false, "is_oracle_destination" : false, "data_length" : 255, "destination_datatype_name" : "string", "column_name" : "entity_id", "source_type" : "sql_server", "schema_name" : "acuity-develop", "is_source_casting_enabled" : false, "is_varchar" : false, "field_name" : "entity_id", "column_id" : 956158, "source_cast_type" : "AsIs", "ordinal_position" : 1, "source_datatype_name" : "varchar", "is_cdc_col" : false, "data_scale" : 0, "replaced_column_name" : "entity_id", "data_type" : "varchar", "is_bigquery" : false, "is_precision" : true, "is_redshift_relational_destination" : false, "source_stg_function" : "AsIs", "istimezone" : false }, { "is_virtual" : false, "data_precision" : 0, "is_nullable" : false, "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "table_id" : 37234, "is_precision_scale" : true, "table_name" : "aaaa", "intermediate_datatype_name" : "string", "is_mysql" : false, "is_source_hive" : false, "is_partitioned_col" : false, "ingested_colorder" : 2, "user_text" : null, "field_name_replaced" : "entity_type", "is_long_col_name" : false, "is_oracle_destination" : false, "data_length" : 255, "destination_datatype_name" : "string", "column_name" : "entity_type", "source_type" : "sql_server", "schema_name" : "acuity-develop", "is_source_casting_enabled" : false, "is_varchar" : false, "field_name" : "entity_type", "column_id" : 956159, "source_cast_type" : "AsIs", "ordinal_position" : 2, "source_datatype_name" : "varchar", "is_cdc_col" : false, "data_scale" : 0, "replaced_column_name" : "entity_type", "data_type" : "varchar", "is_bigquery" : false, "is_precision" : true, "is_redshift_relational_destination" : false, "source_stg_function" : "AsIs", "istimezone" : false } ], "get_varchar_columns_destination" : [], "input_data" : { "flow_number" : 1, "process_id" : 17000625869931891, "source_database_name_lowercase" : "development-db", "batch_id" : 17000625866627691, "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDYyNjA0ODY3ODczNSwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0NTQwNSwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2MjYwNH0.TdlKYjNFZRULplibTKTBiTeNTShCsDicocUZq9KQkMiynWn2WsDoCNVj1Gnby5Zevba71EIlyJc7hK0-wksFFLDOu-AutbS3q-JSjcWr7zHFmWQ3NR6Xs_ycLsdTfh9HnCPt4R-GHKm9SOS5CzT6JBg08gb9cZtV2havzmaG4v9vckfKagGuftWnBKcsQNp2h9zB_EDYLVdDOUd_Aa8UHMklrT8W0SjKoDgbHVZ5T506nwQL-nXZYY0_YHP9KqDtPRiRq-k6db434A4pMx6BkTAG1z355WIuqa1fwRtrSB5HZQULpX85KD8FMpbt2gBBHWDn01TnO5_crpf0lv-SfQ", "end_point" : "http:\/\/dev-dha.humana.com:8889\/fireshots\/credentialsFetchWebService", "where_condition" : "37234", "suffix" : "", "reorder_columns" : [], "job_type_id" : "1", "ingestion_table_format" : "", "job_schedule_id" : 1567, "relative_file_path" : "", "retry_attempt" : "0", "source_schema_name_lowercase" : "acuity-develop", "variables" : { "env_variables" : {}, "user_variables" : {}, "payload_variables" : {} }, "source_database_name_uppercase" : "DEVELOPMENT-DB", "job_scheduled_user_id" : "Manaswini Chinthalapudi", "virtual_column" : [], "new_table_for_rename" : "", "source_schema_name_uppercase" : "ACUITY-DEVELOP", "batch_name" : "Ingestion_20231115", "modified_columns" : [], "source_database_name" : "development-db", "data_movement_id" : 261, "last_run_timestamp" : "2023-11-07 12:42:00.86365", "is_relative_file_path" : false }, "table_adv_opt_details" : [ { "dataplace_id" : 42, "cru_ts" : "2023-11-15 09:31:16.466337", "data_movement_id" : 261, "valid_to_ts" : "9999-12-31 00:00:00.0", "advance_option_details" : { "advanced_table_options" : { "columns_options" : { "modified_columns" : [], "virtual_column" : [], "excluded_column_ids" : [] }, "CDC" : { "audit_columns" : { "prev_process_id_column_name" : "prev_process_id", "end_date_column_name" : "valid_to_ts", "process_id_column_name" : "process_id", "start_date_column_name" : "valid_from_ts" }, "CDC_process_type" : "", "add_audit_columns" : false, "columns_ids" : [], "CDC_type" : "", "create_view" : false, "hash_type" : "", "view_name" : "v_aaaa" }, "sort_by_columns" : [], "incremental_load" : { "condition_values" : [], "where_clause" : "" }, "parallel_ingestion" : { "max_connections" : 1, "enable" : false }, "remove_duplicates" : { "sort_columns" : [], "key_columns" : [] }, "table_id" : 37234, "reorder_columns" : [], "table_name" : "aaaa", "parallel_hash_ingestion" : { "max_connections" : 8, "enable" : false }, "dataplace_id" : 42, "ingestion_mode" : { "mode" : "Drop & Re-create", "enable" : true }, "enable_cache" : { "enable" : false }, "ingest_using_query" : { "enable" : false, "sql_query" : "" }, "schema_id" : 453, "new_table_name" : "", "table_partitions" : [] }, "advanced_option_flags" : { "columns_options" : false, "CDC" : false, "sort_by_columns" : false, "incremental_load" : false, "parallel_ingestion" : false, "remove_duplicates" : false, "virtual_column" : false, "table_id" : 37234, "reorder_columns" : false, "table_name" : "aaaa", "parallel_hash_ingestion" : false, "dataplace_id" : 42, "modified_columns" : false, "ingestion_mode" : true, "enable_cache" : false, "ingest_using_query" : false, "schema_id" : 453, "new_table_name" : false, "excluded_column_ids" : false, "table_partitions" : false } }, "valid_from_ts" : "2023-11-15 09:31:16.466337", "cru_by" : "Venkata Yeedi", "object_id" : 37234 } ], "check_compute_engine_validity" : [ { "is_valid_compute_engine" : true } ], "get_non_partition_cols" : [ { "is_virtual" : false, "data_precision" : "0", "destination_datatype_name" : "string", "is_auditcol" : false, "data_length" : "255", "column_name" : "entity_id", "source_field_name" : "entity_id", "field_name" : "entity_id", "column_id" : "956158", "source_datatype_name" : "varchar", "is_partitioned_col" : false, "data_scale" : "0", "ingested_colorder" : 1 }, { "is_virtual" : false, "data_precision" : "0", "destination_datatype_name" : "string", "is_auditcol" : false, "data_length" : "255", "column_name" : "entity_type", "source_field_name" : "entity_type", "field_name" : "entity_type", "column_id" : "956159", "source_datatype_name" : "varchar", "is_partitioned_col" : false, "data_scale" : "0", "ingested_colorder" : 2 } ], "get_partition_cols" : [], "list_of_maps_of_incremental_columns" : [ { "?column?" : 1 } ], "spark_script_inputs" : [ { "ssh_username" : "null", "ssh_host" : "null", "loggroupname" : null, "kerberos" : null, "cloud_watch" : null, "compute_engine_info" : "ewoiY2x1c3Rlcl9pZCI6IjA5MjItMDAzMTM4LW9ybjlyMHRlIiwic3BhcmtfdmVyc2lvbl92YWx1ZSI6IjNfMSIsInNjYWxhX3ZlcnNpb25fdmFsdWUiOiIyXzEyIiwiY3JlZGVudGlhbHNfZmlsZXBhdGgiOiIiLCJjbHVzdGVyX2xpYnJhcnlfcGF0aCI6Ii9kYmZzL3RtcCIsInNwYXJrX3ZlcnNpb24iOiIzLjEiLCJzY2FsYV92ZXJzaW9uIjoiMi4xMiIKfQ==", "private_key_path" : "\/dbfs\/tmp\/dev\/nabu\/17000625869931891\/0\/privateKey", "b64_external_jars_map" : null, "cluster_id" : "0922-003138-orn9r0te", "engine_sub_type" : "azure databricks", "spark_location" : "null", "dataproc_cluster" : "null", "cluster_library_path" : "\/dbfs\/tmp", "data_movement_name" : "ss_compass_adb_validation", "dataproc_project" : "null", "engine_path" : "azure_databricks", "is_bucket_encrypted" : null, "execution_role" : null, "cluster_ui" : null, "s3_bucket_path" : null, "rest_url" : null, "s3logs" : null, "cloud_type" : "null", "release_label" : null, "spark_version" : "3.1", "scala_version" : "2.12", "region" : "null" } ], "column_metadata_output" : [ { "is_virtual" : false, "data_precision" : 0, "is_nullable" : false, "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "table_id" : 37234, "is_precision_scale" : true, "table_name" : "aaaa", "intermediate_datatype_name" : "string", "is_mysql" : false, "is_source_hive" : false, "is_partitioned_col" : false, "user_text" : null, "field_name_replaced" : "entity_id", "is_long_col_name" : false, "is_oracle_destination" : false, "data_length" : 255, "destination_datatype_name" : "string", "column_name" : "entity_id", "source_type" : "sql_server", "schema_name" : "acuity-develop", "is_source_casting_enabled" : false, "is_varchar" : false, "field_name" : "entity_id", "column_id" : 956158, "source_cast_type" : "AsIs", "ordinal_position" : 1, "source_datatype_name" : "varchar", "is_cdc_col" : false, "data_scale" : 0, "replaced_column_name" : "entity_id", "data_type" : "varchar", "is_bigquery" : false, "is_precision" : true, "is_redshift_relational_destination" : false, "source_stg_function" : "AsIs", "istimezone" : false }, { "is_virtual" : false, "data_precision" : 0, "is_nullable" : false, "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "table_id" : 37234, "is_precision_scale" : true, "table_name" : "aaaa", "intermediate_datatype_name" : "string", "is_mysql" : false, "is_source_hive" : false, "is_partitioned_col" : false, "user_text" : null, "field_name_replaced" : "entity_type", "is_long_col_name" : false, "is_oracle_destination" : false, "data_length" : 255, "destination_datatype_name" : "string", "column_name" : "entity_type", "source_type" : "sql_server", "schema_name" : "acuity-develop", "is_source_casting_enabled" : false, "is_varchar" : false, "field_name" : "entity_type", "column_id" : 956159, "source_cast_type" : "AsIs", "ordinal_position" : 2, "source_datatype_name" : "varchar", "is_cdc_col" : false, "data_scale" : 0, "replaced_column_name" : "entity_type", "data_type" : "varchar", "is_bigquery" : false, "is_precision" : true, "is_redshift_relational_destination" : false, "source_stg_function" : "AsIs", "istimezone" : false } ], "updated_wherecondition_replaced_with_default_and_max_values" : [ { "?column?" : 1 } ], "cdc_schema_drift_new_table" : [ { "drift_new_table" : false } ], "emr_input_json" : "ewogICJjbHVzdGVyX2lkIjogIjA5MjItMDAzMTM4LW9ybjlyMHRlIiwKICAiY2x1c3Rlcl9yZWdpb24iOiAibnVsbCIsCiAgImNvbXB1dGVfZW5nX2NyZWRzX2pzb24iOiAiZXdvZ0lDSmpjbVZrWlc1MGFXRnNYMmxrSWpvZ0lqUXhJaXdLSUNBaVkzSmxaR1Z1ZEdsaGJGOTBlWEJsWDJsa0lqb2dJakUxSWl3S0lDQWlZM0psWkdWdWRHbGhiRjkwZVhCbElqb2dJa1pwYkdVZ1EyOXVkR1Z1ZENJc0NpQWdJblJ2YTJWdUlqb2dJbU0yT1RVd05UZ3lZVEV5WWpVMU9HRmlOalE0WTJSaU56SXdNRGd4TnpOaU1tVTROREk0Wm1JMU5XUmhZV1EzTkRBeE5USXlOVFk1TVdWbFl6YzRaV1UzWWpWak5HVXpORE14TW1SbFpEY3dZV1UxWlRkbFpUUTRNMkkzWkRkbFlUQmpNak5sTWpSbE5EVTRaV1F4WmpVMFpHRXpZMk5rTjJSaVkyWmxPRGN3WVRZeFpUVmpPV00xTURnM1pUZG1ZalprWXpFMllqWm1PR1kxWlRSaVpXUmhOVFk1TWpSbE9EZzBPV1ZpTlRNNVlUWXpZalptTXpoak16RTRNR1k0TmprM1pHTXhZMlpoTmpFeE1qTXpNVEF4T1RRMk5HSTFZall3WWprM09XSTVNelppWmpVeE56RmhPVGsyTW1NeFkyRTFOR1k0WldNNE5ESXdOamRoT0RRNFlqa3lNMk0yT1dReU9UbGpObUkzTlRJMFl6QTVOVFF5T1RNd05EQXpNRGxoTVdZNFptUXpPV1kzT0RKa01XSmtPRFkwTTJZek1tRTJOV1poTXpVM01EVTJaV0prWmpCa05UUTVaVEl3WmpCbU1XRXdOVFpsT0RFeU5qTTRNak01Tm1NNVptUTFOR016WVdGbE9XUTRNamhqTm1ZMU5XVTNNMkV5WXpZME5UbGhNREprTlRVeU5HVmhNak0wWXpJd1pEbGxaV1kwTm1ReE5XWmxaR0poTldKbU9UVmxObUppT0RNd1ptRmpaR05oWVdVeE56QTJabU5oTmpFNE1HSmtZakF3TXpWaE9UTmxNalJrTlRjMU5HWTNaREptT0dNek16VTRZbUpoWW1GbE9EbGtZak15T1dKbU16WXpaR1l3WXpFME9HTTFPV0ZoWldWbU5HTmtabVppWkRnM09UQTVNRE13TlRSa05tSTFOR0ZpWmpKbU9UTTFOMlZrWVRCbE5HWm1NekZoWWpBM01UZGxaRFJtWW1Kak1XWTFORFk1TlRnME5EUmhPV014TlRNd1pHSXhPVGd6T1RRMVkyRXhaamc0T1Rjd1pXVTNZMlV3WWpBM056VTROVEV3WVRoa01XSXlZemN3TkRWbU4yVXdZelF4TWpJeE1qUTBaRGczTlRFNFltWmlNVEU1WmpCak1HSXlZVEl4TW1RMU56WTFOMk5rTkROaFpqVmhZbU0wTkdRNU9UVTNOVGt4T1RFeFltUmxZV1kyTWpjNVpEUXpZVEU1TnpJeE16ZzROVEprTTJSbFlqZ3haVEF4T0dObVpESmlaV00wTVRJd1lqRmhaV1l5TkdRMU5tVXpNV015WTJGbE5tRTNZemc0WW1ReE16bGlORFF3TXpBeE5UWTNNbVUyWWpoa05UTm1NamhrTWpNelptSXdObVJqTldSbU5qZGxZalkxTVRsbE9XVTBOR1ZrT1RCbE5HSmlabUk0WWpVM05tTTVZV1poTjJSa1ptRmlNVGRoWmpJeE9XSm1PREV6TldSbE1XWTRaVFptWVRObVpqUTJaVEZoWVdNNU5qbGhabU14WmpSak5UWXlOV1F3WXpZd056VTBabU14WW1Kak16UmhaRFl6WlRVNFlUUm1OMkpsT1RjMU5qWm1OREV6T1dFNVlUUmlZbVl3WW1JeE0yUmhPV0l4TXpRME1ERTVaV1ZtTURnelltSXdOVFZoTW1abE1UQm1abVpqTnpNNVlUSTVZV1JpWW1SaE16TXpZamcwWldSa1pUZzJZalZpTnpZME1qazNaREU1WmpCak1UYzJPRGs1Tmpka1pUQXlNbUV4WkdJNVpERTBZMkZoTjJNNE1ERTRZalV5WXpoaVpUWm1NekV3TnpFM016aGpPV00xTnpFeFl6a3lOREl5T1RFeU5HUmlOakl3TVRFeFpXWmxOakZqWkdVNU5XUTVabVprWkRBME5EQTFOemsyTlRjMk5XTTBZVEF6TVdVMlptSXlZV0ZoWVRsbFpqZGxNVGMxTUdNM05UWmlaV0V5WVRGallUTTRaR0UxWWpaa01qSXpNVEV6TjJJd1pETmtaamswTkRVNE5EZGhORE5sWW1Fek4yRTJOMkV3TWpJNUlpd0tJQ0FpWTNKbFpHVnVkR2xoYkY5bGJtUndiMmx1ZEY5MWNtd2lPaUFpYUhSMGNEb3ZMMlJsZGkxa2FHRXVhSFZ0WVc1aExtTnZiVG80T0RnNUwyWnBjbVZ6YUc5MGN5OWpjbVZrWlc1MGFXRnNjMFpsZEdOb1YyVmlVMlZ5ZG1salpTSXNDaUFnSW1acGJHVmZjR0YwYUNJNklDSXhOVFkzWHpJMk1WOHhOekF3TURZeU5UZzJOall5TnpZNU1TSXNDaUFnSW1OeVpXUmxiblJwWVd4ZlptbHNaVjl3WVhSMFpYSnVJaUE2SUNJME1WOHhOams1TXpReU5UYzFJZ3A5IiwKICAiczNfcGF0aCI6ICIiLAogICJiNjRfaW5wdXRfanNvbiI6ICJld29pY0hKdlkyVnpjMGxrSWpveE56QXdNRFl5TlRnMk9Ua3pNVGc1TVN3S0ltUmhkR0Z3YkdGalpVbGtJam8wTWl3S0luUmhZbXhsU1dRaU9qTTNNak0wTEFvaVpHRjBZVzF2ZG1WdFpXNTBTV1FpT2pJMk1Td0tJbXB2WWxOamFHVmtkV3hsWkZWelpYSkpaQ0k2SWsxaGJtRnpkMmx1YVNCRGFHbHVkR2hoYkdGd2RXUnBJaXdLSW1wdllsTmphR1ZrZFd4bFNXUWlPakUxTmpjc0NpSmlZWFJqYUVsa0lqb3hOekF3TURZeU5UZzJOall5TnpZNU1Td0tJbXhoYzNSU2RXNVVhVzFsYzNSaGJYQWlPaUl5TURJekxURXhMVEEzSURFeU9qUXlPakF3TGpnMk16WTFJaXdLSW5KbGRISjVUblZ0SWpvZ0lqQWlDbjA9IiwKICAiZXh0cmFfY29uZmlnIjogImV3b2laWGgwY21GRGIyNW1hV2ROWVhBaU9pQjdJbk53WVhKckxtNWhZblV1Wm1WMFkyaGZjMmw2WlNJNklDSXhNREF3TUNJc0lDSnpjR0Z5YXk1dVlXSjFMbU52YlhCMWRHVmZaVzVuYVc1bElqb2dJbUY2ZFhKbFgyUmhkR0ZpY21samEzTWlMQ0FpYzNCaGNtc3VibUZpZFM1emIyeHlYMkpoZEdOb1gzTnBlbVVpT2lBaU1UQXdNREFpTENBaWMzQmhjbXN1Ym1GaWRTNWhjSEJzYVdOaGRHbHZibDl1WVcxbElqb2dJbTVoWW5VdGMzQmhjbXRpYjNRdGFXNW5aWE4wYVc5dUlpd2dJbk53WVhKckxtUnlhWFpsY2k1dVlXSjFYM0J5YVhaaGRHVkxaWGtpT2lBaUwyUmlabk12ZEcxd0wyUmxkaTl1WVdKMUx6RTNNREF3TmpJMU9EWTVPVE14T0RreEx6QXZjSEpwZG1GMFpVdGxlU0lzSUNKemNHRnlheTVrY21sMlpYSXVjMjkxY21ObFgyRjNjMTlsYm1SUWIybHVkQ0k2SUNKek15NWhiV0Y2YjI1aGQzTXVZMjl0SWl3Z0luTndZWEpyTG1SeWFYWmxjaTUwWVhKblpYUmZZWGR6WDJWdVpGQnZhVzUwSWpvZ0luTXpMbUZ0WVhwdmJtRjNjeTVqYjIwaUxDQWljM0JoY21zdWJtRmlkUzVqYjIxd2RYUmxYMlZ1WjJsdVpWOXNhV0p6WDNCaGRHZ2lPaUFpTDJSaVpuTXZkRzF3TDJSbGRpOXVZV0oxTHpFM01EQXdOakkxT0RZNU9UTXhPRGt4THpBdllYQndiR2xqWVhScGIyNHVZMjl1WmlKOUNuMD0iLAogICJiYXRjaF9pZCI6IDE3MDAwNjI1ODY2NjI3NjkxLAogICJyZXRyeV9udW0iOiAiMCIsCiAgInNwYXJrX2NvbmZpZ3MiOiAiZXdvZ0lDQWdJbk52YkhKZlltRjBZMmhmYzJsNlpTSTZJakV3TURBd0lpd2ljR0Z5WVd4c1pXeGZkR2h5WldGa2N5STZJakV3SWl3aVptVjBZMmhmYzJsNlpTSTZJakV3TURBd0lnb2dJQ0FnZlE9PSIsCiAgImlzX2J1Y2tldF9lbmNyeXB0ZWQiOiAiIiwKICAiYjY0X2V4dGVybmFsX2phcnNfbWFwIiA6ICIiCn0=", "base64_rsa_compressed_encrypted_creds" : "rO0ABXVyAAJbQqzzF\/gGCFTgAgAAeHAAAAEAFBBvYZ7Mim3fI+Np05VO+EHuf5PxldceVzCwdbLhn99OYytVbAynQS5Ral29GY9WQevohqFq0pptfWmC6Hdze1ChYqC3VXBhBj3fvqRQZTXN3\/gYsSGTxp+834hmfUfQbU0RQ7RnV0wV7zyS1QELwx0d2MbPVdCF1bxRqXdtOn1A4aNwc7Ia7\/cZJEKIjKPAUohAvgCyjsGHSbHQx98WKhSwSU60Sa2dauo11GJkO6jT0fdAUjMDuRgiri0JjVTof4u\/gV\/qzwHpGu\/AH\/Q\/dG8vOv1Stjm43HFpaHjBb2lqw0+JUBuIAqO1SbZmHe1FSy4p09C5Z0pkxSxmLBMQXXVxAH4AAAAAA5D7uBN32zcbCqrcmzijqQfhpAWVqmvEcLxsLpAXN0MnSpwYDURX1Bzr\/vmU9PmJjV114yRnCLXxwgtmVebwcXQpDixTHpTKVjL\/CtOTvSkauTybzdVq1nm6iSti+tUV5IX7blC5I+JVJZcJyd6c83OK54FmVswIUe6LEaVCSaMlYzQNpKT7IKYurmTruiz7hrCJ9ZdIk+fUYt2inQ9BMkqscwFr97n+VE9s\/5MPmsbtG7JCzBniT5ePLh9BIr6dWLfZjG+MKsijpwhUINj3sG\/IbsCtqQuNLGxFV6nZObarxX\/8NiFDOwXitmggN2ZBe0ggcLzMHBDILWwaxnGsByVdmKFxN5DozkOUQM1FX0euvznFtk\/Vd7mu6sTeISNvvpempQuPOLzUew2SfynpCR8gqBp0N4E7JYBYpfeuk4wDcX7y6q7xb+p\/Ir2i90Y+AJxMfcXIH7bDQ8H24cSg2pvx1mIZU9btojRD00BaME1dgJOOI42T1jALDSOWIUSxS84qQ1blakpHAKfp4OFgT6XNQNN1mteDjRcLlLxkTP2azXBeWL3\/1Ix9\/2WLHgbeP4rQG27yM6n+YYQU2OTqKr8nJ7HPbwfY3tiagpKX7VpRnoTq\/he0Db7UxxzVEN12\/Pj8fJUjLXTAfoworuhlYo0AaSYMMt2lIr9gB2FRiH1+RELLTrt\/0tGUjMaOLWL6WU8IZj749J9MUYQ6dTnmQHwUKWsaImYLZIPp5HDwC\/8etfQBMqqYUfn8Mm\/McmjKX7AHB48J4X9BBW4n42bLVwBwBxoIzRoQOVAK95be5uR7X9PQ7mqGpjK6KTWPgSj34dg94SCzm40mhvwW0d+KatJ3Bl\/mXsYXzDK6k7vqIQuuYlm8IVvlScQZSrXMJkQK3kVYlZMnpEM47cgs5s\/AtFNRgD3tIRl28PZBvAoU2RdxpEGJCp97LugjtPmQVwPqHtxZQ2eBAWvcT7prIgNQJgKLvMWSb0S42rDhrEaV3vRYjxxZh2a8odrvFve7mNJjYRvscpOOljnliNBnVW703kNQVjIlNiOu6WezpphGFNzd434k1Fom9cQub82hQgHeGssWwjEmL4lCCtT4rRHxouyik36\/v4js9JSVh4RlgXvGR2daW7KTzqW\/GquJUbJjVarT2iljzwahdM08Mbj9T1uxcDycIuEskdEp6pmFVTMgzRYNjAZbWMGnhdKRWYozgis=", "target_schemadrift_details" : [ { "destination_table_name" : "aaaa", "target_schemadrift_backup_table" : false, "target_schemadrift_ignore_table" : false, "backup_table_name" : "aaaa", "target_schemadrift_new_table" : false, "schema_drifted" : false } ], "generate_file_content_json" : "ewogICJjcmVkZW50aWFsX2lkIjogIjQxIiwKICAiY3JlZGVudGlhbF90eXBlX2lkIjogIjE1IiwKICAiY3JlZGVudGlhbF90eXBlIjogIkZpbGUgQ29udGVudCIsCiAgInRva2VuIjogImM2OTUwNTgyYTEyYjU1OGFiNjQ4Y2RiNzIwMDgxNzNiMmU4NDI4ZmI1NWRhYWQ3NDAxNTIyNTY5MWVlYzc4ZWU3YjVjNGUzNDMxMmRlZDcwYWU1ZTdlZTQ4M2I3ZDdlYTBjMjNlMjRlNDU4ZWQxZjU0ZGEzY2NkN2RiY2ZlODcwYTYxZTVjOWM1MDg3ZTdmYjZkYzE2YjZmOGY1ZTRiZWRhNTY5MjRlODg0OWViNTM5YTYzYjZmMzhjMzE4MGY4Njk3ZGMxY2ZhNjExMjMzMTAxOTQ2NGI1YjYwYjk3OWI5MzZiZjUxNzFhOTk2MmMxY2E1NGY4ZWM4NDIwNjdhODQ4YjkyM2M2OWQyOTljNmI3NTI0YzA5NTQyOTMwNDAzMDlhMWY4ZmQzOWY3ODJkMWJkODY0M2YzMmE2NWZhMzU3MDU2ZWJkZjBkNTQ5ZTIwZjBmMWEwNTZlODEyNjM4MjM5NmM5ZmQ1NGMzYWFlOWQ4MjhjNmY1NWU3M2EyYzY0NTlhMDJkNTUyNGVhMjM0YzIwZDllZWY0NmQxNWZlZGJhNWJmOTVlNmJiODMwZmFjZGNhYWUxNzA2ZmNhNjE4MGJkYjAwMzVhOTNlMjRkNTc1NGY3ZDJmOGMzMzU4YmJhYmFlODlkYjMyOWJmMzYzZGYwYzE0OGM1OWFhZWVmNGNkZmZiZDg3OTA5MDMwNTRkNmI1NGFiZjJmOTM1N2VkYTBlNGZmMzFhYjA3MTdlZDRmYmJjMWY1NDY5NTg0NDRhOWMxNTMwZGIxOTgzOTQ1Y2ExZjg4OTcwZWU3Y2UwYjA3NzU4NTEwYThkMWIyYzcwNDVmN2UwYzQxMjIxMjQ0ZDg3NTE4YmZiMTE5ZjBjMGIyYTIxMmQ1NzY1N2NkNDNhZjVhYmM0NGQ5OTU3NTkxOTExYmRlYWY2Mjc5ZDQzYTE5NzIxMzg4NTJkM2RlYjgxZTAxOGNmZDJiZWM0MTIwYjFhZWYyNGQ1NmUzMWMyY2FlNmE3Yzg4YmQxMzliNDQwMzAxNTY3MmU2YjhkNTNmMjhkMjMzZmIwNmRjNWRmNjdlYjY1MTllOWU0NGVkOTBlNGJiZmI4YjU3NmM5YWZhN2RkZmFiMTdhZjIxOWJmODEzNWRlMWY4ZTZmYTNmZjQ2ZTFhYWM5NjlhZmMxZjRjNTYyNWQwYzYwNzU0ZmMxYmJjMzRhZDYzZTU4YTRmN2JlOTc1NjZmNDEzOWE5YTRiYmYwYmIxM2RhOWIxMzQ0MDE5ZWVmMDgzYmIwNTVhMmZlMTBmZmZjNzM5YTI5YWRiYmRhMzMzYjg0ZWRkZTg2YjViNzY0Mjk3ZDE5ZjBjMTc2ODk5NjdkZTAyMmExZGI5ZDE0Y2FhN2M4MDE4YjUyYzhiZTZmMzEwNzE3MzhjOWM1NzExYzkyNDIyOTEyNGRiNjIwMTExZWZlNjFjZGU5NWQ5ZmZkZDA0NDA1Nzk2NTc2NWM0YTAzMWU2ZmIyYWFhYTllZjdlMTc1MGM3NTZiZWEyYTFjYTM4ZGE1YjZkMjIzMTEzN2IwZDNkZjk0NDU4NDdhNDNlYmEzN2E2N2EwMjI5IiwKICAiY3JlZGVudGlhbF9lbmRwb2ludF91cmwiOiAiaHR0cDovL2Rldi1kaGEuaHVtYW5hLmNvbTo4ODg5L2ZpcmVzaG90cy9jcmVkZW50aWFsc0ZldGNoV2ViU2VydmljZSIsCiAgImZpbGVfcGF0aCI6ICIxNTY3XzI2MV8xNzAwMDYyNTg2NjYyNzY5MSIsCiAgImNyZWRlbnRpYWxfZmlsZV9wYXR0ZXJuIiA6ICI0MV8xNjk5MzQyNTc1Igp9", "get_view_info" : [ { "id" : 1 } ], "get_already_ingested_condition" : [ { "already_ingested" : true } ], "sort_by_columns_data" : [], "fetching_credential_inputs" : [ { "credential_type" : "File Content", "metastore_credential_type_id" : null, "credential_type_id" : 15, "metastore_credential_id" : null, "credential_pattern" : "41_1699342575", "spark_credential_id" : 41 } ], "get_varchar_columns" : [], "generate_spark_configs_json" : "ewogICAgInNvbHJfYmF0Y2hfc2l6ZSI6IjEwMDAwIiwicGFyYWxsZWxfdGhyZWFkcyI6IjEwIiwiZmV0Y2hfc2l6ZSI6IjEwMDAwIgogICAgfQ==" }, "batch_id" : "17000625866627691", "template_execution_type" : "single", "query_type" : "json", "currentBotMessageMap" : { "parent_id" : "af56d8ab-458b-4c73-86bf-553c24550201", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "message_context" : "ingestion_deciding", "message_id" : "6595c16c-9675-4ed2-8674-08d9d8e09b79", "task_retry_intervals_secs" : [], "bot_id" : "b006ad5b-9517-4ef8-87e2-7c6dea91f146", "message_topic" : "nabu_2_jdbc", "tags" : { "process_id" : 17000625869931891, "batch_id" : 17000625866627691, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "tags" : [ "AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot", "KoshBot", "DBOpsBot" ], "initial_ts" : 1700062586993, "batch_name" : "Ingestion_20231115", "environment" : "modak", "job_schedule_id" : 1567, "data_movement_id" : 261, "last_run_timestamp" : "2023-11-07 12:42:00.86365", "retry_attempt" : 0, "task_dependency" : true, "ignore_job_termination" : false } } }, "template_execution_type": "single", "query_type":"json" }, "skipLogicPattern" : "doNothing", "output_message_templates": [ { "template_group": "templates/artifact_ingestion/ingestion_flow.stg", "template_name": "spark_ingestion_msg", "useIncomingData":true } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "error_template_create_msg" } ] } ] }
""2023-11-15 15:37:04.745 [Thread-1984] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_jdbc
""2023-11-15 15:37:04.772 [Thread-1984] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_jdbc
""2023-11-15 15:37:04.772 [Thread-1984] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-15 15:37:04.772 [Thread-1984] INFO  com.modak.bots.basebot.AbstractBaseBot - Skipping bot logic as skipBotLogic == true && useIncomingData == false templates/artifact_ingestion/common_templates.stg doNothingTemplate
""2023-11-15 15:37:04.772 [Thread-1984] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:37:04.773 [Thread-1984] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot finished processing message with id 6595c16c-9675-4ed2-8674-08d9d8e09b79
""2023-11-15 15:37:04.796 [Thread-2176] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id b006ad5b-9517-4ef8-87e2-7c6dea91f146 has started processing message with message_id f9af8fe7-d4e3-4a83-8400-4c22ce532ac9 and thread_id 2649 
""2023-11-15 15:37:04.796 [Thread-2176] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:37:04.796 [Thread-2176] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=6595c16c-9675-4ed2-8674-08d9d8e09b79, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=spark_buffer_msg, message_id=f9af8fe7-d4e3-4a83-8400-4c22ce532ac9, task_retry_intervals_secs=[], bot_id=b878e324-4b30-4eeb-9a2a-3f769c50e67c, message_topic=nabu_2_jdbc, tags={process_id=17000625869931891, batch_id=17000625866627691, job_scheduled_user_id=Manaswini Chinthalapudi, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot, KoshBot, DBOpsBot, DBOpsBot], initial_ts=1700062586993, batch_name=Ingestion_20231115, environment=modak, job_schedule_id=1567, data_movement_id=261, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, task_dependency=true, ignore_job_termination=false}}
""2023-11-15 15:37:04.806 [Thread-2176] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
doNothing
""2023-11-15 15:37:04.807 [Thread-2176] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : true
""2023-11-15 15:37:05.032 [Thread-2176] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "SparkScriptBot", "bot_metadata": { "message_id": "d5f7c84d-e235-4701-910a-64489cde6bd3", "parent_id": "f9af8fe7-d4e3-4a83-8400-4c22ce532ac9", "bot_id": "b006ad5b-9517-4ef8-87e2-7c6dea91f146", "message_topic":"nabu_2_spark_script", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":17000625869931891, "initial_ts":1700062586993, "batch_id":17000625866627691, "batch_name":"Ingestion_20231115", "job_schedule_id":1567, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "2023-11-07 12:42:00.86365", "environment": "modak", "ignore_job_termination" : false, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot", "KoshBot", "DBOpsBot", "DBOpsBot", "KoshBot" ],"task_dependency":true}, "task_retry_intervals_secs": [ ], "message_context": "run_almaren_ingestion_job_using_spark" }, "bot_tasks": [ { "task_name": "create_credential_file_if_required", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "pre_task_logging_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "pre_log_template" }, "app_template_details": { "template_group": "templates/artifact_ingestion/ingestion_templates.stg", "template_name": "command_to_create_credentials" }, "input_data": { "is_valid_compute_engine":true, "data": { "batch_id" : "17000625866627691", "templateData" : { "query_input" : { "target_schemadrift_flag" : [ { "nextrun_after_targetdrift" : false } ], "input_json_for_checkpoint_status" : "ewoicHJvY2Vzc0lkIjoxNzAwMDYyNTg2OTkzMTg5MSwKImRhdGFwbGFjZUlkIjo0MiwKInRhYmxlSWQiOjM3MjM0LAoiZGF0YW1vdmVtZW50SWQiOjI2MSwKImpvYlNjaGVkdWxlZFVzZXJJZCI6Ik1hbmFzd2luaSBDaGludGhhbGFwdWRpIiwKImpvYlNjaGVkdWxlSWQiOjE1NjcsCiJiYXRjaElkIjoxNzAwMDYyNTg2NjYyNzY5MSwKImxhc3RSdW5UaW1lc3RhbXAiOiIyMDIzLTExLTA3IDEyOjQyOjAwLjg2MzY1IiwKInJldHJ5TnVtIjogIjAiCn0=", "get_cdc_last_run_table" : [ { "prev_target_path" : null, "cdc_first" : true, "relative_path" : "\/261\/42\/development-db\/acuity-develop\/aaaa.parquet", "target_path" : "abfss:\/\/dataproc@idea15pisplznonprodsa2.dfs.core.windows.net\/261\/42\/development-db\/acuity-develop\/aaaa.parquet" } ], "get_cdc_type" : [ { "cdc_applied" : false, "is_primary" : false, "cdctype2" : false, "temp_path" : "17000625869931891_aaaa" } ], "generate_yeedu_metastore_credential" : "ewogICJjcmVkZW50aWFsX2lkIjogIiIsCiAgImNyZWRlbnRpYWxfdHlwZV9pZCI6ICIiLAogICJ0b2tlbiI6ICJjNjk1MDU4MmExMmI1NThhYjY0OGNkYjcyMDA4MTczYjJlODQyOGZiNTVkYWFkNzQwMTUyMjU2OTFlZWM3OGVlN2I1YzRlMzQzMTJkZWQ3MGFlNWU3ZWU0ODNiN2Q3ZWEwYzIzZTI0ZTQ1OGVkMWY1NGRhM2NjZDdkYmNmZTg3MGE2MWU1YzljNTA4N2U3ZmI2ZGMxNmI2ZjhmNWU0YmVkYTU2OTI0ZTg4NDllYjUzOWE2M2I2ZjM4YzMxODBmODY5N2RjMWNmYTYxMTIzMzEwMTk0NjRiNWI2MGI5NzliOTM2YmY1MTcxYTk5NjJjMWNhNTRmOGVjODQyMDY3YTg0OGI5MjNjNjlkMjk5YzZiNzUyNGMwOTU0MjkzMDQwMzA5YTFmOGZkMzlmNzgyZDFiZDg2NDNmMzJhNjVmYTM1NzA1NmViZGYwZDU0OWUyMGYwZjFhMDU2ZTgxMjYzODIzOTZjOWZkNTRjM2FhZTlkODI4YzZmNTVlNzNhMmM2NDU5YTAyZDU1MjRlYTIzNGMyMGQ5ZWVmNDZkMTVmZWRiYTViZjk1ZTZiYjgzMGZhY2RjYWFlMTcwNmZjYTYxODBiZGIwMDM1YTkzZTI0ZDU3NTRmN2QyZjhjMzM1OGJiYWJhZTg5ZGIzMjliZjM2M2RmMGMxNDhjNTlhYWVlZjRjZGZmYmQ4NzkwOTAzMDU0ZDZiNTRhYmYyZjkzNTdlZGEwZTRmZjMxYWIwNzE3ZWQ0ZmJiYzFmNTQ2OTU4NDQ0YTljMTUzMGRiMTk4Mzk0NWNhMWY4ODk3MGVlN2NlMGIwNzc1ODUxMGE4ZDFiMmM3MDQ1ZjdlMGM0MTIyMTI0NGQ4NzUxOGJmYjExOWYwYzBiMmEyMTJkNTc2NTdjZDQzYWY1YWJjNDRkOTk1NzU5MTkxMWJkZWFmNjI3OWQ0M2ExOTcyMTM4ODUyZDNkZWI4MWUwMThjZmQyYmVjNDEyMGIxYWVmMjRkNTZlMzFjMmNhZTZhN2M4OGJkMTM5YjQ0MDMwMTU2NzJlNmI4ZDUzZjI4ZDIzM2ZiMDZkYzVkZjY3ZWI2NTE5ZTllNDRlZDkwZTRiYmZiOGI1NzZjOWFmYTdkZGZhYjE3YWYyMTliZjgxMzVkZTFmOGU2ZmEzZmY0NmUxYWFjOTY5YWZjMWY0YzU2MjVkMGM2MDc1NGZjMWJiYzM0YWQ2M2U1OGE0ZjdiZTk3NTY2ZjQxMzlhOWE0YmJmMGJiMTNkYTliMTM0NDAxOWVlZjA4M2JiMDU1YTJmZTEwZmZmYzczOWEyOWFkYmJkYTMzM2I4NGVkZGU4NmI1Yjc2NDI5N2QxOWYwYzE3Njg5OTY3ZGUwMjJhMWRiOWQxNGNhYTdjODAxOGI1MmM4YmU2ZjMxMDcxNzM4YzljNTcxMWM5MjQyMjkxMjRkYjYyMDExMWVmZTYxY2RlOTVkOWZmZGQwNDQwNTc5NjU3NjVjNGEwMzFlNmZiMmFhYWE5ZWY3ZTE3NTBjNzU2YmVhMmExY2EzOGRhNWI2ZDIyMzExMzdiMGQzZGY5NDQ1ODQ3YTQzZWJhMzdhNjdhMDIyOSIsCiAgImNyZWRlbnRpYWxfZW5kcG9pbnRfdXJsIjogImh0dHA6Ly9kZXYtZGhhLmh1bWFuYS5jb206ODg4OS9maXJlc2hvdHMvY3JlZGVudGlhbHNGZXRjaFdlYlNlcnZpY2UiCn0=", "table_metadata_output" : [ { "end_point" : "http:\/\/dev-dha.humana.com:8889\/fireshots\/credentialsFetchWebService", "is_filesystem_credential_type_aws" : true, "table_name" : "aaaa", "s3_bucket" : null, "path" : "", "is_lazy_mode" : false, "destination_type" : "adls_gen2", "archive_files_path" : "", "rename_table_condition" : false, "adls_gen2_directory_name" : null, "is_archive_data" : false, "destination_db" : null, "bucket_name" : null, "source_type" : "sql_server", "credential_pattern" : "2_1686574260", "is_destination_hive" : false, "estimated_rows" : 4914, "destination_file_format" : "parquet", "warehouse_name" : null, "filesystem_credential_type" : null, "is_aws_iam_attached_to_ec2_instance" : false, "is_bigquery" : false, "is_source_filetype" : false, "source_jdbc_url" : "jdbc:sqlserver:\/\/hyp-acu-development-5de0.database.windows.net:1433;database=development-db;sslProtocol=TLSv1.2;encrypt=true", "flow_number" : 1, "batch_id" : 17000625866627691, "destination_url" : null, "filesystem_credential_type_id" : null, "schema_drift_flag" : false, "is_mysql" : false, "filesystem_credential_id" : null, "destination_directory" : null, "source_credential_type_id" : 1, "destination_backup_table_name" : "aaaa", "destination_table_name" : "aaaa", "destination_dataplace_sub_component_id" : 18, "is_azure_oauth" : false, "gcs_bucket" : null, "source_directory" : null, "is_file_system_type_s3a" : false, "destination_schema_directory_id" : 3, "intermediate_type" : "parquet", "is_source_jdbc_url" : true, "is_source_spark_hive" : false, "batch_name" : "Ingestion_20231115", "source_endpoint" : "s3.amazonaws.com", "upper_case_destination_table_name" : "AAAA", "source_credential_id" : 37, "destination_credential_type_id" : 5, "adls_gen2_container" : "dataproc", "source_default_credential_exists" : false, "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDYyNjA0ODY3ODczNSwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0NTQwNSwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2MjYwNH0.TdlKYjNFZRULplibTKTBiTeNTShCsDicocUZq9KQkMiynWn2WsDoCNVj1Gnby5Zevba71EIlyJc7hK0-wksFFLDOu-AutbS3q-JSjcWr7zHFmWQ3NR6Xs_ycLsdTfh9HnCPt4R-GHKm9SOS5CzT6JBg08gb9cZtV2havzmaG4v9vckfKagGuftWnBKcsQNp2h9zB_EDYLVdDOUd_Aa8UHMklrT8W0SjKoDgbHVZ5T506nwQL-nXZYY0_YHP9KqDtPRiRq-k6db434A4pMx6BkTAG1z355WIuqa1fwRtrSB5HZQULpX85KD8FMpbt2gBBHWDn01TnO5_crpf0lv-SfQ", "project" : null, "source_table_name" : "aaaa", "table_id" : 37234, "authentication_type" : "auth_token", "source_url" : null, "destination_endpoint" : "s3.amazonaws.com", "schema_id" : 453, "datamovement_engine_type" : "Spark", "relative_file_path" : "", "filesystem_credential_epoch" : null, "is_needed_partition_name_without_column_name" : false, "table_suffix" : "", "schema_name" : "acuity-develop", "is_record_process_enabled" : true, "is_default" : false, "is_jdbcmode" : false, "table_timestamp" : "", "verification_threshold" : 0.1, "pipeline_flow_timeout" : 23, "dest_default_credential_exists" : false, "process_id" : 17000625869931891, "is_destination_file" : true, "where_condition" : "37234", "source_dataplace_id" : 42, "file_system_type" : "abfss", "is_ingestion_root_path" : false, "is_source_hive" : false, "destination_oracle_jdbc_url" : null, "schema_drift_option" : "drop_create_table", "ingestion_table_format" : "", "already_ingested" : true, "destination_dataplace_id" : 5, "destination_credential_id" : 2, "file_format" : "", "create_backup_table" : null, "destination_dataplace_component_type_id" : 3, "source_jdbc_driver" : "com.microsoft.sqlserver.jdbc.SQLServerDriver", "destination_schema_name" : "dataproc", "source_db" : "development-db", "apply_transformation" : false, "target_type" : "adls_gen2", "oracle_jdbc_url" : null, "destination_schema_id" : 3, "dataplace_id" : 42, "filesystem_endpoint" : null, "is_spark_hive" : false, "destination_jdbc_driver" : null, "data_movement_id" : 261, "storage_account" : "idea15pisplznonprodsa2", "is_relative_file_path" : false, "is_create_table" : false, "is_apache_jdbc_driver" : false } ], "get_cdc_audit_cols" : [], "get_list_of_maps_of_partition_columns" : [ { "?column?" : "null" } ], "get_cdc_info" : [ { "job_id_column_name" : "process_id", "prev_job_id_column_name" : "prev_process_id", "is_sha2" : false, "add_audit_columns" : false, "end_date_column_name" : "valid_to_ts", "create_view" : false, "start_date_column_name" : "valid_from_ts", "hash_type" : "", "view_name" : "v_aaaa" } ], "get_spark_configs" : [ { "cluster_id" : null, "config_json" : { "extra_configs" : {}, "default_configs" : { "solr_batch_size" : "10000", "parallel_threads" : "10", "fetch_size" : "10000" } }, "spark_configuration_type_id" : 1, "spark_configs_json" : "{\n \"solr_batch_size\":\"10000\",\"parallel_threads\":\"10\",\"fetch_size\":\"10000\"\n }", "compute_engine_id" : 11, "extra_configs_json" : { "spark.nabu.fetch_size" : "10000", "spark.nabu.solr_batch_size" : "10000" } } ], "advanced_options_tables_flags_status" : [ { "columns_options" : false, "cdc" : null, "sort_by_columns" : false, "incremental_load" : false, "parallel_ingestion" : false, "remove_duplicates" : false, "virtual_column" : false, "reorder_columns" : false, "modified_columns" : false, "ingestion_mode" : true, "enable_cache" : false, "ingest_using_query" : false, "new_table_name" : false, "excluded_column_ids" : false, "table_partitions" : false } ], "yeedu_input_json" : "ewoiY2x1c3Rlcl9pZCI6ICIiLAoiYjY0X2lucHV0X2pzb24iOiAiZXdvaWNISnZZMlZ6YzBsa0lqb3hOekF3TURZeU5UZzJPVGt6TVRnNU1Td0tJbVJoZEdGd2JHRmpaVWxrSWpvME1pd0tJblJoWW14bFNXUWlPak0zTWpNMExBb2laR0YwWVcxdmRtVnRaVzUwU1dRaU9qSTJNU3dLSW1wdllsTmphR1ZrZFd4bFpGVnpaWEpKWkNJNklrMWhibUZ6ZDJsdWFTQkRhR2x1ZEdoaGJHRndkV1JwSWl3S0ltcHZZbE5qYUdWa2RXeGxTV1FpT2pFMU5qY3NDaUppWVhSamFFbGtJam94TnpBd01EWXlOVGcyTmpZeU56WTVNU3dLSW14aGMzUlNkVzVVYVcxbGMzUmhiWEFpT2lJeU1ESXpMVEV4TFRBM0lERXlPalF5T2pBd0xqZzJNelkxSWl3S0luSmxkSEo1VG5WdElqb2dJakFpQ24wPSIsCiJleHRyYV9jb25maWciOiAiZXdvaVpYaDBjbUZEYjI1bWFXZE5ZWEFpT2lCN0luTndZWEpyTG01aFluVXVabVYwWTJoZmMybDZaU0k2SUNJeE1EQXdNQ0lzSUNKemNHRnlheTV1WVdKMUxtTnZiWEIxZEdWZlpXNW5hVzVsSWpvZ0ltRjZkWEpsWDJSaGRHRmljbWxqYTNNaUxDQWljM0JoY21zdWJtRmlkUzV6YjJ4eVgySmhkR05vWDNOcGVtVWlPaUFpTVRBd01EQWlMQ0FpYzNCaGNtc3VibUZpZFM1aGNIQnNhV05oZEdsdmJsOXVZVzFsSWpvZ0ltNWhZblV0YzNCaGNtdGliM1F0YVc1blpYTjBhVzl1SWl3Z0luTndZWEpyTG1SeWFYWmxjaTV1WVdKMVgzQnlhWFpoZEdWTFpYa2lPaUFpTDJSaVpuTXZkRzF3TDJSbGRpOXVZV0oxTHpFM01EQXdOakkxT0RZNU9UTXhPRGt4THpBdmNISnBkbUYwWlV0bGVTSXNJQ0p6Y0dGeWF5NWtjbWwyWlhJdWMyOTFjbU5sWDJGM2MxOWxibVJRYjJsdWRDSTZJQ0p6TXk1aGJXRjZiMjVoZDNNdVkyOXRJaXdnSW5Od1lYSnJMbVJ5YVhabGNpNTBZWEpuWlhSZllYZHpYMlZ1WkZCdmFXNTBJam9nSW5NekxtRnRZWHB2Ym1GM2N5NWpiMjBpTENBaWMzQmhjbXN1Ym1GaWRTNWpiMjF3ZFhSbFgyVnVaMmx1WlY5c2FXSnpYM0JoZEdnaU9pQWlMMlJpWm5NdmRHMXdMMlJsZGk5dVlXSjFMekUzTURBd05qSTFPRFk1T1RNeE9Ea3hMekF2WVhCd2JHbGpZWFJwYjI0dVkyOXVaaUo5Q24wPSIsCiJjb21wdXRlX2VuZ19jcmVkc19qc29uIiA6ICJld29nSUNKamNtVmtaVzUwYVdGc1gybGtJam9nSWpReElpd0tJQ0FpWTNKbFpHVnVkR2xoYkY5MGVYQmxYMmxrSWpvZ0lqRTFJaXdLSUNBaVkzSmxaR1Z1ZEdsaGJGOTBlWEJsSWpvZ0lrWnBiR1VnUTI5dWRHVnVkQ0lzQ2lBZ0luUnZhMlZ1SWpvZ0ltTTJPVFV3TlRneVlURXlZalUxT0dGaU5qUTRZMlJpTnpJd01EZ3hOek5pTW1VNE5ESTRabUkxTldSaFlXUTNOREF4TlRJeU5UWTVNV1ZsWXpjNFpXVTNZalZqTkdVek5ETXhNbVJsWkRjd1lXVTFaVGRsWlRRNE0ySTNaRGRsWVRCak1qTmxNalJsTkRVNFpXUXhaalUwWkdFelkyTmtOMlJpWTJabE9EY3dZVFl4WlRWak9XTTFNRGczWlRkbVlqWmtZekUyWWpabU9HWTFaVFJpWldSaE5UWTVNalJsT0RnME9XVmlOVE01WVRZellqWm1NemhqTXpFNE1HWTROamszWkdNeFkyWmhOakV4TWpNek1UQXhPVFEyTkdJMVlqWXdZamszT1dJNU16WmlaalV4TnpGaE9UazJNbU14WTJFMU5HWTRaV000TkRJd05qZGhPRFE0WWpreU0yTTJPV1F5T1Rsak5tSTNOVEkwWXpBNU5UUXlPVE13TkRBek1EbGhNV1k0Wm1Rek9XWTNPREprTVdKa09EWTBNMll6TW1FMk5XWmhNelUzTURVMlpXSmtaakJrTlRRNVpUSXdaakJtTVdFd05UWmxPREV5TmpNNE1qTTVObU01Wm1RMU5HTXpZV0ZsT1dRNE1qaGpObVkxTldVM00yRXlZelkwTlRsaE1ESmtOVFV5TkdWaE1qTTBZekl3WkRsbFpXWTBObVF4TldabFpHSmhOV0ptT1RWbE5tSmlPRE13Wm1GalpHTmhZV1V4TnpBMlptTmhOakU0TUdKa1lqQXdNelZoT1RObE1qUmtOVGMxTkdZM1pESm1PR016TXpVNFltSmhZbUZsT0Rsa1lqTXlPV0ptTXpZelpHWXdZekUwT0dNMU9XRmhaV1ZtTkdOa1ptWmlaRGczT1RBNU1ETXdOVFJrTm1JMU5HRmlaakptT1RNMU4yVmtZVEJsTkdabU16RmhZakEzTVRkbFpEUm1ZbUpqTVdZMU5EWTVOVGcwTkRSaE9XTXhOVE13WkdJeE9UZ3pPVFExWTJFeFpqZzRPVGN3WldVM1kyVXdZakEzTnpVNE5URXdZVGhrTVdJeVl6Y3dORFZtTjJVd1l6UXhNakl4TWpRMFpEZzNOVEU0WW1aaU1URTVaakJqTUdJeVlUSXhNbVExTnpZMU4yTmtORE5oWmpWaFltTTBOR1E1T1RVM05Ua3hPVEV4WW1SbFlXWTJNamM1WkRRellURTVOekl4TXpnNE5USmtNMlJsWWpneFpUQXhPR05tWkRKaVpXTTBNVEl3WWpGaFpXWXlOR1ExTm1Vek1XTXlZMkZsTm1FM1l6ZzRZbVF4TXpsaU5EUXdNekF4TlRZM01tVTJZamhrTlRObU1qaGtNak16Wm1Jd05tUmpOV1JtTmpkbFlqWTFNVGxsT1dVME5HVmtPVEJsTkdKaVptSTRZalUzTm1NNVlXWmhOMlJrWm1GaU1UZGhaakl4T1dKbU9ERXpOV1JsTVdZNFpUWm1ZVE5tWmpRMlpURmhZV001TmpsaFptTXhaalJqTlRZeU5XUXdZell3TnpVMFptTXhZbUpqTXpSaFpEWXpaVFU0WVRSbU4ySmxPVGMxTmpabU5ERXpPV0U1WVRSaVltWXdZbUl4TTJSaE9XSXhNelEwTURFNVpXVm1NRGd6WW1Jd05UVmhNbVpsTVRCbVptWmpOek01WVRJNVlXUmlZbVJoTXpNellqZzBaV1JrWlRnMllqVmlOelkwTWprM1pERTVaakJqTVRjMk9EazVOamRrWlRBeU1tRXhaR0k1WkRFMFkyRmhOMk00TURFNFlqVXlZemhpWlRabU16RXdOekUzTXpoak9XTTFOekV4WXpreU5ESXlPVEV5TkdSaU5qSXdNVEV4WldabE5qRmpaR1U1TldRNVptWmtaREEwTkRBMU56azJOVGMyTldNMFlUQXpNV1UyWm1JeVlXRmhZVGxsWmpkbE1UYzFNR00zTlRaaVpXRXlZVEZqWVRNNFpHRTFZalprTWpJek1URXpOMkl3WkROa1pqazBORFU0TkRkaE5ETmxZbUV6TjJFMk4yRXdNakk1SWl3S0lDQWlZM0psWkdWdWRHbGhiRjlsYm1Sd2IybHVkRjkxY213aU9pQWlhSFIwY0RvdkwyUmxkaTFrYUdFdWFIVnRZVzVoTG1OdmJUbzRPRGc1TDJacGNtVnphRzkwY3k5amNtVmtaVzUwYVdGc2MwWmxkR05vVjJWaVUyVnlkbWxqWlNJc0NpQWdJbVpwYkdWZmNHRjBhQ0k2SUNJeE5UWTNYekkyTVY4eE56QXdNRFl5TlRnMk5qWXlOelk1TVNJc0NpQWdJbU55WldSbGJuUnBZV3hmWm1sc1pWOXdZWFIwWlhKdUlpQTZJQ0kwTVY4eE5qazVNelF5TlRjMUlncDkiLAoiY2x1c3Rlcl91aSI6ICIiLAoicmV0cnlfbnVtIjogIjAiLAoic3BhcmtfY29uZmlncyI6ICJld29nSUNBZ0luTnZiSEpmWW1GMFkyaGZjMmw2WlNJNklqRXdNREF3SWl3aWNHRnlZV3hzWld4ZmRHaHlaV0ZrY3lJNklqRXdJaXdpWm1WMFkyaGZjMmw2WlNJNklqRXdNREF3SWdvZ0lDQWdmUT09IiwKImI2NF9oaXZlX2NyZWRzX2pzb24iOiAiZXdvZ0lDSmpjbVZrWlc1MGFXRnNYMmxrSWpvZ0lpSXNDaUFnSW1OeVpXUmxiblJwWVd4ZmRIbHdaVjlwWkNJNklDSWlMQW9nSUNKMGIydGxiaUk2SUNKak5qazFNRFU0TW1FeE1tSTFOVGhoWWpZME9HTmtZamN5TURBNE1UY3pZakpsT0RReU9HWmlOVFZrWVdGa056UXdNVFV5TWpVMk9URmxaV00zT0dWbE4ySTFZelJsTXpRek1USmtaV1EzTUdGbE5XVTNaV1UwT0ROaU4yUTNaV0V3WXpJelpUSTBaVFExT0dWa01XWTFOR1JoTTJOalpEZGtZbU5tWlRnM01HRTJNV1UxWXpsak5UQTROMlUzWm1JMlpHTXhObUkyWmpobU5XVTBZbVZrWVRVMk9USTBaVGc0TkRsbFlqVXpPV0UyTTJJMlpqTTRZek14T0RCbU9EWTVOMlJqTVdObVlUWXhNVEl6TXpFd01UazBOalJpTldJMk1HSTVOemxpT1RNMlltWTFNVGN4WVRrNU5qSmpNV05oTlRSbU9HVmpPRFF5TURZM1lUZzBPR0k1TWpOak5qbGtNams1WXpaaU56VXlOR013T1RVME1qa3pNRFF3TXpBNVlURm1PR1prTXpsbU56Z3laREZpWkRnMk5ETm1NekpoTmpWbVlUTTFOekExTm1WaVpHWXdaRFUwT1dVeU1HWXdaakZoTURVMlpUZ3hNall6T0RJek9UWmpPV1prTlRSak0yRmhaVGxrT0RJNFl6Wm1OVFZsTnpOaE1tTTJORFU1WVRBeVpEVTFNalJsWVRJek5HTXlNR1E1WldWbU5EWmtNVFZtWldSaVlUVmlaamsxWlRaaVlqZ3pNR1poWTJSallXRmxNVGN3Tm1aallUWXhPREJpWkdJd01ETTFZVGt6WlRJMFpEVTNOVFJtTjJReVpqaGpNek0xT0dKaVlXSmhaVGc1WkdJek1qbGlaak0yTTJSbU1HTXhORGhqTlRsaFlXVmxaalJqWkdabVltUTROemt3T1RBek1EVTBaRFppTlRSaFltWXlaamt6TlRkbFpHRXdaVFJtWmpNeFlXSXdOekUzWldRMFptSmlZekZtTlRRMk9UVTRORFEwWVRsak1UVXpNR1JpTVRrNE16azBOV05oTVdZNE9EazNNR1ZsTjJObE1HSXdOemMxT0RVeE1HRTRaREZpTW1NM01EUTFaamRsTUdNME1USXlNVEkwTkdRNE56VXhPR0ptWWpFeE9XWXdZekJpTW1FeU1USmtOVGMyTlRkalpEUXpZV1kxWVdKak5EUmtPVGsxTnpVNU1Ua3hNV0prWldGbU5qSTNPV1EwTTJFeE9UY3lNVE00T0RVeVpETmtaV0k0TVdVd01UaGpabVF5WW1Wak5ERXlNR0l4WVdWbU1qUmtOVFpsTXpGak1tTmhaVFpoTjJNNE9HSmtNVE01WWpRME1ETXdNVFUyTnpKbE5tSTRaRFV6WmpJNFpESXpNMlppTURaa1l6VmtaalkzWldJMk5URTVaVGxsTkRSbFpEa3daVFJpWW1aaU9HSTFOelpqT1dGbVlUZGtaR1poWWpFM1lXWXlNVGxpWmpneE16VmtaVEZtT0dVMlptRXpabVkwTm1VeFlXRmpPVFk1WVdaak1XWTBZelUyTWpWa01HTTJNRGMxTkdaak1XSmlZek0wWVdRMk0yVTFPR0UwWmpkaVpUazNOVFkyWmpReE16bGhPV0UwWW1KbU1HSmlNVE5rWVRsaU1UTTBOREF4T1dWbFpqQTRNMkppTURVMVlUSm1aVEV3Wm1abVl6Y3pPV0V5T1dGa1ltSmtZVE16TTJJNE5HVmtaR1U0Tm1JMVlqYzJOREk1TjJReE9XWXdZekUzTmpnNU9UWTNaR1V3TWpKaE1XUmlPV1F4TkdOaFlUZGpPREF4T0dJMU1tTTRZbVUyWmpNeE1EY3hOek00WXpsak5UY3hNV001TWpReU1qa3hNalJrWWpZeU1ERXhNV1ZtWlRZeFkyUmxPVFZrT1dabVpHUXdORFF3TlRjNU5qVTNOalZqTkdFd016RmxObVppTW1GaFlXRTVaV1kzWlRFM05UQmpOelUyWW1WaE1tRXhZMkV6T0dSaE5XSTJaREl5TXpFeE16ZGlNR1F6WkdZNU5EUTFPRFEzWVRRelpXSmhNemRoTmpkaE1ESXlPU0lzQ2lBZ0ltTnlaV1JsYm5ScFlXeGZaVzVrY0c5cGJuUmZkWEpzSWpvZ0ltaDBkSEE2THk5a1pYWXRaR2hoTG1oMWJXRnVZUzVqYjIwNk9EZzRPUzltYVhKbGMyaHZkSE12WTNKbFpHVnVkR2xoYkhOR1pYUmphRmRsWWxObGNuWnBZMlVpQ24wPSIsCiJiYXRjaF9pZCI6MTcwMDA2MjU4NjY2Mjc2OTEsCiJwcm9jZXNzX2lkIiA6MTcwMDA2MjU4Njk5MzE4OTEsCiJyZXN0X3VybCI6ICIiLAoiYjY0X2V4dGVybmFsX2phcnNfbWFwIiA6ICIiCn0=", "ingestion_mode" : [ { "mode" : "overwrite", "save_mode" : "Overwrite", "data_movement_id" : 261, "ingestion_mode_key" : true, "drop_create_condition" : true } ], "generate_extra_configs_json" : "ewoiZXh0cmFDb25maWdNYXAiOiB7InNwYXJrLm5hYnUuZmV0Y2hfc2l6ZSI6ICIxMDAwMCIsICJzcGFyay5uYWJ1LmNvbXB1dGVfZW5naW5lIjogImF6dXJlX2RhdGFicmlja3MiLCAic3BhcmsubmFidS5zb2xyX2JhdGNoX3NpemUiOiAiMTAwMDAiLCAic3BhcmsubmFidS5hcHBsaWNhdGlvbl9uYW1lIjogIm5hYnUtc3Bhcmtib3QtaW5nZXN0aW9uIiwgInNwYXJrLmRyaXZlci5uYWJ1X3ByaXZhdGVLZXkiOiAiL2RiZnMvdG1wL2Rldi9uYWJ1LzE3MDAwNjI1ODY5OTMxODkxLzAvcHJpdmF0ZUtleSIsICJzcGFyay5kcml2ZXIuc291cmNlX2F3c19lbmRQb2ludCI6ICJzMy5hbWF6b25hd3MuY29tIiwgInNwYXJrLmRyaXZlci50YXJnZXRfYXdzX2VuZFBvaW50IjogInMzLmFtYXpvbmF3cy5jb20iLCAic3BhcmsubmFidS5jb21wdXRlX2VuZ2luZV9saWJzX3BhdGgiOiAiL2RiZnMvdG1wL2Rldi9uYWJ1LzE3MDAwNjI1ODY5OTMxODkxLzAvYXBwbGljYXRpb24uY29uZiJ9Cn0=", "incremental_load_details" : [ { "?column?" : 1 } ], "place_holders_with_default_and_max_values" : [ { "?column?" : 1 } ], "incremental_max_columns_with_column_ids" : [ { "?column?" : 1 } ], "remove_duplicates_data" : [], "cdc_first_time" : [ { "cdc_first_time" : true } ], "generate_base64_pipeline_timeout_json" : "ewoicGlwZWxpbmVfdGltZW91dCIgOiAyMwp9", "table_partition_output" : [], "fetch_source_type" : [ { "is_source_filetype" : false, "is_destination_redshift" : false, "data_movement_id" : 261, "source_metadata_category" : "relational", "destination" : "adls_gen2", "is_source_salesforce" : false, "is_destination_filetype" : true, "source" : "sql_server", "is_source_mongodb" : false, "is_ordinalpos_startwith_zero" : false, "destination_metadata_category" : "file" } ], "destination_transformation_query_details_output" : [ { "is_virtual" : false, "data_precision" : 0, "is_nullable" : false, "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "table_id" : 37234, "is_precision_scale" : true, "table_name" : "aaaa", "intermediate_datatype_name" : "string", "is_mysql" : false, "is_source_hive" : false, "is_partitioned_col" : false, "ingested_colorder" : 1, "user_text" : null, "field_name_replaced" : "entity_id", "is_long_col_name" : false, "is_oracle_destination" : false, "data_length" : 255, "destination_datatype_name" : "string", "column_name" : "entity_id", "source_type" : "sql_server", "schema_name" : "acuity-develop", "is_source_casting_enabled" : false, "is_varchar" : false, "field_name" : "entity_id", "column_id" : 956158, "source_cast_type" : "AsIs", "ordinal_position" : 1, "source_datatype_name" : "varchar", "is_cdc_col" : false, "data_scale" : 0, "replaced_column_name" : "entity_id", "data_type" : "varchar", "is_bigquery" : false, "is_precision" : true, "is_redshift_relational_destination" : false, "source_stg_function" : "AsIs", "istimezone" : false }, { "is_virtual" : false, "data_precision" : 0, "is_nullable" : false, "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "table_id" : 37234, "is_precision_scale" : true, "table_name" : "aaaa", "intermediate_datatype_name" : "string", "is_mysql" : false, "is_source_hive" : false, "is_partitioned_col" : false, "ingested_colorder" : 2, "user_text" : null, "field_name_replaced" : "entity_type", "is_long_col_name" : false, "is_oracle_destination" : false, "data_length" : 255, "destination_datatype_name" : "string", "column_name" : "entity_type", "source_type" : "sql_server", "schema_name" : "acuity-develop", "is_source_casting_enabled" : false, "is_varchar" : false, "field_name" : "entity_type", "column_id" : 956159, "source_cast_type" : "AsIs", "ordinal_position" : 2, "source_datatype_name" : "varchar", "is_cdc_col" : false, "data_scale" : 0, "replaced_column_name" : "entity_type", "data_type" : "varchar", "is_bigquery" : false, "is_precision" : true, "is_redshift_relational_destination" : false, "source_stg_function" : "AsIs", "istimezone" : false } ], "get_varchar_columns_destination" : [], "input_data" : { "flow_number" : 1, "process_id" : 17000625869931891, "source_database_name_lowercase" : "development-db", "batch_id" : 17000625866627691, "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDYyNjA0ODY3ODczNSwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0NTQwNSwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2MjYwNH0.TdlKYjNFZRULplibTKTBiTeNTShCsDicocUZq9KQkMiynWn2WsDoCNVj1Gnby5Zevba71EIlyJc7hK0-wksFFLDOu-AutbS3q-JSjcWr7zHFmWQ3NR6Xs_ycLsdTfh9HnCPt4R-GHKm9SOS5CzT6JBg08gb9cZtV2havzmaG4v9vckfKagGuftWnBKcsQNp2h9zB_EDYLVdDOUd_Aa8UHMklrT8W0SjKoDgbHVZ5T506nwQL-nXZYY0_YHP9KqDtPRiRq-k6db434A4pMx6BkTAG1z355WIuqa1fwRtrSB5HZQULpX85KD8FMpbt2gBBHWDn01TnO5_crpf0lv-SfQ", "end_point" : "http:\/\/dev-dha.humana.com:8889\/fireshots\/credentialsFetchWebService", "where_condition" : "37234", "suffix" : "", "reorder_columns" : [], "job_type_id" : "1", "ingestion_table_format" : "", "job_schedule_id" : 1567, "relative_file_path" : "", "retry_attempt" : "0", "source_schema_name_lowercase" : "acuity-develop", "variables" : { "env_variables" : {}, "user_variables" : {}, "payload_variables" : {} }, "source_database_name_uppercase" : "DEVELOPMENT-DB", "job_scheduled_user_id" : "Manaswini Chinthalapudi", "virtual_column" : [], "new_table_for_rename" : "", "source_schema_name_uppercase" : "ACUITY-DEVELOP", "batch_name" : "Ingestion_20231115", "modified_columns" : [], "source_database_name" : "development-db", "data_movement_id" : 261, "last_run_timestamp" : "2023-11-07 12:42:00.86365", "is_relative_file_path" : false }, "table_adv_opt_details" : [ { "dataplace_id" : 42, "cru_ts" : "2023-11-15 09:31:16.466337", "data_movement_id" : 261, "valid_to_ts" : "9999-12-31 00:00:00.0", "advance_option_details" : { "advanced_table_options" : { "columns_options" : { "modified_columns" : [], "virtual_column" : [], "excluded_column_ids" : [] }, "CDC" : { "audit_columns" : { "prev_process_id_column_name" : "prev_process_id", "end_date_column_name" : "valid_to_ts", "process_id_column_name" : "process_id", "start_date_column_name" : "valid_from_ts" }, "CDC_process_type" : "", "add_audit_columns" : false, "columns_ids" : [], "CDC_type" : "", "create_view" : false, "hash_type" : "", "view_name" : "v_aaaa" }, "sort_by_columns" : [], "incremental_load" : { "condition_values" : [], "where_clause" : "" }, "parallel_ingestion" : { "max_connections" : 1, "enable" : false }, "remove_duplicates" : { "sort_columns" : [], "key_columns" : [] }, "table_id" : 37234, "reorder_columns" : [], "table_name" : "aaaa", "parallel_hash_ingestion" : { "max_connections" : 8, "enable" : false }, "dataplace_id" : 42, "ingestion_mode" : { "mode" : "Drop & Re-create", "enable" : true }, "enable_cache" : { "enable" : false }, "ingest_using_query" : { "enable" : false, "sql_query" : "" }, "schema_id" : 453, "new_table_name" : "", "table_partitions" : [] }, "advanced_option_flags" : { "columns_options" : false, "CDC" : false, "sort_by_columns" : false, "incremental_load" : false, "parallel_ingestion" : false, "remove_duplicates" : false, "virtual_column" : false, "table_id" : 37234, "reorder_columns" : false, "table_name" : "aaaa", "parallel_hash_ingestion" : false, "dataplace_id" : 42, "modified_columns" : false, "ingestion_mode" : true, "enable_cache" : false, "ingest_using_query" : false, "schema_id" : 453, "new_table_name" : false, "excluded_column_ids" : false, "table_partitions" : false } }, "valid_from_ts" : "2023-11-15 09:31:16.466337", "cru_by" : "Venkata Yeedi", "object_id" : 37234 } ], "check_compute_engine_validity" : [ { "is_valid_compute_engine" : true } ], "get_non_partition_cols" : [ { "is_virtual" : false, "data_precision" : "0", "destination_datatype_name" : "string", "is_auditcol" : false, "data_length" : "255", "column_name" : "entity_id", "source_field_name" : "entity_id", "field_name" : "entity_id", "column_id" : "956158", "source_datatype_name" : "varchar", "is_partitioned_col" : false, "data_scale" : "0", "ingested_colorder" : 1 }, { "is_virtual" : false, "data_precision" : "0", "destination_datatype_name" : "string", "is_auditcol" : false, "data_length" : "255", "column_name" : "entity_type", "source_field_name" : "entity_type", "field_name" : "entity_type", "column_id" : "956159", "source_datatype_name" : "varchar", "is_partitioned_col" : false, "data_scale" : "0", "ingested_colorder" : 2 } ], "get_partition_cols" : [], "list_of_maps_of_incremental_columns" : [ { "?column?" : 1 } ], "spark_script_inputs" : [ { "ssh_username" : "null", "ssh_host" : "null", "loggroupname" : null, "kerberos" : null, "cloud_watch" : null, "compute_engine_info" : "ewoiY2x1c3Rlcl9pZCI6IjA5MjItMDAzMTM4LW9ybjlyMHRlIiwic3BhcmtfdmVyc2lvbl92YWx1ZSI6IjNfMSIsInNjYWxhX3ZlcnNpb25fdmFsdWUiOiIyXzEyIiwiY3JlZGVudGlhbHNfZmlsZXBhdGgiOiIiLCJjbHVzdGVyX2xpYnJhcnlfcGF0aCI6Ii9kYmZzL3RtcCIsInNwYXJrX3ZlcnNpb24iOiIzLjEiLCJzY2FsYV92ZXJzaW9uIjoiMi4xMiIKfQ==", "private_key_path" : "\/dbfs\/tmp\/dev\/nabu\/17000625869931891\/0\/privateKey", "b64_external_jars_map" : null, "cluster_id" : "0922-003138-orn9r0te", "engine_sub_type" : "azure databricks", "spark_location" : "null", "dataproc_cluster" : "null", "cluster_library_path" : "\/dbfs\/tmp", "data_movement_name" : "ss_compass_adb_validation", "dataproc_project" : "null", "engine_path" : "azure_databricks", "is_bucket_encrypted" : null, "execution_role" : null, "cluster_ui" : null, "s3_bucket_path" : null, "rest_url" : null, "s3logs" : null, "cloud_type" : "null", "release_label" : null, "spark_version" : "3.1", "scala_version" : "2.12", "region" : "null" } ], "column_metadata_output" : [ { "is_virtual" : false, "data_precision" : 0, "is_nullable" : false, "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "table_id" : 37234, "is_precision_scale" : true, "table_name" : "aaaa", "intermediate_datatype_name" : "string", "is_mysql" : false, "is_source_hive" : false, "is_partitioned_col" : false, "user_text" : null, "field_name_replaced" : "entity_id", "is_long_col_name" : false, "is_oracle_destination" : false, "data_length" : 255, "destination_datatype_name" : "string", "column_name" : "entity_id", "source_type" : "sql_server", "schema_name" : "acuity-develop", "is_source_casting_enabled" : false, "is_varchar" : false, "field_name" : "entity_id", "column_id" : 956158, "source_cast_type" : "AsIs", "ordinal_position" : 1, "source_datatype_name" : "varchar", "is_cdc_col" : false, "data_scale" : 0, "replaced_column_name" : "entity_id", "data_type" : "varchar", "is_bigquery" : false, "is_precision" : true, "is_redshift_relational_destination" : false, "source_stg_function" : "AsIs", "istimezone" : false }, { "is_virtual" : false, "data_precision" : 0, "is_nullable" : false, "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "table_id" : 37234, "is_precision_scale" : true, "table_name" : "aaaa", "intermediate_datatype_name" : "string", "is_mysql" : false, "is_source_hive" : false, "is_partitioned_col" : false, "user_text" : null, "field_name_replaced" : "entity_type", "is_long_col_name" : false, "is_oracle_destination" : false, "data_length" : 255, "destination_datatype_name" : "string", "column_name" : "entity_type", "source_type" : "sql_server", "schema_name" : "acuity-develop", "is_source_casting_enabled" : false, "is_varchar" : false, "field_name" : "entity_type", "column_id" : 956159, "source_cast_type" : "AsIs", "ordinal_position" : 2, "source_datatype_name" : "varchar", "is_cdc_col" : false, "data_scale" : 0, "replaced_column_name" : "entity_type", "data_type" : "varchar", "is_bigquery" : false, "is_precision" : true, "is_redshift_relational_destination" : false, "source_stg_function" : "AsIs", "istimezone" : false } ], "updated_wherecondition_replaced_with_default_and_max_values" : [ { "?column?" : 1 } ], "cdc_schema_drift_new_table" : [ { "drift_new_table" : false } ], "emr_input_json" : "ewogICJjbHVzdGVyX2lkIjogIjA5MjItMDAzMTM4LW9ybjlyMHRlIiwKICAiY2x1c3Rlcl9yZWdpb24iOiAibnVsbCIsCiAgImNvbXB1dGVfZW5nX2NyZWRzX2pzb24iOiAiZXdvZ0lDSmpjbVZrWlc1MGFXRnNYMmxrSWpvZ0lqUXhJaXdLSUNBaVkzSmxaR1Z1ZEdsaGJGOTBlWEJsWDJsa0lqb2dJakUxSWl3S0lDQWlZM0psWkdWdWRHbGhiRjkwZVhCbElqb2dJa1pwYkdVZ1EyOXVkR1Z1ZENJc0NpQWdJblJ2YTJWdUlqb2dJbU0yT1RVd05UZ3lZVEV5WWpVMU9HRmlOalE0WTJSaU56SXdNRGd4TnpOaU1tVTROREk0Wm1JMU5XUmhZV1EzTkRBeE5USXlOVFk1TVdWbFl6YzRaV1UzWWpWak5HVXpORE14TW1SbFpEY3dZV1UxWlRkbFpUUTRNMkkzWkRkbFlUQmpNak5sTWpSbE5EVTRaV1F4WmpVMFpHRXpZMk5rTjJSaVkyWmxPRGN3WVRZeFpUVmpPV00xTURnM1pUZG1ZalprWXpFMllqWm1PR1kxWlRSaVpXUmhOVFk1TWpSbE9EZzBPV1ZpTlRNNVlUWXpZalptTXpoak16RTRNR1k0TmprM1pHTXhZMlpoTmpFeE1qTXpNVEF4T1RRMk5HSTFZall3WWprM09XSTVNelppWmpVeE56RmhPVGsyTW1NeFkyRTFOR1k0WldNNE5ESXdOamRoT0RRNFlqa3lNMk0yT1dReU9UbGpObUkzTlRJMFl6QTVOVFF5T1RNd05EQXpNRGxoTVdZNFptUXpPV1kzT0RKa01XSmtPRFkwTTJZek1tRTJOV1poTXpVM01EVTJaV0prWmpCa05UUTVaVEl3WmpCbU1XRXdOVFpsT0RFeU5qTTRNak01Tm1NNVptUTFOR016WVdGbE9XUTRNamhqTm1ZMU5XVTNNMkV5WXpZME5UbGhNREprTlRVeU5HVmhNak0wWXpJd1pEbGxaV1kwTm1ReE5XWmxaR0poTldKbU9UVmxObUppT0RNd1ptRmpaR05oWVdVeE56QTJabU5oTmpFNE1HSmtZakF3TXpWaE9UTmxNalJrTlRjMU5HWTNaREptT0dNek16VTRZbUpoWW1GbE9EbGtZak15T1dKbU16WXpaR1l3WXpFME9HTTFPV0ZoWldWbU5HTmtabVppWkRnM09UQTVNRE13TlRSa05tSTFOR0ZpWmpKbU9UTTFOMlZrWVRCbE5HWm1NekZoWWpBM01UZGxaRFJtWW1Kak1XWTFORFk1TlRnME5EUmhPV014TlRNd1pHSXhPVGd6T1RRMVkyRXhaamc0T1Rjd1pXVTNZMlV3WWpBM056VTROVEV3WVRoa01XSXlZemN3TkRWbU4yVXdZelF4TWpJeE1qUTBaRGczTlRFNFltWmlNVEU1WmpCak1HSXlZVEl4TW1RMU56WTFOMk5rTkROaFpqVmhZbU0wTkdRNU9UVTNOVGt4T1RFeFltUmxZV1kyTWpjNVpEUXpZVEU1TnpJeE16ZzROVEprTTJSbFlqZ3haVEF4T0dObVpESmlaV00wTVRJd1lqRmhaV1l5TkdRMU5tVXpNV015WTJGbE5tRTNZemc0WW1ReE16bGlORFF3TXpBeE5UWTNNbVUyWWpoa05UTm1NamhrTWpNelptSXdObVJqTldSbU5qZGxZalkxTVRsbE9XVTBOR1ZrT1RCbE5HSmlabUk0WWpVM05tTTVZV1poTjJSa1ptRmlNVGRoWmpJeE9XSm1PREV6TldSbE1XWTRaVFptWVRObVpqUTJaVEZoWVdNNU5qbGhabU14WmpSak5UWXlOV1F3WXpZd056VTBabU14WW1Kak16UmhaRFl6WlRVNFlUUm1OMkpsT1RjMU5qWm1OREV6T1dFNVlUUmlZbVl3WW1JeE0yUmhPV0l4TXpRME1ERTVaV1ZtTURnelltSXdOVFZoTW1abE1UQm1abVpqTnpNNVlUSTVZV1JpWW1SaE16TXpZamcwWldSa1pUZzJZalZpTnpZME1qazNaREU1WmpCak1UYzJPRGs1Tmpka1pUQXlNbUV4WkdJNVpERTBZMkZoTjJNNE1ERTRZalV5WXpoaVpUWm1NekV3TnpFM016aGpPV00xTnpFeFl6a3lOREl5T1RFeU5HUmlOakl3TVRFeFpXWmxOakZqWkdVNU5XUTVabVprWkRBME5EQTFOemsyTlRjMk5XTTBZVEF6TVdVMlptSXlZV0ZoWVRsbFpqZGxNVGMxTUdNM05UWmlaV0V5WVRGallUTTRaR0UxWWpaa01qSXpNVEV6TjJJd1pETmtaamswTkRVNE5EZGhORE5sWW1Fek4yRTJOMkV3TWpJNUlpd0tJQ0FpWTNKbFpHVnVkR2xoYkY5bGJtUndiMmx1ZEY5MWNtd2lPaUFpYUhSMGNEb3ZMMlJsZGkxa2FHRXVhSFZ0WVc1aExtTnZiVG80T0RnNUwyWnBjbVZ6YUc5MGN5OWpjbVZrWlc1MGFXRnNjMFpsZEdOb1YyVmlVMlZ5ZG1salpTSXNDaUFnSW1acGJHVmZjR0YwYUNJNklDSXhOVFkzWHpJMk1WOHhOekF3TURZeU5UZzJOall5TnpZNU1TSXNDaUFnSW1OeVpXUmxiblJwWVd4ZlptbHNaVjl3WVhSMFpYSnVJaUE2SUNJME1WOHhOams1TXpReU5UYzFJZ3A5IiwKICAiczNfcGF0aCI6ICIiLAogICJiNjRfaW5wdXRfanNvbiI6ICJld29pY0hKdlkyVnpjMGxrSWpveE56QXdNRFl5TlRnMk9Ua3pNVGc1TVN3S0ltUmhkR0Z3YkdGalpVbGtJam8wTWl3S0luUmhZbXhsU1dRaU9qTTNNak0wTEFvaVpHRjBZVzF2ZG1WdFpXNTBTV1FpT2pJMk1Td0tJbXB2WWxOamFHVmtkV3hsWkZWelpYSkpaQ0k2SWsxaGJtRnpkMmx1YVNCRGFHbHVkR2hoYkdGd2RXUnBJaXdLSW1wdllsTmphR1ZrZFd4bFNXUWlPakUxTmpjc0NpSmlZWFJqYUVsa0lqb3hOekF3TURZeU5UZzJOall5TnpZNU1Td0tJbXhoYzNSU2RXNVVhVzFsYzNSaGJYQWlPaUl5TURJekxURXhMVEEzSURFeU9qUXlPakF3TGpnMk16WTFJaXdLSW5KbGRISjVUblZ0SWpvZ0lqQWlDbjA9IiwKICAiZXh0cmFfY29uZmlnIjogImV3b2laWGgwY21GRGIyNW1hV2ROWVhBaU9pQjdJbk53WVhKckxtNWhZblV1Wm1WMFkyaGZjMmw2WlNJNklDSXhNREF3TUNJc0lDSnpjR0Z5YXk1dVlXSjFMbU52YlhCMWRHVmZaVzVuYVc1bElqb2dJbUY2ZFhKbFgyUmhkR0ZpY21samEzTWlMQ0FpYzNCaGNtc3VibUZpZFM1emIyeHlYMkpoZEdOb1gzTnBlbVVpT2lBaU1UQXdNREFpTENBaWMzQmhjbXN1Ym1GaWRTNWhjSEJzYVdOaGRHbHZibDl1WVcxbElqb2dJbTVoWW5VdGMzQmhjbXRpYjNRdGFXNW5aWE4wYVc5dUlpd2dJbk53WVhKckxtUnlhWFpsY2k1dVlXSjFYM0J5YVhaaGRHVkxaWGtpT2lBaUwyUmlabk12ZEcxd0wyUmxkaTl1WVdKMUx6RTNNREF3TmpJMU9EWTVPVE14T0RreEx6QXZjSEpwZG1GMFpVdGxlU0lzSUNKemNHRnlheTVrY21sMlpYSXVjMjkxY21ObFgyRjNjMTlsYm1SUWIybHVkQ0k2SUNKek15NWhiV0Y2YjI1aGQzTXVZMjl0SWl3Z0luTndZWEpyTG1SeWFYWmxjaTUwWVhKblpYUmZZWGR6WDJWdVpGQnZhVzUwSWpvZ0luTXpMbUZ0WVhwdmJtRjNjeTVqYjIwaUxDQWljM0JoY21zdWJtRmlkUzVqYjIxd2RYUmxYMlZ1WjJsdVpWOXNhV0p6WDNCaGRHZ2lPaUFpTDJSaVpuTXZkRzF3TDJSbGRpOXVZV0oxTHpFM01EQXdOakkxT0RZNU9UTXhPRGt4THpBdllYQndiR2xqWVhScGIyNHVZMjl1WmlKOUNuMD0iLAogICJiYXRjaF9pZCI6IDE3MDAwNjI1ODY2NjI3NjkxLAogICJyZXRyeV9udW0iOiAiMCIsCiAgInNwYXJrX2NvbmZpZ3MiOiAiZXdvZ0lDQWdJbk52YkhKZlltRjBZMmhmYzJsNlpTSTZJakV3TURBd0lpd2ljR0Z5WVd4c1pXeGZkR2h5WldGa2N5STZJakV3SWl3aVptVjBZMmhmYzJsNlpTSTZJakV3TURBd0lnb2dJQ0FnZlE9PSIsCiAgImlzX2J1Y2tldF9lbmNyeXB0ZWQiOiAiIiwKICAiYjY0X2V4dGVybmFsX2phcnNfbWFwIiA6ICIiCn0=", "base64_rsa_compressed_encrypted_creds" : "rO0ABXVyAAJbQqzzF\/gGCFTgAgAAeHAAAAEAFBBvYZ7Mim3fI+Np05VO+EHuf5PxldceVzCwdbLhn99OYytVbAynQS5Ral29GY9WQevohqFq0pptfWmC6Hdze1ChYqC3VXBhBj3fvqRQZTXN3\/gYsSGTxp+834hmfUfQbU0RQ7RnV0wV7zyS1QELwx0d2MbPVdCF1bxRqXdtOn1A4aNwc7Ia7\/cZJEKIjKPAUohAvgCyjsGHSbHQx98WKhSwSU60Sa2dauo11GJkO6jT0fdAUjMDuRgiri0JjVTof4u\/gV\/qzwHpGu\/AH\/Q\/dG8vOv1Stjm43HFpaHjBb2lqw0+JUBuIAqO1SbZmHe1FSy4p09C5Z0pkxSxmLBMQXXVxAH4AAAAAA5D7uBN32zcbCqrcmzijqQfhpAWVqmvEcLxsLpAXN0MnSpwYDURX1Bzr\/vmU9PmJjV114yRnCLXxwgtmVebwcXQpDixTHpTKVjL\/CtOTvSkauTybzdVq1nm6iSti+tUV5IX7blC5I+JVJZcJyd6c83OK54FmVswIUe6LEaVCSaMlYzQNpKT7IKYurmTruiz7hrCJ9ZdIk+fUYt2inQ9BMkqscwFr97n+VE9s\/5MPmsbtG7JCzBniT5ePLh9BIr6dWLfZjG+MKsijpwhUINj3sG\/IbsCtqQuNLGxFV6nZObarxX\/8NiFDOwXitmggN2ZBe0ggcLzMHBDILWwaxnGsByVdmKFxN5DozkOUQM1FX0euvznFtk\/Vd7mu6sTeISNvvpempQuPOLzUew2SfynpCR8gqBp0N4E7JYBYpfeuk4wDcX7y6q7xb+p\/Ir2i90Y+AJxMfcXIH7bDQ8H24cSg2pvx1mIZU9btojRD00BaME1dgJOOI42T1jALDSOWIUSxS84qQ1blakpHAKfp4OFgT6XNQNN1mteDjRcLlLxkTP2azXBeWL3\/1Ix9\/2WLHgbeP4rQG27yM6n+YYQU2OTqKr8nJ7HPbwfY3tiagpKX7VpRnoTq\/he0Db7UxxzVEN12\/Pj8fJUjLXTAfoworuhlYo0AaSYMMt2lIr9gB2FRiH1+RELLTrt\/0tGUjMaOLWL6WU8IZj749J9MUYQ6dTnmQHwUKWsaImYLZIPp5HDwC\/8etfQBMqqYUfn8Mm\/McmjKX7AHB48J4X9BBW4n42bLVwBwBxoIzRoQOVAK95be5uR7X9PQ7mqGpjK6KTWPgSj34dg94SCzm40mhvwW0d+KatJ3Bl\/mXsYXzDK6k7vqIQuuYlm8IVvlScQZSrXMJkQK3kVYlZMnpEM47cgs5s\/AtFNRgD3tIRl28PZBvAoU2RdxpEGJCp97LugjtPmQVwPqHtxZQ2eBAWvcT7prIgNQJgKLvMWSb0S42rDhrEaV3vRYjxxZh2a8odrvFve7mNJjYRvscpOOljnliNBnVW703kNQVjIlNiOu6WezpphGFNzd434k1Fom9cQub82hQgHeGssWwjEmL4lCCtT4rRHxouyik36\/v4js9JSVh4RlgXvGR2daW7KTzqW\/GquJUbJjVarT2iljzwahdM08Mbj9T1uxcDycIuEskdEp6pmFVTMgzRYNjAZbWMGnhdKRWYozgis=", "target_schemadrift_details" : [ { "destination_table_name" : "aaaa", "target_schemadrift_backup_table" : false, "target_schemadrift_ignore_table" : false, "backup_table_name" : "aaaa", "target_schemadrift_new_table" : false, "schema_drifted" : false } ], "generate_file_content_json" : "ewogICJjcmVkZW50aWFsX2lkIjogIjQxIiwKICAiY3JlZGVudGlhbF90eXBlX2lkIjogIjE1IiwKICAiY3JlZGVudGlhbF90eXBlIjogIkZpbGUgQ29udGVudCIsCiAgInRva2VuIjogImM2OTUwNTgyYTEyYjU1OGFiNjQ4Y2RiNzIwMDgxNzNiMmU4NDI4ZmI1NWRhYWQ3NDAxNTIyNTY5MWVlYzc4ZWU3YjVjNGUzNDMxMmRlZDcwYWU1ZTdlZTQ4M2I3ZDdlYTBjMjNlMjRlNDU4ZWQxZjU0ZGEzY2NkN2RiY2ZlODcwYTYxZTVjOWM1MDg3ZTdmYjZkYzE2YjZmOGY1ZTRiZWRhNTY5MjRlODg0OWViNTM5YTYzYjZmMzhjMzE4MGY4Njk3ZGMxY2ZhNjExMjMzMTAxOTQ2NGI1YjYwYjk3OWI5MzZiZjUxNzFhOTk2MmMxY2E1NGY4ZWM4NDIwNjdhODQ4YjkyM2M2OWQyOTljNmI3NTI0YzA5NTQyOTMwNDAzMDlhMWY4ZmQzOWY3ODJkMWJkODY0M2YzMmE2NWZhMzU3MDU2ZWJkZjBkNTQ5ZTIwZjBmMWEwNTZlODEyNjM4MjM5NmM5ZmQ1NGMzYWFlOWQ4MjhjNmY1NWU3M2EyYzY0NTlhMDJkNTUyNGVhMjM0YzIwZDllZWY0NmQxNWZlZGJhNWJmOTVlNmJiODMwZmFjZGNhYWUxNzA2ZmNhNjE4MGJkYjAwMzVhOTNlMjRkNTc1NGY3ZDJmOGMzMzU4YmJhYmFlODlkYjMyOWJmMzYzZGYwYzE0OGM1OWFhZWVmNGNkZmZiZDg3OTA5MDMwNTRkNmI1NGFiZjJmOTM1N2VkYTBlNGZmMzFhYjA3MTdlZDRmYmJjMWY1NDY5NTg0NDRhOWMxNTMwZGIxOTgzOTQ1Y2ExZjg4OTcwZWU3Y2UwYjA3NzU4NTEwYThkMWIyYzcwNDVmN2UwYzQxMjIxMjQ0ZDg3NTE4YmZiMTE5ZjBjMGIyYTIxMmQ1NzY1N2NkNDNhZjVhYmM0NGQ5OTU3NTkxOTExYmRlYWY2Mjc5ZDQzYTE5NzIxMzg4NTJkM2RlYjgxZTAxOGNmZDJiZWM0MTIwYjFhZWYyNGQ1NmUzMWMyY2FlNmE3Yzg4YmQxMzliNDQwMzAxNTY3MmU2YjhkNTNmMjhkMjMzZmIwNmRjNWRmNjdlYjY1MTllOWU0NGVkOTBlNGJiZmI4YjU3NmM5YWZhN2RkZmFiMTdhZjIxOWJmODEzNWRlMWY4ZTZmYTNmZjQ2ZTFhYWM5NjlhZmMxZjRjNTYyNWQwYzYwNzU0ZmMxYmJjMzRhZDYzZTU4YTRmN2JlOTc1NjZmNDEzOWE5YTRiYmYwYmIxM2RhOWIxMzQ0MDE5ZWVmMDgzYmIwNTVhMmZlMTBmZmZjNzM5YTI5YWRiYmRhMzMzYjg0ZWRkZTg2YjViNzY0Mjk3ZDE5ZjBjMTc2ODk5NjdkZTAyMmExZGI5ZDE0Y2FhN2M4MDE4YjUyYzhiZTZmMzEwNzE3MzhjOWM1NzExYzkyNDIyOTEyNGRiNjIwMTExZWZlNjFjZGU5NWQ5ZmZkZDA0NDA1Nzk2NTc2NWM0YTAzMWU2ZmIyYWFhYTllZjdlMTc1MGM3NTZiZWEyYTFjYTM4ZGE1YjZkMjIzMTEzN2IwZDNkZjk0NDU4NDdhNDNlYmEzN2E2N2EwMjI5IiwKICAiY3JlZGVudGlhbF9lbmRwb2ludF91cmwiOiAiaHR0cDovL2Rldi1kaGEuaHVtYW5hLmNvbTo4ODg5L2ZpcmVzaG90cy9jcmVkZW50aWFsc0ZldGNoV2ViU2VydmljZSIsCiAgImZpbGVfcGF0aCI6ICIxNTY3XzI2MV8xNzAwMDYyNTg2NjYyNzY5MSIsCiAgImNyZWRlbnRpYWxfZmlsZV9wYXR0ZXJuIiA6ICI0MV8xNjk5MzQyNTc1Igp9", "get_view_info" : [ { "id" : 1 } ], "get_already_ingested_condition" : [ { "already_ingested" : true } ], "sort_by_columns_data" : [], "fetching_credential_inputs" : [ { "credential_type" : "File Content", "metastore_credential_type_id" : null, "credential_type_id" : 15, "metastore_credential_id" : null, "credential_pattern" : "41_1699342575", "spark_credential_id" : 41 } ], "get_varchar_columns" : [], "generate_spark_configs_json" : "ewogICAgInNvbHJfYmF0Y2hfc2l6ZSI6IjEwMDAwIiwicGFyYWxsZWxfdGhyZWFkcyI6IjEwIiwiZmV0Y2hfc2l6ZSI6IjEwMDAwIgogICAgfQ==" }, "batch_id" : "17000625866627691", "template_execution_type" : "single", "query_type" : "json", "currentBotMessageMap" : { "parent_id" : "af56d8ab-458b-4c73-86bf-553c24550201", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "message_context" : "ingestion_deciding", "message_id" : "6595c16c-9675-4ed2-8674-08d9d8e09b79", "task_retry_intervals_secs" : [], "bot_id" : "b006ad5b-9517-4ef8-87e2-7c6dea91f146", "message_topic" : "nabu_2_jdbc", "tags" : { "process_id" : 17000625869931891, "batch_id" : 17000625866627691, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "tags" : [ "AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot", "KoshBot", "DBOpsBot" ], "initial_ts" : 1700062586993, "batch_name" : "Ingestion_20231115", "environment" : "modak", "job_schedule_id" : 1567, "data_movement_id" : 261, "last_run_timestamp" : "2023-11-07 12:42:00.86365", "retry_attempt" : 0, "task_dependency" : true, "ignore_job_termination" : false } } }, "template_execution_type" : "single", "query_type" : "json", "currentBotMessageMap" : { "parent_id" : "6595c16c-9675-4ed2-8674-08d9d8e09b79", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "message_context" : "spark_buffer_msg", "message_id" : "f9af8fe7-d4e3-4a83-8400-4c22ce532ac9", "task_retry_intervals_secs" : [], "bot_id" : "b878e324-4b30-4eeb-9a2a-3f769c50e67c", "message_topic" : "nabu_2_jdbc", "tags" : { "process_id" : 17000625869931891, "batch_id" : 17000625866627691, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "tags" : [ "AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot", "KoshBot", "DBOpsBot", "DBOpsBot" ], "initial_ts" : 1700062586993, "batch_name" : "Ingestion_20231115", "environment" : "modak", "job_schedule_id" : 1567, "data_movement_id" : 261, "last_run_timestamp" : "2023-11-07 12:42:00.86365", "retry_attempt" : 0, "task_dependency" : true, "ignore_job_termination" : false } } }, "retry_attempt": 0, "flow_number": 1, "data_movement_id": 261, "where_condition": "37234", "process_id": 17000625869931891, "job_scheduled_user_id": "Manaswini Chinthalapudi", "batch_id": 17000625866627691, "last_run_timestamp": "2023-11-07 12:42:00.86365", "schema_drift_flag": false, "ssh_host": "null", "ssh_username": "null", "engine_path": "azure_databricks", "compute_engine_info": "ewoiY2x1c3Rlcl9pZCI6IjA5MjItMDAzMTM4LW9ybjlyMHRlIiwic3BhcmtfdmVyc2lvbl92YWx1ZSI6IjNfMSIsInNjYWxhX3ZlcnNpb25fdmFsdWUiOiIyXzEyIiwiY3JlZGVudGlhbHNfZmlsZXBhdGgiOiIiLCJjbHVzdGVyX2xpYnJhcnlfcGF0aCI6Ii9kYmZzL3RtcCIsInNwYXJrX3ZlcnNpb24iOiIzLjEiLCJzY2FsYV92ZXJzaW9uIjoiMi4xMiIKfQ==", "spark_location": "null", "template_group": "templates/artifact_ingestion/ingestion_templates.stg", "destination": "adls_gen2", "spark_application_template": "insert_spark_application_details", "source_endpoint": "s3.amazonaws.com", "destination_endpoint": "s3.amazonaws.com", "is_create_table": false, "spark_credential_info": "ewogICJjcmVkZW50aWFsX2lkIjogIjQxIiwKICAiY3JlZGVudGlhbF90eXBlX2lkIjogIjE1IiwKICAiY3JlZGVudGlhbF90eXBlIjogIkZpbGUgQ29udGVudCIsCiAgInRva2VuIjogImM2OTUwNTgyYTEyYjU1OGFiNjQ4Y2RiNzIwMDgxNzNiMmU4NDI4ZmI1NWRhYWQ3NDAxNTIyNTY5MWVlYzc4ZWU3YjVjNGUzNDMxMmRlZDcwYWU1ZTdlZTQ4M2I3ZDdlYTBjMjNlMjRlNDU4ZWQxZjU0ZGEzY2NkN2RiY2ZlODcwYTYxZTVjOWM1MDg3ZTdmYjZkYzE2YjZmOGY1ZTRiZWRhNTY5MjRlODg0OWViNTM5YTYzYjZmMzhjMzE4MGY4Njk3ZGMxY2ZhNjExMjMzMTAxOTQ2NGI1YjYwYjk3OWI5MzZiZjUxNzFhOTk2MmMxY2E1NGY4ZWM4NDIwNjdhODQ4YjkyM2M2OWQyOTljNmI3NTI0YzA5NTQyOTMwNDAzMDlhMWY4ZmQzOWY3ODJkMWJkODY0M2YzMmE2NWZhMzU3MDU2ZWJkZjBkNTQ5ZTIwZjBmMWEwNTZlODEyNjM4MjM5NmM5ZmQ1NGMzYWFlOWQ4MjhjNmY1NWU3M2EyYzY0NTlhMDJkNTUyNGVhMjM0YzIwZDllZWY0NmQxNWZlZGJhNWJmOTVlNmJiODMwZmFjZGNhYWUxNzA2ZmNhNjE4MGJkYjAwMzVhOTNlMjRkNTc1NGY3ZDJmOGMzMzU4YmJhYmFlODlkYjMyOWJmMzYzZGYwYzE0OGM1OWFhZWVmNGNkZmZiZDg3OTA5MDMwNTRkNmI1NGFiZjJmOTM1N2VkYTBlNGZmMzFhYjA3MTdlZDRmYmJjMWY1NDY5NTg0NDRhOWMxNTMwZGIxOTgzOTQ1Y2ExZjg4OTcwZWU3Y2UwYjA3NzU4NTEwYThkMWIyYzcwNDVmN2UwYzQxMjIxMjQ0ZDg3NTE4YmZiMTE5ZjBjMGIyYTIxMmQ1NzY1N2NkNDNhZjVhYmM0NGQ5OTU3NTkxOTExYmRlYWY2Mjc5ZDQzYTE5NzIxMzg4NTJkM2RlYjgxZTAxOGNmZDJiZWM0MTIwYjFhZWYyNGQ1NmUzMWMyY2FlNmE3Yzg4YmQxMzliNDQwMzAxNTY3MmU2YjhkNTNmMjhkMjMzZmIwNmRjNWRmNjdlYjY1MTllOWU0NGVkOTBlNGJiZmI4YjU3NmM5YWZhN2RkZmFiMTdhZjIxOWJmODEzNWRlMWY4ZTZmYTNmZjQ2ZTFhYWM5NjlhZmMxZjRjNTYyNWQwYzYwNzU0ZmMxYmJjMzRhZDYzZTU4YTRmN2JlOTc1NjZmNDEzOWE5YTRiYmYwYmIxM2RhOWIxMzQ0MDE5ZWVmMDgzYmIwNTVhMmZlMTBmZmZjNzM5YTI5YWRiYmRhMzMzYjg0ZWRkZTg2YjViNzY0Mjk3ZDE5ZjBjMTc2ODk5NjdkZTAyMmExZGI5ZDE0Y2FhN2M4MDE4YjUyYzhiZTZmMzEwNzE3MzhjOWM1NzExYzkyNDIyOTEyNGRiNjIwMTExZWZlNjFjZGU5NWQ5ZmZkZDA0NDA1Nzk2NTc2NWM0YTAzMWU2ZmIyYWFhYTllZjdlMTc1MGM3NTZiZWEyYTFjYTM4ZGE1YjZkMjIzMTEzN2IwZDNkZjk0NDU4NDdhNDNlYmEzN2E2N2EwMjI5IiwKICAiY3JlZGVudGlhbF9lbmRwb2ludF91cmwiOiAiaHR0cDovL2Rldi1kaGEuaHVtYW5hLmNvbTo4ODg5L2ZpcmVzaG90cy9jcmVkZW50aWFsc0ZldGNoV2ViU2VydmljZSIsCiAgImZpbGVfcGF0aCI6ICIxNTY3XzI2MV8xNzAwMDYyNTg2NjYyNzY5MSIsCiAgImNyZWRlbnRpYWxfZmlsZV9wYXR0ZXJuIiA6ICI0MV8xNjk5MzQyNTc1Igp9" }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "task_status_success_msg" } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "error_template_create_msg" } ] }, { "task_name": "run_almaren_ingestion_job_using_spark", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "pre_task_logging_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "pre_log_template" }, "app_template_details": { "template_group": "templates/artifact_ingestion/ingestion_templates.stg", "template_name": "command_to_run_almaren_ingestion" }, "input_data": { "is_valid_compute_engine":true, "data": { "batch_id" : "17000625866627691", "templateData" : { "query_input" : { "target_schemadrift_flag" : [ { "nextrun_after_targetdrift" : false } ], "input_json_for_checkpoint_status" : "ewoicHJvY2Vzc0lkIjoxNzAwMDYyNTg2OTkzMTg5MSwKImRhdGFwbGFjZUlkIjo0MiwKInRhYmxlSWQiOjM3MjM0LAoiZGF0YW1vdmVtZW50SWQiOjI2MSwKImpvYlNjaGVkdWxlZFVzZXJJZCI6Ik1hbmFzd2luaSBDaGludGhhbGFwdWRpIiwKImpvYlNjaGVkdWxlSWQiOjE1NjcsCiJiYXRjaElkIjoxNzAwMDYyNTg2NjYyNzY5MSwKImxhc3RSdW5UaW1lc3RhbXAiOiIyMDIzLTExLTA3IDEyOjQyOjAwLjg2MzY1IiwKInJldHJ5TnVtIjogIjAiCn0=", "get_cdc_last_run_table" : [ { "prev_target_path" : null, "cdc_first" : true, "relative_path" : "\/261\/42\/development-db\/acuity-develop\/aaaa.parquet", "target_path" : "abfss:\/\/dataproc@idea15pisplznonprodsa2.dfs.core.windows.net\/261\/42\/development-db\/acuity-develop\/aaaa.parquet" } ], "get_cdc_type" : [ { "cdc_applied" : false, "is_primary" : false, "cdctype2" : false, "temp_path" : "17000625869931891_aaaa" } ], "generate_yeedu_metastore_credential" : "ewogICJjcmVkZW50aWFsX2lkIjogIiIsCiAgImNyZWRlbnRpYWxfdHlwZV9pZCI6ICIiLAogICJ0b2tlbiI6ICJjNjk1MDU4MmExMmI1NThhYjY0OGNkYjcyMDA4MTczYjJlODQyOGZiNTVkYWFkNzQwMTUyMjU2OTFlZWM3OGVlN2I1YzRlMzQzMTJkZWQ3MGFlNWU3ZWU0ODNiN2Q3ZWEwYzIzZTI0ZTQ1OGVkMWY1NGRhM2NjZDdkYmNmZTg3MGE2MWU1YzljNTA4N2U3ZmI2ZGMxNmI2ZjhmNWU0YmVkYTU2OTI0ZTg4NDllYjUzOWE2M2I2ZjM4YzMxODBmODY5N2RjMWNmYTYxMTIzMzEwMTk0NjRiNWI2MGI5NzliOTM2YmY1MTcxYTk5NjJjMWNhNTRmOGVjODQyMDY3YTg0OGI5MjNjNjlkMjk5YzZiNzUyNGMwOTU0MjkzMDQwMzA5YTFmOGZkMzlmNzgyZDFiZDg2NDNmMzJhNjVmYTM1NzA1NmViZGYwZDU0OWUyMGYwZjFhMDU2ZTgxMjYzODIzOTZjOWZkNTRjM2FhZTlkODI4YzZmNTVlNzNhMmM2NDU5YTAyZDU1MjRlYTIzNGMyMGQ5ZWVmNDZkMTVmZWRiYTViZjk1ZTZiYjgzMGZhY2RjYWFlMTcwNmZjYTYxODBiZGIwMDM1YTkzZTI0ZDU3NTRmN2QyZjhjMzM1OGJiYWJhZTg5ZGIzMjliZjM2M2RmMGMxNDhjNTlhYWVlZjRjZGZmYmQ4NzkwOTAzMDU0ZDZiNTRhYmYyZjkzNTdlZGEwZTRmZjMxYWIwNzE3ZWQ0ZmJiYzFmNTQ2OTU4NDQ0YTljMTUzMGRiMTk4Mzk0NWNhMWY4ODk3MGVlN2NlMGIwNzc1ODUxMGE4ZDFiMmM3MDQ1ZjdlMGM0MTIyMTI0NGQ4NzUxOGJmYjExOWYwYzBiMmEyMTJkNTc2NTdjZDQzYWY1YWJjNDRkOTk1NzU5MTkxMWJkZWFmNjI3OWQ0M2ExOTcyMTM4ODUyZDNkZWI4MWUwMThjZmQyYmVjNDEyMGIxYWVmMjRkNTZlMzFjMmNhZTZhN2M4OGJkMTM5YjQ0MDMwMTU2NzJlNmI4ZDUzZjI4ZDIzM2ZiMDZkYzVkZjY3ZWI2NTE5ZTllNDRlZDkwZTRiYmZiOGI1NzZjOWFmYTdkZGZhYjE3YWYyMTliZjgxMzVkZTFmOGU2ZmEzZmY0NmUxYWFjOTY5YWZjMWY0YzU2MjVkMGM2MDc1NGZjMWJiYzM0YWQ2M2U1OGE0ZjdiZTk3NTY2ZjQxMzlhOWE0YmJmMGJiMTNkYTliMTM0NDAxOWVlZjA4M2JiMDU1YTJmZTEwZmZmYzczOWEyOWFkYmJkYTMzM2I4NGVkZGU4NmI1Yjc2NDI5N2QxOWYwYzE3Njg5OTY3ZGUwMjJhMWRiOWQxNGNhYTdjODAxOGI1MmM4YmU2ZjMxMDcxNzM4YzljNTcxMWM5MjQyMjkxMjRkYjYyMDExMWVmZTYxY2RlOTVkOWZmZGQwNDQwNTc5NjU3NjVjNGEwMzFlNmZiMmFhYWE5ZWY3ZTE3NTBjNzU2YmVhMmExY2EzOGRhNWI2ZDIyMzExMzdiMGQzZGY5NDQ1ODQ3YTQzZWJhMzdhNjdhMDIyOSIsCiAgImNyZWRlbnRpYWxfZW5kcG9pbnRfdXJsIjogImh0dHA6Ly9kZXYtZGhhLmh1bWFuYS5jb206ODg4OS9maXJlc2hvdHMvY3JlZGVudGlhbHNGZXRjaFdlYlNlcnZpY2UiCn0=", "table_metadata_output" : [ { "end_point" : "http:\/\/dev-dha.humana.com:8889\/fireshots\/credentialsFetchWebService", "is_filesystem_credential_type_aws" : true, "table_name" : "aaaa", "s3_bucket" : null, "path" : "", "is_lazy_mode" : false, "destination_type" : "adls_gen2", "archive_files_path" : "", "rename_table_condition" : false, "adls_gen2_directory_name" : null, "is_archive_data" : false, "destination_db" : null, "bucket_name" : null, "source_type" : "sql_server", "credential_pattern" : "2_1686574260", "is_destination_hive" : false, "estimated_rows" : 4914, "destination_file_format" : "parquet", "warehouse_name" : null, "filesystem_credential_type" : null, "is_aws_iam_attached_to_ec2_instance" : false, "is_bigquery" : false, "is_source_filetype" : false, "source_jdbc_url" : "jdbc:sqlserver:\/\/hyp-acu-development-5de0.database.windows.net:1433;database=development-db;sslProtocol=TLSv1.2;encrypt=true", "flow_number" : 1, "batch_id" : 17000625866627691, "destination_url" : null, "filesystem_credential_type_id" : null, "schema_drift_flag" : false, "is_mysql" : false, "filesystem_credential_id" : null, "destination_directory" : null, "source_credential_type_id" : 1, "destination_backup_table_name" : "aaaa", "destination_table_name" : "aaaa", "destination_dataplace_sub_component_id" : 18, "is_azure_oauth" : false, "gcs_bucket" : null, "source_directory" : null, "is_file_system_type_s3a" : false, "destination_schema_directory_id" : 3, "intermediate_type" : "parquet", "is_source_jdbc_url" : true, "is_source_spark_hive" : false, "batch_name" : "Ingestion_20231115", "source_endpoint" : "s3.amazonaws.com", "upper_case_destination_table_name" : "AAAA", "source_credential_id" : 37, "destination_credential_type_id" : 5, "adls_gen2_container" : "dataproc", "source_default_credential_exists" : false, "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDYyNjA0ODY3ODczNSwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0NTQwNSwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2MjYwNH0.TdlKYjNFZRULplibTKTBiTeNTShCsDicocUZq9KQkMiynWn2WsDoCNVj1Gnby5Zevba71EIlyJc7hK0-wksFFLDOu-AutbS3q-JSjcWr7zHFmWQ3NR6Xs_ycLsdTfh9HnCPt4R-GHKm9SOS5CzT6JBg08gb9cZtV2havzmaG4v9vckfKagGuftWnBKcsQNp2h9zB_EDYLVdDOUd_Aa8UHMklrT8W0SjKoDgbHVZ5T506nwQL-nXZYY0_YHP9KqDtPRiRq-k6db434A4pMx6BkTAG1z355WIuqa1fwRtrSB5HZQULpX85KD8FMpbt2gBBHWDn01TnO5_crpf0lv-SfQ", "project" : null, "source_table_name" : "aaaa", "table_id" : 37234, "authentication_type" : "auth_token", "source_url" : null, "destination_endpoint" : "s3.amazonaws.com", "schema_id" : 453, "datamovement_engine_type" : "Spark", "relative_file_path" : "", "filesystem_credential_epoch" : null, "is_needed_partition_name_without_column_name" : false, "table_suffix" : "", "schema_name" : "acuity-develop", "is_record_process_enabled" : true, "is_default" : false, "is_jdbcmode" : false, "table_timestamp" : "", "verification_threshold" : 0.1, "pipeline_flow_timeout" : 23, "dest_default_credential_exists" : false, "process_id" : 17000625869931891, "is_destination_file" : true, "where_condition" : "37234", "source_dataplace_id" : 42, "file_system_type" : "abfss", "is_ingestion_root_path" : false, "is_source_hive" : false, "destination_oracle_jdbc_url" : null, "schema_drift_option" : "drop_create_table", "ingestion_table_format" : "", "already_ingested" : true, "destination_dataplace_id" : 5, "destination_credential_id" : 2, "file_format" : "", "create_backup_table" : null, "destination_dataplace_component_type_id" : 3, "source_jdbc_driver" : "com.microsoft.sqlserver.jdbc.SQLServerDriver", "destination_schema_name" : "dataproc", "source_db" : "development-db", "apply_transformation" : false, "target_type" : "adls_gen2", "oracle_jdbc_url" : null, "destination_schema_id" : 3, "dataplace_id" : 42, "filesystem_endpoint" : null, "is_spark_hive" : false, "destination_jdbc_driver" : null, "data_movement_id" : 261, "storage_account" : "idea15pisplznonprodsa2", "is_relative_file_path" : false, "is_create_table" : false, "is_apache_jdbc_driver" : false } ], "get_cdc_audit_cols" : [], "get_list_of_maps_of_partition_columns" : [ { "?column?" : "null" } ], "get_cdc_info" : [ { "job_id_column_name" : "process_id", "prev_job_id_column_name" : "prev_process_id", "is_sha2" : false, "add_audit_columns" : false, "end_date_column_name" : "valid_to_ts", "create_view" : false, "start_date_column_name" : "valid_from_ts", "hash_type" : "", "view_name" : "v_aaaa" } ], "get_spark_configs" : [ { "cluster_id" : null, "config_json" : { "extra_configs" : {}, "default_configs" : { "solr_batch_size" : "10000", "parallel_threads" : "10", "fetch_size" : "10000" } }, "spark_configuration_type_id" : 1, "spark_configs_json" : "{\n \"solr_batch_size\":\"10000\",\"parallel_threads\":\"10\",\"fetch_size\":\"10000\"\n }", "compute_engine_id" : 11, "extra_configs_json" : { "spark.nabu.fetch_size" : "10000", "spark.nabu.solr_batch_size" : "10000" } } ], "advanced_options_tables_flags_status" : [ { "columns_options" : false, "cdc" : null, "sort_by_columns" : false, "incremental_load" : false, "parallel_ingestion" : false, "remove_duplicates" : false, "virtual_column" : false, "reorder_columns" : false, "modified_columns" : false, "ingestion_mode" : true, "enable_cache" : false, "ingest_using_query" : false, "new_table_name" : false, "excluded_column_ids" : false, "table_partitions" : false } ], "yeedu_input_json" : "ewoiY2x1c3Rlcl9pZCI6ICIiLAoiYjY0X2lucHV0X2pzb24iOiAiZXdvaWNISnZZMlZ6YzBsa0lqb3hOekF3TURZeU5UZzJPVGt6TVRnNU1Td0tJbVJoZEdGd2JHRmpaVWxrSWpvME1pd0tJblJoWW14bFNXUWlPak0zTWpNMExBb2laR0YwWVcxdmRtVnRaVzUwU1dRaU9qSTJNU3dLSW1wdllsTmphR1ZrZFd4bFpGVnpaWEpKWkNJNklrMWhibUZ6ZDJsdWFTQkRhR2x1ZEdoaGJHRndkV1JwSWl3S0ltcHZZbE5qYUdWa2RXeGxTV1FpT2pFMU5qY3NDaUppWVhSamFFbGtJam94TnpBd01EWXlOVGcyTmpZeU56WTVNU3dLSW14aGMzUlNkVzVVYVcxbGMzUmhiWEFpT2lJeU1ESXpMVEV4TFRBM0lERXlPalF5T2pBd0xqZzJNelkxSWl3S0luSmxkSEo1VG5WdElqb2dJakFpQ24wPSIsCiJleHRyYV9jb25maWciOiAiZXdvaVpYaDBjbUZEYjI1bWFXZE5ZWEFpT2lCN0luTndZWEpyTG01aFluVXVabVYwWTJoZmMybDZaU0k2SUNJeE1EQXdNQ0lzSUNKemNHRnlheTV1WVdKMUxtTnZiWEIxZEdWZlpXNW5hVzVsSWpvZ0ltRjZkWEpsWDJSaGRHRmljbWxqYTNNaUxDQWljM0JoY21zdWJtRmlkUzV6YjJ4eVgySmhkR05vWDNOcGVtVWlPaUFpTVRBd01EQWlMQ0FpYzNCaGNtc3VibUZpZFM1aGNIQnNhV05oZEdsdmJsOXVZVzFsSWpvZ0ltNWhZblV0YzNCaGNtdGliM1F0YVc1blpYTjBhVzl1SWl3Z0luTndZWEpyTG1SeWFYWmxjaTV1WVdKMVgzQnlhWFpoZEdWTFpYa2lPaUFpTDJSaVpuTXZkRzF3TDJSbGRpOXVZV0oxTHpFM01EQXdOakkxT0RZNU9UTXhPRGt4THpBdmNISnBkbUYwWlV0bGVTSXNJQ0p6Y0dGeWF5NWtjbWwyWlhJdWMyOTFjbU5sWDJGM2MxOWxibVJRYjJsdWRDSTZJQ0p6TXk1aGJXRjZiMjVoZDNNdVkyOXRJaXdnSW5Od1lYSnJMbVJ5YVhabGNpNTBZWEpuWlhSZllYZHpYMlZ1WkZCdmFXNTBJam9nSW5NekxtRnRZWHB2Ym1GM2N5NWpiMjBpTENBaWMzQmhjbXN1Ym1GaWRTNWpiMjF3ZFhSbFgyVnVaMmx1WlY5c2FXSnpYM0JoZEdnaU9pQWlMMlJpWm5NdmRHMXdMMlJsZGk5dVlXSjFMekUzTURBd05qSTFPRFk1T1RNeE9Ea3hMekF2WVhCd2JHbGpZWFJwYjI0dVkyOXVaaUo5Q24wPSIsCiJjb21wdXRlX2VuZ19jcmVkc19qc29uIiA6ICJld29nSUNKamNtVmtaVzUwYVdGc1gybGtJam9nSWpReElpd0tJQ0FpWTNKbFpHVnVkR2xoYkY5MGVYQmxYMmxrSWpvZ0lqRTFJaXdLSUNBaVkzSmxaR1Z1ZEdsaGJGOTBlWEJsSWpvZ0lrWnBiR1VnUTI5dWRHVnVkQ0lzQ2lBZ0luUnZhMlZ1SWpvZ0ltTTJPVFV3TlRneVlURXlZalUxT0dGaU5qUTRZMlJpTnpJd01EZ3hOek5pTW1VNE5ESTRabUkxTldSaFlXUTNOREF4TlRJeU5UWTVNV1ZsWXpjNFpXVTNZalZqTkdVek5ETXhNbVJsWkRjd1lXVTFaVGRsWlRRNE0ySTNaRGRsWVRCak1qTmxNalJsTkRVNFpXUXhaalUwWkdFelkyTmtOMlJpWTJabE9EY3dZVFl4WlRWak9XTTFNRGczWlRkbVlqWmtZekUyWWpabU9HWTFaVFJpWldSaE5UWTVNalJsT0RnME9XVmlOVE01WVRZellqWm1NemhqTXpFNE1HWTROamszWkdNeFkyWmhOakV4TWpNek1UQXhPVFEyTkdJMVlqWXdZamszT1dJNU16WmlaalV4TnpGaE9UazJNbU14WTJFMU5HWTRaV000TkRJd05qZGhPRFE0WWpreU0yTTJPV1F5T1Rsak5tSTNOVEkwWXpBNU5UUXlPVE13TkRBek1EbGhNV1k0Wm1Rek9XWTNPREprTVdKa09EWTBNMll6TW1FMk5XWmhNelUzTURVMlpXSmtaakJrTlRRNVpUSXdaakJtTVdFd05UWmxPREV5TmpNNE1qTTVObU01Wm1RMU5HTXpZV0ZsT1dRNE1qaGpObVkxTldVM00yRXlZelkwTlRsaE1ESmtOVFV5TkdWaE1qTTBZekl3WkRsbFpXWTBObVF4TldabFpHSmhOV0ptT1RWbE5tSmlPRE13Wm1GalpHTmhZV1V4TnpBMlptTmhOakU0TUdKa1lqQXdNelZoT1RObE1qUmtOVGMxTkdZM1pESm1PR016TXpVNFltSmhZbUZsT0Rsa1lqTXlPV0ptTXpZelpHWXdZekUwT0dNMU9XRmhaV1ZtTkdOa1ptWmlaRGczT1RBNU1ETXdOVFJrTm1JMU5HRmlaakptT1RNMU4yVmtZVEJsTkdabU16RmhZakEzTVRkbFpEUm1ZbUpqTVdZMU5EWTVOVGcwTkRSaE9XTXhOVE13WkdJeE9UZ3pPVFExWTJFeFpqZzRPVGN3WldVM1kyVXdZakEzTnpVNE5URXdZVGhrTVdJeVl6Y3dORFZtTjJVd1l6UXhNakl4TWpRMFpEZzNOVEU0WW1aaU1URTVaakJqTUdJeVlUSXhNbVExTnpZMU4yTmtORE5oWmpWaFltTTBOR1E1T1RVM05Ua3hPVEV4WW1SbFlXWTJNamM1WkRRellURTVOekl4TXpnNE5USmtNMlJsWWpneFpUQXhPR05tWkRKaVpXTTBNVEl3WWpGaFpXWXlOR1ExTm1Vek1XTXlZMkZsTm1FM1l6ZzRZbVF4TXpsaU5EUXdNekF4TlRZM01tVTJZamhrTlRObU1qaGtNak16Wm1Jd05tUmpOV1JtTmpkbFlqWTFNVGxsT1dVME5HVmtPVEJsTkdKaVptSTRZalUzTm1NNVlXWmhOMlJrWm1GaU1UZGhaakl4T1dKbU9ERXpOV1JsTVdZNFpUWm1ZVE5tWmpRMlpURmhZV001TmpsaFptTXhaalJqTlRZeU5XUXdZell3TnpVMFptTXhZbUpqTXpSaFpEWXpaVFU0WVRSbU4ySmxPVGMxTmpabU5ERXpPV0U1WVRSaVltWXdZbUl4TTJSaE9XSXhNelEwTURFNVpXVm1NRGd6WW1Jd05UVmhNbVpsTVRCbVptWmpOek01WVRJNVlXUmlZbVJoTXpNellqZzBaV1JrWlRnMllqVmlOelkwTWprM1pERTVaakJqTVRjMk9EazVOamRrWlRBeU1tRXhaR0k1WkRFMFkyRmhOMk00TURFNFlqVXlZemhpWlRabU16RXdOekUzTXpoak9XTTFOekV4WXpreU5ESXlPVEV5TkdSaU5qSXdNVEV4WldabE5qRmpaR1U1TldRNVptWmtaREEwTkRBMU56azJOVGMyTldNMFlUQXpNV1UyWm1JeVlXRmhZVGxsWmpkbE1UYzFNR00zTlRaaVpXRXlZVEZqWVRNNFpHRTFZalprTWpJek1URXpOMkl3WkROa1pqazBORFU0TkRkaE5ETmxZbUV6TjJFMk4yRXdNakk1SWl3S0lDQWlZM0psWkdWdWRHbGhiRjlsYm1Sd2IybHVkRjkxY213aU9pQWlhSFIwY0RvdkwyUmxkaTFrYUdFdWFIVnRZVzVoTG1OdmJUbzRPRGc1TDJacGNtVnphRzkwY3k5amNtVmtaVzUwYVdGc2MwWmxkR05vVjJWaVUyVnlkbWxqWlNJc0NpQWdJbVpwYkdWZmNHRjBhQ0k2SUNJeE5UWTNYekkyTVY4eE56QXdNRFl5TlRnMk5qWXlOelk1TVNJc0NpQWdJbU55WldSbGJuUnBZV3hmWm1sc1pWOXdZWFIwWlhKdUlpQTZJQ0kwTVY4eE5qazVNelF5TlRjMUlncDkiLAoiY2x1c3Rlcl91aSI6ICIiLAoicmV0cnlfbnVtIjogIjAiLAoic3BhcmtfY29uZmlncyI6ICJld29nSUNBZ0luTnZiSEpmWW1GMFkyaGZjMmw2WlNJNklqRXdNREF3SWl3aWNHRnlZV3hzWld4ZmRHaHlaV0ZrY3lJNklqRXdJaXdpWm1WMFkyaGZjMmw2WlNJNklqRXdNREF3SWdvZ0lDQWdmUT09IiwKImI2NF9oaXZlX2NyZWRzX2pzb24iOiAiZXdvZ0lDSmpjbVZrWlc1MGFXRnNYMmxrSWpvZ0lpSXNDaUFnSW1OeVpXUmxiblJwWVd4ZmRIbHdaVjlwWkNJNklDSWlMQW9nSUNKMGIydGxiaUk2SUNKak5qazFNRFU0TW1FeE1tSTFOVGhoWWpZME9HTmtZamN5TURBNE1UY3pZakpsT0RReU9HWmlOVFZrWVdGa056UXdNVFV5TWpVMk9URmxaV00zT0dWbE4ySTFZelJsTXpRek1USmtaV1EzTUdGbE5XVTNaV1UwT0ROaU4yUTNaV0V3WXpJelpUSTBaVFExT0dWa01XWTFOR1JoTTJOalpEZGtZbU5tWlRnM01HRTJNV1UxWXpsak5UQTROMlUzWm1JMlpHTXhObUkyWmpobU5XVTBZbVZrWVRVMk9USTBaVGc0TkRsbFlqVXpPV0UyTTJJMlpqTTRZek14T0RCbU9EWTVOMlJqTVdObVlUWXhNVEl6TXpFd01UazBOalJpTldJMk1HSTVOemxpT1RNMlltWTFNVGN4WVRrNU5qSmpNV05oTlRSbU9HVmpPRFF5TURZM1lUZzBPR0k1TWpOak5qbGtNams1WXpaaU56VXlOR013T1RVME1qa3pNRFF3TXpBNVlURm1PR1prTXpsbU56Z3laREZpWkRnMk5ETm1NekpoTmpWbVlUTTFOekExTm1WaVpHWXdaRFUwT1dVeU1HWXdaakZoTURVMlpUZ3hNall6T0RJek9UWmpPV1prTlRSak0yRmhaVGxrT0RJNFl6Wm1OVFZsTnpOaE1tTTJORFU1WVRBeVpEVTFNalJsWVRJek5HTXlNR1E1WldWbU5EWmtNVFZtWldSaVlUVmlaamsxWlRaaVlqZ3pNR1poWTJSallXRmxNVGN3Tm1aallUWXhPREJpWkdJd01ETTFZVGt6WlRJMFpEVTNOVFJtTjJReVpqaGpNek0xT0dKaVlXSmhaVGc1WkdJek1qbGlaak0yTTJSbU1HTXhORGhqTlRsaFlXVmxaalJqWkdabVltUTROemt3T1RBek1EVTBaRFppTlRSaFltWXlaamt6TlRkbFpHRXdaVFJtWmpNeFlXSXdOekUzWldRMFptSmlZekZtTlRRMk9UVTRORFEwWVRsak1UVXpNR1JpTVRrNE16azBOV05oTVdZNE9EazNNR1ZsTjJObE1HSXdOemMxT0RVeE1HRTRaREZpTW1NM01EUTFaamRsTUdNME1USXlNVEkwTkdRNE56VXhPR0ptWWpFeE9XWXdZekJpTW1FeU1USmtOVGMyTlRkalpEUXpZV1kxWVdKak5EUmtPVGsxTnpVNU1Ua3hNV0prWldGbU5qSTNPV1EwTTJFeE9UY3lNVE00T0RVeVpETmtaV0k0TVdVd01UaGpabVF5WW1Wak5ERXlNR0l4WVdWbU1qUmtOVFpsTXpGak1tTmhaVFpoTjJNNE9HSmtNVE01WWpRME1ETXdNVFUyTnpKbE5tSTRaRFV6WmpJNFpESXpNMlppTURaa1l6VmtaalkzWldJMk5URTVaVGxsTkRSbFpEa3daVFJpWW1aaU9HSTFOelpqT1dGbVlUZGtaR1poWWpFM1lXWXlNVGxpWmpneE16VmtaVEZtT0dVMlptRXpabVkwTm1VeFlXRmpPVFk1WVdaak1XWTBZelUyTWpWa01HTTJNRGMxTkdaak1XSmlZek0wWVdRMk0yVTFPR0UwWmpkaVpUazNOVFkyWmpReE16bGhPV0UwWW1KbU1HSmlNVE5rWVRsaU1UTTBOREF4T1dWbFpqQTRNMkppTURVMVlUSm1aVEV3Wm1abVl6Y3pPV0V5T1dGa1ltSmtZVE16TTJJNE5HVmtaR1U0Tm1JMVlqYzJOREk1TjJReE9XWXdZekUzTmpnNU9UWTNaR1V3TWpKaE1XUmlPV1F4TkdOaFlUZGpPREF4T0dJMU1tTTRZbVUyWmpNeE1EY3hOek00WXpsak5UY3hNV001TWpReU1qa3hNalJrWWpZeU1ERXhNV1ZtWlRZeFkyUmxPVFZrT1dabVpHUXdORFF3TlRjNU5qVTNOalZqTkdFd016RmxObVppTW1GaFlXRTVaV1kzWlRFM05UQmpOelUyWW1WaE1tRXhZMkV6T0dSaE5XSTJaREl5TXpFeE16ZGlNR1F6WkdZNU5EUTFPRFEzWVRRelpXSmhNemRoTmpkaE1ESXlPU0lzQ2lBZ0ltTnlaV1JsYm5ScFlXeGZaVzVrY0c5cGJuUmZkWEpzSWpvZ0ltaDBkSEE2THk5a1pYWXRaR2hoTG1oMWJXRnVZUzVqYjIwNk9EZzRPUzltYVhKbGMyaHZkSE12WTNKbFpHVnVkR2xoYkhOR1pYUmphRmRsWWxObGNuWnBZMlVpQ24wPSIsCiJiYXRjaF9pZCI6MTcwMDA2MjU4NjY2Mjc2OTEsCiJwcm9jZXNzX2lkIiA6MTcwMDA2MjU4Njk5MzE4OTEsCiJyZXN0X3VybCI6ICIiLAoiYjY0X2V4dGVybmFsX2phcnNfbWFwIiA6ICIiCn0=", "ingestion_mode" : [ { "mode" : "overwrite", "save_mode" : "Overwrite", "data_movement_id" : 261, "ingestion_mode_key" : true, "drop_create_condition" : true } ], "generate_extra_configs_json" : "ewoiZXh0cmFDb25maWdNYXAiOiB7InNwYXJrLm5hYnUuZmV0Y2hfc2l6ZSI6ICIxMDAwMCIsICJzcGFyay5uYWJ1LmNvbXB1dGVfZW5naW5lIjogImF6dXJlX2RhdGFicmlja3MiLCAic3BhcmsubmFidS5zb2xyX2JhdGNoX3NpemUiOiAiMTAwMDAiLCAic3BhcmsubmFidS5hcHBsaWNhdGlvbl9uYW1lIjogIm5hYnUtc3Bhcmtib3QtaW5nZXN0aW9uIiwgInNwYXJrLmRyaXZlci5uYWJ1X3ByaXZhdGVLZXkiOiAiL2RiZnMvdG1wL2Rldi9uYWJ1LzE3MDAwNjI1ODY5OTMxODkxLzAvcHJpdmF0ZUtleSIsICJzcGFyay5kcml2ZXIuc291cmNlX2F3c19lbmRQb2ludCI6ICJzMy5hbWF6b25hd3MuY29tIiwgInNwYXJrLmRyaXZlci50YXJnZXRfYXdzX2VuZFBvaW50IjogInMzLmFtYXpvbmF3cy5jb20iLCAic3BhcmsubmFidS5jb21wdXRlX2VuZ2luZV9saWJzX3BhdGgiOiAiL2RiZnMvdG1wL2Rldi9uYWJ1LzE3MDAwNjI1ODY5OTMxODkxLzAvYXBwbGljYXRpb24uY29uZiJ9Cn0=", "incremental_load_details" : [ { "?column?" : 1 } ], "place_holders_with_default_and_max_values" : [ { "?column?" : 1 } ], "incremental_max_columns_with_column_ids" : [ { "?column?" : 1 } ], "remove_duplicates_data" : [], "cdc_first_time" : [ { "cdc_first_time" : true } ], "generate_base64_pipeline_timeout_json" : "ewoicGlwZWxpbmVfdGltZW91dCIgOiAyMwp9", "table_partition_output" : [], "fetch_source_type" : [ { "is_source_filetype" : false, "is_destination_redshift" : false, "data_movement_id" : 261, "source_metadata_category" : "relational", "destination" : "adls_gen2", "is_source_salesforce" : false, "is_destination_filetype" : true, "source" : "sql_server", "is_source_mongodb" : false, "is_ordinalpos_startwith_zero" : false, "destination_metadata_category" : "file" } ], "destination_transformation_query_details_output" : [ { "is_virtual" : false, "data_precision" : 0, "is_nullable" : false, "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "table_id" : 37234, "is_precision_scale" : true, "table_name" : "aaaa", "intermediate_datatype_name" : "string", "is_mysql" : false, "is_source_hive" : false, "is_partitioned_col" : false, "ingested_colorder" : 1, "user_text" : null, "field_name_replaced" : "entity_id", "is_long_col_name" : false, "is_oracle_destination" : false, "data_length" : 255, "destination_datatype_name" : "string", "column_name" : "entity_id", "source_type" : "sql_server", "schema_name" : "acuity-develop", "is_source_casting_enabled" : false, "is_varchar" : false, "field_name" : "entity_id", "column_id" : 956158, "source_cast_type" : "AsIs", "ordinal_position" : 1, "source_datatype_name" : "varchar", "is_cdc_col" : false, "data_scale" : 0, "replaced_column_name" : "entity_id", "data_type" : "varchar", "is_bigquery" : false, "is_precision" : true, "is_redshift_relational_destination" : false, "source_stg_function" : "AsIs", "istimezone" : false }, { "is_virtual" : false, "data_precision" : 0, "is_nullable" : false, "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "table_id" : 37234, "is_precision_scale" : true, "table_name" : "aaaa", "intermediate_datatype_name" : "string", "is_mysql" : false, "is_source_hive" : false, "is_partitioned_col" : false, "ingested_colorder" : 2, "user_text" : null, "field_name_replaced" : "entity_type", "is_long_col_name" : false, "is_oracle_destination" : false, "data_length" : 255, "destination_datatype_name" : "string", "column_name" : "entity_type", "source_type" : "sql_server", "schema_name" : "acuity-develop", "is_source_casting_enabled" : false, "is_varchar" : false, "field_name" : "entity_type", "column_id" : 956159, "source_cast_type" : "AsIs", "ordinal_position" : 2, "source_datatype_name" : "varchar", "is_cdc_col" : false, "data_scale" : 0, "replaced_column_name" : "entity_type", "data_type" : "varchar", "is_bigquery" : false, "is_precision" : true, "is_redshift_relational_destination" : false, "source_stg_function" : "AsIs", "istimezone" : false } ], "get_varchar_columns_destination" : [], "input_data" : { "flow_number" : 1, "process_id" : 17000625869931891, "source_database_name_lowercase" : "development-db", "batch_id" : 17000625866627691, "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDYyNjA0ODY3ODczNSwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0NTQwNSwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2MjYwNH0.TdlKYjNFZRULplibTKTBiTeNTShCsDicocUZq9KQkMiynWn2WsDoCNVj1Gnby5Zevba71EIlyJc7hK0-wksFFLDOu-AutbS3q-JSjcWr7zHFmWQ3NR6Xs_ycLsdTfh9HnCPt4R-GHKm9SOS5CzT6JBg08gb9cZtV2havzmaG4v9vckfKagGuftWnBKcsQNp2h9zB_EDYLVdDOUd_Aa8UHMklrT8W0SjKoDgbHVZ5T506nwQL-nXZYY0_YHP9KqDtPRiRq-k6db434A4pMx6BkTAG1z355WIuqa1fwRtrSB5HZQULpX85KD8FMpbt2gBBHWDn01TnO5_crpf0lv-SfQ", "end_point" : "http:\/\/dev-dha.humana.com:8889\/fireshots\/credentialsFetchWebService", "where_condition" : "37234", "suffix" : "", "reorder_columns" : [], "job_type_id" : "1", "ingestion_table_format" : "", "job_schedule_id" : 1567, "relative_file_path" : "", "retry_attempt" : "0", "source_schema_name_lowercase" : "acuity-develop", "variables" : { "env_variables" : {}, "user_variables" : {}, "payload_variables" : {} }, "source_database_name_uppercase" : "DEVELOPMENT-DB", "job_scheduled_user_id" : "Manaswini Chinthalapudi", "virtual_column" : [], "new_table_for_rename" : "", "source_schema_name_uppercase" : "ACUITY-DEVELOP", "batch_name" : "Ingestion_20231115", "modified_columns" : [], "source_database_name" : "development-db", "data_movement_id" : 261, "last_run_timestamp" : "2023-11-07 12:42:00.86365", "is_relative_file_path" : false }, "table_adv_opt_details" : [ { "dataplace_id" : 42, "cru_ts" : "2023-11-15 09:31:16.466337", "data_movement_id" : 261, "valid_to_ts" : "9999-12-31 00:00:00.0", "advance_option_details" : { "advanced_table_options" : { "columns_options" : { "modified_columns" : [], "virtual_column" : [], "excluded_column_ids" : [] }, "CDC" : { "audit_columns" : { "prev_process_id_column_name" : "prev_process_id", "end_date_column_name" : "valid_to_ts", "process_id_column_name" : "process_id", "start_date_column_name" : "valid_from_ts" }, "CDC_process_type" : "", "add_audit_columns" : false, "columns_ids" : [], "CDC_type" : "", "create_view" : false, "hash_type" : "", "view_name" : "v_aaaa" }, "sort_by_columns" : [], "incremental_load" : { "condition_values" : [], "where_clause" : "" }, "parallel_ingestion" : { "max_connections" : 1, "enable" : false }, "remove_duplicates" : { "sort_columns" : [], "key_columns" : [] }, "table_id" : 37234, "reorder_columns" : [], "table_name" : "aaaa", "parallel_hash_ingestion" : { "max_connections" : 8, "enable" : false }, "dataplace_id" : 42, "ingestion_mode" : { "mode" : "Drop & Re-create", "enable" : true }, "enable_cache" : { "enable" : false }, "ingest_using_query" : { "enable" : false, "sql_query" : "" }, "schema_id" : 453, "new_table_name" : "", "table_partitions" : [] }, "advanced_option_flags" : { "columns_options" : false, "CDC" : false, "sort_by_columns" : false, "incremental_load" : false, "parallel_ingestion" : false, "remove_duplicates" : false, "virtual_column" : false, "table_id" : 37234, "reorder_columns" : false, "table_name" : "aaaa", "parallel_hash_ingestion" : false, "dataplace_id" : 42, "modified_columns" : false, "ingestion_mode" : true, "enable_cache" : false, "ingest_using_query" : false, "schema_id" : 453, "new_table_name" : false, "excluded_column_ids" : false, "table_partitions" : false } }, "valid_from_ts" : "2023-11-15 09:31:16.466337", "cru_by" : "Venkata Yeedi", "object_id" : 37234 } ], "check_compute_engine_validity" : [ { "is_valid_compute_engine" : true } ], "get_non_partition_cols" : [ { "is_virtual" : false, "data_precision" : "0", "destination_datatype_name" : "string", "is_auditcol" : false, "data_length" : "255", "column_name" : "entity_id", "source_field_name" : "entity_id", "field_name" : "entity_id", "column_id" : "956158", "source_datatype_name" : "varchar", "is_partitioned_col" : false, "data_scale" : "0", "ingested_colorder" : 1 }, { "is_virtual" : false, "data_precision" : "0", "destination_datatype_name" : "string", "is_auditcol" : false, "data_length" : "255", "column_name" : "entity_type", "source_field_name" : "entity_type", "field_name" : "entity_type", "column_id" : "956159", "source_datatype_name" : "varchar", "is_partitioned_col" : false, "data_scale" : "0", "ingested_colorder" : 2 } ], "get_partition_cols" : [], "list_of_maps_of_incremental_columns" : [ { "?column?" : 1 } ], "spark_script_inputs" : [ { "ssh_username" : "null", "ssh_host" : "null", "loggroupname" : null, "kerberos" : null, "cloud_watch" : null, "compute_engine_info" : "ewoiY2x1c3Rlcl9pZCI6IjA5MjItMDAzMTM4LW9ybjlyMHRlIiwic3BhcmtfdmVyc2lvbl92YWx1ZSI6IjNfMSIsInNjYWxhX3ZlcnNpb25fdmFsdWUiOiIyXzEyIiwiY3JlZGVudGlhbHNfZmlsZXBhdGgiOiIiLCJjbHVzdGVyX2xpYnJhcnlfcGF0aCI6Ii9kYmZzL3RtcCIsInNwYXJrX3ZlcnNpb24iOiIzLjEiLCJzY2FsYV92ZXJzaW9uIjoiMi4xMiIKfQ==", "private_key_path" : "\/dbfs\/tmp\/dev\/nabu\/17000625869931891\/0\/privateKey", "b64_external_jars_map" : null, "cluster_id" : "0922-003138-orn9r0te", "engine_sub_type" : "azure databricks", "spark_location" : "null", "dataproc_cluster" : "null", "cluster_library_path" : "\/dbfs\/tmp", "data_movement_name" : "ss_compass_adb_validation", "dataproc_project" : "null", "engine_path" : "azure_databricks", "is_bucket_encrypted" : null, "execution_role" : null, "cluster_ui" : null, "s3_bucket_path" : null, "rest_url" : null, "s3logs" : null, "cloud_type" : "null", "release_label" : null, "spark_version" : "3.1", "scala_version" : "2.12", "region" : "null" } ], "column_metadata_output" : [ { "is_virtual" : false, "data_precision" : 0, "is_nullable" : false, "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "table_id" : 37234, "is_precision_scale" : true, "table_name" : "aaaa", "intermediate_datatype_name" : "string", "is_mysql" : false, "is_source_hive" : false, "is_partitioned_col" : false, "user_text" : null, "field_name_replaced" : "entity_id", "is_long_col_name" : false, "is_oracle_destination" : false, "data_length" : 255, "destination_datatype_name" : "string", "column_name" : "entity_id", "source_type" : "sql_server", "schema_name" : "acuity-develop", "is_source_casting_enabled" : false, "is_varchar" : false, "field_name" : "entity_id", "column_id" : 956158, "source_cast_type" : "AsIs", "ordinal_position" : 1, "source_datatype_name" : "varchar", "is_cdc_col" : false, "data_scale" : 0, "replaced_column_name" : "entity_id", "data_type" : "varchar", "is_bigquery" : false, "is_precision" : true, "is_redshift_relational_destination" : false, "source_stg_function" : "AsIs", "istimezone" : false }, { "is_virtual" : false, "data_precision" : 0, "is_nullable" : false, "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "table_id" : 37234, "is_precision_scale" : true, "table_name" : "aaaa", "intermediate_datatype_name" : "string", "is_mysql" : false, "is_source_hive" : false, "is_partitioned_col" : false, "user_text" : null, "field_name_replaced" : "entity_type", "is_long_col_name" : false, "is_oracle_destination" : false, "data_length" : 255, "destination_datatype_name" : "string", "column_name" : "entity_type", "source_type" : "sql_server", "schema_name" : "acuity-develop", "is_source_casting_enabled" : false, "is_varchar" : false, "field_name" : "entity_type", "column_id" : 956159, "source_cast_type" : "AsIs", "ordinal_position" : 2, "source_datatype_name" : "varchar", "is_cdc_col" : false, "data_scale" : 0, "replaced_column_name" : "entity_type", "data_type" : "varchar", "is_bigquery" : false, "is_precision" : true, "is_redshift_relational_destination" : false, "source_stg_function" : "AsIs", "istimezone" : false } ], "updated_wherecondition_replaced_with_default_and_max_values" : [ { "?column?" : 1 } ], "cdc_schema_drift_new_table" : [ { "drift_new_table" : false } ], "emr_input_json" : "ewogICJjbHVzdGVyX2lkIjogIjA5MjItMDAzMTM4LW9ybjlyMHRlIiwKICAiY2x1c3Rlcl9yZWdpb24iOiAibnVsbCIsCiAgImNvbXB1dGVfZW5nX2NyZWRzX2pzb24iOiAiZXdvZ0lDSmpjbVZrWlc1MGFXRnNYMmxrSWpvZ0lqUXhJaXdLSUNBaVkzSmxaR1Z1ZEdsaGJGOTBlWEJsWDJsa0lqb2dJakUxSWl3S0lDQWlZM0psWkdWdWRHbGhiRjkwZVhCbElqb2dJa1pwYkdVZ1EyOXVkR1Z1ZENJc0NpQWdJblJ2YTJWdUlqb2dJbU0yT1RVd05UZ3lZVEV5WWpVMU9HRmlOalE0WTJSaU56SXdNRGd4TnpOaU1tVTROREk0Wm1JMU5XUmhZV1EzTkRBeE5USXlOVFk1TVdWbFl6YzRaV1UzWWpWak5HVXpORE14TW1SbFpEY3dZV1UxWlRkbFpUUTRNMkkzWkRkbFlUQmpNak5sTWpSbE5EVTRaV1F4WmpVMFpHRXpZMk5rTjJSaVkyWmxPRGN3WVRZeFpUVmpPV00xTURnM1pUZG1ZalprWXpFMllqWm1PR1kxWlRSaVpXUmhOVFk1TWpSbE9EZzBPV1ZpTlRNNVlUWXpZalptTXpoak16RTRNR1k0TmprM1pHTXhZMlpoTmpFeE1qTXpNVEF4T1RRMk5HSTFZall3WWprM09XSTVNelppWmpVeE56RmhPVGsyTW1NeFkyRTFOR1k0WldNNE5ESXdOamRoT0RRNFlqa3lNMk0yT1dReU9UbGpObUkzTlRJMFl6QTVOVFF5T1RNd05EQXpNRGxoTVdZNFptUXpPV1kzT0RKa01XSmtPRFkwTTJZek1tRTJOV1poTXpVM01EVTJaV0prWmpCa05UUTVaVEl3WmpCbU1XRXdOVFpsT0RFeU5qTTRNak01Tm1NNVptUTFOR016WVdGbE9XUTRNamhqTm1ZMU5XVTNNMkV5WXpZME5UbGhNREprTlRVeU5HVmhNak0wWXpJd1pEbGxaV1kwTm1ReE5XWmxaR0poTldKbU9UVmxObUppT0RNd1ptRmpaR05oWVdVeE56QTJabU5oTmpFNE1HSmtZakF3TXpWaE9UTmxNalJrTlRjMU5HWTNaREptT0dNek16VTRZbUpoWW1GbE9EbGtZak15T1dKbU16WXpaR1l3WXpFME9HTTFPV0ZoWldWbU5HTmtabVppWkRnM09UQTVNRE13TlRSa05tSTFOR0ZpWmpKbU9UTTFOMlZrWVRCbE5HWm1NekZoWWpBM01UZGxaRFJtWW1Kak1XWTFORFk1TlRnME5EUmhPV014TlRNd1pHSXhPVGd6T1RRMVkyRXhaamc0T1Rjd1pXVTNZMlV3WWpBM056VTROVEV3WVRoa01XSXlZemN3TkRWbU4yVXdZelF4TWpJeE1qUTBaRGczTlRFNFltWmlNVEU1WmpCak1HSXlZVEl4TW1RMU56WTFOMk5rTkROaFpqVmhZbU0wTkdRNU9UVTNOVGt4T1RFeFltUmxZV1kyTWpjNVpEUXpZVEU1TnpJeE16ZzROVEprTTJSbFlqZ3haVEF4T0dObVpESmlaV00wTVRJd1lqRmhaV1l5TkdRMU5tVXpNV015WTJGbE5tRTNZemc0WW1ReE16bGlORFF3TXpBeE5UWTNNbVUyWWpoa05UTm1NamhrTWpNelptSXdObVJqTldSbU5qZGxZalkxTVRsbE9XVTBOR1ZrT1RCbE5HSmlabUk0WWpVM05tTTVZV1poTjJSa1ptRmlNVGRoWmpJeE9XSm1PREV6TldSbE1XWTRaVFptWVRObVpqUTJaVEZoWVdNNU5qbGhabU14WmpSak5UWXlOV1F3WXpZd056VTBabU14WW1Kak16UmhaRFl6WlRVNFlUUm1OMkpsT1RjMU5qWm1OREV6T1dFNVlUUmlZbVl3WW1JeE0yUmhPV0l4TXpRME1ERTVaV1ZtTURnelltSXdOVFZoTW1abE1UQm1abVpqTnpNNVlUSTVZV1JpWW1SaE16TXpZamcwWldSa1pUZzJZalZpTnpZME1qazNaREU1WmpCak1UYzJPRGs1Tmpka1pUQXlNbUV4WkdJNVpERTBZMkZoTjJNNE1ERTRZalV5WXpoaVpUWm1NekV3TnpFM016aGpPV00xTnpFeFl6a3lOREl5T1RFeU5HUmlOakl3TVRFeFpXWmxOakZqWkdVNU5XUTVabVprWkRBME5EQTFOemsyTlRjMk5XTTBZVEF6TVdVMlptSXlZV0ZoWVRsbFpqZGxNVGMxTUdNM05UWmlaV0V5WVRGallUTTRaR0UxWWpaa01qSXpNVEV6TjJJd1pETmtaamswTkRVNE5EZGhORE5sWW1Fek4yRTJOMkV3TWpJNUlpd0tJQ0FpWTNKbFpHVnVkR2xoYkY5bGJtUndiMmx1ZEY5MWNtd2lPaUFpYUhSMGNEb3ZMMlJsZGkxa2FHRXVhSFZ0WVc1aExtTnZiVG80T0RnNUwyWnBjbVZ6YUc5MGN5OWpjbVZrWlc1MGFXRnNjMFpsZEdOb1YyVmlVMlZ5ZG1salpTSXNDaUFnSW1acGJHVmZjR0YwYUNJNklDSXhOVFkzWHpJMk1WOHhOekF3TURZeU5UZzJOall5TnpZNU1TSXNDaUFnSW1OeVpXUmxiblJwWVd4ZlptbHNaVjl3WVhSMFpYSnVJaUE2SUNJME1WOHhOams1TXpReU5UYzFJZ3A5IiwKICAiczNfcGF0aCI6ICIiLAogICJiNjRfaW5wdXRfanNvbiI6ICJld29pY0hKdlkyVnpjMGxrSWpveE56QXdNRFl5TlRnMk9Ua3pNVGc1TVN3S0ltUmhkR0Z3YkdGalpVbGtJam8wTWl3S0luUmhZbXhsU1dRaU9qTTNNak0wTEFvaVpHRjBZVzF2ZG1WdFpXNTBTV1FpT2pJMk1Td0tJbXB2WWxOamFHVmtkV3hsWkZWelpYSkpaQ0k2SWsxaGJtRnpkMmx1YVNCRGFHbHVkR2hoYkdGd2RXUnBJaXdLSW1wdllsTmphR1ZrZFd4bFNXUWlPakUxTmpjc0NpSmlZWFJqYUVsa0lqb3hOekF3TURZeU5UZzJOall5TnpZNU1Td0tJbXhoYzNSU2RXNVVhVzFsYzNSaGJYQWlPaUl5TURJekxURXhMVEEzSURFeU9qUXlPakF3TGpnMk16WTFJaXdLSW5KbGRISjVUblZ0SWpvZ0lqQWlDbjA9IiwKICAiZXh0cmFfY29uZmlnIjogImV3b2laWGgwY21GRGIyNW1hV2ROWVhBaU9pQjdJbk53WVhKckxtNWhZblV1Wm1WMFkyaGZjMmw2WlNJNklDSXhNREF3TUNJc0lDSnpjR0Z5YXk1dVlXSjFMbU52YlhCMWRHVmZaVzVuYVc1bElqb2dJbUY2ZFhKbFgyUmhkR0ZpY21samEzTWlMQ0FpYzNCaGNtc3VibUZpZFM1emIyeHlYMkpoZEdOb1gzTnBlbVVpT2lBaU1UQXdNREFpTENBaWMzQmhjbXN1Ym1GaWRTNWhjSEJzYVdOaGRHbHZibDl1WVcxbElqb2dJbTVoWW5VdGMzQmhjbXRpYjNRdGFXNW5aWE4wYVc5dUlpd2dJbk53WVhKckxtUnlhWFpsY2k1dVlXSjFYM0J5YVhaaGRHVkxaWGtpT2lBaUwyUmlabk12ZEcxd0wyUmxkaTl1WVdKMUx6RTNNREF3TmpJMU9EWTVPVE14T0RreEx6QXZjSEpwZG1GMFpVdGxlU0lzSUNKemNHRnlheTVrY21sMlpYSXVjMjkxY21ObFgyRjNjMTlsYm1SUWIybHVkQ0k2SUNKek15NWhiV0Y2YjI1aGQzTXVZMjl0SWl3Z0luTndZWEpyTG1SeWFYWmxjaTUwWVhKblpYUmZZWGR6WDJWdVpGQnZhVzUwSWpvZ0luTXpMbUZ0WVhwdmJtRjNjeTVqYjIwaUxDQWljM0JoY21zdWJtRmlkUzVqYjIxd2RYUmxYMlZ1WjJsdVpWOXNhV0p6WDNCaGRHZ2lPaUFpTDJSaVpuTXZkRzF3TDJSbGRpOXVZV0oxTHpFM01EQXdOakkxT0RZNU9UTXhPRGt4THpBdllYQndiR2xqWVhScGIyNHVZMjl1WmlKOUNuMD0iLAogICJiYXRjaF9pZCI6IDE3MDAwNjI1ODY2NjI3NjkxLAogICJyZXRyeV9udW0iOiAiMCIsCiAgInNwYXJrX2NvbmZpZ3MiOiAiZXdvZ0lDQWdJbk52YkhKZlltRjBZMmhmYzJsNlpTSTZJakV3TURBd0lpd2ljR0Z5WVd4c1pXeGZkR2h5WldGa2N5STZJakV3SWl3aVptVjBZMmhmYzJsNlpTSTZJakV3TURBd0lnb2dJQ0FnZlE9PSIsCiAgImlzX2J1Y2tldF9lbmNyeXB0ZWQiOiAiIiwKICAiYjY0X2V4dGVybmFsX2phcnNfbWFwIiA6ICIiCn0=", "base64_rsa_compressed_encrypted_creds" : "rO0ABXVyAAJbQqzzF\/gGCFTgAgAAeHAAAAEAFBBvYZ7Mim3fI+Np05VO+EHuf5PxldceVzCwdbLhn99OYytVbAynQS5Ral29GY9WQevohqFq0pptfWmC6Hdze1ChYqC3VXBhBj3fvqRQZTXN3\/gYsSGTxp+834hmfUfQbU0RQ7RnV0wV7zyS1QELwx0d2MbPVdCF1bxRqXdtOn1A4aNwc7Ia7\/cZJEKIjKPAUohAvgCyjsGHSbHQx98WKhSwSU60Sa2dauo11GJkO6jT0fdAUjMDuRgiri0JjVTof4u\/gV\/qzwHpGu\/AH\/Q\/dG8vOv1Stjm43HFpaHjBb2lqw0+JUBuIAqO1SbZmHe1FSy4p09C5Z0pkxSxmLBMQXXVxAH4AAAAAA5D7uBN32zcbCqrcmzijqQfhpAWVqmvEcLxsLpAXN0MnSpwYDURX1Bzr\/vmU9PmJjV114yRnCLXxwgtmVebwcXQpDixTHpTKVjL\/CtOTvSkauTybzdVq1nm6iSti+tUV5IX7blC5I+JVJZcJyd6c83OK54FmVswIUe6LEaVCSaMlYzQNpKT7IKYurmTruiz7hrCJ9ZdIk+fUYt2inQ9BMkqscwFr97n+VE9s\/5MPmsbtG7JCzBniT5ePLh9BIr6dWLfZjG+MKsijpwhUINj3sG\/IbsCtqQuNLGxFV6nZObarxX\/8NiFDOwXitmggN2ZBe0ggcLzMHBDILWwaxnGsByVdmKFxN5DozkOUQM1FX0euvznFtk\/Vd7mu6sTeISNvvpempQuPOLzUew2SfynpCR8gqBp0N4E7JYBYpfeuk4wDcX7y6q7xb+p\/Ir2i90Y+AJxMfcXIH7bDQ8H24cSg2pvx1mIZU9btojRD00BaME1dgJOOI42T1jALDSOWIUSxS84qQ1blakpHAKfp4OFgT6XNQNN1mteDjRcLlLxkTP2azXBeWL3\/1Ix9\/2WLHgbeP4rQG27yM6n+YYQU2OTqKr8nJ7HPbwfY3tiagpKX7VpRnoTq\/he0Db7UxxzVEN12\/Pj8fJUjLXTAfoworuhlYo0AaSYMMt2lIr9gB2FRiH1+RELLTrt\/0tGUjMaOLWL6WU8IZj749J9MUYQ6dTnmQHwUKWsaImYLZIPp5HDwC\/8etfQBMqqYUfn8Mm\/McmjKX7AHB48J4X9BBW4n42bLVwBwBxoIzRoQOVAK95be5uR7X9PQ7mqGpjK6KTWPgSj34dg94SCzm40mhvwW0d+KatJ3Bl\/mXsYXzDK6k7vqIQuuYlm8IVvlScQZSrXMJkQK3kVYlZMnpEM47cgs5s\/AtFNRgD3tIRl28PZBvAoU2RdxpEGJCp97LugjtPmQVwPqHtxZQ2eBAWvcT7prIgNQJgKLvMWSb0S42rDhrEaV3vRYjxxZh2a8odrvFve7mNJjYRvscpOOljnliNBnVW703kNQVjIlNiOu6WezpphGFNzd434k1Fom9cQub82hQgHeGssWwjEmL4lCCtT4rRHxouyik36\/v4js9JSVh4RlgXvGR2daW7KTzqW\/GquJUbJjVarT2iljzwahdM08Mbj9T1uxcDycIuEskdEp6pmFVTMgzRYNjAZbWMGnhdKRWYozgis=", "target_schemadrift_details" : [ { "destination_table_name" : "aaaa", "target_schemadrift_backup_table" : false, "target_schemadrift_ignore_table" : false, "backup_table_name" : "aaaa", "target_schemadrift_new_table" : false, "schema_drifted" : false } ], "generate_file_content_json" : "ewogICJjcmVkZW50aWFsX2lkIjogIjQxIiwKICAiY3JlZGVudGlhbF90eXBlX2lkIjogIjE1IiwKICAiY3JlZGVudGlhbF90eXBlIjogIkZpbGUgQ29udGVudCIsCiAgInRva2VuIjogImM2OTUwNTgyYTEyYjU1OGFiNjQ4Y2RiNzIwMDgxNzNiMmU4NDI4ZmI1NWRhYWQ3NDAxNTIyNTY5MWVlYzc4ZWU3YjVjNGUzNDMxMmRlZDcwYWU1ZTdlZTQ4M2I3ZDdlYTBjMjNlMjRlNDU4ZWQxZjU0ZGEzY2NkN2RiY2ZlODcwYTYxZTVjOWM1MDg3ZTdmYjZkYzE2YjZmOGY1ZTRiZWRhNTY5MjRlODg0OWViNTM5YTYzYjZmMzhjMzE4MGY4Njk3ZGMxY2ZhNjExMjMzMTAxOTQ2NGI1YjYwYjk3OWI5MzZiZjUxNzFhOTk2MmMxY2E1NGY4ZWM4NDIwNjdhODQ4YjkyM2M2OWQyOTljNmI3NTI0YzA5NTQyOTMwNDAzMDlhMWY4ZmQzOWY3ODJkMWJkODY0M2YzMmE2NWZhMzU3MDU2ZWJkZjBkNTQ5ZTIwZjBmMWEwNTZlODEyNjM4MjM5NmM5ZmQ1NGMzYWFlOWQ4MjhjNmY1NWU3M2EyYzY0NTlhMDJkNTUyNGVhMjM0YzIwZDllZWY0NmQxNWZlZGJhNWJmOTVlNmJiODMwZmFjZGNhYWUxNzA2ZmNhNjE4MGJkYjAwMzVhOTNlMjRkNTc1NGY3ZDJmOGMzMzU4YmJhYmFlODlkYjMyOWJmMzYzZGYwYzE0OGM1OWFhZWVmNGNkZmZiZDg3OTA5MDMwNTRkNmI1NGFiZjJmOTM1N2VkYTBlNGZmMzFhYjA3MTdlZDRmYmJjMWY1NDY5NTg0NDRhOWMxNTMwZGIxOTgzOTQ1Y2ExZjg4OTcwZWU3Y2UwYjA3NzU4NTEwYThkMWIyYzcwNDVmN2UwYzQxMjIxMjQ0ZDg3NTE4YmZiMTE5ZjBjMGIyYTIxMmQ1NzY1N2NkNDNhZjVhYmM0NGQ5OTU3NTkxOTExYmRlYWY2Mjc5ZDQzYTE5NzIxMzg4NTJkM2RlYjgxZTAxOGNmZDJiZWM0MTIwYjFhZWYyNGQ1NmUzMWMyY2FlNmE3Yzg4YmQxMzliNDQwMzAxNTY3MmU2YjhkNTNmMjhkMjMzZmIwNmRjNWRmNjdlYjY1MTllOWU0NGVkOTBlNGJiZmI4YjU3NmM5YWZhN2RkZmFiMTdhZjIxOWJmODEzNWRlMWY4ZTZmYTNmZjQ2ZTFhYWM5NjlhZmMxZjRjNTYyNWQwYzYwNzU0ZmMxYmJjMzRhZDYzZTU4YTRmN2JlOTc1NjZmNDEzOWE5YTRiYmYwYmIxM2RhOWIxMzQ0MDE5ZWVmMDgzYmIwNTVhMmZlMTBmZmZjNzM5YTI5YWRiYmRhMzMzYjg0ZWRkZTg2YjViNzY0Mjk3ZDE5ZjBjMTc2ODk5NjdkZTAyMmExZGI5ZDE0Y2FhN2M4MDE4YjUyYzhiZTZmMzEwNzE3MzhjOWM1NzExYzkyNDIyOTEyNGRiNjIwMTExZWZlNjFjZGU5NWQ5ZmZkZDA0NDA1Nzk2NTc2NWM0YTAzMWU2ZmIyYWFhYTllZjdlMTc1MGM3NTZiZWEyYTFjYTM4ZGE1YjZkMjIzMTEzN2IwZDNkZjk0NDU4NDdhNDNlYmEzN2E2N2EwMjI5IiwKICAiY3JlZGVudGlhbF9lbmRwb2ludF91cmwiOiAiaHR0cDovL2Rldi1kaGEuaHVtYW5hLmNvbTo4ODg5L2ZpcmVzaG90cy9jcmVkZW50aWFsc0ZldGNoV2ViU2VydmljZSIsCiAgImZpbGVfcGF0aCI6ICIxNTY3XzI2MV8xNzAwMDYyNTg2NjYyNzY5MSIsCiAgImNyZWRlbnRpYWxfZmlsZV9wYXR0ZXJuIiA6ICI0MV8xNjk5MzQyNTc1Igp9", "get_view_info" : [ { "id" : 1 } ], "get_already_ingested_condition" : [ { "already_ingested" : true } ], "sort_by_columns_data" : [], "fetching_credential_inputs" : [ { "credential_type" : "File Content", "metastore_credential_type_id" : null, "credential_type_id" : 15, "metastore_credential_id" : null, "credential_pattern" : "41_1699342575", "spark_credential_id" : 41 } ], "get_varchar_columns" : [], "generate_spark_configs_json" : "ewogICAgInNvbHJfYmF0Y2hfc2l6ZSI6IjEwMDAwIiwicGFyYWxsZWxfdGhyZWFkcyI6IjEwIiwiZmV0Y2hfc2l6ZSI6IjEwMDAwIgogICAgfQ==" }, "batch_id" : "17000625866627691", "template_execution_type" : "single", "query_type" : "json", "currentBotMessageMap" : { "parent_id" : "af56d8ab-458b-4c73-86bf-553c24550201", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "message_context" : "ingestion_deciding", "message_id" : "6595c16c-9675-4ed2-8674-08d9d8e09b79", "task_retry_intervals_secs" : [], "bot_id" : "b006ad5b-9517-4ef8-87e2-7c6dea91f146", "message_topic" : "nabu_2_jdbc", "tags" : { "process_id" : 17000625869931891, "batch_id" : 17000625866627691, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "tags" : [ "AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot", "KoshBot", "DBOpsBot" ], "initial_ts" : 1700062586993, "batch_name" : "Ingestion_20231115", "environment" : "modak", "job_schedule_id" : 1567, "data_movement_id" : 261, "last_run_timestamp" : "2023-11-07 12:42:00.86365", "retry_attempt" : 0, "task_dependency" : true, "ignore_job_termination" : false } } }, "template_execution_type" : "single", "query_type" : "json", "currentBotMessageMap" : { "parent_id" : "6595c16c-9675-4ed2-8674-08d9d8e09b79", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "message_context" : "spark_buffer_msg", "message_id" : "f9af8fe7-d4e3-4a83-8400-4c22ce532ac9", "task_retry_intervals_secs" : [], "bot_id" : "b878e324-4b30-4eeb-9a2a-3f769c50e67c", "message_topic" : "nabu_2_jdbc", "tags" : { "process_id" : 17000625869931891, "batch_id" : 17000625866627691, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "tags" : [ "AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot", "KoshBot", "DBOpsBot", "DBOpsBot" ], "initial_ts" : 1700062586993, "batch_name" : "Ingestion_20231115", "environment" : "modak", "job_schedule_id" : 1567, "data_movement_id" : 261, "last_run_timestamp" : "2023-11-07 12:42:00.86365", "retry_attempt" : 0, "task_dependency" : true, "ignore_job_termination" : false } } }, "retry_attempt": 0, "flow_number": 1, "data_movement_id": 261, "where_condition": "37234", "process_id": 17000625869931891, "job_scheduled_user_id": "Manaswini Chinthalapudi", "batch_id": 17000625866627691, "last_run_timestamp": "2023-11-07 12:42:00.86365", "schema_drift_flag": false, "ssh_host": "null", "ssh_username": "null", "cloud_type": "null", "cluster_library_path": "/dbfs/tmp", "engine_path": "azure_databricks", "compute_engine_info": "ewoiY2x1c3Rlcl9pZCI6IjA5MjItMDAzMTM4LW9ybjlyMHRlIiwic3BhcmtfdmVyc2lvbl92YWx1ZSI6IjNfMSIsInNjYWxhX3ZlcnNpb25fdmFsdWUiOiIyXzEyIiwiY3JlZGVudGlhbHNfZmlsZXBhdGgiOiIiLCJjbHVzdGVyX2xpYnJhcnlfcGF0aCI6Ii9kYmZzL3RtcCIsInNwYXJrX3ZlcnNpb24iOiIzLjEiLCJzY2FsYV92ZXJzaW9uIjoiMi4xMiIKfQ==", "spark_location": "null", "template_group": "templates/artifact_ingestion/ingestion_templates.stg", "destination": "adls_gen2", "spark_application_template": "insert_spark_application_details", "source_endpoint": "s3.amazonaws.com", "destination_endpoint": "s3.amazonaws.com", "is_create_table": false, "spark_credential_info": "ewogICJjcmVkZW50aWFsX2lkIjogIjQxIiwKICAiY3JlZGVudGlhbF90eXBlX2lkIjogIjE1IiwKICAiY3JlZGVudGlhbF90eXBlIjogIkZpbGUgQ29udGVudCIsCiAgInRva2VuIjogImM2OTUwNTgyYTEyYjU1OGFiNjQ4Y2RiNzIwMDgxNzNiMmU4NDI4ZmI1NWRhYWQ3NDAxNTIyNTY5MWVlYzc4ZWU3YjVjNGUzNDMxMmRlZDcwYWU1ZTdlZTQ4M2I3ZDdlYTBjMjNlMjRlNDU4ZWQxZjU0ZGEzY2NkN2RiY2ZlODcwYTYxZTVjOWM1MDg3ZTdmYjZkYzE2YjZmOGY1ZTRiZWRhNTY5MjRlODg0OWViNTM5YTYzYjZmMzhjMzE4MGY4Njk3ZGMxY2ZhNjExMjMzMTAxOTQ2NGI1YjYwYjk3OWI5MzZiZjUxNzFhOTk2MmMxY2E1NGY4ZWM4NDIwNjdhODQ4YjkyM2M2OWQyOTljNmI3NTI0YzA5NTQyOTMwNDAzMDlhMWY4ZmQzOWY3ODJkMWJkODY0M2YzMmE2NWZhMzU3MDU2ZWJkZjBkNTQ5ZTIwZjBmMWEwNTZlODEyNjM4MjM5NmM5ZmQ1NGMzYWFlOWQ4MjhjNmY1NWU3M2EyYzY0NTlhMDJkNTUyNGVhMjM0YzIwZDllZWY0NmQxNWZlZGJhNWJmOTVlNmJiODMwZmFjZGNhYWUxNzA2ZmNhNjE4MGJkYjAwMzVhOTNlMjRkNTc1NGY3ZDJmOGMzMzU4YmJhYmFlODlkYjMyOWJmMzYzZGYwYzE0OGM1OWFhZWVmNGNkZmZiZDg3OTA5MDMwNTRkNmI1NGFiZjJmOTM1N2VkYTBlNGZmMzFhYjA3MTdlZDRmYmJjMWY1NDY5NTg0NDRhOWMxNTMwZGIxOTgzOTQ1Y2ExZjg4OTcwZWU3Y2UwYjA3NzU4NTEwYThkMWIyYzcwNDVmN2UwYzQxMjIxMjQ0ZDg3NTE4YmZiMTE5ZjBjMGIyYTIxMmQ1NzY1N2NkNDNhZjVhYmM0NGQ5OTU3NTkxOTExYmRlYWY2Mjc5ZDQzYTE5NzIxMzg4NTJkM2RlYjgxZTAxOGNmZDJiZWM0MTIwYjFhZWYyNGQ1NmUzMWMyY2FlNmE3Yzg4YmQxMzliNDQwMzAxNTY3MmU2YjhkNTNmMjhkMjMzZmIwNmRjNWRmNjdlYjY1MTllOWU0NGVkOTBlNGJiZmI4YjU3NmM5YWZhN2RkZmFiMTdhZjIxOWJmODEzNWRlMWY4ZTZmYTNmZjQ2ZTFhYWM5NjlhZmMxZjRjNTYyNWQwYzYwNzU0ZmMxYmJjMzRhZDYzZTU4YTRmN2JlOTc1NjZmNDEzOWE5YTRiYmYwYmIxM2RhOWIxMzQ0MDE5ZWVmMDgzYmIwNTVhMmZlMTBmZmZjNzM5YTI5YWRiYmRhMzMzYjg0ZWRkZTg2YjViNzY0Mjk3ZDE5ZjBjMTc2ODk5NjdkZTAyMmExZGI5ZDE0Y2FhN2M4MDE4YjUyYzhiZTZmMzEwNzE3MzhjOWM1NzExYzkyNDIyOTEyNGRiNjIwMTExZWZlNjFjZGU5NWQ5ZmZkZDA0NDA1Nzk2NTc2NWM0YTAzMWU2ZmIyYWFhYTllZjdlMTc1MGM3NTZiZWEyYTFjYTM4ZGE1YjZkMjIzMTEzN2IwZDNkZjk0NDU4NDdhNDNlYmEzN2E2N2EwMjI5IiwKICAiY3JlZGVudGlhbF9lbmRwb2ludF91cmwiOiAiaHR0cDovL2Rldi1kaGEuaHVtYW5hLmNvbTo4ODg5L2ZpcmVzaG90cy9jcmVkZW50aWFsc0ZldGNoV2ViU2VydmljZSIsCiAgImZpbGVfcGF0aCI6ICIxNTY3XzI2MV8xNzAwMDYyNTg2NjYyNzY5MSIsCiAgImNyZWRlbnRpYWxfZmlsZV9wYXR0ZXJuIiA6ICI0MV8xNjk5MzQyNTc1Igp9", "base64_pipeline_timeout_json": "ewoicGlwZWxpbmVfdGltZW91dCIgOiAyMwp9", "emr_input_json":"ewogICJjbHVzdGVyX2lkIjogIjA5MjItMDAzMTM4LW9ybjlyMHRlIiwKICAiY2x1c3Rlcl9yZWdpb24iOiAibnVsbCIsCiAgImNvbXB1dGVfZW5nX2NyZWRzX2pzb24iOiAiZXdvZ0lDSmpjbVZrWlc1MGFXRnNYMmxrSWpvZ0lqUXhJaXdLSUNBaVkzSmxaR1Z1ZEdsaGJGOTBlWEJsWDJsa0lqb2dJakUxSWl3S0lDQWlZM0psWkdWdWRHbGhiRjkwZVhCbElqb2dJa1pwYkdVZ1EyOXVkR1Z1ZENJc0NpQWdJblJ2YTJWdUlqb2dJbU0yT1RVd05UZ3lZVEV5WWpVMU9HRmlOalE0WTJSaU56SXdNRGd4TnpOaU1tVTROREk0Wm1JMU5XUmhZV1EzTkRBeE5USXlOVFk1TVdWbFl6YzRaV1UzWWpWak5HVXpORE14TW1SbFpEY3dZV1UxWlRkbFpUUTRNMkkzWkRkbFlUQmpNak5sTWpSbE5EVTRaV1F4WmpVMFpHRXpZMk5rTjJSaVkyWmxPRGN3WVRZeFpUVmpPV00xTURnM1pUZG1ZalprWXpFMllqWm1PR1kxWlRSaVpXUmhOVFk1TWpSbE9EZzBPV1ZpTlRNNVlUWXpZalptTXpoak16RTRNR1k0TmprM1pHTXhZMlpoTmpFeE1qTXpNVEF4T1RRMk5HSTFZall3WWprM09XSTVNelppWmpVeE56RmhPVGsyTW1NeFkyRTFOR1k0WldNNE5ESXdOamRoT0RRNFlqa3lNMk0yT1dReU9UbGpObUkzTlRJMFl6QTVOVFF5T1RNd05EQXpNRGxoTVdZNFptUXpPV1kzT0RKa01XSmtPRFkwTTJZek1tRTJOV1poTXpVM01EVTJaV0prWmpCa05UUTVaVEl3WmpCbU1XRXdOVFpsT0RFeU5qTTRNak01Tm1NNVptUTFOR016WVdGbE9XUTRNamhqTm1ZMU5XVTNNMkV5WXpZME5UbGhNREprTlRVeU5HVmhNak0wWXpJd1pEbGxaV1kwTm1ReE5XWmxaR0poTldKbU9UVmxObUppT0RNd1ptRmpaR05oWVdVeE56QTJabU5oTmpFNE1HSmtZakF3TXpWaE9UTmxNalJrTlRjMU5HWTNaREptT0dNek16VTRZbUpoWW1GbE9EbGtZak15T1dKbU16WXpaR1l3WXpFME9HTTFPV0ZoWldWbU5HTmtabVppWkRnM09UQTVNRE13TlRSa05tSTFOR0ZpWmpKbU9UTTFOMlZrWVRCbE5HWm1NekZoWWpBM01UZGxaRFJtWW1Kak1XWTFORFk1TlRnME5EUmhPV014TlRNd1pHSXhPVGd6T1RRMVkyRXhaamc0T1Rjd1pXVTNZMlV3WWpBM056VTROVEV3WVRoa01XSXlZemN3TkRWbU4yVXdZelF4TWpJeE1qUTBaRGczTlRFNFltWmlNVEU1WmpCak1HSXlZVEl4TW1RMU56WTFOMk5rTkROaFpqVmhZbU0wTkdRNU9UVTNOVGt4T1RFeFltUmxZV1kyTWpjNVpEUXpZVEU1TnpJeE16ZzROVEprTTJSbFlqZ3haVEF4T0dObVpESmlaV00wTVRJd1lqRmhaV1l5TkdRMU5tVXpNV015WTJGbE5tRTNZemc0WW1ReE16bGlORFF3TXpBeE5UWTNNbVUyWWpoa05UTm1NamhrTWpNelptSXdObVJqTldSbU5qZGxZalkxTVRsbE9XVTBOR1ZrT1RCbE5HSmlabUk0WWpVM05tTTVZV1poTjJSa1ptRmlNVGRoWmpJeE9XSm1PREV6TldSbE1XWTRaVFptWVRObVpqUTJaVEZoWVdNNU5qbGhabU14WmpSak5UWXlOV1F3WXpZd056VTBabU14WW1Kak16UmhaRFl6WlRVNFlUUm1OMkpsT1RjMU5qWm1OREV6T1dFNVlUUmlZbVl3WW1JeE0yUmhPV0l4TXpRME1ERTVaV1ZtTURnelltSXdOVFZoTW1abE1UQm1abVpqTnpNNVlUSTVZV1JpWW1SaE16TXpZamcwWldSa1pUZzJZalZpTnpZME1qazNaREU1WmpCak1UYzJPRGs1Tmpka1pUQXlNbUV4WkdJNVpERTBZMkZoTjJNNE1ERTRZalV5WXpoaVpUWm1NekV3TnpFM016aGpPV00xTnpFeFl6a3lOREl5T1RFeU5HUmlOakl3TVRFeFpXWmxOakZqWkdVNU5XUTVabVprWkRBME5EQTFOemsyTlRjMk5XTTBZVEF6TVdVMlptSXlZV0ZoWVRsbFpqZGxNVGMxTUdNM05UWmlaV0V5WVRGallUTTRaR0UxWWpaa01qSXpNVEV6TjJJd1pETmtaamswTkRVNE5EZGhORE5sWW1Fek4yRTJOMkV3TWpJNUlpd0tJQ0FpWTNKbFpHVnVkR2xoYkY5bGJtUndiMmx1ZEY5MWNtd2lPaUFpYUhSMGNEb3ZMMlJsZGkxa2FHRXVhSFZ0WVc1aExtTnZiVG80T0RnNUwyWnBjbVZ6YUc5MGN5OWpjbVZrWlc1MGFXRnNjMFpsZEdOb1YyVmlVMlZ5ZG1salpTSXNDaUFnSW1acGJHVmZjR0YwYUNJNklDSXhOVFkzWHpJMk1WOHhOekF3TURZeU5UZzJOall5TnpZNU1TSXNDaUFnSW1OeVpXUmxiblJwWVd4ZlptbHNaVjl3WVhSMFpYSnVJaUE2SUNJME1WOHhOams1TXpReU5UYzFJZ3A5IiwKICAiczNfcGF0aCI6ICIiLAogICJiNjRfaW5wdXRfanNvbiI6ICJld29pY0hKdlkyVnpjMGxrSWpveE56QXdNRFl5TlRnMk9Ua3pNVGc1TVN3S0ltUmhkR0Z3YkdGalpVbGtJam8wTWl3S0luUmhZbXhsU1dRaU9qTTNNak0wTEFvaVpHRjBZVzF2ZG1WdFpXNTBTV1FpT2pJMk1Td0tJbXB2WWxOamFHVmtkV3hsWkZWelpYSkpaQ0k2SWsxaGJtRnpkMmx1YVNCRGFHbHVkR2hoYkdGd2RXUnBJaXdLSW1wdllsTmphR1ZrZFd4bFNXUWlPakUxTmpjc0NpSmlZWFJqYUVsa0lqb3hOekF3TURZeU5UZzJOall5TnpZNU1Td0tJbXhoYzNSU2RXNVVhVzFsYzNSaGJYQWlPaUl5TURJekxURXhMVEEzSURFeU9qUXlPakF3TGpnMk16WTFJaXdLSW5KbGRISjVUblZ0SWpvZ0lqQWlDbjA9IiwKICAiZXh0cmFfY29uZmlnIjogImV3b2laWGgwY21GRGIyNW1hV2ROWVhBaU9pQjdJbk53WVhKckxtNWhZblV1Wm1WMFkyaGZjMmw2WlNJNklDSXhNREF3TUNJc0lDSnpjR0Z5YXk1dVlXSjFMbU52YlhCMWRHVmZaVzVuYVc1bElqb2dJbUY2ZFhKbFgyUmhkR0ZpY21samEzTWlMQ0FpYzNCaGNtc3VibUZpZFM1emIyeHlYMkpoZEdOb1gzTnBlbVVpT2lBaU1UQXdNREFpTENBaWMzQmhjbXN1Ym1GaWRTNWhjSEJzYVdOaGRHbHZibDl1WVcxbElqb2dJbTVoWW5VdGMzQmhjbXRpYjNRdGFXNW5aWE4wYVc5dUlpd2dJbk53WVhKckxtUnlhWFpsY2k1dVlXSjFYM0J5YVhaaGRHVkxaWGtpT2lBaUwyUmlabk12ZEcxd0wyUmxkaTl1WVdKMUx6RTNNREF3TmpJMU9EWTVPVE14T0RreEx6QXZjSEpwZG1GMFpVdGxlU0lzSUNKemNHRnlheTVrY21sMlpYSXVjMjkxY21ObFgyRjNjMTlsYm1SUWIybHVkQ0k2SUNKek15NWhiV0Y2YjI1aGQzTXVZMjl0SWl3Z0luTndZWEpyTG1SeWFYWmxjaTUwWVhKblpYUmZZWGR6WDJWdVpGQnZhVzUwSWpvZ0luTXpMbUZ0WVhwdmJtRjNjeTVqYjIwaUxDQWljM0JoY21zdWJtRmlkUzVqYjIxd2RYUmxYMlZ1WjJsdVpWOXNhV0p6WDNCaGRHZ2lPaUFpTDJSaVpuTXZkRzF3TDJSbGRpOXVZV0oxTHpFM01EQXdOakkxT0RZNU9UTXhPRGt4THpBdllYQndiR2xqWVhScGIyNHVZMjl1WmlKOUNuMD0iLAogICJiYXRjaF9pZCI6IDE3MDAwNjI1ODY2NjI3NjkxLAogICJyZXRyeV9udW0iOiAiMCIsCiAgInNwYXJrX2NvbmZpZ3MiOiAiZXdvZ0lDQWdJbk52YkhKZlltRjBZMmhmYzJsNlpTSTZJakV3TURBd0lpd2ljR0Z5WVd4c1pXeGZkR2h5WldGa2N5STZJakV3SWl3aVptVjBZMmhmYzJsNlpTSTZJakV3TURBd0lnb2dJQ0FnZlE9PSIsCiAgImlzX2J1Y2tldF9lbmNyeXB0ZWQiOiAiIiwKICAiYjY0X2V4dGVybmFsX2phcnNfbWFwIiA6ICIiCn0=", "yeedu_input_json":"ewoiY2x1c3Rlcl9pZCI6ICIiLAoiYjY0X2lucHV0X2pzb24iOiAiZXdvaWNISnZZMlZ6YzBsa0lqb3hOekF3TURZeU5UZzJPVGt6TVRnNU1Td0tJbVJoZEdGd2JHRmpaVWxrSWpvME1pd0tJblJoWW14bFNXUWlPak0zTWpNMExBb2laR0YwWVcxdmRtVnRaVzUwU1dRaU9qSTJNU3dLSW1wdllsTmphR1ZrZFd4bFpGVnpaWEpKWkNJNklrMWhibUZ6ZDJsdWFTQkRhR2x1ZEdoaGJHRndkV1JwSWl3S0ltcHZZbE5qYUdWa2RXeGxTV1FpT2pFMU5qY3NDaUppWVhSamFFbGtJam94TnpBd01EWXlOVGcyTmpZeU56WTVNU3dLSW14aGMzUlNkVzVVYVcxbGMzUmhiWEFpT2lJeU1ESXpMVEV4TFRBM0lERXlPalF5T2pBd0xqZzJNelkxSWl3S0luSmxkSEo1VG5WdElqb2dJakFpQ24wPSIsCiJleHRyYV9jb25maWciOiAiZXdvaVpYaDBjbUZEYjI1bWFXZE5ZWEFpT2lCN0luTndZWEpyTG01aFluVXVabVYwWTJoZmMybDZaU0k2SUNJeE1EQXdNQ0lzSUNKemNHRnlheTV1WVdKMUxtTnZiWEIxZEdWZlpXNW5hVzVsSWpvZ0ltRjZkWEpsWDJSaGRHRmljbWxqYTNNaUxDQWljM0JoY21zdWJtRmlkUzV6YjJ4eVgySmhkR05vWDNOcGVtVWlPaUFpTVRBd01EQWlMQ0FpYzNCaGNtc3VibUZpZFM1aGNIQnNhV05oZEdsdmJsOXVZVzFsSWpvZ0ltNWhZblV0YzNCaGNtdGliM1F0YVc1blpYTjBhVzl1SWl3Z0luTndZWEpyTG1SeWFYWmxjaTV1WVdKMVgzQnlhWFpoZEdWTFpYa2lPaUFpTDJSaVpuTXZkRzF3TDJSbGRpOXVZV0oxTHpFM01EQXdOakkxT0RZNU9UTXhPRGt4THpBdmNISnBkbUYwWlV0bGVTSXNJQ0p6Y0dGeWF5NWtjbWwyWlhJdWMyOTFjbU5sWDJGM2MxOWxibVJRYjJsdWRDSTZJQ0p6TXk1aGJXRjZiMjVoZDNNdVkyOXRJaXdnSW5Od1lYSnJMbVJ5YVhabGNpNTBZWEpuWlhSZllYZHpYMlZ1WkZCdmFXNTBJam9nSW5NekxtRnRZWHB2Ym1GM2N5NWpiMjBpTENBaWMzQmhjbXN1Ym1GaWRTNWpiMjF3ZFhSbFgyVnVaMmx1WlY5c2FXSnpYM0JoZEdnaU9pQWlMMlJpWm5NdmRHMXdMMlJsZGk5dVlXSjFMekUzTURBd05qSTFPRFk1T1RNeE9Ea3hMekF2WVhCd2JHbGpZWFJwYjI0dVkyOXVaaUo5Q24wPSIsCiJjb21wdXRlX2VuZ19jcmVkc19qc29uIiA6ICJld29nSUNKamNtVmtaVzUwYVdGc1gybGtJam9nSWpReElpd0tJQ0FpWTNKbFpHVnVkR2xoYkY5MGVYQmxYMmxrSWpvZ0lqRTFJaXdLSUNBaVkzSmxaR1Z1ZEdsaGJGOTBlWEJsSWpvZ0lrWnBiR1VnUTI5dWRHVnVkQ0lzQ2lBZ0luUnZhMlZ1SWpvZ0ltTTJPVFV3TlRneVlURXlZalUxT0dGaU5qUTRZMlJpTnpJd01EZ3hOek5pTW1VNE5ESTRabUkxTldSaFlXUTNOREF4TlRJeU5UWTVNV1ZsWXpjNFpXVTNZalZqTkdVek5ETXhNbVJsWkRjd1lXVTFaVGRsWlRRNE0ySTNaRGRsWVRCak1qTmxNalJsTkRVNFpXUXhaalUwWkdFelkyTmtOMlJpWTJabE9EY3dZVFl4WlRWak9XTTFNRGczWlRkbVlqWmtZekUyWWpabU9HWTFaVFJpWldSaE5UWTVNalJsT0RnME9XVmlOVE01WVRZellqWm1NemhqTXpFNE1HWTROamszWkdNeFkyWmhOakV4TWpNek1UQXhPVFEyTkdJMVlqWXdZamszT1dJNU16WmlaalV4TnpGaE9UazJNbU14WTJFMU5HWTRaV000TkRJd05qZGhPRFE0WWpreU0yTTJPV1F5T1Rsak5tSTNOVEkwWXpBNU5UUXlPVE13TkRBek1EbGhNV1k0Wm1Rek9XWTNPREprTVdKa09EWTBNMll6TW1FMk5XWmhNelUzTURVMlpXSmtaakJrTlRRNVpUSXdaakJtTVdFd05UWmxPREV5TmpNNE1qTTVObU01Wm1RMU5HTXpZV0ZsT1dRNE1qaGpObVkxTldVM00yRXlZelkwTlRsaE1ESmtOVFV5TkdWaE1qTTBZekl3WkRsbFpXWTBObVF4TldabFpHSmhOV0ptT1RWbE5tSmlPRE13Wm1GalpHTmhZV1V4TnpBMlptTmhOakU0TUdKa1lqQXdNelZoT1RObE1qUmtOVGMxTkdZM1pESm1PR016TXpVNFltSmhZbUZsT0Rsa1lqTXlPV0ptTXpZelpHWXdZekUwT0dNMU9XRmhaV1ZtTkdOa1ptWmlaRGczT1RBNU1ETXdOVFJrTm1JMU5HRmlaakptT1RNMU4yVmtZVEJsTkdabU16RmhZakEzTVRkbFpEUm1ZbUpqTVdZMU5EWTVOVGcwTkRSaE9XTXhOVE13WkdJeE9UZ3pPVFExWTJFeFpqZzRPVGN3WldVM1kyVXdZakEzTnpVNE5URXdZVGhrTVdJeVl6Y3dORFZtTjJVd1l6UXhNakl4TWpRMFpEZzNOVEU0WW1aaU1URTVaakJqTUdJeVlUSXhNbVExTnpZMU4yTmtORE5oWmpWaFltTTBOR1E1T1RVM05Ua3hPVEV4WW1SbFlXWTJNamM1WkRRellURTVOekl4TXpnNE5USmtNMlJsWWpneFpUQXhPR05tWkRKaVpXTTBNVEl3WWpGaFpXWXlOR1ExTm1Vek1XTXlZMkZsTm1FM1l6ZzRZbVF4TXpsaU5EUXdNekF4TlRZM01tVTJZamhrTlRObU1qaGtNak16Wm1Jd05tUmpOV1JtTmpkbFlqWTFNVGxsT1dVME5HVmtPVEJsTkdKaVptSTRZalUzTm1NNVlXWmhOMlJrWm1GaU1UZGhaakl4T1dKbU9ERXpOV1JsTVdZNFpUWm1ZVE5tWmpRMlpURmhZV001TmpsaFptTXhaalJqTlRZeU5XUXdZell3TnpVMFptTXhZbUpqTXpSaFpEWXpaVFU0WVRSbU4ySmxPVGMxTmpabU5ERXpPV0U1WVRSaVltWXdZbUl4TTJSaE9XSXhNelEwTURFNVpXVm1NRGd6WW1Jd05UVmhNbVpsTVRCbVptWmpOek01WVRJNVlXUmlZbVJoTXpNellqZzBaV1JrWlRnMllqVmlOelkwTWprM1pERTVaakJqTVRjMk9EazVOamRrWlRBeU1tRXhaR0k1WkRFMFkyRmhOMk00TURFNFlqVXlZemhpWlRabU16RXdOekUzTXpoak9XTTFOekV4WXpreU5ESXlPVEV5TkdSaU5qSXdNVEV4WldabE5qRmpaR1U1TldRNVptWmtaREEwTkRBMU56azJOVGMyTldNMFlUQXpNV1UyWm1JeVlXRmhZVGxsWmpkbE1UYzFNR00zTlRaaVpXRXlZVEZqWVRNNFpHRTFZalprTWpJek1URXpOMkl3WkROa1pqazBORFU0TkRkaE5ETmxZbUV6TjJFMk4yRXdNakk1SWl3S0lDQWlZM0psWkdWdWRHbGhiRjlsYm1Sd2IybHVkRjkxY213aU9pQWlhSFIwY0RvdkwyUmxkaTFrYUdFdWFIVnRZVzVoTG1OdmJUbzRPRGc1TDJacGNtVnphRzkwY3k5amNtVmtaVzUwYVdGc2MwWmxkR05vVjJWaVUyVnlkbWxqWlNJc0NpQWdJbVpwYkdWZmNHRjBhQ0k2SUNJeE5UWTNYekkyTVY4eE56QXdNRFl5TlRnMk5qWXlOelk1TVNJc0NpQWdJbU55WldSbGJuUnBZV3hmWm1sc1pWOXdZWFIwWlhKdUlpQTZJQ0kwTVY4eE5qazVNelF5TlRjMUlncDkiLAoiY2x1c3Rlcl91aSI6ICIiLAoicmV0cnlfbnVtIjogIjAiLAoic3BhcmtfY29uZmlncyI6ICJld29nSUNBZ0luTnZiSEpmWW1GMFkyaGZjMmw2WlNJNklqRXdNREF3SWl3aWNHRnlZV3hzWld4ZmRHaHlaV0ZrY3lJNklqRXdJaXdpWm1WMFkyaGZjMmw2WlNJNklqRXdNREF3SWdvZ0lDQWdmUT09IiwKImI2NF9oaXZlX2NyZWRzX2pzb24iOiAiZXdvZ0lDSmpjbVZrWlc1MGFXRnNYMmxrSWpvZ0lpSXNDaUFnSW1OeVpXUmxiblJwWVd4ZmRIbHdaVjlwWkNJNklDSWlMQW9nSUNKMGIydGxiaUk2SUNKak5qazFNRFU0TW1FeE1tSTFOVGhoWWpZME9HTmtZamN5TURBNE1UY3pZakpsT0RReU9HWmlOVFZrWVdGa056UXdNVFV5TWpVMk9URmxaV00zT0dWbE4ySTFZelJsTXpRek1USmtaV1EzTUdGbE5XVTNaV1UwT0ROaU4yUTNaV0V3WXpJelpUSTBaVFExT0dWa01XWTFOR1JoTTJOalpEZGtZbU5tWlRnM01HRTJNV1UxWXpsak5UQTROMlUzWm1JMlpHTXhObUkyWmpobU5XVTBZbVZrWVRVMk9USTBaVGc0TkRsbFlqVXpPV0UyTTJJMlpqTTRZek14T0RCbU9EWTVOMlJqTVdObVlUWXhNVEl6TXpFd01UazBOalJpTldJMk1HSTVOemxpT1RNMlltWTFNVGN4WVRrNU5qSmpNV05oTlRSbU9HVmpPRFF5TURZM1lUZzBPR0k1TWpOak5qbGtNams1WXpaaU56VXlOR013T1RVME1qa3pNRFF3TXpBNVlURm1PR1prTXpsbU56Z3laREZpWkRnMk5ETm1NekpoTmpWbVlUTTFOekExTm1WaVpHWXdaRFUwT1dVeU1HWXdaakZoTURVMlpUZ3hNall6T0RJek9UWmpPV1prTlRSak0yRmhaVGxrT0RJNFl6Wm1OVFZsTnpOaE1tTTJORFU1WVRBeVpEVTFNalJsWVRJek5HTXlNR1E1WldWbU5EWmtNVFZtWldSaVlUVmlaamsxWlRaaVlqZ3pNR1poWTJSallXRmxNVGN3Tm1aallUWXhPREJpWkdJd01ETTFZVGt6WlRJMFpEVTNOVFJtTjJReVpqaGpNek0xT0dKaVlXSmhaVGc1WkdJek1qbGlaak0yTTJSbU1HTXhORGhqTlRsaFlXVmxaalJqWkdabVltUTROemt3T1RBek1EVTBaRFppTlRSaFltWXlaamt6TlRkbFpHRXdaVFJtWmpNeFlXSXdOekUzWldRMFptSmlZekZtTlRRMk9UVTRORFEwWVRsak1UVXpNR1JpTVRrNE16azBOV05oTVdZNE9EazNNR1ZsTjJObE1HSXdOemMxT0RVeE1HRTRaREZpTW1NM01EUTFaamRsTUdNME1USXlNVEkwTkdRNE56VXhPR0ptWWpFeE9XWXdZekJpTW1FeU1USmtOVGMyTlRkalpEUXpZV1kxWVdKak5EUmtPVGsxTnpVNU1Ua3hNV0prWldGbU5qSTNPV1EwTTJFeE9UY3lNVE00T0RVeVpETmtaV0k0TVdVd01UaGpabVF5WW1Wak5ERXlNR0l4WVdWbU1qUmtOVFpsTXpGak1tTmhaVFpoTjJNNE9HSmtNVE01WWpRME1ETXdNVFUyTnpKbE5tSTRaRFV6WmpJNFpESXpNMlppTURaa1l6VmtaalkzWldJMk5URTVaVGxsTkRSbFpEa3daVFJpWW1aaU9HSTFOelpqT1dGbVlUZGtaR1poWWpFM1lXWXlNVGxpWmpneE16VmtaVEZtT0dVMlptRXpabVkwTm1VeFlXRmpPVFk1WVdaak1XWTBZelUyTWpWa01HTTJNRGMxTkdaak1XSmlZek0wWVdRMk0yVTFPR0UwWmpkaVpUazNOVFkyWmpReE16bGhPV0UwWW1KbU1HSmlNVE5rWVRsaU1UTTBOREF4T1dWbFpqQTRNMkppTURVMVlUSm1aVEV3Wm1abVl6Y3pPV0V5T1dGa1ltSmtZVE16TTJJNE5HVmtaR1U0Tm1JMVlqYzJOREk1TjJReE9XWXdZekUzTmpnNU9UWTNaR1V3TWpKaE1XUmlPV1F4TkdOaFlUZGpPREF4T0dJMU1tTTRZbVUyWmpNeE1EY3hOek00WXpsak5UY3hNV001TWpReU1qa3hNalJrWWpZeU1ERXhNV1ZtWlRZeFkyUmxPVFZrT1dabVpHUXdORFF3TlRjNU5qVTNOalZqTkdFd016RmxObVppTW1GaFlXRTVaV1kzWlRFM05UQmpOelUyWW1WaE1tRXhZMkV6T0dSaE5XSTJaREl5TXpFeE16ZGlNR1F6WkdZNU5EUTFPRFEzWVRRelpXSmhNemRoTmpkaE1ESXlPU0lzQ2lBZ0ltTnlaV1JsYm5ScFlXeGZaVzVrY0c5cGJuUmZkWEpzSWpvZ0ltaDBkSEE2THk5a1pYWXRaR2hoTG1oMWJXRnVZUzVqYjIwNk9EZzRPUzltYVhKbGMyaHZkSE12WTNKbFpHVnVkR2xoYkhOR1pYUmphRmRsWWxObGNuWnBZMlVpQ24wPSIsCiJiYXRjaF9pZCI6MTcwMDA2MjU4NjY2Mjc2OTEsCiJwcm9jZXNzX2lkIiA6MTcwMDA2MjU4Njk5MzE4OTEsCiJyZXN0X3VybCI6ICIiLAoiYjY0X2V4dGVybmFsX2phcnNfbWFwIiA6ICIiCn0=", "yeedu_restapi_url":"null" }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/ingestion_flow.stg", "template_name": "advanced_table_options_utility", "useIncomingData": true }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "task_status_success_msg", "useIncomingData": true } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "error_template_create_msg" } ] } ] }
""2023-11-15 15:37:05.059 [Thread-2176] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_spark_script
""2023-11-15 15:37:05.064 [Thread-2176] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_spark_script
""2023-11-15 15:37:05.064 [Thread-2176] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:37:05.064 [Thread-2176] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot finished processing message with id f9af8fe7-d4e3-4a83-8400-4c22ce532ac9
""2023-11-15 15:37:05.103 [Thread-2064] INFO  com.modak.bots.basebot.AbstractBaseBot - SparkScriptBot with bot_id 2e8814f0-bfd3-416c-a2b9-266ce96ef204 has started processing message with message_id d5f7c84d-e235-4701-910a-64489cde6bd3 and thread_id 2517 
""2023-11-15 15:37:05.103 [Thread-2064] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:37:05.103 [Thread-2064] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=f9af8fe7-d4e3-4a83-8400-4c22ce532ac9, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=run_almaren_ingestion_job_using_spark, message_id=d5f7c84d-e235-4701-910a-64489cde6bd3, task_retry_intervals_secs=[], bot_id=b006ad5b-9517-4ef8-87e2-7c6dea91f146, message_topic=nabu_2_spark_script, tags={process_id=17000625869931891, batch_id=17000625866627691, job_scheduled_user_id=Manaswini Chinthalapudi, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot, KoshBot, DBOpsBot, DBOpsBot, KoshBot], initial_ts=1700062586993, batch_name=Ingestion_20231115, environment=modak, job_schedule_id=1567, data_movement_id=261, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, task_dependency=true, ignore_job_termination=false}}
""2023-11-15 15:37:05.300 [Thread-2064] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
["sh","-l","-c","$NABU_ROOT_INSTALLATION/botworks/scripts/createCredentials.sh null null azure_databricks null ewogICJjcmVkZW50aWFsX2lkIjogIjQxIiwKICAiY3JlZGVudGlhbF90eXBlX2lkIjogIjE1IiwKICAiY3JlZGVudGlhbF90eXBlIjogIkZpbGUgQ29udGVudCIsCiAgInRva2VuIjogImM2OTUwNTgyYTEyYjU1OGFiNjQ4Y2RiNzIwMDgxNzNiMmU4NDI4ZmI1NWRhYWQ3NDAxNTIyNTY5MWVlYzc4ZWU3YjVjNGUzNDMxMmRlZDcwYWU1ZTdlZTQ4M2I3ZDdlYTBjMjNlMjRlNDU4ZWQxZjU0ZGEzY2NkN2RiY2ZlODcwYTYxZTVjOWM1MDg3ZTdmYjZkYzE2YjZmOGY1ZTRiZWRhNTY5MjRlODg0OWViNTM5YTYzYjZmMzhjMzE4MGY4Njk3ZGMxY2ZhNjExMjMzMTAxOTQ2NGI1YjYwYjk3OWI5MzZiZjUxNzFhOTk2MmMxY2E1NGY4ZWM4NDIwNjdhODQ4YjkyM2M2OWQyOTljNmI3NTI0YzA5NTQyOTMwNDAzMDlhMWY4ZmQzOWY3ODJkMWJkODY0M2YzMmE2NWZhMzU3MDU2ZWJkZjBkNTQ5ZTIwZjBmMWEwNTZlODEyNjM4MjM5NmM5ZmQ1NGMzYWFlOWQ4MjhjNmY1NWU3M2EyYzY0NTlhMDJkNTUyNGVhMjM0YzIwZDllZWY0NmQxNWZlZGJhNWJmOTVlNmJiODMwZmFjZGNhYWUxNzA2ZmNhNjE4MGJkYjAwMzVhOTNlMjRkNTc1NGY3ZDJmOGMzMzU4YmJhYmFlODlkYjMyOWJmMzYzZGYwYzE0OGM1OWFhZWVmNGNkZmZiZDg3OTA5MDMwNTRkNmI1NGFiZjJmOTM1N2VkYTBlNGZmMzFhYjA3MTdlZDRmYmJjMWY1NDY5NTg0NDRhOWMxNTMwZGIxOTgzOTQ1Y2ExZjg4OTcwZWU3Y2UwYjA3NzU4NTEwYThkMWIyYzcwNDVmN2UwYzQxMjIxMjQ0ZDg3NTE4YmZiMTE5ZjBjMGIyYTIxMmQ1NzY1N2NkNDNhZjVhYmM0NGQ5OTU3NTkxOTExYmRlYWY2Mjc5ZDQzYTE5NzIxMzg4NTJkM2RlYjgxZTAxOGNmZDJiZWM0MTIwYjFhZWYyNGQ1NmUzMWMyY2FlNmE3Yzg4YmQxMzliNDQwMzAxNTY3MmU2YjhkNTNmMjhkMjMzZmIwNmRjNWRmNjdlYjY1MTllOWU0NGVkOTBlNGJiZmI4YjU3NmM5YWZhN2RkZmFiMTdhZjIxOWJmODEzNWRlMWY4ZTZmYTNmZjQ2ZTFhYWM5NjlhZmMxZjRjNTYyNWQwYzYwNzU0ZmMxYmJjMzRhZDYzZTU4YTRmN2JlOTc1NjZmNDEzOWE5YTRiYmYwYmIxM2RhOWIxMzQ0MDE5ZWVmMDgzYmIwNTVhMmZlMTBmZmZjNzM5YTI5YWRiYmRhMzMzYjg0ZWRkZTg2YjViNzY0Mjk3ZDE5ZjBjMTc2ODk5NjdkZTAyMmExZGI5ZDE0Y2FhN2M4MDE4YjUyYzhiZTZmMzEwNzE3MzhjOWM1NzExYzkyNDIyOTEyNGRiNjIwMTExZWZlNjFjZGU5NWQ5ZmZkZDA0NDA1Nzk2NTc2NWM0YTAzMWU2ZmIyYWFhYTllZjdlMTc1MGM3NTZiZWEyYTFjYTM4ZGE1YjZkMjIzMTEzN2IwZDNkZjk0NDU4NDdhNDNlYmEzN2E2N2EwMjI5IiwKICAiY3JlZGVudGlhbF9lbmRwb2ludF91cmwiOiAiaHR0cDovL2Rldi1kaGEuaHVtYW5hLmNvbTo4ODg5L2ZpcmVzaG90cy9jcmVkZW50aWFsc0ZldGNoV2ViU2VydmljZSIsCiAgImZpbGVfcGF0aCI6ICIxNTY3XzI2MV8xNzAwMDYyNTg2NjYyNzY5MSIsCiAgImNyZWRlbnRpYWxfZmlsZV9wYXR0ZXJuIiA6ICI0MV8xNjk5MzQyNTc1Igp9"]
""2023-11-15 15:37:05.315 [Thread-2064] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 15:37:05.316 [Thread-2064] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:37:05.322 [Thread-2064] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:37:05.322 [Thread-2064] INFO  com.modak.bots.basebot.AbstractBaseBot - SparkScriptBot with bot_id 2e8814f0-bfd3-416c-a2b9-266ce96ef204 has started process logic with message_id d5f7c84d-e235-4701-910a-64489cde6bd3 and thread_id 2517
""2023-11-15 15:37:05.326 [Thread-784] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id dffb37f0-c728-4a3a-84e7-d58fa3893a69 has started processing message with message_id fd287747-56b5-4577-ac04-412a24360536 and thread_id 974 
""2023-11-15 15:37:05.326 [Thread-784] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:37:05.326 [Thread-784] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=d5f7c84d-e235-4701-910a-64489cde6bd3, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=fd287747-56b5-4577-ac04-412a24360536, task_retry_intervals_secs=[], bot_id=2e8814f0-bfd3-416c-a2b9-266ce96ef204, message_topic=nabu_2_taskmonitor, tags={process_id=17000625869931891, initial_ts=1700062586993, batch_name=Ingestion_20231115, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot, KoshBot, DBOpsBot, DBOpsBot, KoshBot, TaskMonitorBot]}}
""2023-11-15 15:37:05.337 [Thread-784] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 17000625869931891, 'SparkScriptBot', 'run_almaren_ingestion_job_using_spark', 'create_credential_file_if_required', 10 , TO_TIMESTAMP(1700062625103::double precision / 1000) ,'2e8814f0-bfd3-416c-a2b9-266ce96ef204');
""2023-11-15 15:37:05.337 [Thread-784] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id dffb37f0-c728-4a3a-84e7-d58fa3893a69 has started process logic with message_id fd287747-56b5-4577-ac04-412a24360536 and thread_id 974
""2023-11-15 15:37:05.454 [Thread-784] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id dffb37f0-c728-4a3a-84e7-d58fa3893a69 has finished process logic with message_id fd287747-56b5-4577-ac04-412a24360536 and thread_id 974
""2023-11-15 15:37:05.454 [Thread-784] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:37:05.455 [Thread-784] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id fd287747-56b5-4577-ac04-412a24360536
""2023-11-15 15:37:05.482 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - command to be executed  [sh, -l, -c, $NABU_ROOT_INSTALLATION/botworks/scripts/createCredentials.sh null null azure_databricks null ewogICJjcmVkZW50aWFsX2lkIjogIjQxIiwKICAiY3JlZGVudGlhbF90eXBlX2lkIjogIjE1IiwKICAiY3JlZGVudGlhbF90eXBlIjogIkZpbGUgQ29udGVudCIsCiAgInRva2VuIjogImM2OTUwNTgyYTEyYjU1OGFiNjQ4Y2RiNzIwMDgxNzNiMmU4NDI4ZmI1NWRhYWQ3NDAxNTIyNTY5MWVlYzc4ZWU3YjVjNGUzNDMxMmRlZDcwYWU1ZTdlZTQ4M2I3ZDdlYTBjMjNlMjRlNDU4ZWQxZjU0ZGEzY2NkN2RiY2ZlODcwYTYxZTVjOWM1MDg3ZTdmYjZkYzE2YjZmOGY1ZTRiZWRhNTY5MjRlODg0OWViNTM5YTYzYjZmMzhjMzE4MGY4Njk3ZGMxY2ZhNjExMjMzMTAxOTQ2NGI1YjYwYjk3OWI5MzZiZjUxNzFhOTk2MmMxY2E1NGY4ZWM4NDIwNjdhODQ4YjkyM2M2OWQyOTljNmI3NTI0YzA5NTQyOTMwNDAzMDlhMWY4ZmQzOWY3ODJkMWJkODY0M2YzMmE2NWZhMzU3MDU2ZWJkZjBkNTQ5ZTIwZjBmMWEwNTZlODEyNjM4MjM5NmM5ZmQ1NGMzYWFlOWQ4MjhjNmY1NWU3M2EyYzY0NTlhMDJkNTUyNGVhMjM0YzIwZDllZWY0NmQxNWZlZGJhNWJmOTVlNmJiODMwZmFjZGNhYWUxNzA2ZmNhNjE4MGJkYjAwMzVhOTNlMjRkNTc1NGY3ZDJmOGMzMzU4YmJhYmFlODlkYjMyOWJmMzYzZGYwYzE0OGM1OWFhZWVmNGNkZmZiZDg3OTA5MDMwNTRkNmI1NGFiZjJmOTM1N2VkYTBlNGZmMzFhYjA3MTdlZDRmYmJjMWY1NDY5NTg0NDRhOWMxNTMwZGIxOTgzOTQ1Y2ExZjg4OTcwZWU3Y2UwYjA3NzU4NTEwYThkMWIyYzcwNDVmN2UwYzQxMjIxMjQ0ZDg3NTE4YmZiMTE5ZjBjMGIyYTIxMmQ1NzY1N2NkNDNhZjVhYmM0NGQ5OTU3NTkxOTExYmRlYWY2Mjc5ZDQzYTE5NzIxMzg4NTJkM2RlYjgxZTAxOGNmZDJiZWM0MTIwYjFhZWYyNGQ1NmUzMWMyY2FlNmE3Yzg4YmQxMzliNDQwMzAxNTY3MmU2YjhkNTNmMjhkMjMzZmIwNmRjNWRmNjdlYjY1MTllOWU0NGVkOTBlNGJiZmI4YjU3NmM5YWZhN2RkZmFiMTdhZjIxOWJmODEzNWRlMWY4ZTZmYTNmZjQ2ZTFhYWM5NjlhZmMxZjRjNTYyNWQwYzYwNzU0ZmMxYmJjMzRhZDYzZTU4YTRmN2JlOTc1NjZmNDEzOWE5YTRiYmYwYmIxM2RhOWIxMzQ0MDE5ZWVmMDgzYmIwNTVhMmZlMTBmZmZjNzM5YTI5YWRiYmRhMzMzYjg0ZWRkZTg2YjViNzY0Mjk3ZDE5ZjBjMTc2ODk5NjdkZTAyMmExZGI5ZDE0Y2FhN2M4MDE4YjUyYzhiZTZmMzEwNzE3MzhjOWM1NzExYzkyNDIyOTEyNGRiNjIwMTExZWZlNjFjZGU5NWQ5ZmZkZDA0NDA1Nzk2NTc2NWM0YTAzMWU2ZmIyYWFhYTllZjdlMTc1MGM3NTZiZWEyYTFjYTM4ZGE1YjZkMjIzMTEzN2IwZDNkZjk0NDU4NDdhNDNlYmEzN2E2N2EwMjI5IiwKICAiY3JlZGVudGlhbF9lbmRwb2ludF91cmwiOiAiaHR0cDovL2Rldi1kaGEuaHVtYW5hLmNvbTo4ODg5L2ZpcmVzaG90cy9jcmVkZW50aWFsc0ZldGNoV2ViU2VydmljZSIsCiAgImZpbGVfcGF0aCI6ICIxNTY3XzI2MV8xNzAwMDYyNTg2NjYyNzY5MSIsCiAgImNyZWRlbnRpYWxfZmlsZV9wYXR0ZXJuIiA6ICI0MV8xNjk5MzQyNTc1Igp9]
""2023-11-15 15:37:06.011 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - spark engine is azure_databricks
""2023-11-15 15:37:06.391 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:06,390] 	 DEBUG:Starting new HTTP connection (1): dev-dha.humana.com:8889
""2023-11-15 15:37:06.572 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:06,572] 	 DEBUG:http://dev-dha.humana.com:8889 "POST /fireshots/credentialsFetchWebService HTTP/1.1" 200 332
""2023-11-15 15:37:06.577 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:06,575] 	 INFO:file created at:/opt/nabu/nabu-spark-bots/azure_databricks/creds/1567_261_17000625866627691/ with filename 41_1699342575
""2023-11-15 15:37:06.622 [Thread-2064] INFO  com.modak.bots.SparkScriptBot -  exit status : 0
""2023-11-15 15:37:06.804 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - application_id null
""2023-11-15 15:37:06.804 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - job_id null
""2023-11-15 15:37:06.804 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - run_id null
""2023-11-15 15:37:06.804 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - job_name null
""2023-11-15 15:37:06.804 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - RunPageURL null
""2023-11-15 15:37:06.804 [Thread-2064] INFO  com.modak.bots.SparkScriptBot - Script executed successfully
""2023-11-15 15:37:06.921 [Thread-2064] INFO  com.modak.bots.SparkScriptBot - connection closed!
""2023-11-15 15:37:06.921 [Thread-2064] INFO  com.modak.bots.basebot.AbstractBaseBot - SparkScriptBot with bot_id 2e8814f0-bfd3-416c-a2b9-266ce96ef204 has finished process logic with message_id d5f7c84d-e235-4701-910a-64489cde6bd3 and thread_id 2517
""2023-11-15 15:37:06.921 [Thread-2064] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-15 15:37:06.932 [Thread-2064] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "2d68bbed-f4cd-4e12-bdda-93c69a24ecc1", "parent_id": "d5f7c84d-e235-4701-910a-64489cde6bd3", "bot_id": "2e8814f0-bfd3-416c-a2b9-266ce96ef204", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":17000625869931891, "initial_ts":1700062586993, "batch_id":17000625866627691, "batch_name":"Ingestion_20231115", "job_schedule_id":1567, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "2023-11-07 12:42:00.86365", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot", "KoshBot", "DBOpsBot", "DBOpsBot", "KoshBot", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"2e8814f0-bfd3-416c-a2b9-266ce96ef204", "bot_name":"SparkScriptBot", "process_context":"run_almaren_ingestion_job_using_spark", "task_name":"create_credential_file_if_required", "process_id":"17000625869931891", "task_ts":1700062626921, "batch_id":"17000625866627691", "status_code_id": 6 } } ] }
""2023-11-15 15:37:06.934 [Thread-2064] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:37:06.938 [Thread-2064] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:37:06.938 [Thread-2064] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:37:06.938 [Thread-2064] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:37:06.938 [Thread-2064] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=f9af8fe7-d4e3-4a83-8400-4c22ce532ac9, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=run_almaren_ingestion_job_using_spark, message_id=d5f7c84d-e235-4701-910a-64489cde6bd3, task_retry_intervals_secs=[], bot_id=b006ad5b-9517-4ef8-87e2-7c6dea91f146, message_topic=nabu_2_spark_script, tags={process_id=17000625869931891, batch_id=17000625866627691, job_scheduled_user_id=Manaswini Chinthalapudi, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot, KoshBot, DBOpsBot, DBOpsBot, KoshBot], initial_ts=1700062586993, batch_name=Ingestion_20231115, environment=modak, job_schedule_id=1567, data_movement_id=261, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, task_dependency=true, ignore_job_termination=false}}
""2023-11-15 15:37:06.950 [Thread-1124] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id c89cb15f-b8e9-4e53-936a-13712f3eb214 has started processing message with message_id 2d68bbed-f4cd-4e12-bdda-93c69a24ecc1 and thread_id 1371 
""2023-11-15 15:37:06.950 [Thread-1124] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:37:06.950 [Thread-1124] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=d5f7c84d-e235-4701-910a-64489cde6bd3, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=2d68bbed-f4cd-4e12-bdda-93c69a24ecc1, task_retry_intervals_secs=[], bot_id=2e8814f0-bfd3-416c-a2b9-266ce96ef204, message_topic=nabu_2_taskmonitor, tags={process_id=17000625869931891, initial_ts=1700062586993, batch_name=Ingestion_20231115, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot, KoshBot, DBOpsBot, DBOpsBot, KoshBot, TaskMonitorBot]}}
""2023-11-15 15:37:06.963 [Thread-1124] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 17000625869931891, 'SparkScriptBot', 'run_almaren_ingestion_job_using_spark', 'create_credential_file_if_required', 6 , TO_TIMESTAMP(1700062626921::double precision / 1000) ,'2e8814f0-bfd3-416c-a2b9-266ce96ef204');
""2023-11-15 15:37:06.963 [Thread-1124] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id c89cb15f-b8e9-4e53-936a-13712f3eb214 has started process logic with message_id 2d68bbed-f4cd-4e12-bdda-93c69a24ecc1 and thread_id 1371
""2023-11-15 15:37:06.970 [Thread-1124] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id c89cb15f-b8e9-4e53-936a-13712f3eb214 has finished process logic with message_id 2d68bbed-f4cd-4e12-bdda-93c69a24ecc1 and thread_id 1371
""2023-11-15 15:37:06.970 [Thread-1124] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:37:06.970 [Thread-1124] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 2d68bbed-f4cd-4e12-bdda-93c69a24ecc1
""2023-11-15 15:37:07.135 [Thread-2064] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
["sh","-l","-c","$NABU_ROOT_INSTALLATION/botworks/scripts/ingestion/run_almaren_job.sh rO0ABXVyAAJbQqzzF/gGCFTgAgAAeHAAAAEAFBBvYZ7Mim3fI+Np05VO+EHuf5PxldceVzCwdbLhn99OYytVbAynQS5Ral29GY9WQevohqFq0pptfWmC6Hdze1ChYqC3VXBhBj3fvqRQZTXN3/gYsSGTxp+834hmfUfQbU0RQ7RnV0wV7zyS1QELwx0d2MbPVdCF1bxRqXdtOn1A4aNwc7Ia7/cZJEKIjKPAUohAvgCyjsGHSbHQx98WKhSwSU60Sa2dauo11GJkO6jT0fdAUjMDuRgiri0JjVTof4u/gV/qzwHpGu/AH/Q/dG8vOv1Stjm43HFpaHjBb2lqw0+JUBuIAqO1SbZmHe1FSy4p09C5Z0pkxSxmLBMQXXVxAH4AAAAAA5D7uBN32zcbCqrcmzijqQfhpAWVqmvEcLxsLpAXN0MnSpwYDURX1Bzr/vmU9PmJjV114yRnCLXxwgtmVebwcXQpDixTHpTKVjL/CtOTvSkauTybzdVq1nm6iSti+tUV5IX7blC5I+JVJZcJyd6c83OK54FmVswIUe6LEaVCSaMlYzQNpKT7IKYurmTruiz7hrCJ9ZdIk+fUYt2inQ9BMkqscwFr97n+VE9s/5MPmsbtG7JCzBniT5ePLh9BIr6dWLfZjG+MKsijpwhUINj3sG/IbsCtqQuNLGxFV6nZObarxX/8NiFDOwXitmggN2ZBe0ggcLzMHBDILWwaxnGsByVdmKFxN5DozkOUQM1FX0euvznFtk/Vd7mu6sTeISNvvpempQuPOLzUew2SfynpCR8gqBp0N4E7JYBYpfeuk4wDcX7y6q7xb+p/Ir2i90Y+AJxMfcXIH7bDQ8H24cSg2pvx1mIZU9btojRD00BaME1dgJOOI42T1jALDSOWIUSxS84qQ1blakpHAKfp4OFgT6XNQNN1mteDjRcLlLxkTP2azXBeWL3/1Ix9/2WLHgbeP4rQG27yM6n+YYQU2OTqKr8nJ7HPbwfY3tiagpKX7VpRnoTq/he0Db7UxxzVEN12/Pj8fJUjLXTAfoworuhlYo0AaSYMMt2lIr9gB2FRiH1+RELLTrt/0tGUjMaOLWL6WU8IZj749J9MUYQ6dTnmQHwUKWsaImYLZIPp5HDwC/8etfQBMqqYUfn8Mm/McmjKX7AHB48J4X9BBW4n42bLVwBwBxoIzRoQOVAK95be5uR7X9PQ7mqGpjK6KTWPgSj34dg94SCzm40mhvwW0d+KatJ3Bl/mXsYXzDK6k7vqIQuuYlm8IVvlScQZSrXMJkQK3kVYlZMnpEM47cgs5s/AtFNRgD3tIRl28PZBvAoU2RdxpEGJCp97LugjtPmQVwPqHtxZQ2eBAWvcT7prIgNQJgKLvMWSb0S42rDhrEaV3vRYjxxZh2a8odrvFve7mNJjYRvscpOOljnliNBnVW703kNQVjIlNiOu6WezpphGFNzd434k1Fom9cQub82hQgHeGssWwjEmL4lCCtT4rRHxouyik36/v4js9JSVh4RlgXvGR2daW7KTzqW/GquJUbJjVarT2iljzwahdM08Mbj9T1uxcDycIuEskdEp6pmFVTMgzRYNjAZbWMGnhdKRWYozgis= ewoicHJvY2Vzc0lkIjoxNzAwMDYyNTg2OTkzMTg5MSwKImRhdGFwbGFjZUlkIjo0MiwKInRhYmxlSWQiOjM3MjM0LAoiZGF0YW1vdmVtZW50SWQiOjI2MSwKImpvYlNjaGVkdWxlZFVzZXJJZCI6Ik1hbmFzd2luaSBDaGludGhhbGFwdWRpIiwKImpvYlNjaGVkdWxlSWQiOjE1NjcsCiJiYXRjaElkIjoxNzAwMDYyNTg2NjYyNzY5MSwKImxhc3RSdW5UaW1lc3RhbXAiOiIyMDIzLTExLTA3IDEyOjQyOjAwLjg2MzY1IiwKInJldHJ5TnVtIjogIjAiCn0= 0 null null azure_databricks null ewoiY2x1c3Rlcl9pZCI6IjA5MjItMDAzMTM4LW9ybjlyMHRlIiwic3BhcmtfdmVyc2lvbl92YWx1ZSI6IjNfMSIsInNjYWxhX3ZlcnNpb25fdmFsdWUiOiIyXzEyIiwiY3JlZGVudGlhbHNfZmlsZXBhdGgiOiIiLCJjbHVzdGVyX2xpYnJhcnlfcGF0aCI6Ii9kYmZzL3RtcCIsInNwYXJrX3ZlcnNpb24iOiIzLjEiLCJzY2FsYV92ZXJzaW9uIjoiMi4xMiIKfQ== s3.amazonaws.com s3.amazonaws.com 1 ewogICAgInNvbHJfYmF0Y2hfc2l6ZSI6IjEwMDAwIiwicGFyYWxsZWxfdGhyZWFkcyI6IjEwIiwiZmV0Y2hfc2l6ZSI6IjEwMDAwIgogICAgfQ== ewoiZXh0cmFDb25maWdNYXAiOiB7InNwYXJrLm5hYnUuZmV0Y2hfc2l6ZSI6ICIxMDAwMCIsICJzcGFyay5uYWJ1LmNvbXB1dGVfZW5naW5lIjogImF6dXJlX2RhdGFicmlja3MiLCAic3BhcmsubmFidS5zb2xyX2JhdGNoX3NpemUiOiAiMTAwMDAiLCAic3BhcmsubmFidS5hcHBsaWNhdGlvbl9uYW1lIjogIm5hYnUtc3Bhcmtib3QtaW5nZXN0aW9uIiwgInNwYXJrLmRyaXZlci5uYWJ1X3ByaXZhdGVLZXkiOiAiL2RiZnMvdG1wL2Rldi9uYWJ1LzE3MDAwNjI1ODY5OTMxODkxLzAvcHJpdmF0ZUtleSIsICJzcGFyay5kcml2ZXIuc291cmNlX2F3c19lbmRQb2ludCI6ICJzMy5hbWF6b25hd3MuY29tIiwgInNwYXJrLmRyaXZlci50YXJnZXRfYXdzX2VuZFBvaW50IjogInMzLmFtYXpvbmF3cy5jb20iLCAic3BhcmsubmFidS5jb21wdXRlX2VuZ2luZV9saWJzX3BhdGgiOiAiL2RiZnMvdG1wL2Rldi9uYWJ1LzE3MDAwNjI1ODY5OTMxODkxLzAvYXBwbGljYXRpb24uY29uZiJ9Cn0= ewogICJjcmVkZW50aWFsX2lkIjogIjQxIiwKICAiY3JlZGVudGlhbF90eXBlX2lkIjogIjE1IiwKICAiY3JlZGVudGlhbF90eXBlIjogIkZpbGUgQ29udGVudCIsCiAgInRva2VuIjogImM2OTUwNTgyYTEyYjU1OGFiNjQ4Y2RiNzIwMDgxNzNiMmU4NDI4ZmI1NWRhYWQ3NDAxNTIyNTY5MWVlYzc4ZWU3YjVjNGUzNDMxMmRlZDcwYWU1ZTdlZTQ4M2I3ZDdlYTBjMjNlMjRlNDU4ZWQxZjU0ZGEzY2NkN2RiY2ZlODcwYTYxZTVjOWM1MDg3ZTdmYjZkYzE2YjZmOGY1ZTRiZWRhNTY5MjRlODg0OWViNTM5YTYzYjZmMzhjMzE4MGY4Njk3ZGMxY2ZhNjExMjMzMTAxOTQ2NGI1YjYwYjk3OWI5MzZiZjUxNzFhOTk2MmMxY2E1NGY4ZWM4NDIwNjdhODQ4YjkyM2M2OWQyOTljNmI3NTI0YzA5NTQyOTMwNDAzMDlhMWY4ZmQzOWY3ODJkMWJkODY0M2YzMmE2NWZhMzU3MDU2ZWJkZjBkNTQ5ZTIwZjBmMWEwNTZlODEyNjM4MjM5NmM5ZmQ1NGMzYWFlOWQ4MjhjNmY1NWU3M2EyYzY0NTlhMDJkNTUyNGVhMjM0YzIwZDllZWY0NmQxNWZlZGJhNWJmOTVlNmJiODMwZmFjZGNhYWUxNzA2ZmNhNjE4MGJkYjAwMzVhOTNlMjRkNTc1NGY3ZDJmOGMzMzU4YmJhYmFlODlkYjMyOWJmMzYzZGYwYzE0OGM1OWFhZWVmNGNkZmZiZDg3OTA5MDMwNTRkNmI1NGFiZjJmOTM1N2VkYTBlNGZmMzFhYjA3MTdlZDRmYmJjMWY1NDY5NTg0NDRhOWMxNTMwZGIxOTgzOTQ1Y2ExZjg4OTcwZWU3Y2UwYjA3NzU4NTEwYThkMWIyYzcwNDVmN2UwYzQxMjIxMjQ0ZDg3NTE4YmZiMTE5ZjBjMGIyYTIxMmQ1NzY1N2NkNDNhZjVhYmM0NGQ5OTU3NTkxOTExYmRlYWY2Mjc5ZDQzYTE5NzIxMzg4NTJkM2RlYjgxZTAxOGNmZDJiZWM0MTIwYjFhZWYyNGQ1NmUzMWMyY2FlNmE3Yzg4YmQxMzliNDQwMzAxNTY3MmU2YjhkNTNmMjhkMjMzZmIwNmRjNWRmNjdlYjY1MTllOWU0NGVkOTBlNGJiZmI4YjU3NmM5YWZhN2RkZmFiMTdhZjIxOWJmODEzNWRlMWY4ZTZmYTNmZjQ2ZTFhYWM5NjlhZmMxZjRjNTYyNWQwYzYwNzU0ZmMxYmJjMzRhZDYzZTU4YTRmN2JlOTc1NjZmNDEzOWE5YTRiYmYwYmIxM2RhOWIxMzQ0MDE5ZWVmMDgzYmIwNTVhMmZlMTBmZmZjNzM5YTI5YWRiYmRhMzMzYjg0ZWRkZTg2YjViNzY0Mjk3ZDE5ZjBjMTc2ODk5NjdkZTAyMmExZGI5ZDE0Y2FhN2M4MDE4YjUyYzhiZTZmMzEwNzE3MzhjOWM1NzExYzkyNDIyOTEyNGRiNjIwMTExZWZlNjFjZGU5NWQ5ZmZkZDA0NDA1Nzk2NTc2NWM0YTAzMWU2ZmIyYWFhYTllZjdlMTc1MGM3NTZiZWEyYTFjYTM4ZGE1YjZkMjIzMTEzN2IwZDNkZjk0NDU4NDdhNDNlYmEzN2E2N2EwMjI5IiwKICAiY3JlZGVudGlhbF9lbmRwb2ludF91cmwiOiAiaHR0cDovL2Rldi1kaGEuaHVtYW5hLmNvbTo4ODg5L2ZpcmVzaG90cy9jcmVkZW50aWFsc0ZldGNoV2ViU2VydmljZSIsCiAgImZpbGVfcGF0aCI6ICIxNTY3XzI2MV8xNzAwMDYyNTg2NjYyNzY5MSIsCiAgImNyZWRlbnRpYWxfZmlsZV9wYXR0ZXJuIiA6ICI0MV8xNjk5MzQyNTc1Igp9 ewogICJjbHVzdGVyX2lkIjogIjA5MjItMDAzMTM4LW9ybjlyMHRlIiwKICAiY2x1c3Rlcl9yZWdpb24iOiAibnVsbCIsCiAgImNvbXB1dGVfZW5nX2NyZWRzX2pzb24iOiAiZXdvZ0lDSmpjbVZrWlc1MGFXRnNYMmxrSWpvZ0lqUXhJaXdLSUNBaVkzSmxaR1Z1ZEdsaGJGOTBlWEJsWDJsa0lqb2dJakUxSWl3S0lDQWlZM0psWkdWdWRHbGhiRjkwZVhCbElqb2dJa1pwYkdVZ1EyOXVkR1Z1ZENJc0NpQWdJblJ2YTJWdUlqb2dJbU0yT1RVd05UZ3lZVEV5WWpVMU9HRmlOalE0WTJSaU56SXdNRGd4TnpOaU1tVTROREk0Wm1JMU5XUmhZV1EzTkRBeE5USXlOVFk1TVdWbFl6YzRaV1UzWWpWak5HVXpORE14TW1SbFpEY3dZV1UxWlRkbFpUUTRNMkkzWkRkbFlUQmpNak5sTWpSbE5EVTRaV1F4WmpVMFpHRXpZMk5rTjJSaVkyWmxPRGN3WVRZeFpUVmpPV00xTURnM1pUZG1ZalprWXpFMllqWm1PR1kxWlRSaVpXUmhOVFk1TWpSbE9EZzBPV1ZpTlRNNVlUWXpZalptTXpoak16RTRNR1k0TmprM1pHTXhZMlpoTmpFeE1qTXpNVEF4T1RRMk5HSTFZall3WWprM09XSTVNelppWmpVeE56RmhPVGsyTW1NeFkyRTFOR1k0WldNNE5ESXdOamRoT0RRNFlqa3lNMk0yT1dReU9UbGpObUkzTlRJMFl6QTVOVFF5T1RNd05EQXpNRGxoTVdZNFptUXpPV1kzT0RKa01XSmtPRFkwTTJZek1tRTJOV1poTXpVM01EVTJaV0prWmpCa05UUTVaVEl3WmpCbU1XRXdOVFpsT0RFeU5qTTRNak01Tm1NNVptUTFOR016WVdGbE9XUTRNamhqTm1ZMU5XVTNNMkV5WXpZME5UbGhNREprTlRVeU5HVmhNak0wWXpJd1pEbGxaV1kwTm1ReE5XWmxaR0poTldKbU9UVmxObUppT0RNd1ptRmpaR05oWVdVeE56QTJabU5oTmpFNE1HSmtZakF3TXpWaE9UTmxNalJrTlRjMU5HWTNaREptT0dNek16VTRZbUpoWW1GbE9EbGtZak15T1dKbU16WXpaR1l3WXpFME9HTTFPV0ZoWldWbU5HTmtabVppWkRnM09UQTVNRE13TlRSa05tSTFOR0ZpWmpKbU9UTTFOMlZrWVRCbE5HWm1NekZoWWpBM01UZGxaRFJtWW1Kak1XWTFORFk1TlRnME5EUmhPV014TlRNd1pHSXhPVGd6T1RRMVkyRXhaamc0T1Rjd1pXVTNZMlV3WWpBM056VTROVEV3WVRoa01XSXlZemN3TkRWbU4yVXdZelF4TWpJeE1qUTBaRGczTlRFNFltWmlNVEU1WmpCak1HSXlZVEl4TW1RMU56WTFOMk5rTkROaFpqVmhZbU0wTkdRNU9UVTNOVGt4T1RFeFltUmxZV1kyTWpjNVpEUXpZVEU1TnpJeE16ZzROVEprTTJSbFlqZ3haVEF4T0dObVpESmlaV00wTVRJd1lqRmhaV1l5TkdRMU5tVXpNV015WTJGbE5tRTNZemc0WW1ReE16bGlORFF3TXpBeE5UWTNNbVUyWWpoa05UTm1NamhrTWpNelptSXdObVJqTldSbU5qZGxZalkxTVRsbE9XVTBOR1ZrT1RCbE5HSmlabUk0WWpVM05tTTVZV1poTjJSa1ptRmlNVGRoWmpJeE9XSm1PREV6TldSbE1XWTRaVFptWVRObVpqUTJaVEZoWVdNNU5qbGhabU14WmpSak5UWXlOV1F3WXpZd056VTBabU14WW1Kak16UmhaRFl6WlRVNFlUUm1OMkpsT1RjMU5qWm1OREV6T1dFNVlUUmlZbVl3WW1JeE0yUmhPV0l4TXpRME1ERTVaV1ZtTURnelltSXdOVFZoTW1abE1UQm1abVpqTnpNNVlUSTVZV1JpWW1SaE16TXpZamcwWldSa1pUZzJZalZpTnpZME1qazNaREU1WmpCak1UYzJPRGs1Tmpka1pUQXlNbUV4WkdJNVpERTBZMkZoTjJNNE1ERTRZalV5WXpoaVpUWm1NekV3TnpFM016aGpPV00xTnpFeFl6a3lOREl5T1RFeU5HUmlOakl3TVRFeFpXWmxOakZqWkdVNU5XUTVabVprWkRBME5EQTFOemsyTlRjMk5XTTBZVEF6TVdVMlptSXlZV0ZoWVRsbFpqZGxNVGMxTUdNM05UWmlaV0V5WVRGallUTTRaR0UxWWpaa01qSXpNVEV6TjJJd1pETmtaamswTkRVNE5EZGhORE5sWW1Fek4yRTJOMkV3TWpJNUlpd0tJQ0FpWTNKbFpHVnVkR2xoYkY5bGJtUndiMmx1ZEY5MWNtd2lPaUFpYUhSMGNEb3ZMMlJsZGkxa2FHRXVhSFZ0WVc1aExtTnZiVG80T0RnNUwyWnBjbVZ6YUc5MGN5OWpjbVZrWlc1MGFXRnNjMFpsZEdOb1YyVmlVMlZ5ZG1salpTSXNDaUFnSW1acGJHVmZjR0YwYUNJNklDSXhOVFkzWHpJMk1WOHhOekF3TURZeU5UZzJOall5TnpZNU1TSXNDaUFnSW1OeVpXUmxiblJwWVd4ZlptbHNaVjl3WVhSMFpYSnVJaUE2SUNJME1WOHhOams1TXpReU5UYzFJZ3A5IiwKICAiczNfcGF0aCI6ICIiLAogICJiNjRfaW5wdXRfanNvbiI6ICJld29pY0hKdlkyVnpjMGxrSWpveE56QXdNRFl5TlRnMk9Ua3pNVGc1TVN3S0ltUmhkR0Z3YkdGalpVbGtJam8wTWl3S0luUmhZbXhsU1dRaU9qTTNNak0wTEFvaVpHRjBZVzF2ZG1WdFpXNTBTV1FpT2pJMk1Td0tJbXB2WWxOamFHVmtkV3hsWkZWelpYSkpaQ0k2SWsxaGJtRnpkMmx1YVNCRGFHbHVkR2hoYkdGd2RXUnBJaXdLSW1wdllsTmphR1ZrZFd4bFNXUWlPakUxTmpjc0NpSmlZWFJqYUVsa0lqb3hOekF3TURZeU5UZzJOall5TnpZNU1Td0tJbXhoYzNSU2RXNVVhVzFsYzNSaGJYQWlPaUl5TURJekxURXhMVEEzSURFeU9qUXlPakF3TGpnMk16WTFJaXdLSW5KbGRISjVUblZ0SWpvZ0lqQWlDbjA9IiwKICAiZXh0cmFfY29uZmlnIjogImV3b2laWGgwY21GRGIyNW1hV2ROWVhBaU9pQjdJbk53WVhKckxtNWhZblV1Wm1WMFkyaGZjMmw2WlNJNklDSXhNREF3TUNJc0lDSnpjR0Z5YXk1dVlXSjFMbU52YlhCMWRHVmZaVzVuYVc1bElqb2dJbUY2ZFhKbFgyUmhkR0ZpY21samEzTWlMQ0FpYzNCaGNtc3VibUZpZFM1emIyeHlYMkpoZEdOb1gzTnBlbVVpT2lBaU1UQXdNREFpTENBaWMzQmhjbXN1Ym1GaWRTNWhjSEJzYVdOaGRHbHZibDl1WVcxbElqb2dJbTVoWW5VdGMzQmhjbXRpYjNRdGFXNW5aWE4wYVc5dUlpd2dJbk53WVhKckxtUnlhWFpsY2k1dVlXSjFYM0J5YVhaaGRHVkxaWGtpT2lBaUwyUmlabk12ZEcxd0wyUmxkaTl1WVdKMUx6RTNNREF3TmpJMU9EWTVPVE14T0RreEx6QXZjSEpwZG1GMFpVdGxlU0lzSUNKemNHRnlheTVrY21sMlpYSXVjMjkxY21ObFgyRjNjMTlsYm1SUWIybHVkQ0k2SUNKek15NWhiV0Y2YjI1aGQzTXVZMjl0SWl3Z0luTndZWEpyTG1SeWFYWmxjaTUwWVhKblpYUmZZWGR6WDJWdVpGQnZhVzUwSWpvZ0luTXpMbUZ0WVhwdmJtRjNjeTVqYjIwaUxDQWljM0JoY21zdWJtRmlkUzVqYjIxd2RYUmxYMlZ1WjJsdVpWOXNhV0p6WDNCaGRHZ2lPaUFpTDJSaVpuTXZkRzF3TDJSbGRpOXVZV0oxTHpFM01EQXdOakkxT0RZNU9UTXhPRGt4THpBdllYQndiR2xqWVhScGIyNHVZMjl1WmlKOUNuMD0iLAogICJiYXRjaF9pZCI6IDE3MDAwNjI1ODY2NjI3NjkxLAogICJyZXRyeV9udW0iOiAiMCIsCiAgInNwYXJrX2NvbmZpZ3MiOiAiZXdvZ0lDQWdJbk52YkhKZlltRjBZMmhmYzJsNlpTSTZJakV3TURBd0lpd2ljR0Z5WVd4c1pXeGZkR2h5WldGa2N5STZJakV3SWl3aVptVjBZMmhmYzJsNlpTSTZJakV3TURBd0lnb2dJQ0FnZlE9PSIsCiAgImlzX2J1Y2tldF9lbmNyeXB0ZWQiOiAiIiwKICAiYjY0X2V4dGVybmFsX2phcnNfbWFwIiA6ICIiCn0= null /dbfs/tmp ewoiY2x1c3Rlcl9pZCI6ICIiLAoiYjY0X2lucHV0X2pzb24iOiAiZXdvaWNISnZZMlZ6YzBsa0lqb3hOekF3TURZeU5UZzJPVGt6TVRnNU1Td0tJbVJoZEdGd2JHRmpaVWxrSWpvME1pd0tJblJoWW14bFNXUWlPak0zTWpNMExBb2laR0YwWVcxdmRtVnRaVzUwU1dRaU9qSTJNU3dLSW1wdllsTmphR1ZrZFd4bFpGVnpaWEpKWkNJNklrMWhibUZ6ZDJsdWFTQkRhR2x1ZEdoaGJHRndkV1JwSWl3S0ltcHZZbE5qYUdWa2RXeGxTV1FpT2pFMU5qY3NDaUppWVhSamFFbGtJam94TnpBd01EWXlOVGcyTmpZeU56WTVNU3dLSW14aGMzUlNkVzVVYVcxbGMzUmhiWEFpT2lJeU1ESXpMVEV4TFRBM0lERXlPalF5T2pBd0xqZzJNelkxSWl3S0luSmxkSEo1VG5WdElqb2dJakFpQ24wPSIsCiJleHRyYV9jb25maWciOiAiZXdvaVpYaDBjbUZEYjI1bWFXZE5ZWEFpT2lCN0luTndZWEpyTG01aFluVXVabVYwWTJoZmMybDZaU0k2SUNJeE1EQXdNQ0lzSUNKemNHRnlheTV1WVdKMUxtTnZiWEIxZEdWZlpXNW5hVzVsSWpvZ0ltRjZkWEpsWDJSaGRHRmljbWxqYTNNaUxDQWljM0JoY21zdWJtRmlkUzV6YjJ4eVgySmhkR05vWDNOcGVtVWlPaUFpTVRBd01EQWlMQ0FpYzNCaGNtc3VibUZpZFM1aGNIQnNhV05oZEdsdmJsOXVZVzFsSWpvZ0ltNWhZblV0YzNCaGNtdGliM1F0YVc1blpYTjBhVzl1SWl3Z0luTndZWEpyTG1SeWFYWmxjaTV1WVdKMVgzQnlhWFpoZEdWTFpYa2lPaUFpTDJSaVpuTXZkRzF3TDJSbGRpOXVZV0oxTHpFM01EQXdOakkxT0RZNU9UTXhPRGt4THpBdmNISnBkbUYwWlV0bGVTSXNJQ0p6Y0dGeWF5NWtjbWwyWlhJdWMyOTFjbU5sWDJGM2MxOWxibVJRYjJsdWRDSTZJQ0p6TXk1aGJXRjZiMjVoZDNNdVkyOXRJaXdnSW5Od1lYSnJMbVJ5YVhabGNpNTBZWEpuWlhSZllYZHpYMlZ1WkZCdmFXNTBJam9nSW5NekxtRnRZWHB2Ym1GM2N5NWpiMjBpTENBaWMzQmhjbXN1Ym1GaWRTNWpiMjF3ZFhSbFgyVnVaMmx1WlY5c2FXSnpYM0JoZEdnaU9pQWlMMlJpWm5NdmRHMXdMMlJsZGk5dVlXSjFMekUzTURBd05qSTFPRFk1T1RNeE9Ea3hMekF2WVhCd2JHbGpZWFJwYjI0dVkyOXVaaUo5Q24wPSIsCiJjb21wdXRlX2VuZ19jcmVkc19qc29uIiA6ICJld29nSUNKamNtVmtaVzUwYVdGc1gybGtJam9nSWpReElpd0tJQ0FpWTNKbFpHVnVkR2xoYkY5MGVYQmxYMmxrSWpvZ0lqRTFJaXdLSUNBaVkzSmxaR1Z1ZEdsaGJGOTBlWEJsSWpvZ0lrWnBiR1VnUTI5dWRHVnVkQ0lzQ2lBZ0luUnZhMlZ1SWpvZ0ltTTJPVFV3TlRneVlURXlZalUxT0dGaU5qUTRZMlJpTnpJd01EZ3hOek5pTW1VNE5ESTRabUkxTldSaFlXUTNOREF4TlRJeU5UWTVNV1ZsWXpjNFpXVTNZalZqTkdVek5ETXhNbVJsWkRjd1lXVTFaVGRsWlRRNE0ySTNaRGRsWVRCak1qTmxNalJsTkRVNFpXUXhaalUwWkdFelkyTmtOMlJpWTJabE9EY3dZVFl4WlRWak9XTTFNRGczWlRkbVlqWmtZekUyWWpabU9HWTFaVFJpWldSaE5UWTVNalJsT0RnME9XVmlOVE01WVRZellqWm1NemhqTXpFNE1HWTROamszWkdNeFkyWmhOakV4TWpNek1UQXhPVFEyTkdJMVlqWXdZamszT1dJNU16WmlaalV4TnpGaE9UazJNbU14WTJFMU5HWTRaV000TkRJd05qZGhPRFE0WWpreU0yTTJPV1F5T1Rsak5tSTNOVEkwWXpBNU5UUXlPVE13TkRBek1EbGhNV1k0Wm1Rek9XWTNPREprTVdKa09EWTBNMll6TW1FMk5XWmhNelUzTURVMlpXSmtaakJrTlRRNVpUSXdaakJtTVdFd05UWmxPREV5TmpNNE1qTTVObU01Wm1RMU5HTXpZV0ZsT1dRNE1qaGpObVkxTldVM00yRXlZelkwTlRsaE1ESmtOVFV5TkdWaE1qTTBZekl3WkRsbFpXWTBObVF4TldabFpHSmhOV0ptT1RWbE5tSmlPRE13Wm1GalpHTmhZV1V4TnpBMlptTmhOakU0TUdKa1lqQXdNelZoT1RObE1qUmtOVGMxTkdZM1pESm1PR016TXpVNFltSmhZbUZsT0Rsa1lqTXlPV0ptTXpZelpHWXdZekUwT0dNMU9XRmhaV1ZtTkdOa1ptWmlaRGczT1RBNU1ETXdOVFJrTm1JMU5HRmlaakptT1RNMU4yVmtZVEJsTkdabU16RmhZakEzTVRkbFpEUm1ZbUpqTVdZMU5EWTVOVGcwTkRSaE9XTXhOVE13WkdJeE9UZ3pPVFExWTJFeFpqZzRPVGN3WldVM1kyVXdZakEzTnpVNE5URXdZVGhrTVdJeVl6Y3dORFZtTjJVd1l6UXhNakl4TWpRMFpEZzNOVEU0WW1aaU1URTVaakJqTUdJeVlUSXhNbVExTnpZMU4yTmtORE5oWmpWaFltTTBOR1E1T1RVM05Ua3hPVEV4WW1SbFlXWTJNamM1WkRRellURTVOekl4TXpnNE5USmtNMlJsWWpneFpUQXhPR05tWkRKaVpXTTBNVEl3WWpGaFpXWXlOR1ExTm1Vek1XTXlZMkZsTm1FM1l6ZzRZbVF4TXpsaU5EUXdNekF4TlRZM01tVTJZamhrTlRObU1qaGtNak16Wm1Jd05tUmpOV1JtTmpkbFlqWTFNVGxsT1dVME5HVmtPVEJsTkdKaVptSTRZalUzTm1NNVlXWmhOMlJrWm1GaU1UZGhaakl4T1dKbU9ERXpOV1JsTVdZNFpUWm1ZVE5tWmpRMlpURmhZV001TmpsaFptTXhaalJqTlRZeU5XUXdZell3TnpVMFptTXhZbUpqTXpSaFpEWXpaVFU0WVRSbU4ySmxPVGMxTmpabU5ERXpPV0U1WVRSaVltWXdZbUl4TTJSaE9XSXhNelEwTURFNVpXVm1NRGd6WW1Jd05UVmhNbVpsTVRCbVptWmpOek01WVRJNVlXUmlZbVJoTXpNellqZzBaV1JrWlRnMllqVmlOelkwTWprM1pERTVaakJqTVRjMk9EazVOamRrWlRBeU1tRXhaR0k1WkRFMFkyRmhOMk00TURFNFlqVXlZemhpWlRabU16RXdOekUzTXpoak9XTTFOekV4WXpreU5ESXlPVEV5TkdSaU5qSXdNVEV4WldabE5qRmpaR1U1TldRNVptWmtaREEwTkRBMU56azJOVGMyTldNMFlUQXpNV1UyWm1JeVlXRmhZVGxsWmpkbE1UYzFNR00zTlRaaVpXRXlZVEZqWVRNNFpHRTFZalprTWpJek1URXpOMkl3WkROa1pqazBORFU0TkRkaE5ETmxZbUV6TjJFMk4yRXdNakk1SWl3S0lDQWlZM0psWkdWdWRHbGhiRjlsYm1Sd2IybHVkRjkxY213aU9pQWlhSFIwY0RvdkwyUmxkaTFrYUdFdWFIVnRZVzVoTG1OdmJUbzRPRGc1TDJacGNtVnphRzkwY3k5amNtVmtaVzUwYVdGc2MwWmxkR05vVjJWaVUyVnlkbWxqWlNJc0NpQWdJbVpwYkdWZmNHRjBhQ0k2SUNJeE5UWTNYekkyTVY4eE56QXdNRFl5TlRnMk5qWXlOelk1TVNJc0NpQWdJbU55WldSbGJuUnBZV3hmWm1sc1pWOXdZWFIwWlhKdUlpQTZJQ0kwTVY4eE5qazVNelF5TlRjMUlncDkiLAoiY2x1c3Rlcl91aSI6ICIiLAoicmV0cnlfbnVtIjogIjAiLAoic3BhcmtfY29uZmlncyI6ICJld29nSUNBZ0luTnZiSEpmWW1GMFkyaGZjMmw2WlNJNklqRXdNREF3SWl3aWNHRnlZV3hzWld4ZmRHaHlaV0ZrY3lJNklqRXdJaXdpWm1WMFkyaGZjMmw2WlNJNklqRXdNREF3SWdvZ0lDQWdmUT09IiwKImI2NF9oaXZlX2NyZWRzX2pzb24iOiAiZXdvZ0lDSmpjbVZrWlc1MGFXRnNYMmxrSWpvZ0lpSXNDaUFnSW1OeVpXUmxiblJwWVd4ZmRIbHdaVjlwWkNJNklDSWlMQW9nSUNKMGIydGxiaUk2SUNKak5qazFNRFU0TW1FeE1tSTFOVGhoWWpZME9HTmtZamN5TURBNE1UY3pZakpsT0RReU9HWmlOVFZrWVdGa056UXdNVFV5TWpVMk9URmxaV00zT0dWbE4ySTFZelJsTXpRek1USmtaV1EzTUdGbE5XVTNaV1UwT0ROaU4yUTNaV0V3WXpJelpUSTBaVFExT0dWa01XWTFOR1JoTTJOalpEZGtZbU5tWlRnM01HRTJNV1UxWXpsak5UQTROMlUzWm1JMlpHTXhObUkyWmpobU5XVTBZbVZrWVRVMk9USTBaVGc0TkRsbFlqVXpPV0UyTTJJMlpqTTRZek14T0RCbU9EWTVOMlJqTVdObVlUWXhNVEl6TXpFd01UazBOalJpTldJMk1HSTVOemxpT1RNMlltWTFNVGN4WVRrNU5qSmpNV05oTlRSbU9HVmpPRFF5TURZM1lUZzBPR0k1TWpOak5qbGtNams1WXpaaU56VXlOR013T1RVME1qa3pNRFF3TXpBNVlURm1PR1prTXpsbU56Z3laREZpWkRnMk5ETm1NekpoTmpWbVlUTTFOekExTm1WaVpHWXdaRFUwT1dVeU1HWXdaakZoTURVMlpUZ3hNall6T0RJek9UWmpPV1prTlRSak0yRmhaVGxrT0RJNFl6Wm1OVFZsTnpOaE1tTTJORFU1WVRBeVpEVTFNalJsWVRJek5HTXlNR1E1WldWbU5EWmtNVFZtWldSaVlUVmlaamsxWlRaaVlqZ3pNR1poWTJSallXRmxNVGN3Tm1aallUWXhPREJpWkdJd01ETTFZVGt6WlRJMFpEVTNOVFJtTjJReVpqaGpNek0xT0dKaVlXSmhaVGc1WkdJek1qbGlaak0yTTJSbU1HTXhORGhqTlRsaFlXVmxaalJqWkdabVltUTROemt3T1RBek1EVTBaRFppTlRSaFltWXlaamt6TlRkbFpHRXdaVFJtWmpNeFlXSXdOekUzWldRMFptSmlZekZtTlRRMk9UVTRORFEwWVRsak1UVXpNR1JpTVRrNE16azBOV05oTVdZNE9EazNNR1ZsTjJObE1HSXdOemMxT0RVeE1HRTRaREZpTW1NM01EUTFaamRsTUdNME1USXlNVEkwTkdRNE56VXhPR0ptWWpFeE9XWXdZekJpTW1FeU1USmtOVGMyTlRkalpEUXpZV1kxWVdKak5EUmtPVGsxTnpVNU1Ua3hNV0prWldGbU5qSTNPV1EwTTJFeE9UY3lNVE00T0RVeVpETmtaV0k0TVdVd01UaGpabVF5WW1Wak5ERXlNR0l4WVdWbU1qUmtOVFpsTXpGak1tTmhaVFpoTjJNNE9HSmtNVE01WWpRME1ETXdNVFUyTnpKbE5tSTRaRFV6WmpJNFpESXpNMlppTURaa1l6VmtaalkzWldJMk5URTVaVGxsTkRSbFpEa3daVFJpWW1aaU9HSTFOelpqT1dGbVlUZGtaR1poWWpFM1lXWXlNVGxpWmpneE16VmtaVEZtT0dVMlptRXpabVkwTm1VeFlXRmpPVFk1WVdaak1XWTBZelUyTWpWa01HTTJNRGMxTkdaak1XSmlZek0wWVdRMk0yVTFPR0UwWmpkaVpUazNOVFkyWmpReE16bGhPV0UwWW1KbU1HSmlNVE5rWVRsaU1UTTBOREF4T1dWbFpqQTRNMkppTURVMVlUSm1aVEV3Wm1abVl6Y3pPV0V5T1dGa1ltSmtZVE16TTJJNE5HVmtaR1U0Tm1JMVlqYzJOREk1TjJReE9XWXdZekUzTmpnNU9UWTNaR1V3TWpKaE1XUmlPV1F4TkdOaFlUZGpPREF4T0dJMU1tTTRZbVUyWmpNeE1EY3hOek00WXpsak5UY3hNV001TWpReU1qa3hNalJrWWpZeU1ERXhNV1ZtWlRZeFkyUmxPVFZrT1dabVpHUXdORFF3TlRjNU5qVTNOalZqTkdFd016RmxObVppTW1GaFlXRTVaV1kzWlRFM05UQmpOelUyWW1WaE1tRXhZMkV6T0dSaE5XSTJaREl5TXpFeE16ZGlNR1F6WkdZNU5EUTFPRFEzWVRRelpXSmhNemRoTmpkaE1ESXlPU0lzQ2lBZ0ltTnlaV1JsYm5ScFlXeGZaVzVrY0c5cGJuUmZkWEpzSWpvZ0ltaDBkSEE2THk5a1pYWXRaR2hoTG1oMWJXRnVZUzVqYjIwNk9EZzRPUzltYVhKbGMyaHZkSE12WTNKbFpHVnVkR2xoYkhOR1pYUmphRmRsWWxObGNuWnBZMlVpQ24wPSIsCiJiYXRjaF9pZCI6MTcwMDA2MjU4NjY2Mjc2OTEsCiJwcm9jZXNzX2lkIiA6MTcwMDA2MjU4Njk5MzE4OTEsCiJyZXN0X3VybCI6ICIiLAoiYjY0X2V4dGVybmFsX2phcnNfbWFwIiA6ICIiCn0= null ewoicGlwZWxpbmVfdGltZW91dCIgOiAyMwp9"]
""2023-11-15 15:37:07.149 [Thread-2064] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 15:37:07.150 [Thread-2064] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:37:07.156 [Thread-2064] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:37:07.156 [Thread-2064] INFO  com.modak.bots.basebot.AbstractBaseBot - SparkScriptBot with bot_id 2e8814f0-bfd3-416c-a2b9-266ce96ef204 has started process logic with message_id d5f7c84d-e235-4701-910a-64489cde6bd3 and thread_id 2517
""2023-11-15 15:37:07.488 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - command to be executed  [sh, -l, -c, $NABU_ROOT_INSTALLATION/botworks/scripts/ingestion/run_almaren_job.sh rO0ABXVyAAJbQqzzF/gGCFTgAgAAeHAAAAEAFBBvYZ7Mim3fI+Np05VO+EHuf5PxldceVzCwdbLhn99OYytVbAynQS5Ral29GY9WQevohqFq0pptfWmC6Hdze1ChYqC3VXBhBj3fvqRQZTXN3/gYsSGTxp+834hmfUfQbU0RQ7RnV0wV7zyS1QELwx0d2MbPVdCF1bxRqXdtOn1A4aNwc7Ia7/cZJEKIjKPAUohAvgCyjsGHSbHQx98WKhSwSU60Sa2dauo11GJkO6jT0fdAUjMDuRgiri0JjVTof4u/gV/qzwHpGu/AH/Q/dG8vOv1Stjm43HFpaHjBb2lqw0+JUBuIAqO1SbZmHe1FSy4p09C5Z0pkxSxmLBMQXXVxAH4AAAAAA5D7uBN32zcbCqrcmzijqQfhpAWVqmvEcLxsLpAXN0MnSpwYDURX1Bzr/vmU9PmJjV114yRnCLXxwgtmVebwcXQpDixTHpTKVjL/CtOTvSkauTybzdVq1nm6iSti+tUV5IX7blC5I+JVJZcJyd6c83OK54FmVswIUe6LEaVCSaMlYzQNpKT7IKYurmTruiz7hrCJ9ZdIk+fUYt2inQ9BMkqscwFr97n+VE9s/5MPmsbtG7JCzBniT5ePLh9BIr6dWLfZjG+MKsijpwhUINj3sG/IbsCtqQuNLGxFV6nZObarxX/8NiFDOwXitmggN2ZBe0ggcLzMHBDILWwaxnGsByVdmKFxN5DozkOUQM1FX0euvznFtk/Vd7mu6sTeISNvvpempQuPOLzUew2SfynpCR8gqBp0N4E7JYBYpfeuk4wDcX7y6q7xb+p/Ir2i90Y+AJxMfcXIH7bDQ8H24cSg2pvx1mIZU9btojRD00BaME1dgJOOI42T1jALDSOWIUSxS84qQ1blakpHAKfp4OFgT6XNQNN1mteDjRcLlLxkTP2azXBeWL3/1Ix9/2WLHgbeP4rQG27yM6n+YYQU2OTqKr8nJ7HPbwfY3tiagpKX7VpRnoTq/he0Db7UxxzVEN12/Pj8fJUjLXTAfoworuhlYo0AaSYMMt2lIr9gB2FRiH1+RELLTrt/0tGUjMaOLWL6WU8IZj749J9MUYQ6dTnmQHwUKWsaImYLZIPp5HDwC/8etfQBMqqYUfn8Mm/McmjKX7AHB48J4X9BBW4n42bLVwBwBxoIzRoQOVAK95be5uR7X9PQ7mqGpjK6KTWPgSj34dg94SCzm40mhvwW0d+KatJ3Bl/mXsYXzDK6k7vqIQuuYlm8IVvlScQZSrXMJkQK3kVYlZMnpEM47cgs5s/AtFNRgD3tIRl28PZBvAoU2RdxpEGJCp97LugjtPmQVwPqHtxZQ2eBAWvcT7prIgNQJgKLvMWSb0S42rDhrEaV3vRYjxxZh2a8odrvFve7mNJjYRvscpOOljnliNBnVW703kNQVjIlNiOu6WezpphGFNzd434k1Fom9cQub82hQgHeGssWwjEmL4lCCtT4rRHxouyik36/v4js9JSVh4RlgXvGR2daW7KTzqW/GquJUbJjVarT2iljzwahdM08Mbj9T1uxcDycIuEskdEp6pmFVTMgzRYNjAZbWMGnhdKRWYozgis= ewoicHJvY2Vzc0lkIjoxNzAwMDYyNTg2OTkzMTg5MSwKImRhdGFwbGFjZUlkIjo0MiwKInRhYmxlSWQiOjM3MjM0LAoiZGF0YW1vdmVtZW50SWQiOjI2MSwKImpvYlNjaGVkdWxlZFVzZXJJZCI6Ik1hbmFzd2luaSBDaGludGhhbGFwdWRpIiwKImpvYlNjaGVkdWxlSWQiOjE1NjcsCiJiYXRjaElkIjoxNzAwMDYyNTg2NjYyNzY5MSwKImxhc3RSdW5UaW1lc3RhbXAiOiIyMDIzLTExLTA3IDEyOjQyOjAwLjg2MzY1IiwKInJldHJ5TnVtIjogIjAiCn0= 0 null null azure_databricks null ewoiY2x1c3Rlcl9pZCI6IjA5MjItMDAzMTM4LW9ybjlyMHRlIiwic3BhcmtfdmVyc2lvbl92YWx1ZSI6IjNfMSIsInNjYWxhX3ZlcnNpb25fdmFsdWUiOiIyXzEyIiwiY3JlZGVudGlhbHNfZmlsZXBhdGgiOiIiLCJjbHVzdGVyX2xpYnJhcnlfcGF0aCI6Ii9kYmZzL3RtcCIsInNwYXJrX3ZlcnNpb24iOiIzLjEiLCJzY2FsYV92ZXJzaW9uIjoiMi4xMiIKfQ== s3.amazonaws.com s3.amazonaws.com 1 ewogICAgInNvbHJfYmF0Y2hfc2l6ZSI6IjEwMDAwIiwicGFyYWxsZWxfdGhyZWFkcyI6IjEwIiwiZmV0Y2hfc2l6ZSI6IjEwMDAwIgogICAgfQ== ewoiZXh0cmFDb25maWdNYXAiOiB7InNwYXJrLm5hYnUuZmV0Y2hfc2l6ZSI6ICIxMDAwMCIsICJzcGFyay5uYWJ1LmNvbXB1dGVfZW5naW5lIjogImF6dXJlX2RhdGFicmlja3MiLCAic3BhcmsubmFidS5zb2xyX2JhdGNoX3NpemUiOiAiMTAwMDAiLCAic3BhcmsubmFidS5hcHBsaWNhdGlvbl9uYW1lIjogIm5hYnUtc3Bhcmtib3QtaW5nZXN0aW9uIiwgInNwYXJrLmRyaXZlci5uYWJ1X3ByaXZhdGVLZXkiOiAiL2RiZnMvdG1wL2Rldi9uYWJ1LzE3MDAwNjI1ODY5OTMxODkxLzAvcHJpdmF0ZUtleSIsICJzcGFyay5kcml2ZXIuc291cmNlX2F3c19lbmRQb2ludCI6ICJzMy5hbWF6b25hd3MuY29tIiwgInNwYXJrLmRyaXZlci50YXJnZXRfYXdzX2VuZFBvaW50IjogInMzLmFtYXpvbmF3cy5jb20iLCAic3BhcmsubmFidS5jb21wdXRlX2VuZ2luZV9saWJzX3BhdGgiOiAiL2RiZnMvdG1wL2Rldi9uYWJ1LzE3MDAwNjI1ODY5OTMxODkxLzAvYXBwbGljYXRpb24uY29uZiJ9Cn0= ewogICJjcmVkZW50aWFsX2lkIjogIjQxIiwKICAiY3JlZGVudGlhbF90eXBlX2lkIjogIjE1IiwKICAiY3JlZGVudGlhbF90eXBlIjogIkZpbGUgQ29udGVudCIsCiAgInRva2VuIjogImM2OTUwNTgyYTEyYjU1OGFiNjQ4Y2RiNzIwMDgxNzNiMmU4NDI4ZmI1NWRhYWQ3NDAxNTIyNTY5MWVlYzc4ZWU3YjVjNGUzNDMxMmRlZDcwYWU1ZTdlZTQ4M2I3ZDdlYTBjMjNlMjRlNDU4ZWQxZjU0ZGEzY2NkN2RiY2ZlODcwYTYxZTVjOWM1MDg3ZTdmYjZkYzE2YjZmOGY1ZTRiZWRhNTY5MjRlODg0OWViNTM5YTYzYjZmMzhjMzE4MGY4Njk3ZGMxY2ZhNjExMjMzMTAxOTQ2NGI1YjYwYjk3OWI5MzZiZjUxNzFhOTk2MmMxY2E1NGY4ZWM4NDIwNjdhODQ4YjkyM2M2OWQyOTljNmI3NTI0YzA5NTQyOTMwNDAzMDlhMWY4ZmQzOWY3ODJkMWJkODY0M2YzMmE2NWZhMzU3MDU2ZWJkZjBkNTQ5ZTIwZjBmMWEwNTZlODEyNjM4MjM5NmM5ZmQ1NGMzYWFlOWQ4MjhjNmY1NWU3M2EyYzY0NTlhMDJkNTUyNGVhMjM0YzIwZDllZWY0NmQxNWZlZGJhNWJmOTVlNmJiODMwZmFjZGNhYWUxNzA2ZmNhNjE4MGJkYjAwMzVhOTNlMjRkNTc1NGY3ZDJmOGMzMzU4YmJhYmFlODlkYjMyOWJmMzYzZGYwYzE0OGM1OWFhZWVmNGNkZmZiZDg3OTA5MDMwNTRkNmI1NGFiZjJmOTM1N2VkYTBlNGZmMzFhYjA3MTdlZDRmYmJjMWY1NDY5NTg0NDRhOWMxNTMwZGIxOTgzOTQ1Y2ExZjg4OTcwZWU3Y2UwYjA3NzU4NTEwYThkMWIyYzcwNDVmN2UwYzQxMjIxMjQ0ZDg3NTE4YmZiMTE5ZjBjMGIyYTIxMmQ1NzY1N2NkNDNhZjVhYmM0NGQ5OTU3NTkxOTExYmRlYWY2Mjc5ZDQzYTE5NzIxMzg4NTJkM2RlYjgxZTAxOGNmZDJiZWM0MTIwYjFhZWYyNGQ1NmUzMWMyY2FlNmE3Yzg4YmQxMzliNDQwMzAxNTY3MmU2YjhkNTNmMjhkMjMzZmIwNmRjNWRmNjdlYjY1MTllOWU0NGVkOTBlNGJiZmI4YjU3NmM5YWZhN2RkZmFiMTdhZjIxOWJmODEzNWRlMWY4ZTZmYTNmZjQ2ZTFhYWM5NjlhZmMxZjRjNTYyNWQwYzYwNzU0ZmMxYmJjMzRhZDYzZTU4YTRmN2JlOTc1NjZmNDEzOWE5YTRiYmYwYmIxM2RhOWIxMzQ0MDE5ZWVmMDgzYmIwNTVhMmZlMTBmZmZjNzM5YTI5YWRiYmRhMzMzYjg0ZWRkZTg2YjViNzY0Mjk3ZDE5ZjBjMTc2ODk5NjdkZTAyMmExZGI5ZDE0Y2FhN2M4MDE4YjUyYzhiZTZmMzEwNzE3MzhjOWM1NzExYzkyNDIyOTEyNGRiNjIwMTExZWZlNjFjZGU5NWQ5ZmZkZDA0NDA1Nzk2NTc2NWM0YTAzMWU2ZmIyYWFhYTllZjdlMTc1MGM3NTZiZWEyYTFjYTM4ZGE1YjZkMjIzMTEzN2IwZDNkZjk0NDU4NDdhNDNlYmEzN2E2N2EwMjI5IiwKICAiY3JlZGVudGlhbF9lbmRwb2ludF91cmwiOiAiaHR0cDovL2Rldi1kaGEuaHVtYW5hLmNvbTo4ODg5L2ZpcmVzaG90cy9jcmVkZW50aWFsc0ZldGNoV2ViU2VydmljZSIsCiAgImZpbGVfcGF0aCI6ICIxNTY3XzI2MV8xNzAwMDYyNTg2NjYyNzY5MSIsCiAgImNyZWRlbnRpYWxfZmlsZV9wYXR0ZXJuIiA6ICI0MV8xNjk5MzQyNTc1Igp9 ewogICJjbHVzdGVyX2lkIjogIjA5MjItMDAzMTM4LW9ybjlyMHRlIiwKICAiY2x1c3Rlcl9yZWdpb24iOiAibnVsbCIsCiAgImNvbXB1dGVfZW5nX2NyZWRzX2pzb24iOiAiZXdvZ0lDSmpjbVZrWlc1MGFXRnNYMmxrSWpvZ0lqUXhJaXdLSUNBaVkzSmxaR1Z1ZEdsaGJGOTBlWEJsWDJsa0lqb2dJakUxSWl3S0lDQWlZM0psWkdWdWRHbGhiRjkwZVhCbElqb2dJa1pwYkdVZ1EyOXVkR1Z1ZENJc0NpQWdJblJ2YTJWdUlqb2dJbU0yT1RVd05UZ3lZVEV5WWpVMU9HRmlOalE0WTJSaU56SXdNRGd4TnpOaU1tVTROREk0Wm1JMU5XUmhZV1EzTkRBeE5USXlOVFk1TVdWbFl6YzRaV1UzWWpWak5HVXpORE14TW1SbFpEY3dZV1UxWlRkbFpUUTRNMkkzWkRkbFlUQmpNak5sTWpSbE5EVTRaV1F4WmpVMFpHRXpZMk5rTjJSaVkyWmxPRGN3WVRZeFpUVmpPV00xTURnM1pUZG1ZalprWXpFMllqWm1PR1kxWlRSaVpXUmhOVFk1TWpSbE9EZzBPV1ZpTlRNNVlUWXpZalptTXpoak16RTRNR1k0TmprM1pHTXhZMlpoTmpFeE1qTXpNVEF4T1RRMk5HSTFZall3WWprM09XSTVNelppWmpVeE56RmhPVGsyTW1NeFkyRTFOR1k0WldNNE5ESXdOamRoT0RRNFlqa3lNMk0yT1dReU9UbGpObUkzTlRJMFl6QTVOVFF5T1RNd05EQXpNRGxoTVdZNFptUXpPV1kzT0RKa01XSmtPRFkwTTJZek1tRTJOV1poTXpVM01EVTJaV0prWmpCa05UUTVaVEl3WmpCbU1XRXdOVFpsT0RFeU5qTTRNak01Tm1NNVptUTFOR016WVdGbE9XUTRNamhqTm1ZMU5XVTNNMkV5WXpZME5UbGhNREprTlRVeU5HVmhNak0wWXpJd1pEbGxaV1kwTm1ReE5XWmxaR0poTldKbU9UVmxObUppT0RNd1ptRmpaR05oWVdVeE56QTJabU5oTmpFNE1HSmtZakF3TXpWaE9UTmxNalJrTlRjMU5HWTNaREptT0dNek16VTRZbUpoWW1GbE9EbGtZak15T1dKbU16WXpaR1l3WXpFME9HTTFPV0ZoWldWbU5HTmtabVppWkRnM09UQTVNRE13TlRSa05tSTFOR0ZpWmpKbU9UTTFOMlZrWVRCbE5HWm1NekZoWWpBM01UZGxaRFJtWW1Kak1XWTFORFk1TlRnME5EUmhPV014TlRNd1pHSXhPVGd6T1RRMVkyRXhaamc0T1Rjd1pXVTNZMlV3WWpBM056VTROVEV3WVRoa01XSXlZemN3TkRWbU4yVXdZelF4TWpJeE1qUTBaRGczTlRFNFltWmlNVEU1WmpCak1HSXlZVEl4TW1RMU56WTFOMk5rTkROaFpqVmhZbU0wTkdRNU9UVTNOVGt4T1RFeFltUmxZV1kyTWpjNVpEUXpZVEU1TnpJeE16ZzROVEprTTJSbFlqZ3haVEF4T0dObVpESmlaV00wTVRJd1lqRmhaV1l5TkdRMU5tVXpNV015WTJGbE5tRTNZemc0WW1ReE16bGlORFF3TXpBeE5UWTNNbVUyWWpoa05UTm1NamhrTWpNelptSXdObVJqTldSbU5qZGxZalkxTVRsbE9XVTBOR1ZrT1RCbE5HSmlabUk0WWpVM05tTTVZV1poTjJSa1ptRmlNVGRoWmpJeE9XSm1PREV6TldSbE1XWTRaVFptWVRObVpqUTJaVEZoWVdNNU5qbGhabU14WmpSak5UWXlOV1F3WXpZd056VTBabU14WW1Kak16UmhaRFl6WlRVNFlUUm1OMkpsT1RjMU5qWm1OREV6T1dFNVlUUmlZbVl3WW1JeE0yUmhPV0l4TXpRME1ERTVaV1ZtTURnelltSXdOVFZoTW1abE1UQm1abVpqTnpNNVlUSTVZV1JpWW1SaE16TXpZamcwWldSa1pUZzJZalZpTnpZME1qazNaREU1WmpCak1UYzJPRGs1Tmpka1pUQXlNbUV4WkdJNVpERTBZMkZoTjJNNE1ERTRZalV5WXpoaVpUWm1NekV3TnpFM016aGpPV00xTnpFeFl6a3lOREl5T1RFeU5HUmlOakl3TVRFeFpXWmxOakZqWkdVNU5XUTVabVprWkRBME5EQTFOemsyTlRjMk5XTTBZVEF6TVdVMlptSXlZV0ZoWVRsbFpqZGxNVGMxTUdNM05UWmlaV0V5WVRGallUTTRaR0UxWWpaa01qSXpNVEV6TjJJd1pETmtaamswTkRVNE5EZGhORE5sWW1Fek4yRTJOMkV3TWpJNUlpd0tJQ0FpWTNKbFpHVnVkR2xoYkY5bGJtUndiMmx1ZEY5MWNtd2lPaUFpYUhSMGNEb3ZMMlJsZGkxa2FHRXVhSFZ0WVc1aExtTnZiVG80T0RnNUwyWnBjbVZ6YUc5MGN5OWpjbVZrWlc1MGFXRnNjMFpsZEdOb1YyVmlVMlZ5ZG1salpTSXNDaUFnSW1acGJHVmZjR0YwYUNJNklDSXhOVFkzWHpJMk1WOHhOekF3TURZeU5UZzJOall5TnpZNU1TSXNDaUFnSW1OeVpXUmxiblJwWVd4ZlptbHNaVjl3WVhSMFpYSnVJaUE2SUNJME1WOHhOams1TXpReU5UYzFJZ3A5IiwKICAiczNfcGF0aCI6ICIiLAogICJiNjRfaW5wdXRfanNvbiI6ICJld29pY0hKdlkyVnpjMGxrSWpveE56QXdNRFl5TlRnMk9Ua3pNVGc1TVN3S0ltUmhkR0Z3YkdGalpVbGtJam8wTWl3S0luUmhZbXhsU1dRaU9qTTNNak0wTEFvaVpHRjBZVzF2ZG1WdFpXNTBTV1FpT2pJMk1Td0tJbXB2WWxOamFHVmtkV3hsWkZWelpYSkpaQ0k2SWsxaGJtRnpkMmx1YVNCRGFHbHVkR2hoYkdGd2RXUnBJaXdLSW1wdllsTmphR1ZrZFd4bFNXUWlPakUxTmpjc0NpSmlZWFJqYUVsa0lqb3hOekF3TURZeU5UZzJOall5TnpZNU1Td0tJbXhoYzNSU2RXNVVhVzFsYzNSaGJYQWlPaUl5TURJekxURXhMVEEzSURFeU9qUXlPakF3TGpnMk16WTFJaXdLSW5KbGRISjVUblZ0SWpvZ0lqQWlDbjA9IiwKICAiZXh0cmFfY29uZmlnIjogImV3b2laWGgwY21GRGIyNW1hV2ROWVhBaU9pQjdJbk53WVhKckxtNWhZblV1Wm1WMFkyaGZjMmw2WlNJNklDSXhNREF3TUNJc0lDSnpjR0Z5YXk1dVlXSjFMbU52YlhCMWRHVmZaVzVuYVc1bElqb2dJbUY2ZFhKbFgyUmhkR0ZpY21samEzTWlMQ0FpYzNCaGNtc3VibUZpZFM1emIyeHlYMkpoZEdOb1gzTnBlbVVpT2lBaU1UQXdNREFpTENBaWMzQmhjbXN1Ym1GaWRTNWhjSEJzYVdOaGRHbHZibDl1WVcxbElqb2dJbTVoWW5VdGMzQmhjbXRpYjNRdGFXNW5aWE4wYVc5dUlpd2dJbk53WVhKckxtUnlhWFpsY2k1dVlXSjFYM0J5YVhaaGRHVkxaWGtpT2lBaUwyUmlabk12ZEcxd0wyUmxkaTl1WVdKMUx6RTNNREF3TmpJMU9EWTVPVE14T0RreEx6QXZjSEpwZG1GMFpVdGxlU0lzSUNKemNHRnlheTVrY21sMlpYSXVjMjkxY21ObFgyRjNjMTlsYm1SUWIybHVkQ0k2SUNKek15NWhiV0Y2YjI1aGQzTXVZMjl0SWl3Z0luTndZWEpyTG1SeWFYWmxjaTUwWVhKblpYUmZZWGR6WDJWdVpGQnZhVzUwSWpvZ0luTXpMbUZ0WVhwdmJtRjNjeTVqYjIwaUxDQWljM0JoY21zdWJtRmlkUzVqYjIxd2RYUmxYMlZ1WjJsdVpWOXNhV0p6WDNCaGRHZ2lPaUFpTDJSaVpuTXZkRzF3TDJSbGRpOXVZV0oxTHpFM01EQXdOakkxT0RZNU9UTXhPRGt4THpBdllYQndiR2xqWVhScGIyNHVZMjl1WmlKOUNuMD0iLAogICJiYXRjaF9pZCI6IDE3MDAwNjI1ODY2NjI3NjkxLAogICJyZXRyeV9udW0iOiAiMCIsCiAgInNwYXJrX2NvbmZpZ3MiOiAiZXdvZ0lDQWdJbk52YkhKZlltRjBZMmhmYzJsNlpTSTZJakV3TURBd0lpd2ljR0Z5WVd4c1pXeGZkR2h5WldGa2N5STZJakV3SWl3aVptVjBZMmhmYzJsNlpTSTZJakV3TURBd0lnb2dJQ0FnZlE9PSIsCiAgImlzX2J1Y2tldF9lbmNyeXB0ZWQiOiAiIiwKICAiYjY0X2V4dGVybmFsX2phcnNfbWFwIiA6ICIiCn0= null /dbfs/tmp ewoiY2x1c3Rlcl9pZCI6ICIiLAoiYjY0X2lucHV0X2pzb24iOiAiZXdvaWNISnZZMlZ6YzBsa0lqb3hOekF3TURZeU5UZzJPVGt6TVRnNU1Td0tJbVJoZEdGd2JHRmpaVWxrSWpvME1pd0tJblJoWW14bFNXUWlPak0zTWpNMExBb2laR0YwWVcxdmRtVnRaVzUwU1dRaU9qSTJNU3dLSW1wdllsTmphR1ZrZFd4bFpGVnpaWEpKWkNJNklrMWhibUZ6ZDJsdWFTQkRhR2x1ZEdoaGJHRndkV1JwSWl3S0ltcHZZbE5qYUdWa2RXeGxTV1FpT2pFMU5qY3NDaUppWVhSamFFbGtJam94TnpBd01EWXlOVGcyTmpZeU56WTVNU3dLSW14aGMzUlNkVzVVYVcxbGMzUmhiWEFpT2lJeU1ESXpMVEV4TFRBM0lERXlPalF5T2pBd0xqZzJNelkxSWl3S0luSmxkSEo1VG5WdElqb2dJakFpQ24wPSIsCiJleHRyYV9jb25maWciOiAiZXdvaVpYaDBjbUZEYjI1bWFXZE5ZWEFpT2lCN0luTndZWEpyTG01aFluVXVabVYwWTJoZmMybDZaU0k2SUNJeE1EQXdNQ0lzSUNKemNHRnlheTV1WVdKMUxtTnZiWEIxZEdWZlpXNW5hVzVsSWpvZ0ltRjZkWEpsWDJSaGRHRmljbWxqYTNNaUxDQWljM0JoY21zdWJtRmlkUzV6YjJ4eVgySmhkR05vWDNOcGVtVWlPaUFpTVRBd01EQWlMQ0FpYzNCaGNtc3VibUZpZFM1aGNIQnNhV05oZEdsdmJsOXVZVzFsSWpvZ0ltNWhZblV0YzNCaGNtdGliM1F0YVc1blpYTjBhVzl1SWl3Z0luTndZWEpyTG1SeWFYWmxjaTV1WVdKMVgzQnlhWFpoZEdWTFpYa2lPaUFpTDJSaVpuTXZkRzF3TDJSbGRpOXVZV0oxTHpFM01EQXdOakkxT0RZNU9UTXhPRGt4THpBdmNISnBkbUYwWlV0bGVTSXNJQ0p6Y0dGeWF5NWtjbWwyWlhJdWMyOTFjbU5sWDJGM2MxOWxibVJRYjJsdWRDSTZJQ0p6TXk1aGJXRjZiMjVoZDNNdVkyOXRJaXdnSW5Od1lYSnJMbVJ5YVhabGNpNTBZWEpuWlhSZllYZHpYMlZ1WkZCdmFXNTBJam9nSW5NekxtRnRZWHB2Ym1GM2N5NWpiMjBpTENBaWMzQmhjbXN1Ym1GaWRTNWpiMjF3ZFhSbFgyVnVaMmx1WlY5c2FXSnpYM0JoZEdnaU9pQWlMMlJpWm5NdmRHMXdMMlJsZGk5dVlXSjFMekUzTURBd05qSTFPRFk1T1RNeE9Ea3hMekF2WVhCd2JHbGpZWFJwYjI0dVkyOXVaaUo5Q24wPSIsCiJjb21wdXRlX2VuZ19jcmVkc19qc29uIiA6ICJld29nSUNKamNtVmtaVzUwYVdGc1gybGtJam9nSWpReElpd0tJQ0FpWTNKbFpHVnVkR2xoYkY5MGVYQmxYMmxrSWpvZ0lqRTFJaXdLSUNBaVkzSmxaR1Z1ZEdsaGJGOTBlWEJsSWpvZ0lrWnBiR1VnUTI5dWRHVnVkQ0lzQ2lBZ0luUnZhMlZ1SWpvZ0ltTTJPVFV3TlRneVlURXlZalUxT0dGaU5qUTRZMlJpTnpJd01EZ3hOek5pTW1VNE5ESTRabUkxTldSaFlXUTNOREF4TlRJeU5UWTVNV1ZsWXpjNFpXVTNZalZqTkdVek5ETXhNbVJsWkRjd1lXVTFaVGRsWlRRNE0ySTNaRGRsWVRCak1qTmxNalJsTkRVNFpXUXhaalUwWkdFelkyTmtOMlJpWTJabE9EY3dZVFl4WlRWak9XTTFNRGczWlRkbVlqWmtZekUyWWpabU9HWTFaVFJpWldSaE5UWTVNalJsT0RnME9XVmlOVE01WVRZellqWm1NemhqTXpFNE1HWTROamszWkdNeFkyWmhOakV4TWpNek1UQXhPVFEyTkdJMVlqWXdZamszT1dJNU16WmlaalV4TnpGaE9UazJNbU14WTJFMU5HWTRaV000TkRJd05qZGhPRFE0WWpreU0yTTJPV1F5T1Rsak5tSTNOVEkwWXpBNU5UUXlPVE13TkRBek1EbGhNV1k0Wm1Rek9XWTNPREprTVdKa09EWTBNMll6TW1FMk5XWmhNelUzTURVMlpXSmtaakJrTlRRNVpUSXdaakJtTVdFd05UWmxPREV5TmpNNE1qTTVObU01Wm1RMU5HTXpZV0ZsT1dRNE1qaGpObVkxTldVM00yRXlZelkwTlRsaE1ESmtOVFV5TkdWaE1qTTBZekl3WkRsbFpXWTBObVF4TldabFpHSmhOV0ptT1RWbE5tSmlPRE13Wm1GalpHTmhZV1V4TnpBMlptTmhOakU0TUdKa1lqQXdNelZoT1RObE1qUmtOVGMxTkdZM1pESm1PR016TXpVNFltSmhZbUZsT0Rsa1lqTXlPV0ptTXpZelpHWXdZekUwT0dNMU9XRmhaV1ZtTkdOa1ptWmlaRGczT1RBNU1ETXdOVFJrTm1JMU5HRmlaakptT1RNMU4yVmtZVEJsTkdabU16RmhZakEzTVRkbFpEUm1ZbUpqTVdZMU5EWTVOVGcwTkRSaE9XTXhOVE13WkdJeE9UZ3pPVFExWTJFeFpqZzRPVGN3WldVM1kyVXdZakEzTnpVNE5URXdZVGhrTVdJeVl6Y3dORFZtTjJVd1l6UXhNakl4TWpRMFpEZzNOVEU0WW1aaU1URTVaakJqTUdJeVlUSXhNbVExTnpZMU4yTmtORE5oWmpWaFltTTBOR1E1T1RVM05Ua3hPVEV4WW1SbFlXWTJNamM1WkRRellURTVOekl4TXpnNE5USmtNMlJsWWpneFpUQXhPR05tWkRKaVpXTTBNVEl3WWpGaFpXWXlOR1ExTm1Vek1XTXlZMkZsTm1FM1l6ZzRZbVF4TXpsaU5EUXdNekF4TlRZM01tVTJZamhrTlRObU1qaGtNak16Wm1Jd05tUmpOV1JtTmpkbFlqWTFNVGxsT1dVME5HVmtPVEJsTkdKaVptSTRZalUzTm1NNVlXWmhOMlJrWm1GaU1UZGhaakl4T1dKbU9ERXpOV1JsTVdZNFpUWm1ZVE5tWmpRMlpURmhZV001TmpsaFptTXhaalJqTlRZeU5XUXdZell3TnpVMFptTXhZbUpqTXpSaFpEWXpaVFU0WVRSbU4ySmxPVGMxTmpabU5ERXpPV0U1WVRSaVltWXdZbUl4TTJSaE9XSXhNelEwTURFNVpXVm1NRGd6WW1Jd05UVmhNbVpsTVRCbVptWmpOek01WVRJNVlXUmlZbVJoTXpNellqZzBaV1JrWlRnMllqVmlOelkwTWprM1pERTVaakJqTVRjMk9EazVOamRrWlRBeU1tRXhaR0k1WkRFMFkyRmhOMk00TURFNFlqVXlZemhpWlRabU16RXdOekUzTXpoak9XTTFOekV4WXpreU5ESXlPVEV5TkdSaU5qSXdNVEV4WldabE5qRmpaR1U1TldRNVptWmtaREEwTkRBMU56azJOVGMyTldNMFlUQXpNV1UyWm1JeVlXRmhZVGxsWmpkbE1UYzFNR00zTlRaaVpXRXlZVEZqWVRNNFpHRTFZalprTWpJek1URXpOMkl3WkROa1pqazBORFU0TkRkaE5ETmxZbUV6TjJFMk4yRXdNakk1SWl3S0lDQWlZM0psWkdWdWRHbGhiRjlsYm1Sd2IybHVkRjkxY213aU9pQWlhSFIwY0RvdkwyUmxkaTFrYUdFdWFIVnRZVzVoTG1OdmJUbzRPRGc1TDJacGNtVnphRzkwY3k5amNtVmtaVzUwYVdGc2MwWmxkR05vVjJWaVUyVnlkbWxqWlNJc0NpQWdJbVpwYkdWZmNHRjBhQ0k2SUNJeE5UWTNYekkyTVY4eE56QXdNRFl5TlRnMk5qWXlOelk1TVNJc0NpQWdJbU55WldSbGJuUnBZV3hmWm1sc1pWOXdZWFIwWlhKdUlpQTZJQ0kwTVY4eE5qazVNelF5TlRjMUlncDkiLAoiY2x1c3Rlcl91aSI6ICIiLAoicmV0cnlfbnVtIjogIjAiLAoic3BhcmtfY29uZmlncyI6ICJld29nSUNBZ0luTnZiSEpmWW1GMFkyaGZjMmw2WlNJNklqRXdNREF3SWl3aWNHRnlZV3hzWld4ZmRHaHlaV0ZrY3lJNklqRXdJaXdpWm1WMFkyaGZjMmw2WlNJNklqRXdNREF3SWdvZ0lDQWdmUT09IiwKImI2NF9oaXZlX2NyZWRzX2pzb24iOiAiZXdvZ0lDSmpjbVZrWlc1MGFXRnNYMmxrSWpvZ0lpSXNDaUFnSW1OeVpXUmxiblJwWVd4ZmRIbHdaVjlwWkNJNklDSWlMQW9nSUNKMGIydGxiaUk2SUNKak5qazFNRFU0TW1FeE1tSTFOVGhoWWpZME9HTmtZamN5TURBNE1UY3pZakpsT0RReU9HWmlOVFZrWVdGa056UXdNVFV5TWpVMk9URmxaV00zT0dWbE4ySTFZelJsTXpRek1USmtaV1EzTUdGbE5XVTNaV1UwT0ROaU4yUTNaV0V3WXpJelpUSTBaVFExT0dWa01XWTFOR1JoTTJOalpEZGtZbU5tWlRnM01HRTJNV1UxWXpsak5UQTROMlUzWm1JMlpHTXhObUkyWmpobU5XVTBZbVZrWVRVMk9USTBaVGc0TkRsbFlqVXpPV0UyTTJJMlpqTTRZek14T0RCbU9EWTVOMlJqTVdObVlUWXhNVEl6TXpFd01UazBOalJpTldJMk1HSTVOemxpT1RNMlltWTFNVGN4WVRrNU5qSmpNV05oTlRSbU9HVmpPRFF5TURZM1lUZzBPR0k1TWpOak5qbGtNams1WXpaaU56VXlOR013T1RVME1qa3pNRFF3TXpBNVlURm1PR1prTXpsbU56Z3laREZpWkRnMk5ETm1NekpoTmpWbVlUTTFOekExTm1WaVpHWXdaRFUwT1dVeU1HWXdaakZoTURVMlpUZ3hNall6T0RJek9UWmpPV1prTlRSak0yRmhaVGxrT0RJNFl6Wm1OVFZsTnpOaE1tTTJORFU1WVRBeVpEVTFNalJsWVRJek5HTXlNR1E1WldWbU5EWmtNVFZtWldSaVlUVmlaamsxWlRaaVlqZ3pNR1poWTJSallXRmxNVGN3Tm1aallUWXhPREJpWkdJd01ETTFZVGt6WlRJMFpEVTNOVFJtTjJReVpqaGpNek0xT0dKaVlXSmhaVGc1WkdJek1qbGlaak0yTTJSbU1HTXhORGhqTlRsaFlXVmxaalJqWkdabVltUTROemt3T1RBek1EVTBaRFppTlRSaFltWXlaamt6TlRkbFpHRXdaVFJtWmpNeFlXSXdOekUzWldRMFptSmlZekZtTlRRMk9UVTRORFEwWVRsak1UVXpNR1JpTVRrNE16azBOV05oTVdZNE9EazNNR1ZsTjJObE1HSXdOemMxT0RVeE1HRTRaREZpTW1NM01EUTFaamRsTUdNME1USXlNVEkwTkdRNE56VXhPR0ptWWpFeE9XWXdZekJpTW1FeU1USmtOVGMyTlRkalpEUXpZV1kxWVdKak5EUmtPVGsxTnpVNU1Ua3hNV0prWldGbU5qSTNPV1EwTTJFeE9UY3lNVE00T0RVeVpETmtaV0k0TVdVd01UaGpabVF5WW1Wak5ERXlNR0l4WVdWbU1qUmtOVFpsTXpGak1tTmhaVFpoTjJNNE9HSmtNVE01WWpRME1ETXdNVFUyTnpKbE5tSTRaRFV6WmpJNFpESXpNMlppTURaa1l6VmtaalkzWldJMk5URTVaVGxsTkRSbFpEa3daVFJpWW1aaU9HSTFOelpqT1dGbVlUZGtaR1poWWpFM1lXWXlNVGxpWmpneE16VmtaVEZtT0dVMlptRXpabVkwTm1VeFlXRmpPVFk1WVdaak1XWTBZelUyTWpWa01HTTJNRGMxTkdaak1XSmlZek0wWVdRMk0yVTFPR0UwWmpkaVpUazNOVFkyWmpReE16bGhPV0UwWW1KbU1HSmlNVE5rWVRsaU1UTTBOREF4T1dWbFpqQTRNMkppTURVMVlUSm1aVEV3Wm1abVl6Y3pPV0V5T1dGa1ltSmtZVE16TTJJNE5HVmtaR1U0Tm1JMVlqYzJOREk1TjJReE9XWXdZekUzTmpnNU9UWTNaR1V3TWpKaE1XUmlPV1F4TkdOaFlUZGpPREF4T0dJMU1tTTRZbVUyWmpNeE1EY3hOek00WXpsak5UY3hNV001TWpReU1qa3hNalJrWWpZeU1ERXhNV1ZtWlRZeFkyUmxPVFZrT1dabVpHUXdORFF3TlRjNU5qVTNOalZqTkdFd016RmxObVppTW1GaFlXRTVaV1kzWlRFM05UQmpOelUyWW1WaE1tRXhZMkV6T0dSaE5XSTJaREl5TXpFeE16ZGlNR1F6WkdZNU5EUTFPRFEzWVRRelpXSmhNemRoTmpkaE1ESXlPU0lzQ2lBZ0ltTnlaV1JsYm5ScFlXeGZaVzVrY0c5cGJuUmZkWEpzSWpvZ0ltaDBkSEE2THk5a1pYWXRaR2hoTG1oMWJXRnVZUzVqYjIwNk9EZzRPUzltYVhKbGMyaHZkSE12WTNKbFpHVnVkR2xoYkhOR1pYUmphRmRsWWxObGNuWnBZMlVpQ24wPSIsCiJiYXRjaF9pZCI6MTcwMDA2MjU4NjY2Mjc2OTEsCiJwcm9jZXNzX2lkIiA6MTcwMDA2MjU4Njk5MzE4OTEsCiJyZXN0X3VybCI6ICIiLAoiYjY0X2V4dGVybmFsX2phcnNfbWFwIiA6ICIiCn0= null ewoicGlwZWxpbmVfdGltZW91dCIgOiAyMwp9]
""2023-11-15 15:37:07.548 [Thread-732] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ffeba0b-db26-48ef-8e8d-8c6bd1891ea1 has started processing message with message_id 46dbccf4-9011-43d0-acfa-4c7b2d0f6c14 and thread_id 913 
""2023-11-15 15:37:07.548 [Thread-732] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:37:07.548 [Thread-732] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=d5f7c84d-e235-4701-910a-64489cde6bd3, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=46dbccf4-9011-43d0-acfa-4c7b2d0f6c14, task_retry_intervals_secs=[], bot_id=2e8814f0-bfd3-416c-a2b9-266ce96ef204, message_topic=nabu_2_taskmonitor, tags={process_id=17000625869931891, initial_ts=1700062586993, batch_name=Ingestion_20231115, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot, KoshBot, DBOpsBot, DBOpsBot, KoshBot, TaskMonitorBot]}}
""2023-11-15 15:37:07.562 [Thread-732] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 17000625869931891, 'SparkScriptBot', 'run_almaren_ingestion_job_using_spark', 'run_almaren_ingestion_job_using_spark', 10 , TO_TIMESTAMP(1700062626938::double precision / 1000) ,'2e8814f0-bfd3-416c-a2b9-266ce96ef204');
""2023-11-15 15:37:07.562 [Thread-732] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ffeba0b-db26-48ef-8e8d-8c6bd1891ea1 has started process logic with message_id 46dbccf4-9011-43d0-acfa-4c7b2d0f6c14 and thread_id 913
""2023-11-15 15:37:07.680 [Thread-732] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ffeba0b-db26-48ef-8e8d-8c6bd1891ea1 has finished process logic with message_id 46dbccf4-9011-43d0-acfa-4c7b2d0f6c14 and thread_id 913
""2023-11-15 15:37:07.680 [Thread-732] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:37:07.680 [Thread-732] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 46dbccf4-9011-43d0-acfa-4c7b2d0f6c14
""2023-11-15 15:37:08.989 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - spark engine is azure_databricks
""2023-11-15 15:37:09.071 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:09,071] 	 INFO:[+] Logging nabu-sparkbot-ingestion Job 
""2023-11-15 15:37:10.846 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:10,844] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-profiler-assembly-jar-3-1-2-12/nabu-sparkbot-profiler-v0.6.1-3.1.jar from libraries
""2023-11-15 15:37:11.989 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:11,989] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-profiler-assembly-jar-3-1-2-12/postgresql-42.2.8.jar from libraries
""2023-11-15 15:37:13.169 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:13,168] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-profiler-assembly-jar-3-1-2-12/carolina-jdbc-2.4.4.jar from libraries
""2023-11-15 15:37:14.357 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:14,356] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-profiler-assembly-jar-3-1-2-12/spark-bigquery-with-dependencies_2.12-0.24.2.jar from libraries
""2023-11-15 15:37:15.510 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:15,509] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-profiler-assembly-jar-3-1-2-12/snowflake-jdbc-3.13.10.jar from libraries
""2023-11-15 15:37:16.678 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:16,677] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-profiler-assembly-jar-3-1-2-12/ngdbc-2.11.17.jar from libraries
""2023-11-15 15:37:17.898 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:17,898] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-profiler-assembly-jar-3-1-2-12/mongo-spark-connector-10.0.5.jar from libraries
""2023-11-15 15:37:19.039 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:19,039] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-profiler-assembly-jar-3-1-2-12/terajdbc-20.00.00.10.jar from libraries
""2023-11-15 15:37:20.219 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:20,218] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-profiler-assembly-jar-3-1-2-12/jcc-11.5.8.0.jar from libraries
""2023-11-15 15:37:21.403 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:21,402] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-profiler-assembly-jar-3-1-2-12/vertica-jdbc-12.0.2-0.jar from libraries
""2023-11-15 15:37:22.519 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:22,518] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-sparkbot-fuzzy-matching-jar-3-1-2-12/nabu-sparkbot-fuzzy-matching-v0.4.1-3.1.jar from libraries
""2023-11-15 15:37:23.678 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:23,677] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-sparkbot-fuzzy-matching-jar-3-1-2-12/postgresql-42.2.8.jar from libraries
""2023-11-15 15:37:24.822 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:24,822] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-index-bot-assembly-jar-3-1-2-12/nabu-sparkbot-index-v0.4.15-3.1.jar from libraries
""2023-11-15 15:37:25.965 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:25,964] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-index-bot-assembly-jar-3-1-2-12/carolina-jdbc-2.4.4.jar from libraries
""2023-11-15 15:37:27.133 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:27,133] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-index-bot-assembly-jar-3-1-2-12/spark-bigquery-with-dependencies_2.12-0.24.2.jar from libraries
""2023-11-15 15:37:28.267 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:28,266] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-index-bot-assembly-jar-3-1-2-12/snowflake-jdbc-3.13.10.jar from libraries
""2023-11-15 15:37:29.428 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:29,427] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-index-bot-assembly-jar-3-1-2-12/ngdbc-2.11.17.jar from libraries
""2023-11-15 15:37:30.608 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:30,608] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-index-bot-assembly-jar-3-1-2-12/mongo-spark-connector-10.0.5.jar from libraries
""2023-11-15 15:37:31.798 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:31,797] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-index-bot-assembly-jar-3-1-2-12/terajdbc-20.00.00.10.jar from libraries
""2023-11-15 15:37:32.979 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:32,978] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-index-bot-assembly-jar-3-1-2-12/jcc-11.5.8.0.jar from libraries
""2023-11-15 15:37:34.212 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:34,210] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-index-bot-assembly-jar-3-1-2-12/vertica-jdbc-12.0.2-0.jar from libraries
""2023-11-15 15:37:35.408 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:35,408] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-curation-dependency-jars-3-1/nabu-sparkbot-reflection-code-execution-v0.5.9-3.1.jar from libraries
""2023-11-15 15:37:36.505 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:36,504] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-curation-dependency-jars-3-1/hive-jdbc-1.0.jar from libraries
""2023-11-15 15:37:37.715 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:37,714] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-curation-dependency-jars-3-1/carolina-jdbc-2.4.4.jar from libraries
""2023-11-15 15:37:38.890 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:38,889] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-curation-dependency-jars-3-1/ojdbc6-11.2.0.4.jar from libraries
""2023-11-15 15:37:40.048 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:40,047] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-curation-dependency-jars-3-1/mssql-jdbc-8.2.0.jre8.jar from libraries
""2023-11-15 15:37:41.302 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:41,301] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-curation-dependency-jars-3-1/aws-java-sdk-1.11.163.jar from libraries
""2023-11-15 15:37:42.445 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:42,444] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-curation-dependency-jars-3-1/almaren-framework_2.12-0.9.9-3.1.jar from libraries
""2023-11-15 15:37:43.552 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:43,550] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-curation-dependency-jars-3-1/jdbcparallel-almaren_2.12-0.0.4-3.1.jar from libraries
""2023-11-15 15:37:44.728 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:44,728] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-curation-dependency-jars-3-1/postgresql-42.2.8.jar from libraries
""2023-11-15 15:37:45.927 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:45,926] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-curation-dependency-jars-3-1/mysql-connector-java-8.0.29.jar from libraries
""2023-11-15 15:37:47.104 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:47,103] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-curation-dependency-jars-3-1/jtds-1.3.1.jar from libraries
""2023-11-15 15:37:48.307 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:48,305] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-curation-dependency-jars-3-1/spark-bigquery-with-dependencies_2.12-0.24.2.jar from libraries
""2023-11-15 15:37:49.457 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:49,455] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-curation-dependency-jars-3-1/redshift-jdbc42-2.1.0.1.jar from libraries
""2023-11-15 15:37:50.607 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:50,607] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-curation-dependency-jars-3-1/snowflake-jdbc-3.13.10.jar from libraries
""2023-11-15 15:37:51.792 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:51,791] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-curation-dependency-jars-3-1/ngdbc-2.11.17.jar from libraries
""2023-11-15 15:37:53.007 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:53,006] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-curation-dependency-jars-3-1/terajdbc-20.00.00.10.jar from libraries
""2023-11-15 15:37:54.181 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:54,179] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-curation-dependency-jars-3-1/jcc-11.5.8.0.jar from libraries
""2023-11-15 15:37:55.359 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:55,359] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-curation-dependency-jars-3-1/mongo-spark-connector-10.0.5.jar from libraries
""2023-11-15 15:37:56.529 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:56,528] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-curation-dependency-jars-3-1/vertica-jdbc-12.0.2-0.jar from libraries
""2023-11-15 15:37:57.679 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:57,678] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-curation-dependency-jars-3-1/hive-jdbc-3.1.3.jar from libraries
""2023-11-15 15:37:58.863 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:37:58,861] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-curation-dependency-jars-3-1/hive-service-3.1.3.jar from libraries
""2023-11-15 15:38:00.009 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:00,008] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-curation-dependency-jars-3-1/hive-common-3.1.3.jar from libraries
""2023-11-15 15:38:01.211 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:01,210] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-curation-dependency-jars-3-1/hive-serde-3.1.3.jar from libraries
""2023-11-15 15:38:02.381 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:02,380] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-curation-dependency-jars-3-1/hive-service-rpc-3.1.3.jar from libraries
""2023-11-15 15:38:03.514 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:03,513] 	 INFO:[+] Removed dbfs:/tmp/dev/nabu-spark-bot-curation-dependency-jars-3-1/libthrift-0.18.1.jar from libraries
""2023-11-15 15:38:04.737 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:04,736] 	 INFO:[+] Restarting cluster...
""2023-11-15 15:38:04.738 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:04,737] 	 INFO:[+] Checking resources
""2023-11-15 15:38:07.491 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:07,490] 	 INFO:[+] Resources are not available
""2023-11-15 15:38:07.491 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:07,491] 	 INFO:[+] Uploading the resources ....
""2023-11-15 15:38:08.646 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:08,646] 	 INFO:[+] Created Directory nabu-spark-bot-ingestion-dependency-jars-3-1 
""2023-11-15 15:38:20.857 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:20,855] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/2.12/nabu-sparkbot-reflection-code-execution-v0.5.9-3.1.jar
""2023-11-15 15:38:22.945 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:22,944] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/hive-jdbc-1.0.jar
""2023-11-15 15:38:24.652 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:24,651] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/carolina-jdbc-2.4.4.jar
""2023-11-15 15:38:26.297 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:26,296] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/com/oracle/database/jdbc/ojdbc6/11.2.0.4/ojdbc6-11.2.0.4.jar
""2023-11-15 15:38:28.027 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:28,027] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/com/microsoft/sqlserver/mssql-jdbc/8.2.0.jre8/mssql-jdbc-8.2.0.jre8.jar
""2023-11-15 15:38:29.423 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:29,423] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/com/amazonaws/aws-java-sdk/1.11.163/aws-java-sdk-1.11.163.jar
""2023-11-15 15:38:30.855 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:30,854] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/com/github/music-of-the-ainur/almaren-framework_2.12/0.9.9-3.1/almaren-framework_2.12-0.9.9-3.1.jar
""2023-11-15 15:38:32.603 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:32,602] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/jdbcparallel-almaren_2.12-0.0.4-3.1.jar
""2023-11-15 15:38:34.179 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:34,179] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/org/postgresql/postgresql/42.2.8/postgresql-42.2.8.jar
""2023-11-15 15:38:35.824 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:35,822] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/mysql/mysql-connector-java/8.0.29/mysql-connector-java-8.0.29.jar
""2023-11-15 15:38:37.312 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:37,310] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/net/sourceforge/jtds/jtds/1.3.1/jtds-1.3.1.jar
""2023-11-15 15:38:39.693 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:39,692] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/com/google/cloud/spark/spark-bigquery-with-dependencies_2.12/0.24.2/spark-bigquery-with-dependencies_2.12-0.24.2.jar
""2023-11-15 15:38:41.357 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:41,356] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/com/amazon/redshift/redshift-jdbc42/2.1.0.1/redshift-jdbc42-2.1.0.1.jar
""2023-11-15 15:38:43.667 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:43,666] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/net/snowflake/snowflake-jdbc/3.13.10/snowflake-jdbc-3.13.10.jar
""2023-11-15 15:38:45.263 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:45,262] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/com/sap/cloud/db/jdbc/ngdbc/2.11.17/ngdbc-2.11.17.jar
""2023-11-15 15:38:46.664 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:46,664] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/org/mongodb/spark/mongo-spark-connector/10.0.5/mongo-spark-connector-10.0.5.jar
""2023-11-15 15:38:48.227 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:48,226] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/com/teradata/jdbc/terajdbc/20.00.00.10/terajdbc-20.00.00.10.jar
""2023-11-15 15:38:49.896 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:49,894] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/com/ibm/db2/jcc/11.5.8.0/jcc-11.5.8.0.jar
""2023-11-15 15:38:51.420 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:51,419] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/com/vertica/jdbc/vertica-jdbc/12.0.2-0/vertica-jdbc-12.0.2-0.jar
""2023-11-15 15:38:51.420 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:51,419] 	 INFO:[+] Uploaded the resources
""2023-11-15 15:38:51.421 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:51,419] 	 INFO:[+] Uploading temporary resources
""2023-11-15 15:38:54.036 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:54,035] 	 INFO:[+] Uploaded temporary resources /opt/nabu/nabu-spark-bots/azure_databricks/conf/small/application.conf
""2023-11-15 15:38:55.340 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:55,335] 	 INFO:[+] Uploaded temporary resources /opt/nabu/nabu-spark-bots/keys/privateKey
""2023-11-15 15:38:56.676 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:56,675] 	 INFO:[+] Uploaded temporary resources /opt/nabu/nabu-spark-bots/azure_databricks/conf/log4j.properties
""2023-11-15 15:38:56.676 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:56,675] 	 INFO:[+] Creating the Job_json for 17000625869931892
""2023-11-15 15:38:56.677 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:56,675] 	 INFO:[+] Creating reflection_job.json file
""2023-11-15 15:38:56.677 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:56,675] 	 INFO:[+] Creating the folder 17000625869931892/0
""2023-11-15 15:38:56.678 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:56,677] 	 INFO:[+] Job json file 17000625869931892/0/reflection_job.json successfully created
""2023-11-15 15:38:56.679 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:56,677] 	 INFO:[+] Creating the job for the file job_json
""2023-11-15 15:38:57.525 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - WARN: Your CLI is configured to use Jobs API 2.0. In order to use the latest Jobs features please upgrade to 2.1: 'databricks jobs configure --version=2.1'. Future versions of this CLI will default to the new Jobs API. Learn more at https://docs.databricks.com/dev-tools/cli/jobs-cli.html
""2023-11-15 15:38:57.940 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:57,939] 	 INFO:[+] Job id is 349081976322531
""2023-11-15 15:38:57.940 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:57,939] 	 INFO:[+] Running the job 349081976322531
""2023-11-15 15:38:58.820 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - WARN: Your CLI is configured to use Jobs API 2.0. In order to use the latest Jobs features please upgrade to 2.1: 'databricks jobs configure --version=2.1'. Future versions of this CLI will default to the new Jobs API. Learn more at https://docs.databricks.com/dev-tools/cli/jobs-cli.html
""2023-11-15 15:38:59.176 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:38:59,176] 	 INFO:[+] Run id is 837939490085749
""2023-11-15 15:39:00.013 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - WARN: Your CLI is configured to use Jobs API 2.0. In order to use the latest Jobs features please upgrade to 2.1: 'databricks jobs configure --version=2.1'. Future versions of this CLI will default to the new Jobs API. Learn more at https://docs.databricks.com/dev-tools/cli/jobs-cli.html
""2023-11-15 15:39:00.298 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:39:00,297] 	 INFO:[+] Run page URL is https://adb-5839172005328472.12.azuredatabricks.net/?o=5839172005328472#job/349081976322531/run/837939490085749
""2023-11-15 15:39:00.299 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:39:00,298] 	 INFO:[+] Inserting JOB details into kosh
""2023-11-15 15:39:00.614 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:39:00,613] 	 INFO:[+] Inserted job details into Kosh
""2023-11-15 15:39:01.516 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - WARN: Your CLI is configured to use Jobs API 2.0. In order to use the latest Jobs features please upgrade to 2.1: 'databricks jobs configure --version=2.1'. Future versions of this CLI will default to the new Jobs API. Learn more at https://docs.databricks.com/dev-tools/cli/jobs-cli.html
""2023-11-15 15:39:31.811 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:39:31,810] 	 INFO:[+] Job id 349081976322531 and run id 837939490085749 is in PENDING Status
""2023-11-15 15:39:32.703 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - WARN: Your CLI is configured to use Jobs API 2.0. In order to use the latest Jobs features please upgrade to 2.1: 'databricks jobs configure --version=2.1'. Future versions of this CLI will default to the new Jobs API. Learn more at https://docs.databricks.com/dev-tools/cli/jobs-cli.html
""2023-11-15 15:40:03.086 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:40:03,085] 	 INFO:[+] Job id 349081976322531 and run id 837939490085749 is in PENDING Status
""2023-11-15 15:40:03.948 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - WARN: Your CLI is configured to use Jobs API 2.0. In order to use the latest Jobs features please upgrade to 2.1: 'databricks jobs configure --version=2.1'. Future versions of this CLI will default to the new Jobs API. Learn more at https://docs.databricks.com/dev-tools/cli/jobs-cli.html
""2023-11-15 15:40:34.352 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:40:34,345] 	 INFO:[+] Job id 349081976322531 and run id 837939490085749 is in PENDING Status
""2023-11-15 15:40:36.455 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - WARN: Your CLI is configured to use Jobs API 2.0. In order to use the latest Jobs features please upgrade to 2.1: 'databricks jobs configure --version=2.1'. Future versions of this CLI will default to the new Jobs API. Learn more at https://docs.databricks.com/dev-tools/cli/jobs-cli.html
""2023-11-15 15:41:06.828 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:41:06,826] 	 INFO:[+] Job id 349081976322531 and run id 837939490085749 is in PENDING Status
""2023-11-15 15:41:07.669 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - WARN: Your CLI is configured to use Jobs API 2.0. In order to use the latest Jobs features please upgrade to 2.1: 'databricks jobs configure --version=2.1'. Future versions of this CLI will default to the new Jobs API. Learn more at https://docs.databricks.com/dev-tools/cli/jobs-cli.html
""2023-11-15 15:41:38.066 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:41:38,065] 	 INFO:[+] Job id 349081976322531 and run id 837939490085749 is in PENDING Status
""2023-11-15 15:41:38.954 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - WARN: Your CLI is configured to use Jobs API 2.0. In order to use the latest Jobs features please upgrade to 2.1: 'databricks jobs configure --version=2.1'. Future versions of this CLI will default to the new Jobs API. Learn more at https://docs.databricks.com/dev-tools/cli/jobs-cli.html
""2023-11-15 15:42:09.334 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:42:09,333] 	 INFO:[+] Job id 349081976322531 and run id 837939490085749 is in PENDING Status
""2023-11-15 15:42:10.205 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - WARN: Your CLI is configured to use Jobs API 2.0. In order to use the latest Jobs features please upgrade to 2.1: 'databricks jobs configure --version=2.1'. Future versions of this CLI will default to the new Jobs API. Learn more at https://docs.databricks.com/dev-tools/cli/jobs-cli.html
""2023-11-15 15:42:11.424 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - WARN: Your CLI is configured to use Jobs API 2.0. In order to use the latest Jobs features please upgrade to 2.1: 'databricks jobs configure --version=2.1'. Future versions of this CLI will default to the new Jobs API. Learn more at https://docs.databricks.com/dev-tools/cli/jobs-cli.html
""2023-11-15 15:42:12.670 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - WARN: Your CLI is configured to use Jobs API 2.0. In order to use the latest Jobs features please upgrade to 2.1: 'databricks jobs configure --version=2.1'. Future versions of this CLI will default to the new Jobs API. Learn more at https://docs.databricks.com/dev-tools/cli/jobs-cli.html
""2023-11-15 15:42:13.123 [Thread-2064] INFO  com.modak.bots.SparkScriptBot - runId match is: RUN ID is : 837939490085749
""2023-11-15 15:42:13.123 [Thread-2064] INFO  com.modak.bots.SparkScriptBot - runId  is: 837939490085749
""2023-11-15 15:42:13.124 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:42:13,123] 	 ERROR:[+] JOB ID is : 349081976322531 and RUN ID is : 837939490085749 state is FAILED
""2023-11-15 15:42:13.125 [Thread-2064] INFO  com.modak.bots.SparkScriptBot - jobId match is:  JOB ID is : 349081976322531
""2023-11-15 15:42:13.338 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - Executing query to insert the spark application details into kosh: update nabu.spark_application_details set application_id = 'application_349081976322531_837939490085749', mod_ts=now()
where process_id = 17000625869931891 and batch_id = 17000625866627691 and retry_num = 0;
insert into nabu.spark_application_details
(application_id, process_id, additional_info, cru_ts, batch_id, retry_num, mod_ts)
select
'application_349081976322531_837939490085749',17000625869931891,'{"job_id":"349081976322531" ,"job_name": null  ,"run_id":"837939490085749","RunPageURL": null }',now(), 17000625866627691, 0 , now()
where not exists(select * from nabu.spark_application_details where process_id = 17000625869931891 and batch_id = 17000625866627691 and retry_num = 0)
""2023-11-15 15:42:13.344 [Thread-2064] INFO  com.modak.bots.SparkScriptBot - Spark application details are inserted into kosh
""2023-11-15 15:42:13.344 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:42:13,123] 	 INFO:[+] Application id is application_349081976322531_837939490085749
""2023-11-15 15:42:13.344 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:42:13,123] 	 INFO:[+] Removing temporary resources
""2023-11-15 15:42:14.424 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:42:14,424] 	 INFO:[+] Removed temporary resources of 17000625869931892
""2023-11-15 15:42:14.425 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 15:42:14,424] 	 INFO:[+] Deleting JSON file
""2023-11-15 15:42:14.727 [Thread-2064] INFO  com.modak.bots.SparkScriptBot -  exit status : 1
""2023-11-15 15:42:14.727 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - application_id application_349081976322531_837939490085749
""2023-11-15 15:42:14.727 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - job_id 349081976322531
""2023-11-15 15:42:14.727 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - run_id 837939490085749
""2023-11-15 15:42:14.727 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - job_name null
""2023-11-15 15:42:14.727 [Thread-2064] DEBUG com.modak.bots.SparkScriptBot - RunPageURL null
""2023-11-15 15:42:14.727 [Thread-2064] ERROR com.modak.bots.SparkScriptBot - 
application_id : application_349081976322531_837939490085749 
error : 
[2023-11-15 15:42:13,123] 	 ERROR:[+] JOB ID is : 349081976322531 and RUN ID is : 837939490085749 state is FAILED
""2023-11-15 15:42:14.727 [Thread-2064] ERROR com.modak.bots.SparkScriptBot - java.lang.Exception: 
application_id : application_349081976322531_837939490085749
error :
[2023-11-15 15:42:13,123] 	 ERROR:[+] JOB ID is : 349081976322531 and RUN ID is : 837939490085749 state is FAILED
	at com.modak.bots.SparkScriptBot.executeCommand(SparkScriptBot.java:222)
	at com.modak.bots.SparkScriptBot.processLogic(SparkScriptBot.java:94)
	at com.modak.bots.basebot.AbstractBaseBot.processMessage(AbstractBaseBot.java:387)
	at com.modak.bots.basebot.AbstractPullBot.lambda$startBot$0(AbstractPullBot.java:56)
	at java.lang.Thread.run(Thread.java:750)

""2023-11-15 15:42:14.728 [Thread-2064] INFO  com.modak.bots.SparkScriptBot - connection closed!
""2023-11-15 15:42:14.728 [Thread-2064] ERROR com.modak.bots.SparkScriptBot - Exception message : 
application_id : application_349081976322531_837939490085749
error :
[2023-11-15 15:42:13,123] 	 ERROR:[+] JOB ID is : 349081976322531 and RUN ID is : 837939490085749 state is FAILED


""2023-11-15 15:42:14.728 [Thread-2064] ERROR com.modak.bots.basebot.AbstractBaseBot - java.lang.Exception: Exception while executing script :
application_id : application_349081976322531_837939490085749
error :
[2023-11-15 15:42:13,123] 	 ERROR:[+] JOB ID is : 349081976322531 and RUN ID is : 837939490085749 state is FAILED
	at com.modak.bots.SparkScriptBot.processLogic(SparkScriptBot.java:102)
	at com.modak.bots.basebot.AbstractBaseBot.processMessage(AbstractBaseBot.java:387)
	at com.modak.bots.basebot.AbstractPullBot.lambda$startBot$0(AbstractPullBot.java:56)
	at java.lang.Thread.run(Thread.java:750)

""2023-11-15 15:42:14.750 [Thread-2064] INFO  com.modak.bots.basebot.AbstractBaseBot - publish_msg_topic nabu_2_errorbot
""2023-11-15 15:42:14.759 [Thread-2064] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_errorbot
""2023-11-15 15:42:14.765 [Thread-2064] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_errorbot
""2023-11-15 15:42:14.766 [Thread-2064] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:14.766 [Thread-2064] ERROR com.modak.bots.basebot.AbstractBaseBot - com.modak.utils.exception.BotException: BotException : java.lang.Exception: Exception while executing script :
application_id : application_349081976322531_837939490085749
error :
[2023-11-15 15:42:13,123] 	 ERROR:[+] JOB ID is : 349081976322531 and RUN ID is : 837939490085749 state is FAILED
	at com.modak.bots.basebot.AbstractBaseBot.processMessage(AbstractBaseBot.java:417)
	at com.modak.bots.basebot.AbstractPullBot.lambda$startBot$0(AbstractPullBot.java:56)
	at java.lang.Thread.run(Thread.java:750)

""2023-11-15 15:42:14.766 [Thread-2064] INFO  com.modak.bots.basebot.AbstractBaseBot - SparkScriptBot finished processing message with id d5f7c84d-e235-4701-910a-64489cde6bd3
""2023-11-15 15:42:14.816 [Thread-956] INFO  com.modak.bots.basebot.AbstractBaseBot - ErrorBot with bot_id 9aae4f4c-2628-49e3-b7c6-2fe5e3473bd6 has started processing message with message_id f6fddc4a-18b6-4d71-a23c-d545f6caa474 and thread_id 1175 
""2023-11-15 15:42:14.816 [Thread-956] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:14.816 [Thread-956] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=d5f7c84d-e235-4701-910a-64489cde6bd3, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_error_msg, message_id=f6fddc4a-18b6-4d71-a23c-d545f6caa474, task_retry_intervals_secs=[], bot_id=2e8814f0-bfd3-416c-a2b9-266ce96ef204, message_topic=nabu_2_errorbot, tags={process_id=17000625869931891, initial_ts=1700062586993, batch_name=Ingestion_20231115, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot, KoshBot, DBOpsBot, DBOpsBot, KoshBot, ErrorBot]}}
""2023-11-15 15:42:14.828 [Thread-956] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
 INSERT INTO nabu.data_movement_errors (process_id, bot_uuid, process_context, error_json, created_ts, task_map, retry_attempt, bot_type) VALUES(?, ?::uuid, ?, ?, current_timestamp, ?, ?, ?); 
""2023-11-15 15:42:14.828 [Thread-956] INFO  com.modak.bots.basebot.AbstractBaseBot - ErrorBot with bot_id 9aae4f4c-2628-49e3-b7c6-2fe5e3473bd6 has started process logic with message_id f6fddc4a-18b6-4d71-a23c-d545f6caa474 and thread_id 1175
""2023-11-15 15:42:14.851 [Thread-956] DEBUG com.modak.utils.jdbc.JDBCUtility - query : 
INSERT INTO nabu.data_movement_errors
(process_id, bot_uuid, process_context, error_json, created_ts, task_map, retry_attempt, bot_type)
VALUES(?, ?::uuid, ?, ?, current_timestamp, ?, ?, ?);

""2023-11-15 15:42:15.315 [Thread-956] INFO  com.modak.bots.basebot.AbstractBaseBot - ErrorBot with bot_id 9aae4f4c-2628-49e3-b7c6-2fe5e3473bd6 has finished process logic with message_id f6fddc4a-18b6-4d71-a23c-d545f6caa474 and thread_id 1175
""2023-11-15 15:42:15.316 [Thread-956] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:15.316 [Thread-956] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:15.316 [Thread-956] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=d5f7c84d-e235-4701-910a-64489cde6bd3, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_error_msg, message_id=f6fddc4a-18b6-4d71-a23c-d545f6caa474, task_retry_intervals_secs=[], bot_id=2e8814f0-bfd3-416c-a2b9-266ce96ef204, message_topic=nabu_2_errorbot, tags={process_id=17000625869931891, initial_ts=1700062586993, batch_name=Ingestion_20231115, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot, KoshBot, DBOpsBot, DBOpsBot, KoshBot, ErrorBot]}}
""2023-11-15 15:42:15.329 [Thread-956] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 17000625869931891, 'SparkScriptBot', 'run_almaren_ingestion_job_using_spark', 'run_almaren_ingestion_job_using_spark', 7 , TO_TIMESTAMP(1700062934738::double precision / 1000) ,'2e8814f0-bfd3-416c-a2b9-266ce96ef204');
""2023-11-15 15:42:15.329 [Thread-956] INFO  com.modak.bots.basebot.AbstractBaseBot - ErrorBot with bot_id 9aae4f4c-2628-49e3-b7c6-2fe5e3473bd6 has started process logic with message_id f6fddc4a-18b6-4d71-a23c-d545f6caa474 and thread_id 1175
""2023-11-15 15:42:15.334 [Thread-956] INFO  com.modak.bots.basebot.AbstractBaseBot - ErrorBot with bot_id 9aae4f4c-2628-49e3-b7c6-2fe5e3473bd6 has finished process logic with message_id f6fddc4a-18b6-4d71-a23c-d545f6caa474 and thread_id 1175
""2023-11-15 15:42:15.334 [Thread-956] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:15.334 [Thread-956] INFO  com.modak.bots.basebot.AbstractBaseBot - ErrorBot finished processing message with id f6fddc4a-18b6-4d71-a23c-d545f6caa474
""2023-11-15 15:42:15.806 [Thread-2320] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 6e745e91-c4c3-4926-80fe-45279bdacd79 has started processing message with message_id be58b24d-95c8-4bff-ac74-5d729db93fab and thread_id 2818 
""2023-11-15 15:42:15.806 [Thread-2320] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:15.806 [Thread-2320] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=be58b24d-95c8-4bff-ac74-5d729db93fab, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=delete_almaren_code_from_kosh, message_id=be58b24d-95c8-4bff-ac74-5d729db93fab, task_retry_intervals_secs=[], bot_id=d6a03616-281f-4a28-9811-52d565f7ccd1, message_topic=nabu_2_jdbc, tags={process_id=1700062586993189, initial_ts=1700062586993, batch_name=, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, DBOpsBot]}}
""2023-11-15 15:42:15.817 [Thread-2320] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
delete from nabu.pipeline_spark_job_details where batch_id = 17000625866627691 and pipeline_id = 261 and job_type_id = 1
""2023-11-15 15:42:15.828 [Thread-2320] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 15:42:15.830 [Thread-2320] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:42:15.834 [Thread-2320] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:42:15.834 [Thread-2320] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 6e745e91-c4c3-4926-80fe-45279bdacd79 has started process logic with message_id be58b24d-95c8-4bff-ac74-5d729db93fab and thread_id 2818
""2023-11-15 15:42:15.839 [Thread-2320] DEBUG com.modak.bots.DBOpsBot - to execute query timeTakenInMillis : 5
""2023-11-15 15:42:15.839 [Thread-2320] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 6e745e91-c4c3-4926-80fe-45279bdacd79 has finished process logic with message_id be58b24d-95c8-4bff-ac74-5d729db93fab and thread_id 2818
""2023-11-15 15:42:15.840 [Thread-2320] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-15 15:42:15.850 [Thread-2320] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "dfc820b9-4166-4d0a-9359-4b7ce6c83326", "parent_id": "be58b24d-95c8-4bff-ac74-5d729db93fab", "bot_id": "6e745e91-c4c3-4926-80fe-45279bdacd79", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":1700062586993189, "initial_ts":1700062586993, "batch_id":17000625866627691, "batch_name":"", "job_schedule_id":1567, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "DBOpsBot", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"6e745e91-c4c3-4926-80fe-45279bdacd79", "bot_name":"DBOpsBot", "process_context":"delete_almaren_code_from_kosh", "task_name":"delete_almaren_code_from_kosh", "process_id":"1700062586993189", "task_ts":1700062935840, "batch_id":"17000625866627691", "status_code_id": 6 } } ] }
""2023-11-15 15:42:15.851 [Thread-2320] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:42:15.855 [Thread-2320] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:42:15.855 [Thread-2320] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:15.855 [Thread-2320] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot finished processing message with id be58b24d-95c8-4bff-ac74-5d729db93fab
""2023-11-15 15:42:15.926 [Thread-1937] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 13a5eb35-8804-48e2-a685-5383b2ce92c7 has started processing message with message_id 726467cb-6792-4883-8a51-fe5741ec126a and thread_id 2370 
""2023-11-15 15:42:15.927 [Thread-1937] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:15.927 [Thread-1937] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=726467cb-6792-4883-8a51-fe5741ec126a, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=get_created_credentials_details_if_exists, message_id=726467cb-6792-4883-8a51-fe5741ec126a, task_retry_intervals_secs=[], bot_id=d6a03616-281f-4a28-9811-52d565f7ccd1, message_topic=nabu_2_jdbc, tags={process_id=1700062586993189, initial_ts=1700062586993, batch_name=, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, DBOpsBot]}}
""2023-11-15 15:42:15.928 [Thread-732] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ffeba0b-db26-48ef-8e8d-8c6bd1891ea1 has started processing message with message_id 8706301d-d094-4197-8bcb-4c9af0172cc1 and thread_id 913 
""2023-11-15 15:42:15.928 [Thread-732] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:15.928 [Thread-732] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=be58b24d-95c8-4bff-ac74-5d729db93fab, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=8706301d-d094-4197-8bcb-4c9af0172cc1, task_retry_intervals_secs=[], bot_id=6e745e91-c4c3-4926-80fe-45279bdacd79, message_topic=nabu_2_taskmonitor, tags={process_id=1700062586993189, initial_ts=1700062586993, batch_name=, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, DBOpsBot, TaskMonitorBot]}}
""2023-11-15 15:42:15.929 [Thread-464] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 5b116219-7bf5-423b-a09f-c9352a1f0e6f has started processing message with message_id dfc820b9-4166-4d0a-9359-4b7ce6c83326 and thread_id 600 
""2023-11-15 15:42:15.929 [Thread-464] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:15.929 [Thread-464] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=be58b24d-95c8-4bff-ac74-5d729db93fab, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=dfc820b9-4166-4d0a-9359-4b7ce6c83326, task_retry_intervals_secs=[], bot_id=6e745e91-c4c3-4926-80fe-45279bdacd79, message_topic=nabu_2_taskmonitor, tags={process_id=1700062586993189, initial_ts=1700062586993, batch_name=, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, DBOpsBot, TaskMonitorBot]}}
""2023-11-15 15:42:15.937 [Thread-480] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 987221e2-6a29-4685-b1e5-a76cf9dc7906 has started processing message with message_id 1adb4dfc-3574-434b-a42c-4c8ad41d7169 and thread_id 619 
""2023-11-15 15:42:15.937 [Thread-480] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:15.937 [Thread-480] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=1adb4dfc-3574-434b-a42c-4c8ad41d7169, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=inserting_pre_aggregate_stats, message_id=1adb4dfc-3574-434b-a42c-4c8ad41d7169, task_retry_intervals_secs=[], bot_id=d6a03616-281f-4a28-9811-52d565f7ccd1, message_topic=nabu_2_jdbc, tags={process_id=1700062586993189, initial_ts=1700062586993, batch_name=, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, DBOpsBot]}}
""2023-11-15 15:42:15.940 [Thread-1937] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
{ "input_data": { "batch_id": "17000625866627691", "data_movement_id": "261", "job_schedule_id": "1567", "job_type_id" : "1" }, "sequential_templates":[ { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "check_compute_engine_validity_data_movement", "query_output_key": "check_compute_engine_validity", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/common_templates.stg", "query_template_name": "fetching_creds_script_inputs", "query_output_key": "fetching_script_inputs", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/common_templates.stg", "query_template_name": "fetching_credential_inputs", "query_output_key": "fetching_credential_inputs", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/common_templates.stg", "query_template_name": "get_worlflow_type", "query_output_key": "get_worlflow_type", "query_type":"select" } ], "output_keys":["check_compute_engine_validity","fetching_script_inputs","fetching_credential_inputs","get_worlflow_type"] }
""2023-11-15 15:42:15.941 [Thread-464] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 1700062586993189, 'DBOpsBot', 'delete_almaren_code_from_kosh', 'delete_almaren_code_from_kosh', 6 , TO_TIMESTAMP(1700062935840::double precision / 1000) ,'6e745e91-c4c3-4926-80fe-45279bdacd79');
""2023-11-15 15:42:15.941 [Thread-464] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 5b116219-7bf5-423b-a09f-c9352a1f0e6f has started process logic with message_id dfc820b9-4166-4d0a-9359-4b7ce6c83326 and thread_id 600
""2023-11-15 15:42:15.943 [Thread-732] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 1700062586993189, 'DBOpsBot', 'delete_almaren_code_from_kosh', 'delete_almaren_code_from_kosh', 10 , TO_TIMESTAMP(1700062935806::double precision / 1000) ,'6e745e91-c4c3-4926-80fe-45279bdacd79');
""2023-11-15 15:42:15.943 [Thread-732] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ffeba0b-db26-48ef-8e8d-8c6bd1891ea1 has started process logic with message_id 8706301d-d094-4197-8bcb-4c9af0172cc1 and thread_id 913
""2023-11-15 15:42:15.947 [Thread-464] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 5b116219-7bf5-423b-a09f-c9352a1f0e6f has finished process logic with message_id dfc820b9-4166-4d0a-9359-4b7ce6c83326 and thread_id 600
""2023-11-15 15:42:15.947 [Thread-464] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:15.947 [Thread-464] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id dfc820b9-4166-4d0a-9359-4b7ce6c83326
""2023-11-15 15:42:15.948 [Thread-732] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ffeba0b-db26-48ef-8e8d-8c6bd1891ea1 has finished process logic with message_id 8706301d-d094-4197-8bcb-4c9af0172cc1 and thread_id 913
""2023-11-15 15:42:15.948 [Thread-732] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:15.948 [Thread-732] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 8706301d-d094-4197-8bcb-4c9af0172cc1
""2023-11-15 15:42:15.952 [Thread-1937] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 15:42:15.953 [Thread-480] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
{ "input_data": { "batch_id": 17000625866627691, "data_movement_id": 261, "job_type_id": "1", "start_time" : "1700062592087", "end_time" : "1700062935750", "job_schedule_id": 1567 }, "sequential_templates":[ { "query_template_group": "templates/artifact_ingestion/common_templates.stg", "query_template_name": "insert_into_data_movement_pre_aggregate_stats", "query_output_key": "data_movement_pre_aggregate_stats", "query_type":"insert" }, { "query_template_group": "templates/artifact_ingestion/common_templates.stg", "query_template_name": "insert_into_data_movement_pre_aggregate_stats_archive_log", "query_output_key": "data_movement_pre_aggregate_stats_archive_log", "query_type":"insert" }, { "query_template_group": "templates/artifact_ingestion/common_templates.stg", "query_template_name": "delete_from_data_movement_pre_aggregate_stats", "query_output_key": "delete_from_data_movement_pre_aggregate_stats", "query_type":"delete" } ], "output_keys":["data_movement_pre_aggregate_stats","data_movement_pre_aggregate_stats_archive_log"] }
""2023-11-15 15:42:15.953 [Thread-1937] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:42:15.958 [Thread-1937] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:42:15.958 [Thread-1937] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 13a5eb35-8804-48e2-a685-5383b2ce92c7 has started process logic with message_id 726467cb-6792-4883-8a51-fe5741ec126a and thread_id 2370
""2023-11-15 15:42:15.964 [Thread-884] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 682cb07e-f673-40df-8366-143e857b2d74 has started processing message with message_id 3f27176c-d519-404e-bbdb-5ca32f185c4a and thread_id 1091 
""2023-11-15 15:42:15.964 [Thread-884] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:15.964 [Thread-480] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 15:42:15.964 [Thread-884] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=726467cb-6792-4883-8a51-fe5741ec126a, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=3f27176c-d519-404e-bbdb-5ca32f185c4a, task_retry_intervals_secs=[], bot_id=13a5eb35-8804-48e2-a685-5383b2ce92c7, message_topic=nabu_2_taskmonitor, tags={process_id=1700062586993189, initial_ts=1700062586993, batch_name=, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, DBOpsBot, TaskMonitorBot]}}
""2023-11-15 15:42:15.966 [Thread-480] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:42:15.972 [Thread-480] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:42:15.972 [Thread-480] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 987221e2-6a29-4685-b1e5-a76cf9dc7906 has started process logic with message_id 1adb4dfc-3574-434b-a42c-4c8ad41d7169 and thread_id 619
""2023-11-15 15:42:15.978 [Thread-1872] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id e66f3c06-216b-4861-be02-93ba09599724 has started processing message with message_id e2564ff5-4508-49b9-98a0-0e91e7edad8a and thread_id 2292 
""2023-11-15 15:42:15.978 [Thread-1872] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:15.978 [Thread-884] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 1700062586993189, 'DBOpsBot', 'get_created_credentials_details_if_exists', 'get_created_credentials_details_if_exists', 10 , TO_TIMESTAMP(1700062935927::double precision / 1000) ,'13a5eb35-8804-48e2-a685-5383b2ce92c7');
""2023-11-15 15:42:15.978 [Thread-884] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 682cb07e-f673-40df-8366-143e857b2d74 has started process logic with message_id 3f27176c-d519-404e-bbdb-5ca32f185c4a and thread_id 1091
""2023-11-15 15:42:15.978 [Thread-1872] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=1adb4dfc-3574-434b-a42c-4c8ad41d7169, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=e2564ff5-4508-49b9-98a0-0e91e7edad8a, task_retry_intervals_secs=[], bot_id=987221e2-6a29-4685-b1e5-a76cf9dc7906, message_topic=nabu_2_taskmonitor, tags={process_id=1700062586993189, initial_ts=1700062586993, batch_name=, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, DBOpsBot, TaskMonitorBot]}}
""2023-11-15 15:42:15.988 [Thread-1872] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 1700062586993189, 'DBOpsBot', 'inserting_pre_aggregate_stats', 'inserting_pre_aggregate_stats', 10 , TO_TIMESTAMP(1700062935937::double precision / 1000) ,'987221e2-6a29-4685-b1e5-a76cf9dc7906');
""2023-11-15 15:42:15.989 [Thread-1872] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id e66f3c06-216b-4861-be02-93ba09599724 has started process logic with message_id e2564ff5-4508-49b9-98a0-0e91e7edad8a and thread_id 2292
""2023-11-15 15:42:15.995 [Thread-1872] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id e66f3c06-216b-4861-be02-93ba09599724 has finished process logic with message_id e2564ff5-4508-49b9-98a0-0e91e7edad8a and thread_id 2292
""2023-11-15 15:42:15.996 [Thread-1872] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:15.996 [Thread-1872] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id e2564ff5-4508-49b9-98a0-0e91e7edad8a
""2023-11-15 15:42:16.344 [Thread-884] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 682cb07e-f673-40df-8366-143e857b2d74 has finished process logic with message_id 3f27176c-d519-404e-bbdb-5ca32f185c4a and thread_id 1091
""2023-11-15 15:42:16.344 [Thread-884] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:16.344 [Thread-884] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 3f27176c-d519-404e-bbdb-5ca32f185c4a
""2023-11-15 15:42:16.360 [Thread-480] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with dm_batchid_object_map as (
select a.data_movement_id, batch_id, object_id,process_id,  e.metadata_category, status_code_id, source_dataplace_count , start_ts,end_ts
from (
select data_movement_id, batch_id, object_id,process_id,status_code_id, start_ts,end_ts
from (
select data_movement_id, batch_id, object_id,process_id,status_code_id, row_number () over (partition by data_movement_id ,batch_id, object_id order by flow_task_ts desc) as rownum, TO_TIMESTAMP(1700062592087::double precision / 1000) as start_ts, TO_TIMESTAMP(1700062935750::double precision / 1000) as end_ts
from nabu.flow_task_status
 where batch_id = 17000625866627691 and data_movement_id = 261
) x
where rownum = 1 and status_code_id not in(30,31,38,39)) a
inner join  (select  data_movement_id, count(distinct d.source_dataplace_id) as source_dataplace_count , max(e.metadata_category) as metadata_category
from nabu.data_movement_details_physical d
			inner join nabu.dataplace_physical c on d.source_dataplace_id = c.dataplace_id and c.valid_to_ts = '9999-12-31' and d.valid_to_ts = '9999-12-31'
and data_movement_id = 261
			   inner join nabu.dataplace_component_mapping_lookup e on c.dataplace_component_type_id = e.dataplace_component_type_id
and e.dataplace_sub_component_id =  c.dataplace_sub_component_id
group by 1) e on a.data_movement_id = e.data_movement_id
),

flow_status_agg as (
select *,1 as job_type_id, case when a.failed_count = 0 and a.running_count = 0 and a.queued_count = 0  then 'Succeeded'
	        when a.failed_count > 0 and a.running_count = 0 and a.queued_count= 0 then 'Failed'
		when a.running_count > 0 or a.queued_count > 0 then 'Running' end as dm_status_code
from (
select data_movement_id,batch_id,
		count(status_code_id) as total_count,
		count(case when status_code_id in (20) then 1 end) as queued_count,
		count(case when status_code_id= 15 then 1 end)  as success_count,
		count(case when status_code_id in(16,17,18) then 1 end) as failed_count,
		count(case when status_code_id in(19) then 1 end)  as running_count,
		count(case when status_code_id in(18) then 1 end) as flow_timeout_count,
        max (source_dataplace_count) as source_dataplace_count,
	    min(start_ts) as start_ts,
        max(end_ts) as end_ts
from dm_batchid_object_map
group by data_movement_id,batch_id ) a
),

get_status_code_id as (
select a.*,
case when a.job_type_id=6 then (
case when (a.failed_count > 0 and a.running_count = 0 and a.queued_count= 0) then 13
 when a.failed_count = 0 and a.running_count = 0 and a.queued_count = 0  then 12
 when a.running_count > 0 or a.queued_count > 0 then 11 end )
 when job_type_id in (1,3,14) then(
case when ((a.failed_count > 0 and a.running_count = 0 and a.queued_count= 0) and (a.flow_timeout_count>0)) then 29
 when (a.failed_count > 0 and a.running_count = 0 and a.queued_count= 0) then 13
 when a.failed_count = 0 and a.running_count = 0 and a.queued_count = 0  then 12
 when a.running_count > 0 or a.queued_count > 0 then 11 end
)
end as status_code_id from flow_status_agg a
),
get_spark_metrics as (
select data_movement_id,process_id,object_id,inputmetrics_bytesread,inputmetrics_recordsread,outputmetrics_byteswritten,outputmetrics_recordswritten from nabu.spark_metrics sm where
data_movement_id =261 and valid_to_ts = '99991231'  and process_id in (select process_id from dm_batchid_object_map)
)
--select * from get_spark_metrics
,
table_details as (
select data_movement_id, batch_id,count(table_id) as tables_count,
coalesce(sum( case when outputmetrics_byteswritten <= 0 then table_size else outputmetrics_byteswritten end),0) as table_size_in_bytes from
(
    select a.data_movement_id, batch_id,b.table_id,outputmetrics_byteswritten,b.table_size
    from get_spark_metrics c
    left outer join dm_batchid_object_map a on a.data_movement_id =c.data_movement_id and a.object_id = c.object_id and a.process_id=c.process_id
    left outer join nabu.dataplace_table_metadata_physical b on a.object_id = b.table_id
    where  b.valid_to_ts = '9999-12-31' and b.table_type = 'T' and a.metadata_category = 'relational'
)bb
group by 1,2
)
--select * from table_details
,

view_details as (
select data_movement_id, batch_id,count(table_id) as views_count,
coalesce(sum( case when outputmetrics_byteswritten <= 0 then table_size else outputmetrics_byteswritten end),0) as view_size_in_bytes from
(
select a.data_movement_id, batch_id,b.table_id,outputmetrics_byteswritten,b.table_size
    from get_spark_metrics c
    left outer join dm_batchid_object_map a on a.data_movement_id =c.data_movement_id and a.object_id = c.object_id and a.process_id=c.process_id
    left outer join nabu.dataplace_table_metadata_physical b on a.object_id = b.table_id
    where  b.valid_to_ts = '9999-12-31' and b.table_type in ('V', 'M' )and a.metadata_category = 'relational'
)bb
group by 1, 2
),


column_details as ( select a.data_movement_id, batch_id, count(b.column_id) as columns_count
from dm_batchid_object_map a, nabu.dataplace_column_metadata_physical b
where  a.object_id = b.table_id  and b.valid_to_ts = '9999-12-31'
and a.metadata_category = 'relational'
group by 1, 2

union all

select a.data_movement_id, batch_id, count(b.column_id) as columns_count
from dm_batchid_object_map a, nabu.dataplace_semi_structured_column_metadata b
where  a.object_id = b.file_id  and b.valid_to_ts = '9999-12-31'
and a.metadata_category = 'file'
group by 1, 2
),

file_details as(
select data_movement_id, batch_id, coalesce(sum(file_objects),0) as files_count, coalesce(sum(size_in_bytes),0) as file_size_in_bytes
from (

select data_movement_id, batch_id ,coalesce(count(object_id),0) as file_objects,
coalesce(sum( case when outputmetrics_byteswritten <= 0 then size else outputmetrics_byteswritten end),0) as size_in_bytes
from
(
        select a.data_movement_id, batch_id,c.object_id,outputmetrics_byteswritten,b.size as size
        from get_spark_metrics c
        left outer join dm_batchid_object_map a on a.data_movement_id =c.data_movement_id and a.object_id = c.object_id and a.process_id=c.process_id
        left outer join nabu.dataplace_file_metadata b on a.object_id = b.file_id
        where  b.dataplace_component_type_id in (2,3) and a.metadata_category in ( 'file' ) and b.valid_to_ts = '9999-12-31'
)bb
group by data_movement_id, batch_id
union all

select data_movement_id, batch_id ,coalesce(count(object_id),0) as file_objects,
coalesce(sum( case when outputmetrics_byteswritten <= 0 then size else outputmetrics_byteswritten end),0) as size_in_bytes
from
(
        select a.data_movement_id, batch_id,c.object_id,outputmetrics_byteswritten,b.file_size as size
        from get_spark_metrics c
        left outer join dm_batchid_object_map a on a.data_movement_id =c.data_movement_id and a.object_id = c.object_id and a.process_id=c.process_id
        left outer join nabu.dataplace_file_sharepoint_metadata b on a.object_id = b.file_id
        where  b.dataplace_component_type_id in (2,3) and a.metadata_category in ( 'sharepoint' ) and b.valid_to_ts = '9999-12-31'
)bb
group by data_movement_id, batch_id
union all

select data_movement_id, batch_id ,coalesce(count(object_id),0) as file_objects,
coalesce(sum( case when outputmetrics_byteswritten <= 0 then size else outputmetrics_byteswritten end),0) as size_in_bytes
from
(
        select a.data_movement_id, batch_id,c.object_id,outputmetrics_byteswritten,b.file_size as size
        from get_spark_metrics c
        left outer join dm_batchid_object_map a on a.data_movement_id =c.data_movement_id and a.object_id = c.object_id and a.process_id=c.process_id
        left outer join nabu.dataplace_file_documentum_metadata b on a.object_id = b.file_id
        where  b.dataplace_component_type_id in (2,3) and a.metadata_category in ( 'documentum' ) and b.valid_to_ts = '9999-12-31'
)bb
group by data_movement_id, batch_id
union all

select data_movement_id, batch_id ,coalesce(count(object_id),0) as file_objects,
coalesce(sum( case when outputmetrics_byteswritten <= 0 then size else outputmetrics_byteswritten end),0) as size_in_bytes
from
(
        select a.data_movement_id, batch_id,c.object_id,outputmetrics_byteswritten,b.file_size as size
        from get_spark_metrics c
        left outer join dm_batchid_object_map a on a.data_movement_id =c.data_movement_id and a.object_id = c.object_id and a.process_id=c.process_id
        left outer join nabu.dataplace_file_drive_metadata b on a.object_id = b.file_id
        where  b.dataplace_component_type_id in (2,3) and a.metadata_category in ( 'file' ) and b.valid_to_ts = '9999-12-31'
)bb
group by data_movement_id, batch_id


) x

group by data_movement_id, batch_id
)
,collection_details as(
select a.data_movement_id , batch_id, coalesce(sum(cm.collection_size),0) as estimated_size_collections,
count( cm.collection_id) as collections_count
from dm_batchid_object_map a
inner join nabu.dataplace_collection_metadata cm on a.object_id = cm.collection_id and cm.valid_to_ts = '9999-12-31'
and a.metadata_category in ( 'collection' )
group by a.data_movement_id , batch_id
)

,field_details as(
select a.data_movement_id , batch_id, coalesce (count(c.field_id),0) as fields_count
from dm_batchid_object_map a
inner join nabu.dataplace_collection_field_metadata c on a.object_id = c.collection_id and c.valid_to_ts = '9999-12-31'
and a.metadata_category in ( 'collection' )
group by a.data_movement_id , batch_id
)

INSERT INTO nabu_ui.data_movement_pre_aggregate_stats
(data_movement_id, batch_id, job_type_id, total_count, success_count, failed_count, source_dataplace_count, tables_count, views_count, collections_count, files_count, columns_count, fields_count, objects_size, dm_status_code, start_ts, end_ts, crt_ts,status_code_id,job_schedule_id)

select  a.data_movement_id, a.batch_id,1 as job_type_id, coalesce(a.total_count,0) as total_count, coalesce(a.success_count,0) as success_count, coalesce(a.failed_count,0) as failed_count, coalesce(a.source_dataplace_count,0) as source_dataplace_count, coalesce(b.tables_count,0) as tables_count, coalesce(c.views_count,0) as views_count, coalesce(d.collections_count,0) as collections_count, coalesce(e.files_count,0) as files_count, coalesce(f.columns_count,0) as columns_count, coalesce(g.fields_count,0) as fields_count,
 coalesce(estimated_size_collections,0) + coalesce(file_size_in_bytes,0) + coalesce(table_size_in_bytes,0) + coalesce(view_size_in_bytes,0) as objects_size,
a.dm_status_code, a.start_ts, a.end_ts, current_timestamp as crt_ts, i.status_code_id,1567 as job_schedule_id
from flow_status_agg a left outer join table_details b on a.data_movement_id = b.data_movement_id and a.batch_id = b.batch_id
left outer join view_details c on a.data_movement_id = c.data_movement_id and a.batch_id = c.batch_id
left outer join collection_details d on a.data_movement_id = d.data_movement_id and a.batch_id = d.batch_id
left outer join file_details e on a.data_movement_id = e.data_movement_id and a.batch_id = e.batch_id
left outer join column_details f on a.data_movement_id = f.data_movement_id and a.batch_id = f.batch_id
left outer join get_status_code_id i on i.data_movement_id=a.data_movement_id  and i.batch_id = a.batch_id
left outer join field_details g on a.data_movement_id = g.data_movement_id and a.batch_id = g.batch_id

""2023-11-15 15:42:16.752 [Thread-480] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : 
with dm_batchid_object_map as (
select a.data_movement_id, batch_id, object_id,process_id,  e.metadata_category, status_code_id, source_dataplace_count , start_ts,end_ts
from (
select data_movement_id, batch_id, object_id,process_id,status_code_id, start_ts,end_ts
from (
select data_movement_id, batch_id, object_id,process_id,status_code_id, row_number () over (partition by data_movement_id ,batch_id, object_id order by flow_task_ts desc) as rownum, TO_TIMESTAMP(1700062592087::double precision / 1000) as start_ts, TO_TIMESTAMP(1700062935750::double precision / 1000) as end_ts
from nabu.flow_task_status
where batch_id = 17000625866627691 and data_movement_id = 261
) x
where rownum = 1 and status_code_id not in(30,31,38,39) ) a
inner join  (select  data_movement_id, count(distinct d.source_dataplace_id) as source_dataplace_count , max(e.metadata_category) as metadata_category
from nabu.data_movement_details_physical d
			inner join nabu.dataplace_physical c on d.source_dataplace_id = c.dataplace_id and c.valid_to_ts = '9999-12-31' and d.valid_to_ts = '9999-12-31'
and data_movement_id = 261
			   inner join nabu.dataplace_component_mapping_lookup e on c.dataplace_component_type_id = e.dataplace_component_type_id
and e.dataplace_sub_component_id =  c.dataplace_sub_component_id
group by 1) e on a.data_movement_id = e.data_movement_id
),

flow_status_agg as (
select *,1 as job_type_id, case when a.failed_count = 0 and a.running_count = 0 and a.queued_count = 0  then 'Succeeded'
	        when a.failed_count > 0 and a.running_count = 0 and a.queued_count= 0 then 'Failed'
		when a.running_count > 0 or a.queued_count > 0 then 'Running' end as dm_status_code
from (
select data_movement_id,batch_id,
		count(status_code_id) as total_count,
		count(case when status_code_id in (20) then 1 end) as queued_count,
		count(case when status_code_id= 15 then 1 end)  as success_count,
		count(case when status_code_id in(16,17,18) then 1 end) as failed_count,
		count(case when status_code_id in(19) then 1 end)  as running_count,
		count(case when status_code_id in(18) then 1 end) as flow_timeout_count,
        max (source_dataplace_count) as source_dataplace_count,
	    min(start_ts) as start_ts,
        max(end_ts) as end_ts
from dm_batchid_object_map
group by data_movement_id,batch_id ) a
),

get_status_code_id as (
select a.*,
case when a.job_type_id=6 then (
case when (a.failed_count > 0 and a.running_count = 0 and a.queued_count= 0) then 13
 when a.failed_count = 0 and a.running_count = 0 and a.queued_count = 0  then 12
 when a.running_count > 0 or a.queued_count > 0 then 11 end )
 when job_type_id in (1,3,14) then(
case when ((a.failed_count > 0 and a.running_count = 0 and a.queued_count= 0) and (a.flow_timeout_count>0)) then 29
 when (a.failed_count > 0 and a.running_count = 0 and a.queued_count= 0) then 13
 when a.failed_count = 0 and a.running_count = 0 and a.queued_count = 0  then 12
 when a.running_count > 0 or a.queued_count > 0 then 11 end
)
end as status_code_id from flow_status_agg a
),
get_spark_metrics as (
select data_movement_id,process_id,object_id,inputmetrics_bytesread,inputmetrics_recordsread,outputmetrics_byteswritten,outputmetrics_recordswritten from nabu.spark_metrics sm where
data_movement_id =261 and valid_to_ts = '99991231'  and process_id in (select process_id from dm_batchid_object_map)
)
--select * from get_spark_metrics
,
table_details as (
select data_movement_id, batch_id,count(table_id) as tables_count,
coalesce(sum( case when outputmetrics_byteswritten <= 0 then table_size else outputmetrics_byteswritten end),0) as table_size_in_bytes from
(
    select a.data_movement_id, batch_id,b.table_id,outputmetrics_byteswritten,b.table_size
    from get_spark_metrics c
    left outer join dm_batchid_object_map a on a.data_movement_id =c.data_movement_id and a.object_id = c.object_id and a.process_id=c.process_id
    left outer join nabu.dataplace_table_metadata_physical b on a.object_id = b.table_id
    where  b.valid_to_ts = '9999-12-31' and b.table_type = 'T' and a.metadata_category = 'relational'
)bb
group by 1,2
)
--select * from table_details
,

view_details as (
select data_movement_id, batch_id,count(table_id) as views_count,
coalesce(sum( case when outputmetrics_byteswritten <= 0 then table_size else outputmetrics_byteswritten end),0) as view_size_in_bytes from
(
select a.data_movement_id, batch_id,b.table_id,outputmetrics_byteswritten,b.table_size
    from get_spark_metrics c
    left outer join dm_batchid_object_map a on a.data_movement_id =c.data_movement_id and a.object_id = c.object_id and a.process_id=c.process_id
    left outer join nabu.dataplace_table_metadata_physical b on a.object_id = b.table_id
    where  b.valid_to_ts = '9999-12-31' and b.table_type in ('V', 'M' )and a.metadata_category = 'relational'
)bb
group by 1, 2 ),


column_details as ( select a.data_movement_id, batch_id, count(b.column_id) as columns_count
from dm_batchid_object_map a, nabu.dataplace_column_metadata_physical b
where  a.object_id = b.table_id  and b.valid_to_ts = '9999-12-31'
and a.metadata_category = 'relational'
group by 1, 2

union all

select a.data_movement_id, batch_id, count(b.column_id) as columns_count
from dm_batchid_object_map a, nabu.dataplace_semi_structured_column_metadata b
where  a.object_id = b.file_id  and b.valid_to_ts = '9999-12-31'
and a.metadata_category = 'file'
group by 1, 2
),

file_details as(
select data_movement_id, batch_id, coalesce(sum(file_objects),0) as files_count, coalesce(sum(size_in_bytes),0) as file_size_in_bytes
from (

select data_movement_id, batch_id ,coalesce(count(object_id),0) as file_objects,
coalesce(sum( case when outputmetrics_byteswritten <= 0 then size else outputmetrics_byteswritten end),0) as size_in_bytes
from
(
        select a.data_movement_id, batch_id,c.object_id,outputmetrics_byteswritten,b.size as size
        from get_spark_metrics c
        left outer join dm_batchid_object_map a on a.data_movement_id =c.data_movement_id and a.object_id = c.object_id and a.process_id=c.process_id
        left outer join nabu.dataplace_file_metadata b on a.object_id = b.file_id
        where  b.dataplace_component_type_id in (2,3) and a.metadata_category in ( 'file' ) and b.valid_to_ts = '9999-12-31'
)bb
group by data_movement_id, batch_id
union all

select data_movement_id, batch_id ,coalesce(count(object_id),0) as file_objects,
coalesce(sum( case when outputmetrics_byteswritten <= 0 then size else outputmetrics_byteswritten end),0) as size_in_bytes
from
(
        select a.data_movement_id, batch_id,c.object_id,outputmetrics_byteswritten,b.file_size as size
        from get_spark_metrics c
        left outer join dm_batchid_object_map a on a.data_movement_id =c.data_movement_id and a.object_id = c.object_id and a.process_id=c.process_id
        left outer join nabu.dataplace_file_sharepoint_metadata b on a.object_id = b.file_id
        where  b.dataplace_component_type_id in (2,3) and a.metadata_category in ( 'sharepoint' ) and b.valid_to_ts = '9999-12-31'
)bb
group by data_movement_id, batch_id
union all

select data_movement_id, batch_id ,coalesce(count(object_id),0) as file_objects,
coalesce(sum( case when outputmetrics_byteswritten <= 0 then size else outputmetrics_byteswritten end),0) as size_in_bytes
from
(
        select a.data_movement_id, batch_id,c.object_id,outputmetrics_byteswritten,b.file_size as size
        from get_spark_metrics c
        left outer join dm_batchid_object_map a on a.data_movement_id =c.data_movement_id and a.object_id = c.object_id and a.process_id=c.process_id
        left outer join nabu.dataplace_file_documentum_metadata b on a.object_id = b.file_id
        where  b.dataplace_component_type_id in (2,3) and a.metadata_category in ( 'documentum' ) and b.valid_to_ts = '9999-12-31'
)bb
group by data_movement_id, batch_id
union all

select data_movement_id, batch_id ,coalesce(count(object_id),0) as file_objects,
coalesce(sum( case when outputmetrics_byteswritten <= 0 then size else outputmetrics_byteswritten end),0) as size_in_bytes
from
(
        select a.data_movement_id, batch_id,c.object_id,outputmetrics_byteswritten,b.file_size as size
        from get_spark_metrics c
        left outer join dm_batchid_object_map a on a.data_movement_id =c.data_movement_id and a.object_id = c.object_id and a.process_id=c.process_id
        left outer join nabu.dataplace_file_drive_metadata b on a.object_id = b.file_id
        where  b.dataplace_component_type_id in (2,3) and a.metadata_category in ( 'file' ) and b.valid_to_ts = '9999-12-31'
)bb
group by data_movement_id, batch_id


) x

group by data_movement_id, batch_id
)
,collection_details as(
select a.data_movement_id , batch_id, coalesce(sum(cm.collection_size),0) as estimated_size_collections,
count( cm.collection_id) as collections_count
from dm_batchid_object_map a
inner join nabu.dataplace_collection_metadata cm on a.object_id = cm.collection_id and cm.valid_to_ts = '9999-12-31'
and a.metadata_category in ( 'collection' )
group by a.data_movement_id , batch_id
)

,field_details as(
select a.data_movement_id , batch_id, coalesce (count(c.field_id),0) as fields_count
from dm_batchid_object_map a
inner join nabu.dataplace_collection_field_metadata c on a.object_id = c.collection_id and c.valid_to_ts = '9999-12-31'
and a.metadata_category in ( 'collection' )
group by a.data_movement_id , batch_id
)

INSERT INTO nabu_ui.data_movement_pre_aggregate_stats_archive_log
(data_movement_id, batch_id, job_type_id, total_count, success_count, failed_count, source_dataplace_count, tables_count, views_count, collections_count, files_count, columns_count, fields_count, objects_size, dm_status_code, start_ts, end_ts, crt_ts,status_code_id,job_schedule_id)

select  a.data_movement_id, a.batch_id, 1 as job_type_id, coalesce(a.total_count,0) as total_count, coalesce(a.success_count,0) as success_count, coalesce(a.failed_count,0) as failed_count, coalesce(a.source_dataplace_count,0) as source_dataplace_count, coalesce(b.tables_count,0) as tables_count, coalesce(c.views_count,0) as views_count, coalesce(d.collections_count,0) as collections_count, coalesce(e.files_count,0) as files_count, coalesce(f.columns_count,0) as columns_count, coalesce(g.fields_count,0) as fields_count,
 coalesce(estimated_size_collections,0) + coalesce(file_size_in_bytes,0) + coalesce(table_size_in_bytes,0) + coalesce(view_size_in_bytes,0) as objects_size,
a.dm_status_code, a.start_ts, a.end_ts, current_timestamp as crt_ts, i.status_code_id,1567 as job_schedule_id
from flow_status_agg a left outer join table_details b on a.data_movement_id = b.data_movement_id and a.batch_id = b.batch_id
left outer join view_details c on a.data_movement_id = c.data_movement_id and a.batch_id = c.batch_id
left outer join collection_details d on a.data_movement_id = d.data_movement_id and a.batch_id = d.batch_id
left outer join file_details e on a.data_movement_id = e.data_movement_id and a.batch_id = e.batch_id
left outer join column_details f on a.data_movement_id = f.data_movement_id and a.batch_id = f.batch_id
left outer join get_status_code_id i on i.data_movement_id=a.data_movement_id  and i.batch_id = a.batch_id
left outer join field_details g on a.data_movement_id = g.data_movement_id and a.batch_id = g.batch_id
""2023-11-15 15:42:16.782 [Thread-480] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with rows_to_be_deleted as
(
select *
from ( select data_movement_id , batch_id, start_ts, row_number() over (partition by data_movement_id order by start_ts desc) as rownum
from (
select data_movement_id , batch_id , max(start_ts) as start_ts
from nabu_ui.data_movement_pre_aggregate_stats
where data_movement_id = 261
group by 1,2 )x
) A
where rownum >10
)

delete from nabu_ui.data_movement_pre_aggregate_stats
where (data_movement_id, batch_id)
in (select data_movement_id, batch_id from rows_to_be_deleted)
""2023-11-15 15:42:16.788 [Thread-480] DEBUG com.modak.bots.DBOpsBot - to execute query timeTakenInMillis : 816
""2023-11-15 15:42:16.788 [Thread-480] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 987221e2-6a29-4685-b1e5-a76cf9dc7906 has finished process logic with message_id 1adb4dfc-3574-434b-a42c-4c8ad41d7169 and thread_id 619
""2023-11-15 15:42:16.788 [Thread-480] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-15 15:42:16.799 [Thread-480] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "dbc30158-a31b-49f1-aa3c-46818fdc0957", "parent_id": "1adb4dfc-3574-434b-a42c-4c8ad41d7169", "bot_id": "987221e2-6a29-4685-b1e5-a76cf9dc7906", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":1700062586993189, "initial_ts":1700062586993, "batch_id":17000625866627691, "batch_name":"", "job_schedule_id":1567, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "DBOpsBot", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"987221e2-6a29-4685-b1e5-a76cf9dc7906", "bot_name":"DBOpsBot", "process_context":"inserting_pre_aggregate_stats", "task_name":"inserting_pre_aggregate_stats", "process_id":"1700062586993189", "task_ts":1700062936788, "batch_id":"17000625866627691", "status_code_id": 6 } } ] }
""2023-11-15 15:42:16.801 [Thread-480] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:42:16.804 [Thread-480] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:42:16.804 [Thread-480] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:16.804 [Thread-480] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot finished processing message with id 1adb4dfc-3574-434b-a42c-4c8ad41d7169
""2023-11-15 15:42:16.808 [Thread-1917] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 9c1b84c0-e72f-4d2f-aa41-18918c5cc04b has started processing message with message_id dbc30158-a31b-49f1-aa3c-46818fdc0957 and thread_id 2344 
""2023-11-15 15:42:16.809 [Thread-1917] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:16.809 [Thread-1917] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=1adb4dfc-3574-434b-a42c-4c8ad41d7169, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=dbc30158-a31b-49f1-aa3c-46818fdc0957, task_retry_intervals_secs=[], bot_id=987221e2-6a29-4685-b1e5-a76cf9dc7906, message_topic=nabu_2_taskmonitor, tags={process_id=1700062586993189, initial_ts=1700062586993, batch_name=, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, DBOpsBot, TaskMonitorBot]}}
""2023-11-15 15:42:16.819 [Thread-1917] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 1700062586993189, 'DBOpsBot', 'inserting_pre_aggregate_stats', 'inserting_pre_aggregate_stats', 6 , TO_TIMESTAMP(1700062936788::double precision / 1000) ,'987221e2-6a29-4685-b1e5-a76cf9dc7906');
""2023-11-15 15:42:16.819 [Thread-1917] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 9c1b84c0-e72f-4d2f-aa41-18918c5cc04b has started process logic with message_id dbc30158-a31b-49f1-aa3c-46818fdc0957 and thread_id 2344
""2023-11-15 15:42:16.824 [Thread-1917] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 9c1b84c0-e72f-4d2f-aa41-18918c5cc04b has finished process logic with message_id dbc30158-a31b-49f1-aa3c-46818fdc0957 and thread_id 2344
""2023-11-15 15:42:16.824 [Thread-1917] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:16.824 [Thread-1917] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id dbc30158-a31b-49f1-aa3c-46818fdc0957
""2023-11-15 15:42:17.010 [Thread-1937] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select
case when ce.valid_to_ts = '9999-12-31' then true else false
end as is_valid_compute_engine
from nabu.data_movement_physical dmp
left outer join nabu.compute_engine ce
on dmp.compute_engine_id = ce.compute_engine_id
where dmp.data_movement_id = 261
and dmp.valid_to_ts ='9999-12-31'
""2023-11-15 15:42:17.481 [Thread-1937] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with fetch_ssh_configuration as (
select  case when c.config_json->>'hostname' = '' or c.config_json->>'hostname' is null then 'null' else c.config_json->>'hostname' end as ssh_host,
        case when c.config_json->>'username' = '' or c.config_json->>'username' is null then 'null' else c.config_json->>'username' end as ssh_username,
       case when b.compute_engine_info->>'nabu_external_path'= '' or b.compute_engine_info->>'nabu_external_path' is null  then 'null' else b.compute_engine_info->>'nabu_external_path' end as spark_location,
        c.config_json->>'kerberos' as kerberos,
        a.data_movement_id , b.engine_mapping_id,b.compute_engine_info
      from nabu.data_movement_physical a
inner join nabu.compute_engine b on a.compute_engine_id = b.compute_engine_id
inner join nabu.config c on  b.compute_engine_config_id = c.config_id
where a.data_movement_id =261
)
select ssh_host,ssh_username,kerberos::boolean,d.spark_location,
case when engine_sub_type ~*'cdh|cdp' and kerberos ='false'
          then additional_properties ->> 'non_kerberos_sub_engine_path'
          else additional_properties ->> 'default_sub_engine_path' end as engine_path,replace(encode(compute_engine_info::text::bytea,'base64'),E'\n','') as compute_engine_info,
case when engine_sub_type ~*'cdh|cdp|insight|standalone' then spark_location||'/nabu-spark-bots/keys/privateKey'
     when engine_sub_type ~*'cde' then '/app/mount/privateKey'
     when engine_sub_type ~*'dataproc|glue|databricks' then 'privateKey'
     else null
     end as private_key_path
from fetch_ssh_configuration d
inner join nabu.engine_mapping_lookup e on d.engine_mapping_id = e.engine_mapping_id
inner join nabu.engine_sub_type_lookup f on f.engine_sub_type_id = e.engine_sub_type_id
""2023-11-15 15:42:17.500 [Thread-1937] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select '1567_261_17000625866627691' as file_path
""2023-11-15 15:42:17.517 [Thread-1937] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select * from nabu.job_type_lookup jtl where job_type_id =1 and job_type ~*'ingestion'
""2023-11-15 15:42:17.521 [Thread-1937] DEBUG com.modak.bots.DBOpsBot - to execute query timeTakenInMillis : 1562
""2023-11-15 15:42:17.521 [Thread-1937] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 13a5eb35-8804-48e2-a685-5383b2ce92c7 has finished process logic with message_id 726467cb-6792-4883-8a51-fe5741ec126a and thread_id 2370
""2023-11-15 15:42:17.521 [Thread-1937] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : true
""2023-11-15 15:42:17.521 [Thread-1937] INFO  com.modak.bots.basebot.AbstractBaseBot -  skipBotLogic == false && useIncomingData == true ..,so both inputData map and botLogic output map is send as output message
""2023-11-15 15:42:17.521 [Thread-1937] INFO  com.modak.bots.basebot.AbstractBaseBot - botLogicOutput : { "check_compute_engine_validity" : [ { "is_valid_compute_engine" : true } ], "get_worlflow_type" : [ { "job_type_id" : 1, "job_type" : "ingestion", "job_description" : "This is an Ingestion Job" } ], "fetching_credential_inputs" : [ { "file_path" : "1567_261_17000625866627691" } ], "fetching_script_inputs" : [ { "ssh_host" : "null", "ssh_username" : "null", "kerberos" : null, "spark_location" : "null", "engine_path" : "azure_databricks", "compute_engine_info" : "ewoiY2x1c3Rlcl9pZCI6IjA5MjItMDAzMTM4LW9ybjlyMHRlIiwic3BhcmtfdmVyc2lvbl92YWx1ZSI6IjNfMSIsInNjYWxhX3ZlcnNpb25fdmFsdWUiOiIyXzEyIiwiY3JlZGVudGlhbHNfZmlsZXBhdGgiOiIiLCJjbHVzdGVyX2xpYnJhcnlfcGF0aCI6Ii9kYmZzL3RtcCIsInNwYXJrX3ZlcnNpb24iOiIzLjEiLCJzY2FsYV92ZXJzaW9uIjoiMi4xMiIKfQ==", "private_key_path" : "privateKey" } ] }
""2023-11-15 15:42:17.553 [Thread-1937] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "ScriptBot", "bot_metadata": { "message_id": "ca62a3fb-2b19-4517-afeb-34acef1d996c", "parent_id": "726467cb-6792-4883-8a51-fe5741ec126a", "bot_id": "13a5eb35-8804-48e2-a685-5383b2ce92c7", "message_topic":"nabu_2_scriptbot", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":1700062586993189, "initial_ts":1700062586993, "batch_id":17000625866627691, "batch_name":"", "job_schedule_id":1567, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "DBOpsBot", "ScriptBot" ]}, "message_context": "delete_filecontent_credentials", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "delete_filecontent_credentials", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "pre_task_logging_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "pre_log_template" }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "command_to_delete_credentials" }, "input_data": { "is_valid_compute_engine":true, "data":{ "query_input" : { "start_time" : 1700062592087, "batch_id" : "17000625866627691", "job_schedule_id" : "1567", "datastore_id" : null, "data_movement_id" : "261", "end_time" : 1700062935750, "job_type_id" : 1, "is_flow_timed_out" : false, "metadata_category" : null }, "botLogicOutputMap" : { "check_compute_engine_validity" : [ { "is_valid_compute_engine" : true } ], "get_worlflow_type" : [ { "job_type" : "ingestion", "job_description" : "This is an Ingestion Job", "job_type_id" : 1 } ], "fetching_credential_inputs" : [ { "file_path" : "1567_261_17000625866627691" } ], "fetching_script_inputs" : [ { "engine_path" : "azure_databricks", "ssh_username" : "null", "spark_location" : "null", "ssh_host" : "null", "kerberos" : null, "compute_engine_info" : "ewoiY2x1c3Rlcl9pZCI6IjA5MjItMDAzMTM4LW9ybjlyMHRlIiwic3BhcmtfdmVyc2lvbl92YWx1ZSI6IjNfMSIsInNjYWxhX3ZlcnNpb25fdmFsdWUiOiIyXzEyIiwiY3JlZGVudGlhbHNfZmlsZXBhdGgiOiIiLCJjbHVzdGVyX2xpYnJhcnlfcGF0aCI6Ii9kYmZzL3RtcCIsInNwYXJrX3ZlcnNpb24iOiIzLjEiLCJzY2FsYV92ZXJzaW9uIjoiMi4xMiIKfQ==", "private_key_path" : "privateKey" } ] }, "batch_id" : "17000625866627691", "template_execution_type" : "sequential", "useTransactionControl" : true, "currentBotMessageMap" : { "parent_id" : "726467cb-6792-4883-8a51-fe5741ec126a", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "message_context" : "get_created_credentials_details_if_exists", "message_id" : "726467cb-6792-4883-8a51-fe5741ec126a", "task_retry_intervals_secs" : [], "bot_id" : "d6a03616-281f-4a28-9811-52d565f7ccd1", "message_topic" : "nabu_2_jdbc", "tags" : { "process_id" : 1700062586993189, "initial_ts" : 1700062586993, "batch_name" : "", "environment" : "modak", "batch_id" : 17000625866627691, "job_schedule_id" : 1567, "data_movement_id" : 261, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "last_run_timestamp" : "", "retry_attempt" : 0, "ignore_job_termination" : true, "tags" : [ "AuthToken", "DBOpsBot", "DBOpsBot", "DBOpsBot" ] } } }, "batch_id": 17000625866627691, "file_path":"1567_261_17000625866627691", "ssh_host":"null", "ssh_username":"null", "spark_location":"null", "compute_engine_info":"ewoiY2x1c3Rlcl9pZCI6IjA5MjItMDAzMTM4LW9ybjlyMHRlIiwic3BhcmtfdmVyc2lvbl92YWx1ZSI6IjNfMSIsInNjYWxhX3ZlcnNpb25fdmFsdWUiOiIyXzEyIiwiY3JlZGVudGlhbHNfZmlsZXBhdGgiOiIiLCJjbHVzdGVyX2xpYnJhcnlfcGF0aCI6Ii9kYmZzL3RtcCIsInNwYXJrX3ZlcnNpb24iOiIzLjEiLCJzY2FsYV92ZXJzaW9uIjoiMi4xMiIKfQ==", "engine_path":"azure_databricks" }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "task_status_success_msg" } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "error_template_create_msg" } ] } , { "task_name": "delete_ondemandbot_credentials", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "pre_task_logging_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "pre_log_template" }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "command_to_delete_ondemand_credentials" }, "input_data": { "is_valid_compute_engine":true , "data":{ "query_input" : { "start_time" : 1700062592087, "batch_id" : "17000625866627691", "job_schedule_id" : "1567", "datastore_id" : null, "data_movement_id" : "261", "end_time" : 1700062935750, "job_type_id" : 1, "is_flow_timed_out" : false, "metadata_category" : null }, "botLogicOutputMap" : { "check_compute_engine_validity" : [ { "is_valid_compute_engine" : true } ], "get_worlflow_type" : [ { "job_type" : "ingestion", "job_description" : "This is an Ingestion Job", "job_type_id" : 1 } ], "fetching_credential_inputs" : [ { "file_path" : "1567_261_17000625866627691" } ], "fetching_script_inputs" : [ { "engine_path" : "azure_databricks", "ssh_username" : "null", "spark_location" : "null", "ssh_host" : "null", "kerberos" : null, "compute_engine_info" : "ewoiY2x1c3Rlcl9pZCI6IjA5MjItMDAzMTM4LW9ybjlyMHRlIiwic3BhcmtfdmVyc2lvbl92YWx1ZSI6IjNfMSIsInNjYWxhX3ZlcnNpb25fdmFsdWUiOiIyXzEyIiwiY3JlZGVudGlhbHNfZmlsZXBhdGgiOiIiLCJjbHVzdGVyX2xpYnJhcnlfcGF0aCI6Ii9kYmZzL3RtcCIsInNwYXJrX3ZlcnNpb24iOiIzLjEiLCJzY2FsYV92ZXJzaW9uIjoiMi4xMiIKfQ==", "private_key_path" : "privateKey" } ] }, "batch_id" : "17000625866627691", "template_execution_type" : "sequential", "useTransactionControl" : true, "currentBotMessageMap" : { "parent_id" : "726467cb-6792-4883-8a51-fe5741ec126a", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "message_context" : "get_created_credentials_details_if_exists", "message_id" : "726467cb-6792-4883-8a51-fe5741ec126a", "task_retry_intervals_secs" : [], "bot_id" : "d6a03616-281f-4a28-9811-52d565f7ccd1", "message_topic" : "nabu_2_jdbc", "tags" : { "process_id" : 1700062586993189, "initial_ts" : 1700062586993, "batch_name" : "", "environment" : "modak", "batch_id" : 17000625866627691, "job_schedule_id" : 1567, "data_movement_id" : 261, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "last_run_timestamp" : "", "retry_attempt" : 0, "ignore_job_termination" : true, "tags" : [ "AuthToken", "DBOpsBot", "DBOpsBot", "DBOpsBot" ] } } }, "file_path":"1567_261_17000625866627691", "ssh_host":"null", "ssh_username":"null", "spark_location":"null", "compute_engine_info":"ewoiY2x1c3Rlcl9pZCI6IjA5MjItMDAzMTM4LW9ybjlyMHRlIiwic3BhcmtfdmVyc2lvbl92YWx1ZSI6IjNfMSIsInNjYWxhX3ZlcnNpb25fdmFsdWUiOiIyXzEyIiwiY3JlZGVudGlhbHNfZmlsZXBhdGgiOiIiLCJjbHVzdGVyX2xpYnJhcnlfcGF0aCI6Ii9kYmZzL3RtcCIsInNwYXJrX3ZlcnNpb24iOiIzLjEiLCJzY2FsYV92ZXJzaW9uIjoiMi4xMiIKfQ==", "engine_path":"azure_databricks" }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "task_status_success_msg" } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "error_template_create_msg" } ] } ] }
""2023-11-15 15:42:17.557 [Thread-1937] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_scriptbot
""2023-11-15 15:42:17.561 [Thread-1937] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_scriptbot
""2023-11-15 15:42:17.561 [Thread-1937] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:17.561 [Thread-1937] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot finished processing message with id 726467cb-6792-4883-8a51-fe5741ec126a
""2023-11-15 15:42:17.698 [Thread-1809] INFO  com.modak.bots.basebot.AbstractBaseBot - ScriptBot with bot_id 005544f2-f744-4f87-be8f-5fd98be21d44 has started processing message with message_id ca62a3fb-2b19-4517-afeb-34acef1d996c and thread_id 2218 
""2023-11-15 15:42:17.698 [Thread-1809] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:17.698 [Thread-1809] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=726467cb-6792-4883-8a51-fe5741ec126a, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=delete_filecontent_credentials, message_id=ca62a3fb-2b19-4517-afeb-34acef1d996c, task_retry_intervals_secs=[], bot_id=13a5eb35-8804-48e2-a685-5383b2ce92c7, message_topic=nabu_2_scriptbot, tags={process_id=1700062586993189, initial_ts=1700062586993, batch_name=, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, DBOpsBot, ScriptBot]}}
""2023-11-15 15:42:17.727 [Thread-1809] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
["sh","-l","-c","$NABU_ROOT_INSTALLATION/botworks/scripts/deleteCredentials.sh null null azure_databricks null 1567_261_17000625866627691"]
""2023-11-15 15:42:17.741 [Thread-1809] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 15:42:17.742 [Thread-1809] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:42:17.750 [Thread-732] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ffeba0b-db26-48ef-8e8d-8c6bd1891ea1 has started processing message with message_id b08bdbfa-d0b3-41e2-be12-8f0f55652f9b and thread_id 913 
""2023-11-15 15:42:17.750 [Thread-732] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:17.750 [Thread-732] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=ca62a3fb-2b19-4517-afeb-34acef1d996c, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=b08bdbfa-d0b3-41e2-be12-8f0f55652f9b, task_retry_intervals_secs=[], bot_id=005544f2-f744-4f87-be8f-5fd98be21d44, message_topic=nabu_2_taskmonitor, tags={process_id=1700062586993189, initial_ts=1700062586993, batch_name=, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, DBOpsBot, ScriptBot, TaskMonitorBot]}}
""2023-11-15 15:42:17.762 [Thread-732] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 1700062586993189, 'ScriptBot', 'delete_filecontent_credentials', 'delete_filecontent_credentials', 10 , TO_TIMESTAMP(1700062937698::double precision / 1000) ,'005544f2-f744-4f87-be8f-5fd98be21d44');
""2023-11-15 15:42:17.763 [Thread-732] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ffeba0b-db26-48ef-8e8d-8c6bd1891ea1 has started process logic with message_id b08bdbfa-d0b3-41e2-be12-8f0f55652f9b and thread_id 913
""2023-11-15 15:42:17.763 [Thread-1809] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:42:17.763 [Thread-1809] INFO  com.modak.bots.basebot.AbstractBaseBot - ScriptBot with bot_id 005544f2-f744-4f87-be8f-5fd98be21d44 has started process logic with message_id ca62a3fb-2b19-4517-afeb-34acef1d996c and thread_id 2218
""2023-11-15 15:42:17.763 [Thread-1809] INFO  ScriptBot - templateProcessedOutput : ["sh","-l","-c","$NABU_ROOT_INSTALLATION/botworks/scripts/deleteCredentials.sh null null azure_databricks null 1567_261_17000625866627691"]
""2023-11-15 15:42:17.764 [Thread-1809] DEBUG ScriptBot - command to be executed  [sh, -l, -c, $NABU_ROOT_INSTALLATION/botworks/scripts/deleteCredentials.sh null null azure_databricks null 1567_261_17000625866627691]
""2023-11-15 15:42:17.767 [Thread-732] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ffeba0b-db26-48ef-8e8d-8c6bd1891ea1 has finished process logic with message_id b08bdbfa-d0b3-41e2-be12-8f0f55652f9b and thread_id 913
""2023-11-15 15:42:17.767 [Thread-732] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:17.767 [Thread-732] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id b08bdbfa-d0b3-41e2-be12-8f0f55652f9b
""2023-11-15 15:42:17.810 [Thread-1809] DEBUG ScriptBot - spark engine is azure_databricks
""2023-11-15 15:42:18.114 [Thread-1809] DEBUG ScriptBot - [2023-11-15 15:42:18,113] 	 INFO:Deleted /opt/nabu/nabu-spark-bots/azure_databricks/creds/1567_261_17000625866627691 directory successfully
""2023-11-15 15:42:18.156 [Thread-1809] INFO  ScriptBot -  exit status : 0
""2023-11-15 15:42:18.156 [Thread-1809] INFO  ScriptBot - Script executed successfully
""2023-11-15 15:42:18.156 [Thread-1809] INFO  com.modak.bots.basebot.AbstractBaseBot - ScriptBot with bot_id 005544f2-f744-4f87-be8f-5fd98be21d44 has finished process logic with message_id ca62a3fb-2b19-4517-afeb-34acef1d996c and thread_id 2218
""2023-11-15 15:42:18.156 [Thread-1809] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-15 15:42:18.288 [Thread-1809] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "e7160424-387e-431a-8245-0f8cb1bb3bfd", "parent_id": "ca62a3fb-2b19-4517-afeb-34acef1d996c", "bot_id": "005544f2-f744-4f87-be8f-5fd98be21d44", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":1700062586993189, "initial_ts":1700062586993, "batch_id":17000625866627691, "batch_name":"", "job_schedule_id":1567, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "DBOpsBot", "ScriptBot", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"005544f2-f744-4f87-be8f-5fd98be21d44", "bot_name":"ScriptBot", "process_context":"delete_filecontent_credentials", "task_name":"delete_filecontent_credentials", "process_id":"1700062586993189", "task_ts":1700062938156, "batch_id":"17000625866627691", "status_code_id": 6 } } ] }
""2023-11-15 15:42:18.289 [Thread-1809] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:42:18.293 [Thread-1809] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:42:18.293 [Thread-1809] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:18.293 [Thread-1809] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:18.293 [Thread-1809] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=726467cb-6792-4883-8a51-fe5741ec126a, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=delete_filecontent_credentials, message_id=ca62a3fb-2b19-4517-afeb-34acef1d996c, task_retry_intervals_secs=[], bot_id=13a5eb35-8804-48e2-a685-5383b2ce92c7, message_topic=nabu_2_scriptbot, tags={process_id=1700062586993189, initial_ts=1700062586993, batch_name=, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, DBOpsBot, ScriptBot]}}
""2023-11-15 15:42:18.299 [Thread-1965] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 0b7cd6db-90a2-40e7-8778-af8e103dca31 has started processing message with message_id e7160424-387e-431a-8245-0f8cb1bb3bfd and thread_id 2402 
""2023-11-15 15:42:18.299 [Thread-1965] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:18.299 [Thread-1965] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=ca62a3fb-2b19-4517-afeb-34acef1d996c, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=e7160424-387e-431a-8245-0f8cb1bb3bfd, task_retry_intervals_secs=[], bot_id=005544f2-f744-4f87-be8f-5fd98be21d44, message_topic=nabu_2_taskmonitor, tags={process_id=1700062586993189, initial_ts=1700062586993, batch_name=, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, DBOpsBot, ScriptBot, TaskMonitorBot]}}
""2023-11-15 15:42:18.307 [Thread-1809] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
["sh","-l","-c","$NABU_ROOT_INSTALLATION/botworks/scripts/deleteBotCredentials.sh 1567_261_17000625866627691"]
""2023-11-15 15:42:18.313 [Thread-1965] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 1700062586993189, 'ScriptBot', 'delete_filecontent_credentials', 'delete_filecontent_credentials', 6 , TO_TIMESTAMP(1700062938156::double precision / 1000) ,'005544f2-f744-4f87-be8f-5fd98be21d44');
""2023-11-15 15:42:18.313 [Thread-1965] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 0b7cd6db-90a2-40e7-8778-af8e103dca31 has started process logic with message_id e7160424-387e-431a-8245-0f8cb1bb3bfd and thread_id 2402
""2023-11-15 15:42:18.319 [Thread-1965] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 0b7cd6db-90a2-40e7-8778-af8e103dca31 has finished process logic with message_id e7160424-387e-431a-8245-0f8cb1bb3bfd and thread_id 2402
""2023-11-15 15:42:18.319 [Thread-1965] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:18.319 [Thread-1965] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id e7160424-387e-431a-8245-0f8cb1bb3bfd
""2023-11-15 15:42:18.322 [Thread-1809] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 15:42:18.323 [Thread-1809] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:42:18.331 [Thread-1809] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:42:18.332 [Thread-1809] INFO  com.modak.bots.basebot.AbstractBaseBot - ScriptBot with bot_id 005544f2-f744-4f87-be8f-5fd98be21d44 has started process logic with message_id ca62a3fb-2b19-4517-afeb-34acef1d996c and thread_id 2218
""2023-11-15 15:42:18.332 [Thread-1809] INFO  ScriptBot - templateProcessedOutput : ["sh","-l","-c","$NABU_ROOT_INSTALLATION/botworks/scripts/deleteBotCredentials.sh 1567_261_17000625866627691"]
""2023-11-15 15:42:18.332 [Thread-1809] DEBUG ScriptBot - command to be executed  [sh, -l, -c, $NABU_ROOT_INSTALLATION/botworks/scripts/deleteBotCredentials.sh 1567_261_17000625866627691]
""2023-11-15 15:42:18.336 [Thread-2253] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 6a135ec4-943a-46fe-bfe7-8285dc19d38d has started processing message with message_id de4fc56a-5077-4bda-8148-1c48229cd74e and thread_id 2738 
""2023-11-15 15:42:18.336 [Thread-2253] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:18.336 [Thread-2253] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=ca62a3fb-2b19-4517-afeb-34acef1d996c, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=de4fc56a-5077-4bda-8148-1c48229cd74e, task_retry_intervals_secs=[], bot_id=005544f2-f744-4f87-be8f-5fd98be21d44, message_topic=nabu_2_taskmonitor, tags={process_id=1700062586993189, initial_ts=1700062586993, batch_name=, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, DBOpsBot, ScriptBot, TaskMonitorBot]}}
""2023-11-15 15:42:18.350 [Thread-2253] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 1700062586993189, 'ScriptBot', 'delete_filecontent_credentials', 'delete_ondemandbot_credentials', 10 , TO_TIMESTAMP(1700062938293::double precision / 1000) ,'005544f2-f744-4f87-be8f-5fd98be21d44');
""2023-11-15 15:42:18.350 [Thread-2253] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 6a135ec4-943a-46fe-bfe7-8285dc19d38d has started process logic with message_id de4fc56a-5077-4bda-8148-1c48229cd74e and thread_id 2738
""2023-11-15 15:42:18.356 [Thread-2253] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 6a135ec4-943a-46fe-bfe7-8285dc19d38d has finished process logic with message_id de4fc56a-5077-4bda-8148-1c48229cd74e and thread_id 2738
""2023-11-15 15:42:18.357 [Thread-2253] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:18.357 [Thread-2253] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id de4fc56a-5077-4bda-8148-1c48229cd74e
""2023-11-15 15:42:18.682 [Thread-1809] DEBUG ScriptBot - [2023-11-15 15:42:18,682] 	 INFO:checking for path /opt/nabu/botworks/scripts/creds/1567_261_17000625866627691 
""2023-11-15 15:42:18.682 [Thread-1809] DEBUG ScriptBot - [2023-11-15 15:42:18,682] 	 ERROR:No directory to be deleted
""2023-11-15 15:42:18.682 [Thread-1809] DEBUG ScriptBot - False
""2023-11-15 15:42:18.739 [Thread-1809] INFO  ScriptBot -  exit status : 0
""2023-11-15 15:42:18.739 [Thread-1809] INFO  ScriptBot - Script executed successfully
""2023-11-15 15:42:18.739 [Thread-1809] INFO  com.modak.bots.basebot.AbstractBaseBot - ScriptBot with bot_id 005544f2-f744-4f87-be8f-5fd98be21d44 has finished process logic with message_id ca62a3fb-2b19-4517-afeb-34acef1d996c and thread_id 2218
""2023-11-15 15:42:18.739 [Thread-1809] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-15 15:42:18.937 [Thread-1809] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "ac1ef075-9557-4190-8aeb-0a36c4daf2b9", "parent_id": "ca62a3fb-2b19-4517-afeb-34acef1d996c", "bot_id": "005544f2-f744-4f87-be8f-5fd98be21d44", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":1700062586993189, "initial_ts":1700062586993, "batch_id":17000625866627691, "batch_name":"", "job_schedule_id":1567, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "DBOpsBot", "ScriptBot", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"005544f2-f744-4f87-be8f-5fd98be21d44", "bot_name":"ScriptBot", "process_context":"delete_filecontent_credentials", "task_name":"delete_ondemandbot_credentials", "process_id":"1700062586993189", "task_ts":1700062938739, "batch_id":"17000625866627691", "status_code_id": 6 } } ] }
""2023-11-15 15:42:18.940 [Thread-1809] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:42:18.944 [Thread-1809] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:42:18.944 [Thread-1809] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:18.945 [Thread-1809] INFO  com.modak.bots.basebot.AbstractBaseBot - ScriptBot finished processing message with id ca62a3fb-2b19-4517-afeb-34acef1d996c
""2023-11-15 15:42:19.090 [Thread-2301] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id e070d8f7-7524-4683-a208-e74b76c4d260 has started processing message with message_id ac1ef075-9557-4190-8aeb-0a36c4daf2b9 and thread_id 2795 
""2023-11-15 15:42:19.090 [Thread-2301] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:19.090 [Thread-2301] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=ca62a3fb-2b19-4517-afeb-34acef1d996c, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=ac1ef075-9557-4190-8aeb-0a36c4daf2b9, task_retry_intervals_secs=[], bot_id=005544f2-f744-4f87-be8f-5fd98be21d44, message_topic=nabu_2_taskmonitor, tags={process_id=1700062586993189, initial_ts=1700062586993, batch_name=, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, DBOpsBot, ScriptBot, TaskMonitorBot]}}
""2023-11-15 15:42:19.102 [Thread-2301] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 1700062586993189, 'ScriptBot', 'delete_filecontent_credentials', 'delete_ondemandbot_credentials', 6 , TO_TIMESTAMP(1700062938739::double precision / 1000) ,'005544f2-f744-4f87-be8f-5fd98be21d44');
""2023-11-15 15:42:19.102 [Thread-2301] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id e070d8f7-7524-4683-a208-e74b76c4d260 has started process logic with message_id ac1ef075-9557-4190-8aeb-0a36c4daf2b9 and thread_id 2795
""2023-11-15 15:42:19.108 [Thread-2301] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id e070d8f7-7524-4683-a208-e74b76c4d260 has finished process logic with message_id ac1ef075-9557-4190-8aeb-0a36c4daf2b9 and thread_id 2795
""2023-11-15 15:42:19.108 [Thread-2301] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:19.108 [Thread-2301] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id ac1ef075-9557-4190-8aeb-0a36c4daf2b9
""2023-11-15 15:42:23.929 [pool-24-thread-20] DEBUG com.modak.bots.flowcontroller.FlowController - Flow : ingestion_261_17000625866627691 has completed
""2023-11-15 15:42:23.929 [pool-24-thread-20] DEBUG com.modak.bots.flowcontroller.FlowController - start flow inside the loop
""2023-11-15 15:42:24.130 [pool-24-thread-20] DEBUG com.modak.bots.flowcontroller.FlowController - Inside startFlows() of batchid 17000625866627691
""2023-11-15 15:42:24.130 [pool-24-thread-20] DEBUG com.modak.bots.flowcontroller.FlowController - flowsToBeStartedMap in startflows() : {}
""2023-11-15 15:42:24.130 [pool-24-thread-20] DEBUG com.modak.bots.flowcontroller.FlowController - done with startFlows() inside while loop
""2023-11-15 15:42:24.130 [pool-24-thread-20] DEBUG com.modak.bots.flowcontroller.FlowController - All Flows in flow controller has completed
""2023-11-15 15:42:24.130 [pool-24-thread-20] DEBUG com.modak.bots.flowcontroller.FlowController - Time taken to complete all flows: 352 sec
""2023-11-15 15:42:24.130 [pool-24-thread-20] INFO  com.modak.bots.basebot.AbstractBaseBot - FlowControllerBot with bot_id d6a03616-281f-4a28-9811-52d565f7ccd1 has finished process logic with message_id b069046f-8526-4bc6-8dbc-93e25a119ff8 and thread_id 5336
""2023-11-15 15:42:24.130 [pool-24-thread-20] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-15 15:42:24.142 [pool-24-thread-20] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "3522bb9c-2f21-46b5-8314-96449660fb03", "parent_id": "b069046f-8526-4bc6-8dbc-93e25a119ff8", "bot_id": "d6a03616-281f-4a28-9811-52d565f7ccd1", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":1700062586993189, "initial_ts":1700062586993, "batch_id":17000625866627691, "batch_name":"", "job_schedule_id":1567, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"d6a03616-281f-4a28-9811-52d565f7ccd1", "bot_name":"FlowControllerBot", "process_context":"flowcontroller_message_to_generate_flows", "task_name":"generate_flows", "process_id":"1700062586993189", "task_ts":1700062944130, "batch_id":"17000625866627691", "status_code_id": 6 } } ] }
""2023-11-15 15:42:24.144 [pool-24-thread-20] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:42:24.148 [pool-24-thread-20] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 15:42:24.151 [Thread-2061] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id fcbc16aa-d9de-4d67-90e8-a0c8ef4447e2 has started processing message with message_id 3522bb9c-2f21-46b5-8314-96449660fb03 and thread_id 2514 
""2023-11-15 15:42:24.152 [Thread-2061] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:24.152 [Thread-2061] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=b069046f-8526-4bc6-8dbc-93e25a119ff8, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=3522bb9c-2f21-46b5-8314-96449660fb03, task_retry_intervals_secs=[], bot_id=d6a03616-281f-4a28-9811-52d565f7ccd1, message_topic=nabu_2_taskmonitor, tags={process_id=1700062586993189, initial_ts=1700062586993, batch_name=, environment=modak, batch_id=17000625866627691, job_schedule_id=1567, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, TaskMonitorBot]}}
""2023-11-15 15:42:24.159 [pool-24-thread-20] INFO  com.modak.utils.logging.LoggingTemplateUtitlity - 2023-11-15 15:42:24.149 Task end generate_flows of process_id 1700062586993189 of bot FlowControllerBot  with id d6a03616-281f-4a28-9811-52d565f7ccd1
""2023-11-15 15:42:24.159 [pool-24-thread-20] INFO  com.modak.utils.logging.FileLogger - ../logs/logger_output.log
""2023-11-15 15:42:24.159 [pool-24-thread-20] DEBUG com.modak.utils.logging.FileLogger - Log file executed 2023-11-15 15:42:24.149 Task end generate_flows of process_id 1700062586993189 of bot FlowControllerBot  with id d6a03616-281f-4a28-9811-52d565f7ccd1 
""2023-11-15 15:42:24.159 [pool-24-thread-20] INFO  com.modak.bots.basebot.AbstractBaseBot - FlowControllerBot finished processing message with id b069046f-8526-4bc6-8dbc-93e25a119ff8
""2023-11-15 15:42:24.165 [Thread-2061] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000625866627691, 1700062586993189, 'FlowControllerBot', 'flowcontroller_message_to_generate_flows', 'generate_flows', 6 , TO_TIMESTAMP(1700062944130::double precision / 1000) ,'d6a03616-281f-4a28-9811-52d565f7ccd1');
""2023-11-15 15:42:24.165 [Thread-2061] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id fcbc16aa-d9de-4d67-90e8-a0c8ef4447e2 has started process logic with message_id 3522bb9c-2f21-46b5-8314-96449660fb03 and thread_id 2514
""2023-11-15 15:42:24.171 [Thread-2061] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id fcbc16aa-d9de-4d67-90e8-a0c8ef4447e2 has finished process logic with message_id 3522bb9c-2f21-46b5-8314-96449660fb03 and thread_id 2514
""2023-11-15 15:42:24.171 [Thread-2061] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 15:42:24.171 [Thread-2061] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 3522bb9c-2f21-46b5-8314-96449660fb03
"