{"log":" { "bot_name": "DBOpsBot", "bot_metadata": { "message_id": "47a9429e-5e83-4989-b1d0-5654dcb318cc", "parent_id": "f74e4fc4-a793-4afc-bcd0-b0fb9a0c4a8a", "bot_id": "6b185c3c-0199-4553-a85b-22ee46ebf37a", "message_topic":"nabu_3_jdbc", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_3_jdbc","ScriptBot" : "nabu_3_curation_script","SparkComputeEngineBot" : "nabu_3_spark_compute","S3StreamBot" : "nabu_3_s3_stream","FilterResolverDBOpsBot" : "nabu_3_filter_resolver_jdbc","ErrorBot" : "nabu_3_errorbot","OnDemandBot" : "nabu_3_ondemand_bot","AuthTokenBot" : "nabu_3_authtoken","EmailBot" : "nabu_3_emailbot","SparkScriptBot" : "nabu_3_spark_script","PipelineDependencyCheckerBot" : "nabu_3_pipelinedependency_checker","CurationSparkScriptBot" : "nabu_3_curation_script","TaskMonitorBot" : "nabu_3_taskmonitor","completion_topic" : "nabu_3_completion","FlowControllerBot" : "nabu_3_flowcontroller","UpdateDBOpsBot" : "nabu_3_update_jdbc"}, "tags": {"process_id":16474131016671, "initial_ts":1647413100017, "batch_id":1647413100017215, "batch_name":"Ingestion_20220316", "job_schedule_id":"", "environment": "TEST", "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "DBOpsBot", "KoshBot", "KoshBot" ],"task_dependency":true}, "task_retry_intervals_secs": [ ], "message_context": "insert_ingestion_job_metadata" }, "bot_tasks": [ { "task_name": "jdbc_insert_script_details", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "pre_task_logging_template_details": { "template_group": "common_templates|artifact_ingestion", "template_name": "pre_log_template" }, "app_template_details": { "template_group": "ingestion_templates|artifact_ingestion", "template_name": "insert_spark_job_result" }, "input_data": { "template_execution_type":"single", "query_type":"insert", "useTransactionControl":false, "query_input": { "data" : { "dest_container" : "bhpldest", "botLogicOutputMap" : { "jobId" : null, "applicationId" : null, "exit_status" : 0, "status" : true }, "data" : { "query_input" : { "input_data" : { "flow_number" : 1, "process_id" : 16474131016671, "batch_id" : 1647413100017215, "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjo5MDcwODAyMywiZXhwIjoxNjQ3NDM0NzEzLCJ1c2VySWQiOiJib3RzLXNydi1hY2NvdW50IiwiaWF0IjoxNjQ3NDEzMTEzfQ.cYBlXcHg-OUOLVF-bcitWL5BUbeMDqsonuqJxnoFUkaqkEgX0acjtLnFXTAuxybojGv5p6GC10761PI-_s-6tILDZLdEz_a1QrfPZ3VWZQvRFdT7BkpwdfnX9_U9PAEhfEwo0_gXOPCKNVyeSwdurcl9hjUW-Osrb6kv5BXftW8QNEsk0QtP1U22PpmUebA9wO-pxLr0QaxxzZi1N8Kyb6aYO7qnVMpKcWSMuxYhCUd67nkSB9RmA9_II6cYdlOomiNMv941cbp2nFRV74-vt5b9xwvdCvZJC37gBdX69xEdylK2VMv1kgqSWO8WcuXCPbjmX4xMhRNWqi3jVAyoDQ", "end_point" : "http:\\/\\/dev-dha.humana.com:8889\\/fireshots\\/credentialsFetchWebService", "destination" : "adls_gen2", "where_condition" : "144568", "source" : "oracle", "job_type_id" : "1", "intermediate_type" : "parquet", "batch_name" : "Ingestion_20220316", "metadata_category_destination" : "file", "data_movement_id" : 115, "datamovement_engine_type" : "Spark", "is_create_table" : false, "metadata_category" : "relational" }, "input_json_for_checkpoint_status" : "ewoicHJvY2Vzc0lkIjoxNjQ3NDEzMTAxNjY3MSwKImRhdGFwbGFjZUlkIjoyNSwKInRhYmxlSWQiOjE0NDU2OCwKImRhdGFtb3ZlbWVudElkIjoxMTUKfQ==", "get_timestamp_information" : [ { "destination_folder_format" : "2022_03_16_06_45_15" } ], "table_metadata_output" : [ { "adls_gen2_container" : "bhpldest", "source_default_credential_exists" : false, "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjo5MDcwODAyMywiZXhwIjoxNjQ3NDM0NzEzLCJ1c2VySWQiOiJib3RzLXNydi1hY2NvdW50IiwiaWF0IjoxNjQ3NDEzMTEzfQ.cYBlXcHg-OUOLVF-bcitWL5BUbeMDqsonuqJxnoFUkaqkEgX0acjtLnFXTAuxybojGv5p6GC10761PI-_s-6tILDZLdEz_a1QrfPZ3VWZQvRFdT7BkpwdfnX9_U9PAEhfEwo0_gXOPCKNVyeSwdurcl9hjUW-Osrb6kv5BXftW8QNEsk0QtP1U22PpmUebA9wO-pxLr0QaxxzZi1N8Kyb6aYO7qnVMpKcWSMuxYhCUd67nkSB9RmA9_II6cYdlOomiNMv941cbp2nFRV74-vt5b9xwvdCvZJC37gBdX69xEdylK2VMv1kgqSWO8WcuXCPbjmX4xMhRNWqi3jVAyoDQ", "end_point" : "http:\\/\\/dev-dha.humana.com:8889\\/fireshots\\/credentialsFetchWebService", "project" : null, "is_filesystem_credential_type_aws" : true, "table_id" : 144568, "table_name" : "ALERT_INFO", "s3_bucket" : null, "source_url" : "edwdev-scan.humana.com:1521", "destination_endpoint" : "", "path" : "", "destination_type" : "adls_gen2", "schema_id" : 59274, "filesystem_credential_epoch" : null, "adls_gen2_directory_name" : null, "destination_db" : null, "table_suffix" : "", "bucket_name" : null, "source_type" : "oracle", "schema_name" : "EDW_PROD", "table_timestamp" : "", "is_destination_credential_kerberos" : false, "estimated_rows" : 0, "destination_file_format" : "Parquet", "verification_threshold" : 0.1, "filesystem_credential_type" : null, "is_oracle" : true, "dest_default_credential_exists" : false, "destination_folder_format" : "2022\\/03\\/16\\/06\\/45\\/14", "process_id" : 16474131016671, "flow_number" : 1, "is_destination_file" : true, "batch_id" : 1647413100017215, "is_aws_iam" : false, "destination_url" : null, "where_condition" : "144568", "file_system_type" : "abfss", "filesystem_credential_type_id" : null, "schema_drift_flag" : false, "is_source_hive" : false, "is_mysql" : false, "destination_oracle_jdbc_url" : null, "schema_drift_option" : "drop_create_table", "ingestion_table_format" : "", "filesystem_credential_id" : null, "destination_directory" : null, "destination_dataplace_id" : 30, "source_credential_type_id" : 1, "destination_credential_id" : 98, "destination_backup_table_name" : "alert_info", "create_backup_table" : null, "destination_table_name" : "alert_info", "source_jdbc_driver" : "oracle.jdbc.OracleDriver", "destination_dataplace_sub_component_id" : 18, "destination_schema_name" : "bhpldest", "is_azure_oauth" : false, "source_db" : "edwqa", "gcs_bucket" : null, "source_directory" : null, "target_type" : "adls_gen2", "is_file_system_type_s3a" : false, "oracle_jdbc_url" : null, "is_source_spark_hive" : false, "batch_name" : "Ingestion_20220316", "dataplace_id" : 25, "filesystem_endpoint" : null, "is_spark_hive" : false, "source_endpoint" : "", "upper_case_destination_table_name" : "ALERT_INFO", "source_credential_id" : 96, "destination_jdbc_driver" : null, "data_movement_id" : 115, "destination_credential_type_id" : 5, "storage_account" : "idea15pisplznonprodsa2", "is_apache_jdbc_driver" : false } ], "base64_encrypted_success_event_json" : "ewoJImp3dF90b2tlbiI6ICJleUpoYkdjaU9pSlNVekkxTmlKOS5leUpwYzNNaU9pSkdTVkpGVTBoUFZGTmZRVkJRVEVsRFFWUkpUMDRpTENKelpYTnphVzl1WDJsa0lqbzVNRGN3T0RBeU15d2laWGh3SWpveE5qUTNORE0wTnpFekxDSjFjMlZ5U1dRaU9pSmliM1J6TFhOeWRpMWhZMk52ZFc1MElpd2lhV0YwSWpveE5qUTNOREV6TVRFemZRLmNZQmxYY0hnLU9VT0xWRi1iY2l0V0w1QlViZU1EcXNvbnVxSnhub0ZVa2Fxa0VnWDBhY2p0TG5GWFRBdXh5Ym9qR3Y1cDZHQzEwNzYxUEktX3MtNnRJTERaTGRFel9hMVFyZlBaM1ZXWlF2UkZkVDdCa3B3ZGZuWDlfVTlQQUVoZkV3bzBfZ1hPUENLTlZ5ZVN3ZHVyY2w5aGpVVy1Pc3JiNmt2NUJYZnRXOFFORXNrMFF0UDFVMjJQcG1VZWJBOXdPLXB4THIwUWF4eHpaaTFOOEt5YjZhWU83cW5WTXBLY1dTTXV4WWhDVWQ2N25rU0I5Um1BOV9JSTZjWWRsT29taU5Ndjk0MWNicDJuRlJWNzQtdnQ1Yjl4d3ZkQ3ZaSkMzN2dCZFg2OXhFZHlsSzJWTXYxa2dxU1dPOFdjdVhDUGJqbVg0eE1oUk5XcWkzalZBeW9EUSIsCgkiZGVzdGluYXRpb25fY3JlZGVudGlhbF9pZCI6IDk4LAoJImRlc3RpbmF0aW9uX2NyZWRlbnRpYWxfdHlwZV9pZCI6IDUsCgkiZXZlbnRUeXBlIjogIkRhdGFMb2FkRXZlbnQiLAoJImRhdGFzZXQiOiAiQUxFUlRfSU5GTyIsCgkibG9hZFR5cGUiOiAiZnVsbCIsCgkibWV0YWRhdGFJbmRpY2F0b3IiOiAiWSIsCgkicmVjb25JbmRpY2F0b3IiOiAiWSIsCgkiZmlsZVR5cGUiOiAiUGFycXVldCIsCgkicGF0aCI6ICJBTEVSVF9JTkZPL2Z1bGwvMjAyMi8wMy8xNi8wNi80NS8xNC9kYXRhIiwKCSJxdWVyeSI6ICJTRUxFQ1QgKiBmcm9tIEVEV19QUk9ELkFMRVJUX0lORk8iCn0=", "spark_script_inputs" : [ { "engine_path" : "dataproc", "ssh_username" : "null", "spark_location" : "null", "ssh_host" : "null", "kerberos" : false, "compute_engine_info" : "ewoiY2x1c3RlciI6ImRldi1iaHBsLWRoYS1kYXRhcHJvYy1jbHVzdGVyIiwic3BhcmtfdmVyc2lvbl92YWx1ZSI6IjJfNCIsImNyZWRlbnRpYWxzX2pzb25fZmlsZXBhdGgiOiIvb3B0L25hYnUvbmFidS1zcGFyay1ib3RzL2NvbmYvc3ZjLXJlbGVhc2UtYWNvdW50LWlkZWEtY2RmLWlkZWExNS1ucGUuanNvbiIsInNjYWxhX3ZlcnNpb25fdmFsdWUiOiIyXzEyIiwic3BhcmtfdmVyc2lvbiI6IjIuNCIsInByb2plY3QiOiJpZGVhLWNkZi1pZGVhMTUtbnBlLTA4MjQiLCJzY2FsYV92ZXJzaW9uIjoiMi4xMiIsInlhcm5fYXBwX3VybCI6Imh0dHBzOi8vYnBuaGlzcTdndmUzbmtrdWhrYmF6dmZqNHEtZG90LXVzLWNlbnRyYWwxLmRhdGFwcm9jLmdvb2dsZXVzZXJjb250ZW50LmNvbS9nYXRld2F5L2RlZmF1bHQvc3BhcmtoaXN0b3J5L2hpc3RvcnkvIiwicmVnaW9uIjoidXMtY2VudHJhbDEiCn0=" } ], "get_spark_configs" : [ { "num_executors" : 2, "parallel_threads" : 1, "dataplace_id" : 25, "driver_memory_gb" : "4G", "executor_memory_gb" : "6G", "schema_id" : 59274, "table_id" : 144568, "table_name" : "ALERT_INFO", "table_size_configs" : "S", "num_executors_cores" : 1 } ], "column_metadata_output" : [ { "data_precision" : null, "is_nullable" : true, "data_length" : 22, "column_name" : "ALERT_KEY", "source_type" : "oracle", "schema_name" : "EDW_PROD", "table_name" : "ALERT_INFO", "intermediate_datatype_name" : "STRING", "field_name" : "alert_key", "is_mysql" : false, "is_source_hive" : false, "source_cast_type" : "cast(columnname as VARCHAR(255)) as columnname", "ordinal_position" : 1, "source_datatype_name" : "number", "is_oracle" : true, "data_scale" : null, "data_type" : "number", "user_text" : null, "source_stg_function" : "OracleNumberToStringConvert", "istimezone" : false }, { "data_precision" : null, "is_nullable" : true, "data_length" : 3, "column_name" : "ALERT_TYPE_CD", "source_type" : "oracle", "schema_name" : "EDW_PROD", "table_name" : "ALERT_INFO", "intermediate_datatype_name" : "STRING", "field_name" : "alert_type_cd", "is_mysql" : false, "is_source_hive" : false, "source_cast_type" : "AsIs", "ordinal_position" : 2, "source_datatype_name" : "varchar2", "is_oracle" : true, "data_scale" : null, "data_type" : "varchar2", "user_text" : null, "source_stg_function" : "AsIs", "istimezone" : false }, { "data_precision" : null, "is_nullable" : true, "data_length" : 22, "column_name" : "ALERT_1_NBR", "source_type" : "oracle", "schema_name" : "EDW_PROD", "table_name" : "ALERT_INFO", "intermediate_datatype_name" : "STRING", "field_name" : "alert_1_nbr", "is_mysql" : false, "is_source_hive" : false, "source_cast_type" : "cast(columnname as VARCHAR(255)) as columnname", "ordinal_position" : 3, "source_datatype_name" : "number", "is_oracle" : true, "data_scale" : null, "data_type" : "number", "user_text" : null, "source_stg_function" : "OracleNumberToStringConvert", "istimezone" : false }, { "data_precision" : null, "is_nullable" : true, "data_length" : 22, "column_name" : "ALERT_2_NBR", "source_type" : "oracle", "schema_name" : "EDW_PROD", "table_name" : "ALERT_INFO", "intermediate_datatype_name" : "STRING", "field_name" : "alert_2_nbr", "is_mysql" : false, "is_source_hive" : false, "source_cast_type" : "cast(columnname as VARCHAR(255)) as columnname", "ordinal_position" : 4, "source_datatype_name" : "number", "is_oracle" : true, "data_scale" : null, "data_type" : "number", "user_text" : null, "source_stg_function" : "OracleNumberToStringConvert", "istimezone" : false }, { "data_precision" : null, "is_nullable" : true, "data_length" : 100, "column_name" : "ALERT_1_TEXT", "source_type" : "oracle", "schema_name" : "EDW_PROD", "table_name" : "ALERT_INFO", "intermediate_datatype_name" : "STRING", "field_name" : "alert_1_text", "is_mysql" : false, "is_source_hive" : false, "source_cast_type" : "AsIs", "ordinal_position" : 5, "source_datatype_name" : "varchar2", "is_oracle" : true, "data_scale" : null, "data_type" : "varchar2", "user_text" : null, "source_stg_function" : "AsIs", "istimezone" : false }, { "data_precision" : null, "is_nullable" : true, "data_length" : 100, "column_name" : "ALERT_2_TEXT", "source_type" : "oracle", "schema_name" : "EDW_PROD", "table_name" : "ALERT_INFO", "intermediate_datatype_name" : "STRING", "field_name" : "alert_2_text", "is_mysql" : false, "is_source_hive" : false, "source_cast_type" : "AsIs", "ordinal_position" : 6, "source_datatype_name" : "varchar2", "is_oracle" : true, "data_scale" : null, "data_type" : "varchar2", "user_text" : null, "source_stg_function" : "AsIs", "istimezone" : false }, { "data_precision" : null, "is_nullable" : true, "data_length" : 7, "column_name" : "ACTION_TIMESTAMP", "source_type" : "oracle", "schema_name" : "EDW_PROD", "table_name" : "ALERT_INFO", "intermediate_datatype_name" : "STRING", "field_name" : "action_timestamp", "is_mysql" : false, "is_source_hive" : false, "source_cast_type" : "TO_CHAR(columnname, 'YYYY-MM-DD HH24:MI:SS') as columnname", "ordinal_position" : 7, "source_datatype_name" : "date", "is_oracle" : true, "data_scale" : null, "data_type" : "date", "user_text" : null, "source_stg_function" : "OracleDateToString", "istimezone" : false }, { "data_precision" : null, "is_nullable" : true, "data_length" : 22, "column_name" : "RPT_SEVERITY_LEVEL_NBR", "source_type" : "oracle", "schema_name" : "EDW_PROD", "table_name" : "ALERT_INFO", "intermediate_datatype_name" : "STRING", "field_name" : "rpt_severity_level_nbr", "is_mysql" : false, "is_source_hive" : false, "source_cast_type" : "cast(columnname as VARCHAR(255)) as columnname", "ordinal_position" : 8, "source_datatype_name" : "number", "is_oracle" : true, "data_scale" : 0, "data_type" : "number", "user_text" : null, "source_stg_function" : "OracleNumberToStringConvert", "istimezone" : false }, { "data_precision" : null, "is_nullable" : true, "data_length" : 100, "column_name" : "RPT_COND_CAT_TEXT", "source_type" : "oracle", "schema_name" : "EDW_PROD", "table_name" : "ALERT_INFO", "intermediate_datatype_name" : "STRING", "field_name" : "rpt_cond_cat_text", "is_mysql" : false, "is_source_hive" : false, "source_cast_type" : "AsIs", "ordinal_position" : 9, "source_datatype_name" : "varchar2", "is_oracle" : true, "data_scale" : null, "data_type" : "varchar2", "user_text" : null, "source_stg_function" : "AsIs", "istimezone" : false }, { "data_precision" : null, "is_nullable" : true, "data_length" : 100, "column_name" : "RPT_ALERT_TYPE_TEXT", "source_type" : "oracle", "schema_name" : "EDW_PROD", "table_name" : "ALERT_INFO", "intermediate_datatype_name" : "STRING", "field_name" : "rpt_alert_type_text", "is_mysql" : false, "is_source_hive" : false, "source_cast_type" : "AsIs", "ordinal_position" : 10, "source_datatype_name" : "varchar2", "is_oracle" : true, "data_scale" : null, "data_type" : "varchar2", "user_text" : null, "source_stg_function" : "AsIs", "istimezone" : false }, { "data_precision" : null, "is_nullable" : true, "data_length" : 100, "column_name" : "RPT_COND_SHORT_TEXT", "source_type" : "oracle", "schema_name" : "EDW_PROD", "table_name" : "ALERT_INFO", "intermediate_datatype_name" : "STRING", "field_name" : "rpt_cond_short_text", "is_mysql" : false, "is_source_hive" : false, "source_cast_type" : "AsIs", "ordinal_position" : 11, "source_datatype_name" : "varchar2", "is_oracle" : true, "data_scale" : null, "data_type" : "varchar2", "user_text" : null, "source_stg_function" : "AsIs", "istimezone" : false }, { "data_precision" : null, "is_nullable" : true, "data_length" : 200, "column_name" : "RPT_COND_LONG_TEXT", "source_type" : "oracle", "schema_name" : "EDW_PROD", "table_name" : "ALERT_INFO", "intermediate_datatype_name" : "STRING", "field_name" : "rpt_cond_long_text", "is_mysql" : false, "is_source_hive" : false, "source_cast_type" : "AsIs", "ordinal_position" : 12, "source_datatype_name" : "varchar2", "is_oracle" : true, "data_scale" : null, "data_type" : "varchar2", "user_text" : null, "source_stg_function" : "AsIs", "istimezone" : false }, { "data_precision" : null, "is_nullable" : true, "data_length" : 1000, "column_name" : "RPT_COND_DETAIL_TEXT", "source_type" : "oracle", "schema_name" : "EDW_PROD", "table_name" : "ALERT_INFO", "intermediate_datatype_name" : "STRING", "field_name" : "rpt_cond_detail_text", "is_mysql" : false, "is_source_hive" : false, "source_cast_type" : "AsIs", "ordinal_position" : 13, "source_datatype_name" : "varchar2", "is_oracle" : true, "data_scale" : null, "data_type" : "varchar2", "user_text" : null, "source_stg_function" : "AsIs", "istimezone" : false } ], "encrypted_script" : "H4sIAAAAAAAAAKVXyXajShb8oN4wFC6zeAuDAYEQVWJIIHcMlkAkiC4JIfT1HYnk8dnV1a+PDwdkkpt3iIwbN4vFMZcdwV54uzQ+V27nKcWkjEWr7mjiXVx2v8z+toYIWTwOZOEoesuOhaVOpa5dUsk8pIEilhY7uN3RSmN2KBOHuboWlrE329us+z5PtFPRrbew2bmtOaaxt6eBcsilQshq5XtoEYnG48E2zicqlayox21oqV0Ym0Ma43cnLPWOVrmu4Zuyo4m9\\/RloKzx7aaxUVCKT25asfPl+W6eSenQbc4JvLfYT7LpZ5rA5r+08vp","stream":"stdout","time":"2022-03-16T06:46:39.525338613Z"}
