"2023-11-15 16:40:38.593 [Thread-24] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id ae09474d-cd53-4464-babc-0804a06a16cd has started processing message with message_id a9aeba11-f96c-45a8-ae06-58ea1329813f and thread_id 89 
""2023-11-15 16:40:38.616 [Thread-24] INFO  com.modak.utils.logging.LoggingTemplateUtitlity - 2023-11-15 16:40:38.6 Task start data_movement_flow_queries of process_id 1700066438126424 of bot DBOpsBot  with id ae09474d-cd53-4464-babc-0804a06a16cd
""2023-11-15 16:40:38.618 [Thread-24] INFO  com.modak.utils.logging.FileLogger - ../logs/logger_output.log
""2023-11-15 16:40:38.619 [Thread-24] DEBUG com.modak.utils.logging.FileLogger - Log file executed 2023-11-15 16:40:38.6 Task start data_movement_flow_queries of process_id 1700066438126424 of bot DBOpsBot  with id ae09474d-cd53-4464-babc-0804a06a16cd 
""2023-11-15 16:40:38.620 [Thread-24] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=e035080f-88d6-4fdb-a318-a1ad0f1a8cc9, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=data_movement_initial_flow_queries, message_id=a9aeba11-f96c-45a8-ae06-58ea1329813f, task_retry_intervals_secs=[], bot_id=e035080f-88d6-4fdb-a318-a1ad0f1a8cc9, message_topic=nabu_2_jdbc, tags={process_id=1700066438126424, initial_ts=1700066438126, batch_name=Ingestion_20231115, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, generated_ts=1700066438126, task_dependency=true, tags=[AuthToken]}}
""2023-11-15 16:40:38.670 [Thread-24] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
select dm.data_movement_id, case when jsd.job_type_id = 6 then true else false end as manual_retry, coalesce(data_movement_additional_info->'flow_details'->>'retry',data_movement_additional_info->'flow_details'->>'pipeline_retry','false') :: boolean as pipeline_retry, coalesce(data_movement_additional_info->'flow_details'->'pre_conditions'->>'enabled','false') :: boolean as pipeline_pre_conditions_enabled, coalesce(data_movement_additional_info->'flow_details'->>'ignore_null_tables','false') :: boolean as ignore_null_tables_flag from nabu.data_movement_physical dm inner join nabu.job_schedule_details jsd on jsd.data_movement_id =dm.data_movement_id where jsd.valid_to_ts ='9999-12-31' and dm.valid_to_ts = '9999-12-31' and dm.data_movement_id=261 and jsd.job_schedule_id=1568
""2023-11-15 16:40:38.687 [Thread-24] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 16:40:38.768 [Thread-24] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:40:38.773 [Thread-24] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:40:38.773 [Thread-24] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id ae09474d-cd53-4464-babc-0804a06a16cd has started process logic with message_id a9aeba11-f96c-45a8-ae06-58ea1329813f and thread_id 89
""2023-11-15 16:40:38.800 [Thread-1076] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id aec66b87-c359-43a6-adee-0e9c6b3f0e45 has started processing message with message_id 8989105d-de83-4579-b45b-d2365fd35438 and thread_id 1319 
""2023-11-15 16:40:38.820 [Thread-1076] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:40:38.820 [Thread-1076] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=a9aeba11-f96c-45a8-ae06-58ea1329813f, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=8989105d-de83-4579-b45b-d2365fd35438, task_retry_intervals_secs=[], bot_id=ae09474d-cd53-4464-babc-0804a06a16cd, message_topic=nabu_2_taskmonitor, tags={process_id=1700066438126424, initial_ts=1700066438126, batch_name=Ingestion_20231115, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, ignore_job_termination=true, tags=[AuthToken, TaskMonitorBot]}}
""2023-11-15 16:40:38.835 [Thread-1076] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 1700066438126424, 'DBOpsBot', 'data_movement_initial_flow_queries', 'data_movement_flow_queries', 10 , TO_TIMESTAMP(1700066438597::double precision / 1000) ,'ae09474d-cd53-4464-babc-0804a06a16cd');
""2023-11-15 16:40:38.835 [Thread-1076] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id aec66b87-c359-43a6-adee-0e9c6b3f0e45 has started process logic with message_id 8989105d-de83-4579-b45b-d2365fd35438 and thread_id 1319
""2023-11-15 16:40:38.934 [Thread-1076] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id aec66b87-c359-43a6-adee-0e9c6b3f0e45 has finished process logic with message_id 8989105d-de83-4579-b45b-d2365fd35438 and thread_id 1319
""2023-11-15 16:40:38.934 [Thread-1076] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:40:38.934 [Thread-1076] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 8989105d-de83-4579-b45b-d2365fd35438
""2023-11-15 16:40:39.037 [Thread-24] DEBUG com.modak.bots.DBOpsBot - to execute query timeTakenInMillis : 263
""2023-11-15 16:40:39.037 [Thread-24] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id ae09474d-cd53-4464-babc-0804a06a16cd has finished process logic with message_id a9aeba11-f96c-45a8-ae06-58ea1329813f and thread_id 89
""2023-11-15 16:40:39.038 [Thread-24] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : true
""2023-11-15 16:40:39.038 [Thread-24] INFO  com.modak.bots.basebot.AbstractBaseBot -  skipBotLogic == false && useIncomingData == true ..,so both inputData map and botLogic output map is send as output message
""2023-11-15 16:40:39.038 [Thread-24] INFO  com.modak.bots.basebot.AbstractBaseBot - botLogicOutput : { "outputList" : [ { "data_movement_id" : 261, "manual_retry" : false, "pipeline_retry" : false, "pipeline_pre_conditions_enabled" : false, "ignore_null_tables_flag" : false } ] }
""2023-11-15 16:40:39.082 [Thread-24] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "DBOpsBot", "bot_metadata": { "message_topic": "nabu_2_jdbc", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "message_id": "17e23ae8-df64-4622-93cb-60072cbd0ea8", "bot_id": "e035080f-88d6-4fdb-a318-a1ad0f1a8cc9", "parent_id": "e035080f-88d6-4fdb-a318-a1ad0f1a8cc9", "tags": { "process_id": 1700066438126424, "initial_ts": 1700066438126, "generated_ts": 1700066438126, "batch_id":17000664380239952, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "environment": "modak", "tags": [ "AuthToken", ], "job_schedule_id":1568, "task_dependency": true, "retry_attempt": 0 }, "task_retry_intervals_secs": [ ], "message_context": "starting_message_for_ingestion" }, "bot_tasks": [ { "task_name": "checking_pre_conditions_or_starting_msg_of_ingestion", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "skipLogicPattern": "doNothing", "pre_task_logging_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "pre_log_template" }, "app_template_details": { "template_group": "templates/artifact_ingestion/ingestion_fc.stg", "template_name": "data_movement_queries" }, "input_data": { "template_execution_type": "sequential", "useTransactionControl":false, "query_input": { "bot_topic_prefix" : "nabu_", "workflow_engine_id" : 2, "batch_id": 17000664380239952, "process_id": 1700066438126424, "batch_name": "Ingestion_20231115", "data_movement_id":261, "environment": "modak", "pipeline_retry": false, "ignore_null_tables_flag":false, "include_blobs": "", "manual_retry":false, "job_schedule_id":1568, "job_scheduled_user_id":"Manaswini Chinthalapudi", "job_type": "ingestion", "destination_type":"", "workflow_route_bot_topic_details" : {"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"} } }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/ingestion_fc.stg", "template_name": "data_movement_deciding_msg" }, { "template_group": "templates/artifact_ingestion/ingestion_flow.stg", "template_name": "task_status_success_msg" } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "error_template_create_msg" } ] } ] }
""2023-11-15 16:40:39.085 [Thread-24] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_jdbc
""2023-11-15 16:40:39.104 [Thread-24] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_jdbc
""2023-11-15 16:40:39.104 [Thread-24] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-15 16:40:39.117 [Thread-24] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "17021c9c-625d-48b5-96ff-eae51e41b039", "parent_id": "a9aeba11-f96c-45a8-ae06-58ea1329813f", "bot_id": "ae09474d-cd53-4464-babc-0804a06a16cd", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":1700066438126424, "initial_ts":1700066438126, "batch_id":17000664380239952, "batch_name":"Ingestion_20231115", "job_schedule_id":1568, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "", "environment": "modak", "ignore_job_termination" : true, "tags": ["AuthToken", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"ae09474d-cd53-4464-babc-0804a06a16cd", "bot_name":"DBOpsBot", "process_context":"data_movement_initial_flow_queries", "task_name":"data_movement_flow_queries", "process_id":"1700066438126424", "task_ts":1700066439038, "batch_id":"17000664380239952", "status_code_id": 6 } } ] }
""2023-11-15 16:40:39.121 [Thread-24] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:40:39.142 [Thread-844] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 9ac78b1a-14c9-4e99-a7ad-09e2357f0287 has started processing message with message_id 17e23ae8-df64-4622-93cb-60072cbd0ea8 and thread_id 1049 
""2023-11-15 16:40:39.142 [Thread-844] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:40:39.143 [Thread-844] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, parent_id=e035080f-88d6-4fdb-a318-a1ad0f1a8cc9, message_context=starting_message_for_ingestion, message_id=17e23ae8-df64-4622-93cb-60072cbd0ea8, task_retry_intervals_secs=[], message_topic=nabu_2_jdbc, bot_id=e035080f-88d6-4fdb-a318-a1ad0f1a8cc9, tags={process_id=1700066438126424, initial_ts=1700066438126, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, generated_ts=1700066438126, task_dependency=true, retry_attempt=0, tags=[AuthToken]}}
""2023-11-15 16:40:39.153 [Thread-24] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:40:39.161 [Thread-784] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id a64e46f5-5e22-402a-9cb1-04f0074a13b2 has started processing message with message_id 17021c9c-625d-48b5-96ff-eae51e41b039 and thread_id 978 
""2023-11-15 16:40:39.161 [Thread-784] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:40:39.161 [Thread-784] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=a9aeba11-f96c-45a8-ae06-58ea1329813f, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=17021c9c-625d-48b5-96ff-eae51e41b039, task_retry_intervals_secs=[], bot_id=ae09474d-cd53-4464-babc-0804a06a16cd, message_topic=nabu_2_taskmonitor, tags={process_id=1700066438126424, initial_ts=1700066438126, batch_name=Ingestion_20231115, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, ignore_job_termination=true, tags=[AuthToken, TaskMonitorBot]}}
""2023-11-15 16:40:39.170 [Thread-24] INFO  com.modak.utils.logging.LoggingTemplateUtitlity - 2023-11-15 16:40:39.154 Task end data_movement_flow_queries of process_id 1700066438126424 of bot DBOpsBot  with id ae09474d-cd53-4464-babc-0804a06a16cd
""2023-11-15 16:40:39.170 [Thread-24] INFO  com.modak.utils.logging.FileLogger - ../logs/logger_output.log
""2023-11-15 16:40:39.170 [Thread-24] DEBUG com.modak.utils.logging.FileLogger - Log file executed 2023-11-15 16:40:39.154 Task end data_movement_flow_queries of process_id 1700066438126424 of bot DBOpsBot  with id ae09474d-cd53-4464-babc-0804a06a16cd 
""2023-11-15 16:40:39.171 [Thread-24] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot finished processing message with id a9aeba11-f96c-45a8-ae06-58ea1329813f
""2023-11-15 16:40:39.179 [Thread-784] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 1700066438126424, 'DBOpsBot', 'data_movement_initial_flow_queries', 'data_movement_flow_queries', 6 , TO_TIMESTAMP(1700066439038::double precision / 1000) ,'ae09474d-cd53-4464-babc-0804a06a16cd');
""2023-11-15 16:40:39.179 [Thread-784] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id a64e46f5-5e22-402a-9cb1-04f0074a13b2 has started process logic with message_id 17021c9c-625d-48b5-96ff-eae51e41b039 and thread_id 978
""2023-11-15 16:40:39.445 [Thread-844] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
{ "input_data": { "batch_id": 17000664380239952, "process_id": 1700066438126424, "batch_name": "Ingestion_20231115", "data_movement_id":261, "environment": "modak", "pipeline_retry": false, "ignore_null_tables_flag": false, "include_blobs": "", "destination_type":"", "job_type":"ingestion", "manual_retry":false, "job_schedule_id":1568, "job_scheduled_user_id":"Manaswini Chinthalapudi", "workflow_route_bot_topic_details" : {"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"} }, "sequential_templates":[ { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "fetch_source_metadata_category", "query_output_key": "source_metadata_category", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "fetch_data_movement_info", "query_output_key": "data_movement_info", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "schema_drift_object_info", "query_output_key": "schema_drift_table_info", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "fetch_job_type_id", "query_output_key": "job_type_id", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "check_if_selected_schemas_are_empty", "query_output_key": "check_if_selected_schemas_are_empty", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "get_deleted_objects", "query_output_key": "get_deleted_objects", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "get_schema_drift_ignore_tables", "query_output_key": "get_schema_drift_ignore_tables", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "insert_schema_drift_ignore_tables", "query_output_key": "insert_schema_drift_ignore_tables", "query_type":"insert" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "advanced_options_mapping_details", "query_output_key": "advanced_options_mapping_details", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "insert_data_movement_schema_drift_table", "query_output_key": "insert_data_movement_schema_drift_table", "query_type":"insert" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "get_datatype_ignore_tables", "query_output_key": "get_datatype_ignore_tables", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "insert_datatype_ignore_tables", "query_output_key": "insert_datatype_ignore_tables", "query_type":"insert" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "fetch_pipeline_data", "query_output_key": "fetch_pipeline_data", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "get_jwt_details", "query_output_key": "get_jwt_details", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "ingestion_object_info", "query_output_key": "nabu_ingestion", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "email_input", "query_output_key": "email_input", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "rest_api_input", "query_output_key": "rest_api_input", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "condition_for_success_mail", "query_output_key": "condition_for_success_mail", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "condition_for_failure_mail", "query_output_key": "condition_for_failure_mail", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "condition_for_schema_drift_mail", "query_output_key": "condition_for_schema_drift_mail", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "get_rest_apis", "query_output_key": "get_rest_apis", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "flows_list_query", "query_output_key": "flows", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "get_batch_datamovement_id", "query_output_key": "get_batch_datamovement_id", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "flow_controller_timeout", "query_output_key": "flow_controller_timeout", "query_type":"select" } ], "output_keys":["flows","schema_drift_table_info","get_schema_drift_ignore_tables","get_datatype_ignore_tables","get_batch_datamovement_id","nabu_ingestion","email_input","rest_api_input","condition_for_schema_drift_mail","condition_for_success_mail","condition_for_failure_mail","flow_controller_timeout","get_deleted_objects","source_metadata_category","get_jwt_details", "get_ignore_null_tables","check_if_selected_schemas_are_empty"] }
""2023-11-15 16:40:39.490 [Thread-784] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id a64e46f5-5e22-402a-9cb1-04f0074a13b2 has finished process logic with message_id 17021c9c-625d-48b5-96ff-eae51e41b039 and thread_id 978
""2023-11-15 16:40:39.490 [Thread-784] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:40:39.490 [Thread-784] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 17021c9c-625d-48b5-96ff-eae51e41b039
""2023-11-15 16:40:39.495 [Thread-844] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 16:40:39.497 [Thread-844] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:40:39.512 [Thread-844] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:40:39.513 [Thread-844] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 9ac78b1a-14c9-4e99-a7ad-09e2357f0287 has started process logic with message_id 17e23ae8-df64-4622-93cb-60072cbd0ea8 and thread_id 1049
""2023-11-15 16:40:39.596 [Thread-1124] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id d3459c0a-7492-443d-b058-1c03dc73e481 has started processing message with message_id ef097c17-9f7c-4e09-bdd4-ef984495c8c5 and thread_id 1375 
""2023-11-15 16:40:39.597 [Thread-1124] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:40:39.596 [Thread-844] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select distinct dm.data_movement_id,dcml.metadata_category as source_type, dscl.dataplace_sub_component_type as source from nabu.data_movement_details_physical dm inner join nabu.dataplace_physical dp on dp.dataplace_id=dm.source_dataplace_id
inner join  nabu.dataplace_component_mapping_lookup dcml on dcml.dataplace_sub_component_id =dp.dataplace_sub_component_id
inner join nabu.dataplace_sub_component_lookup dscl on dcml.dataplace_sub_component_id =dscl.dataplace_sub_component_id
where dm.data_movement_id=261 and dp.valid_to_ts='9999-12-31 00:00:00' and dm.valid_to_ts ='9999-12-31 00:00:00'
""2023-11-15 16:40:39.597 [Thread-1124] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=17e23ae8-df64-4622-93cb-60072cbd0ea8, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=ef097c17-9f7c-4e09-bdd4-ef984495c8c5, task_retry_intervals_secs=[], bot_id=9ac78b1a-14c9-4e99-a7ad-09e2357f0287, message_topic=nabu_2_taskmonitor, tags={process_id=1700066438126424, initial_ts=1700066438126, batch_name=, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, TaskMonitorBot]}}
""2023-11-15 16:40:39.792 [Thread-1124] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 1700066438126424, 'DBOpsBot', 'starting_message_for_ingestion', 'checking_pre_conditions_or_starting_msg_of_ingestion', 10 , TO_TIMESTAMP(1700066439142::double precision / 1000) ,'9ac78b1a-14c9-4e99-a7ad-09e2357f0287');
""2023-11-15 16:40:39.792 [Thread-1124] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id d3459c0a-7492-443d-b058-1c03dc73e481 has started process logic with message_id ef097c17-9f7c-4e09-bdd4-ef984495c8c5 and thread_id 1375
""2023-11-15 16:40:39.855 [Thread-844] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select  string_agg('('||where_condition||')',' or ') as where_condition,string_agg('('||table_id_where_condition||')',' or ') as table_id_where_condition,workflow_name,schema_drift_option, schema_drift_option_id
from(
select  data_movement_id,source_dataplace_id,source_schema_id,
case when where_condition is null then 'schema_id = '|| source_schema_id || ' and table_type in ('||ingest_all_tables_views||')'||' and dataplace_id = '||source_dataplace_id
          else string_agg('('||where_condition||')',' and ') over(partition by data_movement_id,source_dataplace_id,source_schema_id) || ' and schema_id = ' || source_schema_id || ' and table_type in ('||ingest_all_tables_views||')'||' and dataplace_id = '||source_dataplace_id end as where_condition,
case when where_condition is null then 'schema_id = '|| source_schema_id ||' and dataplace_id = '||source_dataplace_id
          else string_agg('('||where_condition||')',' and ') over(partition by data_movement_id,source_dataplace_id,source_schema_id) || ' and schema_id = ' || source_schema_id || ' and dataplace_id = '||source_dataplace_id end as table_id_where_condition,
ingest_all_tables_views,workflow_name,schema_drift_option, schema_drift_option_id
from(
select  data_movement_id,source_dataplace_id,source_schema_id,
string_agg('('||where_condition||')',' and ') over(partition by data_movement_id,source_dataplace_id,filter_type_id,source_schema_id) as where_condition,
ingest_all_tables_views,workflow_name,schema_drift_option, schema_drift_option_id
from (
select a.data_movement_id, a.source_dataplace_id, a.source_schema_id, a.filter_type_id,workflow_name,
case when a.filter_type_id = 1 then 'table_name ~* '''||regexp_replace(a.filter_rule::text,'\[|\]|"'::text,''::text,'g')||''''
     when a.filter_type_id = 2 then 'table_name !~* '''||regexp_replace(a.filter_rule::text,'\[|\]|"'::text,''::text,'g')||''''
     when a.filter_type_id = 3 then 'table_name like ''%'||regexp_replace(a.filter_rule::text,'\[|\]|"'::text,''::text,'g')||'%'''
     when a.filter_type_id = 4 then 'table_name not like ''%'||regexp_replace(a.filter_rule::text,'\[|\]|"'::text,''::text,'g')||'%'''
     when a.filter_type_id = 5 then 'table_id in ('||regexp_replace(a.filter_rule::text,'\[|\]|"'::text,''::text,'g')||')'
     else null
     end as where_condition,
     regexp_replace(regexp_replace(a.ingest_all_tables_views::text,'"','''','g'),'\[|\]|'::text,''::text,'g') as ingest_all_tables_views,schema_drift_option, schema_drift_option_id
from
(
select b.data_movement_id,source_dataplace_id,
source_schema_directory_id as source_schema_id,destination_dataplace_id,destination_schema_directory_id as destination_schema_id,
filter_rule,filter_type_id,
ingest_all_tables_views,a.priority_order,d.workflow_name,
case when ((((data_movement_additional_info->>'flow_details')::json->>'schema_drift')::json)->>'advanced_options_sub_type') is null then 'drop_create_table' else ((((data_movement_additional_info->>'flow_details')::json->>'schema_drift')::json)->>'advanced_options_sub_type') end as schema_drift_option,
((((data_movement_additional_info->>'flow_details')::json->>'schema_drift')::json)->>'advanced_options_sub_type_id')::int as schema_drift_option_id
from nabu.data_movement_details_physical a
inner join nabu.dataplace_physical dp
on a.destination_dataplace_id =dp.dataplace_id
inner join nabu.data_movement_physical b
on a.data_movement_id = b.data_movement_id
inner join nabu.workflow_engine c on c.workflow_engine_id = b.workflow_engine_id
inner join nabu.bot_configuration_workflow d on d.workflow_id = b.workflow_id
where b.data_movement_id = 261 and a.valid_to_ts = '9999-12-31'
and b.valid_to_ts = '9999-12-31') a
inner join nabu.filter_type_lookup b
on a.filter_type_id = b.filter_type_id
order by data_movement_id,priority_order
) x
) y
) z
group by data_movement_id,workflow_name,schema_drift_option, schema_drift_option_id

""2023-11-15 16:40:39.917 [Thread-1124] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id d3459c0a-7492-443d-b058-1c03dc73e481 has finished process logic with message_id ef097c17-9f7c-4e09-bdd4-ef984495c8c5 and thread_id 1375
""2023-11-15 16:40:39.917 [Thread-1124] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:40:39.917 [Thread-1124] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id ef097c17-9f7c-4e09-bdd4-ef984495c8c5
""2023-11-15 16:40:39.958 [Thread-844] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with data_movement_schema_drift_table_ids as(
select * from(
select data_movement_id, dataplace_id, schema_directory_id, object_id, cru_ts, row_number() over(partition by object_id order by cru_ts desc) as rownum
from nabu.data_movement_schema_drift_details
where data_movement_id = 261) a
where rownum = 1
),
get_table_ids as (
select table_id from nabu.dataplace_table_metadata_physical dtmp where ((((table_id in (37234))) and schema_id = 453 and table_type in ('T','V','M') and dataplace_id = 42)) and valid_to_ts = '9999-12-31'
),
get_non_schema_drifted_table_ids as(
select a.dataplace_id,a.schema_id, a.dataplace_component_type_id,a.table_id
from nabu.dataplace_table_schema_drift_details a
inner join
data_movement_schema_drift_table_ids b
on a.table_id = b.object_id
and a.schema_id = b.schema_directory_id
and a.dataplace_id = b.dataplace_id
where a.valid_to_ts = '9999-12-31'
and a.crt_ts < b.cru_ts
and b.data_movement_id = 261
union all
select a.dataplace_id,a.schema_id, a.dataplace_component_type_id,a.table_id
from nabu.dataplace_table_schema_drift_details a
inner join
nabu.structured_jobtotable b
on a.table_id = b.object_id
and a.dataplace_id = b.dataplace_id
where b.data_movement_id = 261
and b.object_type = 'S'
and a.valid_to_ts = '9999-12-31'
and b.cru_ts > a.crt_ts
union all
select a.dataplace_id,a.schema_id, a.dataplace_component_type_id,a.table_id
from nabu.dataplace_table_schema_drift_details a
where table_id in(select * from get_table_ids)
and a.valid_to_ts = '9999-12-31'
and table_id not in (select object_id as table_id from nabu.structured_jobtotable b
where b.data_movement_id = 261 and b.object_type = 'S'
)
)
select string_agg(a.table_id::text,',') as schema_drifted_table_id_list from nabu.dataplace_table_schema_drift_details a
where table_id in (select table_id from get_table_ids)
and a.valid_to_ts = '9999-12-31'
and table_id not in (select table_id from get_non_schema_drifted_table_ids)
""2023-11-15 16:40:40.005 [Thread-844] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select job_type_id from nabu.job_type_lookup where job_type='ingestion'
""2023-11-15 16:40:40.041 [Thread-844] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select case count(*) when 0 then true else false end as empty_schma from nabu.dataplace_table_metadata_physical where ((((table_id in (37234))) and schema_id = 453 and table_type in ('T','V','M') and dataplace_id = 42))
""2023-11-15 16:40:40.087 [Thread-844] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with get_table_ids as(
select row_number()over(partition by table_id order by valid_to_ts desc) as rownum,* from nabu.dataplace_table_metadata_physical
where ((((table_id in (37234))) and schema_id = 453 and table_type in ('T','V','M') and dataplace_id = 42))
)
select string_agg(a.table_id::text,',') as object_id from get_table_ids a where rownum =1 and valid_to_ts != '9999-12-31'
""2023-11-15 16:40:40.140 [Thread-844] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with cte2 as(
select rows/1 as flow_number,*
from (
select row_number()over(order by table_id) as rows,* from nabu.dataplace_table_metadata_physical
where ((((table_id in (37234))) and schema_id = 453 and table_type in ('T','V','M') and dataplace_id = 42)) and valid_to_ts='9999-12-31'
)a
),
get_schema_drifted_table_ids as(
select a.dataplace_id,a.schema_id, a.schema_name, a.dataplace_component_type_id,a.table_id
from nabu.table_schema_drift a
where 1 = 0
),
table_ids_for_ingestion as(
select a.* from cte2 a left outer join get_schema_drifted_table_ids b
on a.table_id = b.table_id
and a.schema_id = b.schema_id
and a.schema_name = b.schema_name
and a.dataplace_id = b.dataplace_id
and a.dataplace_component_type_id = b.dataplace_component_type_id
where b.table_id is not null)

select string_agg(a.table_id::text,',') as object_id,
30 as status_code_id,
0 as retry_count
from table_ids_for_ingestion a
""2023-11-15 16:40:40.184 [Thread-844] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : INSERT INTO nabu.flow_task_status
(data_movement_id,  batch_id,job_type_id, status_code_id, retry_count,object_id,process_id, flow_task_ts, flow_task_date)
with cte as (
select 261 as data_movement_id ,  17000664380239952 as batch_id ,1 as job_type_id,30 as status_code_id,0 as retry_count,
unnest(string_to_array('',',' ))::int4 as object_id
)
select a.data_movement_id,a.batch_id,a.job_type_id,a.status_code_id,a.retry_count,a.object_id,('1700066438126424'||a.flow_number) :: bigint as process_id,current_timestamp,current_date from (select cte.*,row_number ()over( order by cte.object_id )as flow_number from cte)a

""2023-11-15 16:40:40.231 [Thread-844] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query :     select case when ((((data_movement_additional_info->>'flow_details')::json->>'schema_drift')::json)->>'advanced_options_sub_type') is null then 'drop_create_table'
else ((((data_movement_additional_info->>'flow_details')::json->>'schema_drift')::json)->>'advanced_options_sub_type') end as schema_drift_option,
case when ((((data_movement_additional_info->>'flow_details')::json->>'schema_drift')::json)->>'advanced_options_sub_type_id') is null then '3'
else ((((data_movement_additional_info->>'flow_details')::json->>'schema_drift')::json)->>'advanced_options_sub_type_id') end as schema_drift_option_id
,data_movement_id
from nabu.data_movement_physical
where data_movement_id = 261
and valid_to_ts = '9999-12-31'
""2023-11-15 16:40:40.273 [Thread-844] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with process_id_for_ignore_tables as(select * from nabu.flow_task_status
where status_code_id= 30
and batch_id = 17000664380239952)

INSERT INTO nabu.data_movement_schema_drift_details
(data_movement_id, dataplace_id, schema_directory_id, object_id, advanced_options_sub_type_id, advanced_options_sub_type, cru_by, cru_ts, batch_id, process_id)
select 261 as data_movement_id, a.dataplace_id, a.schema_id as schema_directory_id, a.table_id as object_id,
4 as advanced_options_sub_type_id,
'drop_create_table' as advanced_options_sub_type, 'Modak', now(),
b.batch_id, b.process_id
from nabu.dataplace_table_schema_drift_details a
inner join process_id_for_ignore_tables b
on a.table_id = b.object_id
where 1 = 0

""2023-11-15 16:40:40.320 [Thread-844] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with datatypes_to_be_ignored as (
 select replace((json_array_elements(data_movement_additional_info->'flow_details'->'ignore_data_types'))::text,'"','') as ignore_data_types
 from nabu.data_movement_physical
 where data_movement_id =261 and valid_to_ts='9999-12-31'
 union
 select source_datatype_name as ignore_data_types from nabu.user_defined_trans_for_unsupported_datatype udtfud where advanced_options_sub_type_id =16 and
	data_movement_id =261 and valid_to_ts='9999-12-31'
),
get_table_ids as(
select table_id from nabu.dataplace_table_metadata_physical dtmp where ((((table_id in (37234))) and schema_id = 453 and table_type in ('T','V','M') and dataplace_id = 42)) and valid_to_ts='9999-12-31'
),
tables_with_valid_column_data_types as (
select table_id, count(*) as cnt
from nabu.dataplace_column_metadata_physical
where table_id in(select * from get_table_ids) and valid_to_ts='9999-12-31'
and data_type not in ( select * from datatypes_to_be_ignored ) group by table_id
),
datatype_ignored_tables as (
select a.table_id, case when b.cnt is null then true when b.cnt is not null then false end as ignore_status_flag
from get_table_ids a
left outer join tables_with_valid_column_data_types b on a.table_id = b.table_id
),
ignored_tables_in_pipeline_adv_opt as(
Select * from datatype_ignored_tables where table_id not in (select object_id from nabu.advanced_options_object_details aood where data_movement_id = 261  and valid_to_ts = '9999-12-31')
)
select string_agg(a.table_id::text,',') as object_id,
 31 as status_code_id,
 0 as retry_count
 from ignored_tables_in_pipeline_adv_opt a where ignore_status_flag=true
""2023-11-15 16:40:40.545 [Thread-844] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : INSERT INTO nabu.flow_task_status
(data_movement_id,batch_id,job_type_id, status_code_id, retry_count,object_id,process_id, flow_task_ts, flow_task_date)
with cte as (
select 261 as data_movement_id , 17000664380239952 as batch_id ,1 as job_type_id,31 as status_code_id,0 as retry_count,
unnest(string_to_array('',',' ))::int4 as object_id
)
select a.data_movement_id,a.batch_id,a.job_type_id,a.status_code_id,a.retry_count,a.object_id,('1700066438126424'||a.flow_number) :: bigint as process_id,current_timestamp,current_date from (select cte.*,row_number ()over( order by cte.object_id )as flow_number from cte)a

""2023-11-15 16:40:40.573 [Thread-844] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select
data_movement_additional_info->'flow_details'->'schema_drift'->'config'->>'suffix' as suffix,
case when ((data_movement_additional_info->>'ingestion_table_format')::json->>'prefix')::boolean
then (data_movement_additional_info->>'ingestion_table_format')::json->>'prefix_value' || '_'
else '' end as ingestion_table_format,
'17000664380239952' as batch_id,(data_movement_additional_info->>'target_relative_path') as relative_file_path,
case when (data_movement_additional_info->>'target_relative_path'='') then false
when ((data_movement_additional_info->>'overwrite_default_relative_path')::varchar='true')then true
 else false end as is_relative_file_path,
data_movement_name
from nabu.data_movement_physical
where
data_movement_id =261
and
valid_to_ts ='9999-12-31'
""2023-11-15 16:40:40.606 [Thread-844] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with cte1 as(select coalesce(data_movement_additional_info->'flow_details'->>'flow_timeout',data_movement_additional_info->'flow_details'->>'pipeline_flow_timeout')::int *3600000 as flow_timeout
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 261 and dmp.valid_to_ts = '9999-12-31' )
select ae.job_type,case when ct.flow_timeout is null then ae.jwt_ttl else flow_timeout end as jwt_ttl
from nabu.authtoken_expiration ae,cte1 as ct where job_type ='default'
""2023-11-15 16:40:40.647 [Thread-844] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with cte2 as(
select rows/1 as flow_number,*
from (
select row_number()over(order by table_id) as rows, table_id,schema_name, dataplace_id from nabu.dataplace_table_metadata_physical
where ((((table_id in (37234))) and schema_id = 453 and table_type in ('T','V','M') and dataplace_id = 42)) and valid_to_ts='9999-12-31'
)a
),
dataplace_details as(
select c.*,
case when (b.dataplace_sub_component_type='hive' or b.dataplace_sub_component_type='cloudera_hive')  then trim(((dataplace_info->>'jdbc_info')::json)->>'database_name')
when ((b.dataplace_sub_component_type = 'bigquery')) then dataplace_info->>'bucket_name'
else trim(dataplace_info->>'database_name') end as source_db
from nabu.dataplace_physical a, nabu.dataplace_sub_component_lookup b, cte2 c
where a.dataplace_sub_component_id = b.dataplace_sub_component_id
and a.dataplace_id = c.dataplace_id
),

get_last_run_timestamp as (
    select flow_task_ts, object_id, data_movement_id from (
    	select flow_task_ts, object_id, data_movement_id,
    	row_number() over( partition by data_movement_id, object_id order by flow_task_ts desc ) as rownum
    	from nabu.flow_task_status
    	where process_id in (
    				select process_id from (
    						select process_id, row_number() over( partition by data_movement_id, object_id order by flow_task_ts desc ) as rownum
    						from nabu.flow_task_status
    						where data_movement_id = 261
    						and object_id in ( select table_id from dataplace_details )
    						and status_code_id = 15
    				)a
    				where rownum = 1
    	)
    	and status_code_id = 19
    )b
    where rownum = 1 and data_movement_id = 261
)

select  17000664380239952 as batch_id,
       'Ingestion_20231115' as batch_name,
       261 as data_movement_id,
       '' as relative_file_path,
       '' as ingestion_table_format,
       '' as suffix,
	  false as is_relative_file_path,
	   lower(a.schema_name) as source_schema_name_lowercase,
	  lower(a.source_db) as source_database_name_lowercase,
	   a.schema_name as source_schema_name,
	  a.source_db as source_database_name,
	   upper(a.schema_name) as source_schema_name_uppercase,
	  upper(a.source_db) as source_database_name_uppercase,
	   'ss_compass_adb_validation' as data_movement_name,
       'modak' as environment,
       1 as job_type_id,
       '' as type,
       1568 as job_schedule_id,
       'Manaswini Chinthalapudi' as job_scheduled_user_id,
       case when b.flow_task_ts is null then '0001-01-01T00:00:00.103+02'::timestamp else b.flow_task_ts end as last_run_timestamp,
        '{
             "payload_variables": {
             }
         }'::json as variables,
        '{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}' :: json as workflow_route_bot_topic_details,
       'artifact_generation' as workflow_name,
       '1700066438126424'||flow_number :: text as process_id,
        table_id  as where_condition,flow_number
        from dataplace_details a
        left outer join get_last_run_timestamp b
        on a.table_id = b.object_id

""2023-11-15 16:40:40.690 [Thread-844] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select 17000664380239952 as batch_id,
       'Ingestion_20231115' as batch_name,
       261 as data_movement_id,
       1568 as job_schedule_id,
       'Manaswini Chinthalapudi' as job_scheduled_user_id,
       'artifact_generation' as workflow_name,
	   '1700066438126424'||workflow_engine_id :: text as process_id,
	   '{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}' :: json as workflow_route_bot_topic_details,
       'email_notification_enable' as flow_name,15 as job_type_id,
       'modak' as environment from nabu.data_movement_physical where data_movement_id = 261
""2023-11-15 16:40:40.747 [Thread-844] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select 17000664380239952 as batch_id,
       'Ingestion_20231115' as batch_name,
       261 as data_movement_id,
       1568 as job_schedule_id,
       data_movement_name,
       '2023-11-07 12:42:00.86365' as last_run_timestamp,
       'Manaswini Chinthalapudi' as job_scheduled_user_id,
       'artifact_generation' as workflow_name,
	   '1700066438126424'||workflow_engine_id :: text as process_id,
        '{
             "payload_variables": {
             }
         }'::json as variables,
	   '{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}' :: json as workflow_route_bot_topic_details,
       'rest_api_notification_enable' as flow_name,
       19 as job_type_id,
       'modak' as environment from nabu.data_movement_physical
       where data_movement_id = 261
       and valid_to_ts = '9999-12-31'
""2023-11-15 16:40:40.793 [Thread-844] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select case when a.email_id='' then false else true end as email_id  from
(select
replace( trim(trailing ']' from trim( leading '[' from (data_movement_additional_info->'flow_details'->>'email_notification')::json->>'on_success' )),'"','')  as email_id
from nabu.data_movement_physical where data_movement_id=261 and valid_to_ts='9999-12-31')a
""2023-11-15 16:40:40.834 [Thread-844] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select case when a.email_id='' then false else true end as email_id  from
(select
replace( trim(trailing ']' from trim( leading '[' from (data_movement_additional_info->'flow_details'->>'email_notification')::json->>'on_failure' )),'"','')  as email_id
from nabu.data_movement_physical where data_movement_id=261 and valid_to_ts='9999-12-31')a
""2023-11-15 16:40:40.871 [Thread-844] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select ((data_movement_additional_info->'flow_details'->>'schema_drift')::json->>'enabled')::boolean as  email_id from nabu.data_movement_physical where data_movement_id = 261 and valid_to_ts='9999-12-31'

""2023-11-15 16:40:40.915 [Thread-844] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : 
with get_rest_api_details as(
    select a.is_postconditions_enabled,
    (a.rest_api_details->>'rest_api_id')::int as rest_api_id,
    (a.rest_api_details->>'rest_api_name')::text as rest_api_name,
    (a.rest_api_details->>'status_code_id')::int as status_code_id,
    (a.rest_api_details->>'payload') as payload,
    (a.rest_api_details->>'ordinal_position')::int ordinal_position
    from (
        select
        (data_movement_additional_info ->'flow_details'->'post_conditions'->>'enabled')::boolean as is_postconditions_enabled,
        json_array_elements(data_movement_additional_info ->'flow_details'->'post_conditions'->'rest_api_details') as rest_api_details
        from nabu.data_movement_physical
        where data_movement_id = 261
        and valid_to_ts ='9999-12-31'
    )a
)
,get_valid_apis as (
	select c.*
	from get_rest_api_details c left outer join nabu_ui.rest_api_info rai
    on c.rest_api_id = rai.rest_api_id
    where rai.valid_to_ts ='9999-12-31'
)
select a.*,
case
	when a.status_code_id = 21 then 'complete'
	when a.status_code_id = 13 then 'error'
	else 'success'
end as status_code_description,
b.rest_api_name||'_'||b.ordinal_position as input_flow from get_valid_apis a
left outer join get_valid_apis b
on a.ordinal_position=b.ordinal_position+1
and a.status_code_id = b.status_code_id
""2023-11-15 16:40:40.977 [Thread-844] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with flows as(
select 1 as task,
'' as emptyOutputTemplate,
'' as outputflows_template,
'' as input_flows,
cast((extract(epoch from now())*100) as bigint)::text||1568||1 as flow_id,
'fc_ingestion_flow_task' as flowtask_template,
 'ingestion_'||'261_17000664380239952' as flow_name,
false as is_success_mail,'ingestion' as flow_type,
'' as output_flows,
'nabu_ingestion' as task_data_key,
17000664380239952
 as batch_id,
261 as data_movement_id,
1568 as job_schedule_id,
coalesce(data_movement_additional_info->'flow_details'->>'flow_timeout',data_movement_additional_info->'flow_details'->>'pipeline_flow_timeout','72') as flow_timeout,
coalesce((data_movement_additional_info->>'flow_details')::json->>'parallel_count',
(data_movement_additional_info->>'flow_details')::json->>'parallel_source_connections','10') as parallel_count,
coalesce(data_movement_additional_info->'flow_details'->>'retry_count','3'):: int as number_of_retries,
true as loggers_required ,
true as pre_agg_stats_required,
true as delete_credentials,
true as delete_almaren,
'' as rest_api_id,'' as payload,
true as flow_condition,82800000 as jwt_ttl, 'default' as authtoken_job_type
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 261 and dmp.valid_to_ts = '9999-12-31'

union all

select 2 as task,
'' as emptyOutputTemplate,
'' as outputflows_template,
'"ingestion_261_17000664380239952.success"' as input_flows,
cast((extract(epoch from now())*100) as bigint)::text||1568||2 as flow_id,
'end_mail_flow_task' as flowtask_template,
'success_notification_email' as flow_name, true as is_success_mail,'success' as flow_type,
'' as output_flows,
'email_input' as task_data_key,
 17000664380239952  as batch_id,
261 as data_movement_id,
1568 as job_schedule_id,
coalesce(data_movement_additional_info->'flow_details'->>'flow_timeout','72') as flow_timeout,
coalesce(data_movement_additional_info->'flow_details'->>'parallel_count','10') as parallel_count,
coalesce(data_movement_additional_info->'flow_details'->>'retry_count','10'):: int as number_of_retries,
false as loggers_required ,
false as pre_agg_stats_required,
false as delete_credentials,
false as delete_almaren,
'' as rest_api_id,'' as payload,
false as flow_condition,82800000 as jwt_ttl,'default' as authtoken_job_type
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 261 and dmp.valid_to_ts = '9999-12-31'
union all

select 3 as task,
'' as emptyOutputTemplate,
'' as outputflows_template,
'"ingestion_261_17000664380239952.error"' as input_flows,
cast((extract(epoch from now())*100) as bigint)::text||1568||3 as flow_id,
'end_mail_flow_task' as flowtask_template,
'failure_notification_email' as flow_name, false as is_success_mail, 'failure' as flow_type,
'' as output_flows,
'email_input' as task_data_key,
 17000664380239952  as batch_id,
261 as data_movement_id,
1568 as job_schedule_id,
coalesce(data_movement_additional_info->'flow_details'->>'flow_timeout','72') as flow_timeout,
coalesce(data_movement_additional_info->'flow_details'->>'parallel_count','10') as parallel_count,
coalesce(data_movement_additional_info->'flow_details'->>'retry_count','10'):: int as number_of_retries,
false as loggers_required ,
false as pre_agg_stats_required,
false as delete_credentials,
false as delete_almaren,
'' as rest_api_id,'' as payload,
false as flow_condition,82800000 as jwt_ttl, 'default' as authtoken_job_type
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 261 and dmp.valid_to_ts = '9999-12-31'

union all

select 4 as task,
'' as emptyOutputTemplate,
'' as outputflows_template,
'"ingestion_261_17000664380239952.flow_timeout"' as input_flows,
cast((extract(epoch from now())*100) as bigint)::text||1568||4 as flow_id,
'timed_out_end_mail_flow_task' as flowtask_template,
'flow_timeout_notification_email' as flow_name, false as is_success_mail, null as flow_type,
'' as output_flows,
'email_input' as task_data_key,
 17000664380239952  as batch_id,
261 as data_movement_id,
1568 as job_schedule_id,
coalesce(data_movement_additional_info->'flow_details'->>'flow_timeout','72') as flow_timeout,
coalesce(data_movement_additional_info->'flow_details'->>'parallel_count','10') as parallel_count,
coalesce(data_movement_additional_info->'flow_details'->>'retry_count','10'):: int as number_of_retries,
false as loggers_required ,
false as pre_agg_stats_required,
false as delete_credentials,
false as delete_almaren,
'' as rest_api_id,'' as payload,
false as flow_condition,82800000 as jwt_ttl, 'default' as authtoken_job_type
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 261 and dmp.valid_to_ts = '9999-12-31'

union all

select 5 as task,
'' as emptyOutputTemplate,
'' as outputflows_template,
'' as input_flows,
cast((extract(epoch from now())*100) as bigint)::text||1568||5 as flow_id,
'schema_drift_mail_flow_task' as flowtask_template,
'schema_drift_notification_email' as flow_name, false as is_success_mail, 'schema_drift' as flow_type,
'' as output_flows,
'email_input' as task_data_key,
 17000664380239952  as batch_id,
261 as data_movement_id,
1568 as job_schedule_id,
coalesce(data_movement_additional_info->'flow_details'->>'flow_timeout','72') as flow_timeout,
coalesce(data_movement_additional_info->'flow_details'->>'parallel_count','3') as parallel_count,
coalesce(data_movement_additional_info->'flow_details'->>'retry_count','10'):: int as number_of_retries,
false as loggers_required ,
false as pre_agg_stats_required,
false as delete_credentials,
false as delete_almaren,
'' as rest_api_id,'' as payload,
false as flow_condition,82800000 as jwt_ttl, 'default' as authtoken_job_type
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 261 and dmp.valid_to_ts = '9999-12-31'

union all

select 6 as task,
'' as emptyOutputTemplate,'' as outputflows_template,
'"ingestion_261_17000664380239952.success"' as input_flows,
cast((extract(epoch from now())*100) as bigint)::text||1568||6 as flow_id,
'end_mail_flow_task_manual_retry' as flowtask_template,
'success_notification_email_manual_retry' as flow_name, true as is_success_mail, 'success' as flow_type,
'' as output_flows,
'email_input' as task_data_key,
 17000664380239952  as batch_id,
261 as data_movement_id,
1568 as job_schedule_id,
coalesce(data_movement_additional_info->'flow_details'->>'flow_timeout','72') as flow_timeout,
coalesce(data_movement_additional_info->'flow_details'->>'parallel_count','10') as parallel_count,
coalesce(data_movement_additional_info->'flow_details'->>'retry_count','10'):: int as number_of_retries,
false as loggers_required ,
false as pre_agg_stats_required,
false as delete_credentials,
false as delete_almaren,
'' as rest_api_id,'' as payload,
false as flow_condition,82800000 as jwt_ttl, 'default' as authtoken_job_type
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 261 and dmp.valid_to_ts = '9999-12-31'

union all

select 7 as task,
'' as emptyOutputTemplate,
'' as outputflows_template,
'"ingestion_261_17000664380239952.error"' as input_flows,
cast((extract(epoch from now())*100) as bigint)::text||1568||7 as flow_id,
'end_mail_flow_task_manual_retry' as flowtask_template,
'failure_notification_email_manual_retry' as flow_name, false as is_success_mail, 'failure' as flow_type,
'' as output_flows,
'email_input' as task_data_key,
 17000664380239952  as batch_id,
261 as data_movement_id,
1568 as job_schedule_id,
coalesce(data_movement_additional_info->'flow_details'->>'flow_timeout','72') as flow_timeout,
coalesce(data_movement_additional_info->'flow_details'->>'parallel_count','3') as parallel_count,
coalesce(data_movement_additional_info->'flow_details'->>'retry_count','10'):: int as number_of_retries,
false as loggers_required ,
false as pre_agg_stats_required,
false as delete_credentials,
false as delete_almaren,
'' as rest_api_id,'' as payload,
false as flow_condition,82800000 as jwt_ttl, 'default' as authtoken_job_type
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 261 and dmp.valid_to_ts = '9999-12-31'

union all

select 8 as task,
'' as emptyOutputTemplate,
'' as outputflows_template,
'"ingestion_261_17000664380239952.flow_timeout"' as input_flows,
cast((extract(epoch from now())*100) as bigint)::text||1568||8 as flow_id,
'timed_out_end_mail_flow_task' as flowtask_template,
'flow_timeout_notification_email_manual_retry' as flow_name, true as is_success_mail, '_manual_retry' as flow_type,
'' as output_flows,
'email_input' as task_data_key,
 17000664380239952  as batch_id,
261 as data_movement_id,
1568 as job_schedule_id,
coalesce(data_movement_additional_info->'flow_details'->>'flow_timeout','72') as flow_timeout,
coalesce(data_movement_additional_info->'flow_details'->>'parallel_count','3') as parallel_count,
coalesce(data_movement_additional_info->'flow_details'->>'retry_count','10'):: int as number_of_retries,
false as loggers_required ,
false as pre_agg_stats_required,
false as delete_credentials,
false as delete_almaren,
'' as rest_api_id,'' as payload,
false as flow_condition,82800000 as jwt_ttl, 'default' as authtoken_job_type
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 261 and dmp.valid_to_ts = '9999-12-31'

)
select * from flows where flow_condition=true order by  task asc
""2023-11-15 16:40:41.021 [Thread-844] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select 261 as data_movement_id,1 as job_type_id, 17000664380239952 as batch_id  ,36  as status_code_id , 1568 as job_schedule_id
""2023-11-15 16:40:41.055 [Thread-844] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select
coalesce (data_movement_additional_info->'flow_details'->>'pipeline_flow_timeout','72') as flow_timeout
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 261 and dmp.valid_to_ts = '9999-12-31'
""2023-11-15 16:40:41.059 [Thread-844] DEBUG com.modak.bots.DBOpsBot - to execute query timeTakenInMillis : 1546
""2023-11-15 16:40:41.060 [Thread-844] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 9ac78b1a-14c9-4e99-a7ad-09e2357f0287 has finished process logic with message_id 17e23ae8-df64-4622-93cb-60072cbd0ea8 and thread_id 1049
""2023-11-15 16:40:41.060 [Thread-844] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-15 16:40:41.215 [Thread-844] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "DBOpsBot", "bot_metadata": { "message_id": "904f67cb-f816-4d44-bbad-71773cb9268b", "parent_id": "17e23ae8-df64-4622-93cb-60072cbd0ea8", "bot_id": "9ac78b1a-14c9-4e99-a7ad-09e2357f0287", "message_topic":"nabu_2_jdbc", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":1700066438126424, "initial_ts":1700066438126, "batch_id":17000664380239952, "batch_name":"", "job_schedule_id":1568, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "", "environment": "modak", "ignore_job_termination" : false, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot" ],"task_dependency":true}, "task_retry_intervals_secs": [ ], "message_context": "data_movement_deciding" }, "bot_tasks": [ { "task_name": "data_movement_deciding_msg", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "pre_task_logging_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "pre_log_template" }, "app_template_details": { "template_group": "templates/artifact_ingestion/ingestion_fc.stg", "template_name": "doNothingTemplate" }, "input_data": { "template_execution_type": "single", "query_type":"json", "encryption_details" : {"encryption" : "no"}, "query_input": { "condition_for_success_mail" : [ { "email_id" : false } ], "get_deleted_objects" : [ { "object_id" : null } ], "get_batch_datamovement_id" : [ { "data_movement_id" : 261, "job_type_id" : 1, "batch_id" : 17000664380239952, "status_code_id" : 36, "job_schedule_id" : 1568 } ], "email_input" : [ { "batch_id" : 17000664380239952, "batch_name" : "Ingestion_20231115", "data_movement_id" : 261, "job_schedule_id" : 1568, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "workflow_name" : "artifact_generation", "process_id" : "17000664381264242", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "flow_name" : "email_notification_enable", "job_type_id" : 15, "environment" : "modak" } ], "rest_api_input" : [ { "batch_id" : 17000664380239952, "batch_name" : "Ingestion_20231115", "data_movement_id" : 261, "job_schedule_id" : 1568, "data_movement_name" : "ss_compass_adb_validation", "last_run_timestamp" : "2023-11-07 12:42:00.86365", "job_scheduled_user_id" : "Manaswini Chinthalapudi", "workflow_name" : "artifact_generation", "process_id" : "17000664381264242", "variables" : { "payload_variables" : {} }, "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "flow_name" : "rest_api_notification_enable", "job_type_id" : 19, "environment" : "modak" } ], "get_ignore_null_tables" : null, "condition_for_schema_drift_mail" : [ { "email_id" : true } ], "check_if_selected_schemas_are_empty" : [ { "empty_schma" : false } ], "get_datatype_ignore_tables" : [ { "object_id" : null, "status_code_id" : 31, "retry_count" : 0 } ], "get_schema_drift_ignore_tables" : [ { "object_id" : null, "status_code_id" : 30, "retry_count" : 0 } ], "condition_for_failure_mail" : [ { "email_id" : false } ], "schema_drift_table_info" : [ { "schema_drifted_table_id_list" : null } ], "flows" : [ { "task" : 1, "emptyoutputtemplate" : "", "outputflows_template" : "", "input_flows" : "", "flow_id" : "17000664409915681", "flowtask_template" : "fc_ingestion_flow_task", "flow_name" : "ingestion_261_17000664380239952", "is_success_mail" : false, "flow_type" : "ingestion", "output_flows" : "", "task_data_key" : "nabu_ingestion", "batch_id" : 17000664380239952, "data_movement_id" : 261, "job_schedule_id" : 1568, "flow_timeout" : "23", "parallel_count" : "1", "number_of_retries" : 0, "loggers_required" : true, "pre_agg_stats_required" : true, "delete_credentials" : true, "delete_almaren" : true, "rest_api_id" : "", "payload" : "", "flow_condition" : true, "jwt_ttl" : 82800000, "authtoken_job_type" : "default" } ], "get_jwt_details" : [ { "job_type" : "default", "jwt_ttl" : 82800000 } ], "nabu_ingestion" : [ { "batch_id" : 17000664380239952, "batch_name" : "Ingestion_20231115", "data_movement_id" : 261, "relative_file_path" : "", "ingestion_table_format" : "", "suffix" : "", "is_relative_file_path" : false, "source_schema_name_lowercase" : "acuity-develop", "source_database_name_lowercase" : "development-db", "source_schema_name" : "acuity-develop", "source_database_name" : "development-db", "source_schema_name_uppercase" : "ACUITY-DEVELOP", "source_database_name_uppercase" : "DEVELOPMENT-DB", "data_movement_name" : "ss_compass_adb_validation", "environment" : "modak", "job_type_id" : 1, "type" : "", "job_schedule_id" : 1568, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "last_run_timestamp" : "2023-11-07 12:42:00.86365", "variables" : { "payload_variables" : {} }, "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "workflow_name" : "artifact_generation", "process_id" : "17000664381264241", "where_condition" : 37234, "flow_number" : 1 } ], "source_metadata_category" : [ { "data_movement_id" : 261, "source_type" : "relational", "source" : "sql_server" } ], "flow_controller_timeout" : [ { "flow_timeout" : "23" } ] } }, "skipLogicPattern" : "doNothing", "output_message_templates": [ { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "flow_controller_message_for_ingestion", "useIncomingData":true }, { "template_group": "templates/artifact_ingestion/ingestion_flow.stg", "template_name": "task_status_success_msg", "useIncomingData":true } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/ingestion_templates.stg", "template_name": "error_template_create_msg" } ] } ] }
""2023-11-15 16:40:41.223 [Thread-844] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_jdbc
""2023-11-15 16:40:41.311 [Thread-844] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_jdbc
""2023-11-15 16:40:41.311 [Thread-844] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-15 16:40:41.314 [Thread-1228] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 5645838a-33b2-48a4-86c1-4538fa4c0a4c has started processing message with message_id 904f67cb-f816-4d44-bbad-71773cb9268b and thread_id 1497 
""2023-11-15 16:40:41.314 [Thread-1228] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:40:41.314 [Thread-1228] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=17e23ae8-df64-4622-93cb-60072cbd0ea8, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=data_movement_deciding, message_id=904f67cb-f816-4d44-bbad-71773cb9268b, task_retry_intervals_secs=[], bot_id=9ac78b1a-14c9-4e99-a7ad-09e2357f0287, message_topic=nabu_2_jdbc, tags={process_id=1700066438126424, batch_id=17000664380239952, job_scheduled_user_id=Manaswini Chinthalapudi, tags=[AuthToken, DBOpsBot], initial_ts=1700066438126, batch_name=, environment=modak, job_schedule_id=1568, data_movement_id=261, last_run_timestamp=, retry_attempt=0, task_dependency=true, ignore_job_termination=false}}
""2023-11-15 16:40:41.373 [Thread-1228] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
doNothing
""2023-11-15 16:40:41.384 [Thread-1228] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 16:40:41.386 [Thread-1228] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:40:41.580 [Thread-844] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "d656b3cb-84e8-478d-9c31-7ddd6ab1ed29", "parent_id": "17e23ae8-df64-4622-93cb-60072cbd0ea8", "bot_id": "9ac78b1a-14c9-4e99-a7ad-09e2357f0287", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":1700066438126424, "initial_ts":1700066438126, "batch_id":17000664380239952, "batch_name":"", "job_schedule_id":1568, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"9ac78b1a-14c9-4e99-a7ad-09e2357f0287", "bot_name":"DBOpsBot", "process_context":"starting_message_for_ingestion", "task_name":"checking_pre_conditions_or_starting_msg_of_ingestion", "process_id":"1700066438126424", "task_ts":1700066441060, "batch_id":"17000664380239952", "status_code_id": 6 } } ] }
""2023-11-15 16:40:41.604 [Thread-844] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:40:41.793 [Thread-844] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:40:41.793 [Thread-844] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:40:41.793 [Thread-844] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot finished processing message with id 17e23ae8-df64-4622-93cb-60072cbd0ea8
""2023-11-15 16:40:41.794 [Thread-1228] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:40:41.795 [Thread-1228] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : true
""2023-11-15 16:40:41.821 [Thread-520] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 7b28e22d-3ddf-4bc2-8582-71b466eff01f has started processing message with message_id d656b3cb-84e8-478d-9c31-7ddd6ab1ed29 and thread_id 667 
""2023-11-15 16:40:41.822 [Thread-520] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:40:41.822 [Thread-520] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=17e23ae8-df64-4622-93cb-60072cbd0ea8, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=d656b3cb-84e8-478d-9c31-7ddd6ab1ed29, task_retry_intervals_secs=[], bot_id=9ac78b1a-14c9-4e99-a7ad-09e2357f0287, message_topic=nabu_2_taskmonitor, tags={process_id=1700066438126424, initial_ts=1700066438126, batch_name=, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, TaskMonitorBot]}}
""2023-11-15 16:40:41.826 [Thread-128] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 568ef160-0090-481a-b7fb-be051b3c6ef2 has started processing message with message_id 3da12a05-9fcf-4136-b06a-d08ff1b5659b and thread_id 210 
""2023-11-15 16:40:41.827 [Thread-128] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:40:41.827 [Thread-128] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=904f67cb-f816-4d44-bbad-71773cb9268b, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=3da12a05-9fcf-4136-b06a-d08ff1b5659b, task_retry_intervals_secs=[], bot_id=5645838a-33b2-48a4-86c1-4538fa4c0a4c, message_topic=nabu_2_taskmonitor, tags={process_id=1700066438126424, initial_ts=1700066438126, batch_name=, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, TaskMonitorBot]}}
""2023-11-15 16:40:41.846 [Thread-128] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 1700066438126424, 'DBOpsBot', 'data_movement_deciding', 'data_movement_deciding_msg', 10 , TO_TIMESTAMP(1700066441314::double precision / 1000) ,'5645838a-33b2-48a4-86c1-4538fa4c0a4c');
""2023-11-15 16:40:41.846 [Thread-128] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 568ef160-0090-481a-b7fb-be051b3c6ef2 has started process logic with message_id 3da12a05-9fcf-4136-b06a-d08ff1b5659b and thread_id 210
""2023-11-15 16:40:41.846 [Thread-1228] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "FlowControllerBot", "bot_metadata": { "message_id": "f4fca0e9-0d78-4928-b49f-ecea9eb3b5cf", "parent_id": "904f67cb-f816-4d44-bbad-71773cb9268b", "bot_id": "5645838a-33b2-48a4-86c1-4538fa4c0a4c", "message_topic":"nabu_2_flowcontroller", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":1700066438126424, "initial_ts":1700066438126, "batch_id":17000664380239952, "batch_name":"", "job_schedule_id":1568, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "", "environment": "modak", "ignore_job_termination" : false, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot" ],"task_dependency":true}, "task_retry_intervals_secs": [ ], "message_context": "flowcontroller_message_to_generate_flows" }, "bot_tasks": [ { "task_name": "generate_flows", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "pre_task_logging_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "pre_log_template" }, "app_template_details": { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "generate_flows" }, "input_data":{ "query_input" : { "condition_for_success_mail" : [ { "email_id" : false } ], "get_deleted_objects" : [ { "object_id" : null } ], "get_batch_datamovement_id" : [ { "status_code_id" : 36, "batch_id" : 17000664380239952, "job_schedule_id" : 1568, "data_movement_id" : 261, "job_type_id" : 1 } ], "email_input" : [ { "process_id" : "17000664381264242", "batch_name" : "Ingestion_20231115", "environment" : "modak", "batch_id" : 17000664380239952, "workflow_name" : "artifact_generation", "job_schedule_id" : 1568, "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "data_movement_id" : 261, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "flow_name" : "email_notification_enable", "job_type_id" : 15 } ], "rest_api_input" : [ { "process_id" : "17000664381264242", "variables" : { "payload_variables" : {} }, "batch_id" : 17000664380239952, "workflow_name" : "artifact_generation", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "flow_name" : "rest_api_notification_enable", "job_type_id" : 19, "batch_name" : "Ingestion_20231115", "environment" : "modak", "job_schedule_id" : 1568, "data_movement_id" : 261, "last_run_timestamp" : "2023-11-07 12:42:00.86365", "data_movement_name" : "ss_compass_adb_validation" } ], "get_ignore_null_tables" : null, "condition_for_schema_drift_mail" : [ { "email_id" : true } ], "check_if_selected_schemas_are_empty" : [ { "empty_schma" : false } ], "get_datatype_ignore_tables" : [ { "status_code_id" : 31, "retry_count" : 0, "object_id" : null } ], "get_schema_drift_ignore_tables" : [ { "status_code_id" : 30, "retry_count" : 0, "object_id" : null } ], "condition_for_failure_mail" : [ { "email_id" : false } ], "schema_drift_table_info" : [ { "schema_drifted_table_id_list" : null } ], "flows" : [ { "jwt_ttl" : 82800000, "rest_api_id" : "", "batch_id" : 17000664380239952, "pre_agg_stats_required" : true, "outputflows_template" : "", "parallel_count" : "1", "emptyoutputtemplate" : "", "payload" : "", "flow_id" : "17000664409915681", "job_schedule_id" : 1568, "delete_credentials" : true, "number_of_retries" : 0, "delete_almaren" : true, "input_flows" : "", "flow_name" : "ingestion_261_17000664380239952", "output_flows" : "", "task_data_key" : "nabu_ingestion", "flow_condition" : true, "task" : 1, "flow_type" : "ingestion", "authtoken_job_type" : "default", "is_success_mail" : false, "flowtask_template" : "fc_ingestion_flow_task", "data_movement_id" : 261, "flow_timeout" : "23", "loggers_required" : true } ], "get_jwt_details" : [ { "job_type" : "default", "jwt_ttl" : 82800000 } ], "nabu_ingestion" : [ { "process_id" : "17000664381264241", "flow_number" : 1, "source_database_name_lowercase" : "development-db", "batch_id" : 17000664380239952, "workflow_name" : "artifact_generation", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "where_condition" : 37234, "suffix" : "", "type" : "", "job_type_id" : 1, "ingestion_table_format" : "", "job_schedule_id" : 1568, "relative_file_path" : "", "data_movement_name" : "ss_compass_adb_validation", "source_schema_name_lowercase" : "acuity-develop", "variables" : { "payload_variables" : {} }, "source_database_name_uppercase" : "DEVELOPMENT-DB", "job_scheduled_user_id" : "Manaswini Chinthalapudi", "source_schema_name_uppercase" : "ACUITY-DEVELOP", "source_schema_name" : "acuity-develop", "batch_name" : "Ingestion_20231115", "environment" : "modak", "source_database_name" : "development-db", "data_movement_id" : 261, "last_run_timestamp" : "2023-11-07 12:42:00.86365", "is_relative_file_path" : false } ], "source_metadata_category" : [ { "data_movement_id" : 261, "source_type" : "relational", "source" : "sql_server" } ], "flow_controller_timeout" : [ { "flow_timeout" : "23" } ] }, "encryption_details" : { "encryption" : "no" }, "batch_id" : "17000664380239952", "template_execution_type" : "single", "query_type" : "json", "currentBotMessageMap" : { "parent_id" : "17e23ae8-df64-4622-93cb-60072cbd0ea8", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "message_context" : "data_movement_deciding", "message_id" : "904f67cb-f816-4d44-bbad-71773cb9268b", "task_retry_intervals_secs" : [], "bot_id" : "9ac78b1a-14c9-4e99-a7ad-09e2357f0287", "message_topic" : "nabu_2_jdbc", "tags" : { "process_id" : 1700066438126424, "batch_id" : 17000664380239952, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "tags" : [ "AuthToken", "DBOpsBot" ], "initial_ts" : 1700066438126, "batch_name" : "", "environment" : "modak", "job_schedule_id" : 1568, "data_movement_id" : 261, "last_run_timestamp" : "", "retry_attempt" : 0, "task_dependency" : true, "ignore_job_termination" : false } } }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "task_status_success_msg" } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "error_template_create_msg" } ], "loggers":{ "pre_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "bot_pre_log", "log_type": "FILE", "log_file_location": "../logs/logger_output.log" } ], "post_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "bot_post_log", "log_type": "FILE", "log_file_location": "../logs/logger_output.log" } ], "error_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "bot_error_log", "log_type": "FILE", "log_file_location": "../logs/logger_output.log" } ] } } ] } 
""2023-11-15 16:40:41.868 [Thread-520] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 1700066438126424, 'DBOpsBot', 'starting_message_for_ingestion', 'checking_pre_conditions_or_starting_msg_of_ingestion', 6 , TO_TIMESTAMP(1700066441060::double precision / 1000) ,'9ac78b1a-14c9-4e99-a7ad-09e2357f0287');
""2023-11-15 16:40:41.868 [Thread-520] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 7b28e22d-3ddf-4bc2-8582-71b466eff01f has started process logic with message_id d656b3cb-84e8-478d-9c31-7ddd6ab1ed29 and thread_id 667
""2023-11-15 16:40:41.889 [Thread-1228] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_flowcontroller
""2023-11-15 16:40:41.893 [Thread-1228] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_flowcontroller
""2023-11-15 16:40:41.893 [Thread-1228] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : true
""2023-11-15 16:40:42.046 [Thread-520] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 7b28e22d-3ddf-4bc2-8582-71b466eff01f has finished process logic with message_id d656b3cb-84e8-478d-9c31-7ddd6ab1ed29 and thread_id 667
""2023-11-15 16:40:42.046 [Thread-520] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:40:42.046 [Thread-520] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id d656b3cb-84e8-478d-9c31-7ddd6ab1ed29
""2023-11-15 16:40:42.074 [Thread-128] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 568ef160-0090-481a-b7fb-be051b3c6ef2 has finished process logic with message_id 3da12a05-9fcf-4136-b06a-d08ff1b5659b and thread_id 210
""2023-11-15 16:40:42.074 [Thread-128] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:40:42.074 [Thread-128] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 3da12a05-9fcf-4136-b06a-d08ff1b5659b
""2023-11-15 16:40:42.082 [pool-24-thread-1] INFO  com.modak.bots.basebot.AbstractBaseBot - FlowControllerBot with bot_id 9a243656-a8f6-45a1-bf1a-431a00d18e91 has started processing message with message_id f4fca0e9-0d78-4928-b49f-ecea9eb3b5cf and thread_id 2466 
""2023-11-15 16:40:42.093 [pool-24-thread-1] INFO  com.modak.utils.logging.LoggingTemplateUtitlity - 2023-11-15 16:40:42.083 Task start generate_flows of process_id 1700066438126424 of bot FlowControllerBot  with id 9a243656-a8f6-45a1-bf1a-431a00d18e91
""2023-11-15 16:40:42.282 [pool-24-thread-1] INFO  com.modak.utils.logging.FileLogger - ../logs/logger_output.log
""2023-11-15 16:40:42.282 [pool-24-thread-1] DEBUG com.modak.utils.logging.FileLogger - Log file executed 2023-11-15 16:40:42.083 Task start generate_flows of process_id 1700066438126424 of bot FlowControllerBot  with id 9a243656-a8f6-45a1-bf1a-431a00d18e91 
""2023-11-15 16:40:42.283 [pool-24-thread-1] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=904f67cb-f816-4d44-bbad-71773cb9268b, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=flowcontroller_message_to_generate_flows, message_id=f4fca0e9-0d78-4928-b49f-ecea9eb3b5cf, task_retry_intervals_secs=[], bot_id=5645838a-33b2-48a4-86c1-4538fa4c0a4c, message_topic=nabu_2_flowcontroller, tags={process_id=1700066438126424, batch_id=17000664380239952, job_scheduled_user_id=Manaswini Chinthalapudi, tags=[AuthToken, DBOpsBot, DBOpsBot], initial_ts=1700066438126, batch_name=, environment=modak, job_schedule_id=1568, data_movement_id=261, last_run_timestamp=, retry_attempt=0, task_dependency=true, ignore_job_termination=false}}
""2023-11-15 16:40:42.311 [pool-24-thread-1] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
{ "flows":[ { "flowName": "ingestion_261_17000664380239952", "flowId":17000664409915681, "batch_id":17000664380239952, "job_schedule_id": "1568", "job_type_id": 1, "data_movement_id":"261", "flow_type": "ingestion", "metaflowData": { "tags": { "tags": [ "ingestion_261_17000664380239952" ] } }, "configuration": { "parallel":1, "flowTimeoutHrs":23 }, "uiInfo": { "description": "Auto generated by flow controller for flow ingestion_261_17000664380239952" }, "flowTasks": [ { "flowTaskName": "spark_ingestion_almaren_261_1", "flowTaskId": 2611, "processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "bot_metadata": { "tags":{ "process_id":17000664381264241, "batch_id": 17000664380239952, "batch_name": "Ingestion_20231115", "environment": "modak", "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "2023-11-07 12:42:00.86365", "job_schedule_id": 1568, "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"} } }, "app_template_details": { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "generate_input_data" }, "input_data": { "variables": { "env_variables": { }, "user_variables": { }, "payload_variables": { } }, "environment": "modak", "data_movement_id":"261", "process_id": "17000664381264241", "batch_id": "17000664380239952", "batch_name": "Ingestion_20231115", "workflow_name": "artifact_generation", "where_condition":"37234", "flow_number":1, "job_schedule_id": 1568, "job_scheduled_user_id": "Manaswini Chinthalapudi", "relative_file_path": "", "ingestion_table_format": "", "suffix": "", "is_relative_file_path": false, "source_schema_name": "acuity-develop", "source_database_name": "development-db", "source_schema_name_lowercase": "acuity-develop", "source_database_name_lowercase": "development-db", "source_database_name_uppercase": "DEVELOPMENT-DB", "source_schema_name_uppercase": "ACUITY-DEVELOP", "data_movement_name":"ss_compass_adb_validation", "last_run_timestamp": "2023-11-07 12:42:00.86365", "job_type_id":"1", "jwt_ttl":"82800000", "authtoken_job_type":"default" }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "artifact_generation_auth_token_msg" } ], "retry_template": { "retry_template_group": "templates/artifact_ingestion/flow_controller.stg", "retry_template_name": "artifact_generation_auth_token_msg_retry" }, "loggers":{ "scheduled_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_scheduled_log", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" } ], "pre_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_running_log", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_pre_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" } ], "post_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_post_log_db", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_post_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" } ], "retry_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_retry_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" } ] }, "completionCriteria": { "success":{ "botTopics": [ "nabu_2_completion" ], "criteria":[ "AND", { "bot_metadata.tags.process_id": 17000664381264241, "opOperator": "==" }, { "bot_metadata.message_context": "end_of_the_flow", "opOperator": "==" } ] }, "error": { "botTopics": [ "nabu_2_errorbot" ], "criteria": [ "AND", { "opOperator": "==", "bot_metadata.tags.process_id": 17000664381264241 }, { "opOperator": "==", "bot_metadata.message_context": "taskstatus_bot_error_msg" } ] }, "retry": [ "AND", { "error_data.retry_attempt": 0, "opOperator": "<" }, { "error_data.error_json": "(?i).*exception.*", "opOperator": "~" } ] } } ], "inputFlows": [], "outputFlows": [], "flowOutputTemplates": [ { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "delete_almaren_code_from_kosh" }, { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "delete_created_credentials" } ,{ "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "insert_pre_agg_stats_template" } ] ,"loggers":{ "pre_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_pre_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_pre_log_db", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" } ], "post_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_post_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_post_log_db", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" } ] } } ], "flow_timeout":23 }
""2023-11-15 16:40:42.322 [pool-24-thread-1] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 16:40:42.323 [pool-24-thread-1] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:40:42.375 [pool-24-thread-1] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:40:42.375 [pool-24-thread-1] INFO  com.modak.bots.basebot.AbstractBaseBot - FlowControllerBot with bot_id 9a243656-a8f6-45a1-bf1a-431a00d18e91 has started process logic with message_id f4fca0e9-0d78-4928-b49f-ecea9eb3b5cf and thread_id 2466
""2023-11-15 16:40:42.376 [pool-24-thread-1] DEBUG com.modak.bots.FlowControllerBot - FlowController bot data : { "flows":[ { "flowName": "ingestion_261_17000664380239952", "flowId":17000664409915681, "batch_id":17000664380239952, "job_schedule_id": "1568", "job_type_id": 1, "data_movement_id":"261", "flow_type": "ingestion", "metaflowData": { "tags": { "tags": [ "ingestion_261_17000664380239952" ] } }, "configuration": { "parallel":1, "flowTimeoutHrs":23 }, "uiInfo": { "description": "Auto generated by flow controller for flow ingestion_261_17000664380239952" }, "flowTasks": [ { "flowTaskName": "spark_ingestion_almaren_261_1", "flowTaskId": 2611, "processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "bot_metadata": { "tags":{ "process_id":17000664381264241, "batch_id": 17000664380239952, "batch_name": "Ingestion_20231115", "environment": "modak", "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "2023-11-07 12:42:00.86365", "job_schedule_id": 1568, "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"} } }, "app_template_details": { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "generate_input_data" }, "input_data": { "variables": { "env_variables": { }, "user_variables": { }, "payload_variables": { } }, "environment": "modak", "data_movement_id":"261", "process_id": "17000664381264241", "batch_id": "17000664380239952", "batch_name": "Ingestion_20231115", "workflow_name": "artifact_generation", "where_condition":"37234", "flow_number":1, "job_schedule_id": 1568, "job_scheduled_user_id": "Manaswini Chinthalapudi", "relative_file_path": "", "ingestion_table_format": "", "suffix": "", "is_relative_file_path": false, "source_schema_name": "acuity-develop", "source_database_name": "development-db", "source_schema_name_lowercase": "acuity-develop", "source_database_name_lowercase": "development-db", "source_database_name_uppercase": "DEVELOPMENT-DB", "source_schema_name_uppercase": "ACUITY-DEVELOP", "data_movement_name":"ss_compass_adb_validation", "last_run_timestamp": "2023-11-07 12:42:00.86365", "job_type_id":"1", "jwt_ttl":"82800000", "authtoken_job_type":"default" }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "artifact_generation_auth_token_msg" } ], "retry_template": { "retry_template_group": "templates/artifact_ingestion/flow_controller.stg", "retry_template_name": "artifact_generation_auth_token_msg_retry" }, "loggers":{ "scheduled_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_scheduled_log", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" } ], "pre_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_running_log", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_pre_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" } ], "post_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_post_log_db", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_post_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" } ], "retry_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_retry_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" } ] }, "completionCriteria": { "success":{ "botTopics": [ "nabu_2_completion" ], "criteria":[ "AND", { "bot_metadata.tags.process_id": 17000664381264241, "opOperator": "==" }, { "bot_metadata.message_context": "end_of_the_flow", "opOperator": "==" } ] }, "error": { "botTopics": [ "nabu_2_errorbot" ], "criteria": [ "AND", { "opOperator": "==", "bot_metadata.tags.process_id": 17000664381264241 }, { "opOperator": "==", "bot_metadata.message_context": "taskstatus_bot_error_msg" } ] }, "retry": [ "AND", { "error_data.retry_attempt": 0, "opOperator": "<" }, { "error_data.error_json": "(?i).*exception.*", "opOperator": "~" } ] } } ], "inputFlows": [], "outputFlows": [], "flowOutputTemplates": [ { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "delete_almaren_code_from_kosh" }, { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "delete_created_credentials" } ,{ "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "insert_pre_agg_stats_template" } ] ,"loggers":{ "pre_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_pre_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_pre_log_db", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" } ], "post_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_post_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_post_log_db", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" } ] } } ], "flow_timeout":23 }
""2023-11-15 16:40:42.377 [pool-24-thread-1] DEBUG com.modak.bots.FlowControllerBot - flowMap to flowcontroller is {flows=[{flowOutputTemplates=[{template_name=delete_almaren_code_from_kosh, template_group=templates/artifact_ingestion/flow_controller.stg}, {template_name=delete_created_credentials, template_group=templates/artifact_ingestion/flow_controller.stg}, {template_name=insert_pre_agg_stats_template, template_group=templates/artifact_ingestion/flow_controller.stg}], batch_id=17000664380239952, configuration={parallel=1, flowTimeoutHrs=23}, loggers={post_loggers=[{template_name=flow_post_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_post_log_db, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], pre_loggers=[{template_name=flow_pre_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_pre_log_db, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}]}, flowName=ingestion_261_17000664380239952, job_type_id=1, flow_type=ingestion, uiInfo={description=Auto generated by flow controller for flow ingestion_261_17000664380239952}, flowTasks=[{input_data={jwt_ttl=82800000, process_id=17000664381264241, flow_number=1, source_database_name_lowercase=development-db, batch_id=17000664380239952, workflow_name=artifact_generation, where_condition=37234, suffix=, job_type_id=1, ingestion_table_format=, job_schedule_id=1568, relative_file_path=, data_movement_name=ss_compass_adb_validation, source_schema_name_lowercase=acuity-develop, variables={env_variables={}, user_variables={}, payload_variables={}}, source_database_name_uppercase=DEVELOPMENT-DB, job_scheduled_user_id=Manaswini Chinthalapudi, source_schema_name_uppercase=ACUITY-DEVELOP, source_schema_name=acuity-develop, environment=modak, batch_name=Ingestion_20231115, source_database_name=development-db, authtoken_job_type=default, data_movement_id=261, last_run_timestamp=2023-11-07 12:42:00.86365, is_relative_file_path=false}, flowTaskId=2611, bot_metadata={tags={process_id=17000664381264241, batch_name=Ingestion_20231115, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365}}, retry_template={retry_template_name=artifact_generation_auth_token_msg_retry, retry_template_group=templates/artifact_ingestion/flow_controller.stg}, loggers={scheduled_loggers=[{template_name=flow_task_scheduled_log, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], post_loggers=[{template_name=flow_task_post_log_db, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_task_post_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], pre_loggers=[{template_name=flow_task_running_log, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_task_pre_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], retry_loggers=[{template_name=flow_task_retry_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}]}, completionCriteria={success={botTopics=[nabu_2_completion], criteria=[AND, {bot_metadata.tags.process_id=17000664381264241, opOperator===}, {opOperator===, bot_metadata.message_context=end_of_the_flow}]}, error={botTopics=[nabu_2_errorbot], criteria=[AND, {bot_metadata.tags.process_id=17000664381264241, opOperator===}, {opOperator===, bot_metadata.message_context=taskstatus_bot_error_msg}]}, retry=[AND, {error_data.retry_attempt=0, opOperator=<}, {error_data.error_json=(?i).*exception.*, opOperator=~}]}, app_template_details={template_name=generate_input_data, template_group=templates/artifact_ingestion/flow_controller.stg}, output_message_templates=[{template_name=artifact_generation_auth_token_msg, template_group=templates/artifact_ingestion/flow_controller.stg}], processor={classname=com.modak.bots.processor.NullProcessor, props={}}, flowTaskName=spark_ingestion_almaren_261_1}], job_schedule_id=1568, data_movement_id=261, inputFlows=[], outputFlows=[], flowId=17000664409915681, metaflowData={tags={tags=[ingestion_261_17000664380239952]}}}], flow_timeout=23}
""2023-11-15 16:40:42.377 [pool-24-thread-1] DEBUG com.modak.bots.FlowControllerBot - inputMessageMetadataMap to flowcontroller is {flowControllerMetadata={parent_id=904f67cb-f816-4d44-bbad-71773cb9268b, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=flowcontroller_message_to_generate_flows, message_id=f4fca0e9-0d78-4928-b49f-ecea9eb3b5cf, task_retry_intervals_secs=[], bot_id=5645838a-33b2-48a4-86c1-4538fa4c0a4c, message_topic=nabu_2_flowcontroller, tags={process_id=1700066438126424, batch_id=17000664380239952, job_scheduled_user_id=Manaswini Chinthalapudi, tags=[AuthToken, DBOpsBot, DBOpsBot], initial_ts=1700066438126, batch_name=, environment=modak, job_schedule_id=1568, data_movement_id=261, last_run_timestamp=, retry_attempt=0, task_dependency=true, ignore_job_termination=false}}, bot_id=9a243656-a8f6-45a1-bf1a-431a00d18e91}
""2023-11-15 16:40:42.382 [pool-24-thread-1] DEBUG com.modak.bots.flowcontroller.FlowController - FlowController input : 
{"flows":[{"flowOutputTemplates":[{"template_group":"templates/artifact_ingestion/flow_controller.stg","template_name":"delete_almaren_code_from_kosh"},{"template_group":"templates/artifact_ingestion/flow_controller.stg","template_name":"delete_created_credentials"},{"template_group":"templates/artifact_ingestion/flow_controller.stg","template_name":"insert_pre_agg_stats_template"}],"batch_id":17000664380239952,"configuration":{"parallel":1,"flowTimeoutHrs":23},"loggers":{"post_loggers":[{"template_name":"flow_post_log","log_type":"FILE","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"},{"template_name":"flow_post_log_db","log_type":"DB","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"}],"pre_loggers":[{"template_name":"flow_pre_log","log_type":"FILE","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"},{"template_name":"flow_pre_log_db","log_type":"DB","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"}]},"flowName":"ingestion_261_17000664380239952","job_type_id":1,"flow_type":"ingestion","uiInfo":{"description":"Auto generated by flow controller for flow ingestion_261_17000664380239952"},"flowTasks":[{"input_data":{"jwt_ttl":"82800000","process_id":"17000664381264241","flow_number":1,"source_database_name_lowercase":"development-db","batch_id":"17000664380239952","workflow_name":"artifact_generation","where_condition":"37234","suffix":"","job_type_id":"1","ingestion_table_format":"","job_schedule_id":1568,"relative_file_path":"","data_movement_name":"ss_compass_adb_validation","source_schema_name_lowercase":"acuity-develop","variables":{"env_variables":{},"user_variables":{},"payload_variables":{}},"source_database_name_uppercase":"DEVELOPMENT-DB","job_scheduled_user_id":"Manaswini Chinthalapudi","source_schema_name_uppercase":"ACUITY-DEVELOP","source_schema_name":"acuity-develop","environment":"modak","batch_name":"Ingestion_20231115","source_database_name":"development-db","authtoken_job_type":"default","data_movement_id":"261","last_run_timestamp":"2023-11-07 12:42:00.86365","is_relative_file_path":false},"flowTaskId":2611,"bot_metadata":{"tags":{"process_id":17000664381264241,"batch_name":"Ingestion_20231115","environment":"modak","batch_id":17000664380239952,"job_schedule_id":1568,"workflow_route_bot_topic_details":{"DBOpsBot":"nabu_2_jdbc","ScriptBot":"nabu_2_scriptbot","SparkComputeEngineBot":"nabu_2_spark_compute","FilterResolverDBOpsBot":"nabu_2_filter_resolver_jdbc","S3StreamBot":"nabu_2_s3_stream","ErrorBot":"nabu_2_errorbot","AuthTokenBot":"nabu_2_authtoken","OnDemandBot":"nabu_2_ondemand_bot","EmailBot":"nabu_2_emailbot","PipelineDependencyCheckerBot":"nabu_2_pipelinedependency_checker","RPCSparkScriptBot":"nabu_2_rpc_spark_script","SparkScriptBot":"nabu_2_spark_script","RestAPIBot":"nabu_2_restapibot","CurationSparkScriptBot":"nabu_2_curation_script","TaskMonitorBot":"nabu_2_taskmonitor","completion_topic":"nabu_2_completion","FlowControllerBot":"nabu_2_flowcontroller","UpdateDBOpsBot":"nabu_2_update_jdbc"},"data_movement_id":261,"job_scheduled_user_id":"Manaswini Chinthalapudi","last_run_timestamp":"2023-11-07 12:42:00.86365"}},"retry_template":{"retry_template_name":"artifact_generation_auth_token_msg_retry","retry_template_group":"templates/artifact_ingestion/flow_controller.stg"},"loggers":{"scheduled_loggers":[{"template_name":"flow_task_scheduled_log","log_type":"DB","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"}],"post_loggers":[{"template_name":"flow_task_post_log_db","log_type":"DB","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"},{"template_name":"flow_task_post_log","log_type":"FILE","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"}],"pre_loggers":[{"template_name":"flow_task_running_log","log_type":"DB","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"},{"template_name":"flow_task_pre_log","log_type":"FILE","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"}],"retry_loggers":[{"template_name":"flow_task_retry_log","log_type":"FILE","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"}]},"completionCriteria":{"error":{"botTopics":["nabu_2_errorbot"],"criteria":["AND",{"opOperator":"==","bot_metadata.tags.process_id":17000664381264241},{"opOperator":"==","bot_metadata.message_context":"taskstatus_bot_error_msg"}]},"success":{"botTopics":["nabu_2_completion"],"criteria":["AND",{"opOperator":"==","bot_metadata.tags.process_id":17000664381264241},{"opOperator":"==","bot_metadata.message_context":"end_of_the_flow"}]},"retry":["AND",{"opOperator":"<","error_data.retry_attempt":0},{"error_data.error_json":"(?i).*exception.*","opOperator":"~"}]},"app_template_details":{"template_group":"templates/artifact_ingestion/flow_controller.stg","template_name":"generate_input_data"},"output_message_templates":[{"template_group":"templates/artifact_ingestion/flow_controller.stg","template_name":"artifact_generation_auth_token_msg"}],"processor":{"classname":"com.modak.bots.processor.NullProcessor","props":{}},"flowTaskName":"spark_ingestion_almaren_261_1"}],"job_schedule_id":"1568","data_movement_id":"261","inputFlows":[],"outputFlows":[],"flowId":17000664409915681,"metaflowData":{"tags":{"tags":["ingestion_261_17000664380239952"]}}}],"flow_timeout":23}
""2023-11-15 16:40:42.383 [pool-24-thread-1] DEBUG com.modak.bots.flowcontroller.FlowController - Flow Timeout is configured as: 23
""2023-11-15 16:40:42.386 [pool-24-thread-1] DEBUG com.modak.bots.flowcontroller.FlowController - executorService FixedThreadPool size is : 1 for batchid : 17000664380239952
""2023-11-15 16:40:42.386 [pool-24-thread-1] DEBUG com.modak.bots.flowcontroller.FlowController - start flow out side the loop flowcontroller object com.modak.bots.flowcontroller.FlowController@5af3fc7f with batchid 17000664380239952
""2023-11-15 16:40:42.386 [pool-24-thread-1] DEBUG com.modak.bots.flowcontroller.FlowController - Inside startFlows() of batchid 17000664380239952
""2023-11-15 16:40:42.387 [pool-24-thread-1] DEBUG com.modak.bots.flowcontroller.FlowController - flowsToBeStartedMap in startflows() : {ingestion_261_17000664380239952={flowOutputTemplates=[{template_name=delete_almaren_code_from_kosh, template_group=templates/artifact_ingestion/flow_controller.stg}, {template_name=delete_created_credentials, template_group=templates/artifact_ingestion/flow_controller.stg}, {template_name=insert_pre_agg_stats_template, template_group=templates/artifact_ingestion/flow_controller.stg}], batch_id=17000664380239952, configuration={parallel=1, flowTimeoutHrs=23}, loggers={post_loggers=[{template_name=flow_post_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_post_log_db, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], pre_loggers=[{template_name=flow_pre_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_pre_log_db, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}]}, flowName=ingestion_261_17000664380239952, job_type_id=1, flow_type=ingestion, uiInfo={description=Auto generated by flow controller for flow ingestion_261_17000664380239952}, flowTasks=[{input_data={jwt_ttl=82800000, process_id=17000664381264241, flow_number=1, source_database_name_lowercase=development-db, batch_id=17000664380239952, workflow_name=artifact_generation, where_condition=37234, suffix=, job_type_id=1, ingestion_table_format=, job_schedule_id=1568, relative_file_path=, data_movement_name=ss_compass_adb_validation, source_schema_name_lowercase=acuity-develop, variables={env_variables={}, user_variables={}, payload_variables={}}, source_database_name_uppercase=DEVELOPMENT-DB, job_scheduled_user_id=Manaswini Chinthalapudi, source_schema_name_uppercase=ACUITY-DEVELOP, source_schema_name=acuity-develop, environment=modak, batch_name=Ingestion_20231115, source_database_name=development-db, authtoken_job_type=default, data_movement_id=261, last_run_timestamp=2023-11-07 12:42:00.86365, is_relative_file_path=false}, flowTaskId=2611, bot_metadata={tags={process_id=17000664381264241, batch_name=Ingestion_20231115, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365}}, retry_template={retry_template_name=artifact_generation_auth_token_msg_retry, retry_template_group=templates/artifact_ingestion/flow_controller.stg}, loggers={scheduled_loggers=[{template_name=flow_task_scheduled_log, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], post_loggers=[{template_name=flow_task_post_log_db, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_task_post_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], pre_loggers=[{template_name=flow_task_running_log, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_task_pre_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], retry_loggers=[{template_name=flow_task_retry_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}]}, completionCriteria={success={botTopics=[nabu_2_completion], criteria=[AND, {bot_metadata.tags.process_id=17000664381264241, opOperator===}, {opOperator===, bot_metadata.message_context=end_of_the_flow}]}, error={botTopics=[nabu_2_errorbot], criteria=[AND, {bot_metadata.tags.process_id=17000664381264241, opOperator===}, {opOperator===, bot_metadata.message_context=taskstatus_bot_error_msg}]}, retry=[AND, {error_data.retry_attempt=0, opOperator=<}, {error_data.error_json=(?i).*exception.*, opOperator=~}]}, app_template_details={template_name=generate_input_data, template_group=templates/artifact_ingestion/flow_controller.stg}, output_message_templates=[{template_name=artifact_generation_auth_token_msg, template_group=templates/artifact_ingestion/flow_controller.stg}], processor={classname=com.modak.bots.processor.NullProcessor, props={}}, flowTaskName=spark_ingestion_almaren_261_1}], job_schedule_id=1568, data_movement_id=261, inputFlows=[], outputFlows=[], flowId=17000664409915681, metaflowData={tags={tags=[ingestion_261_17000664380239952]}}}}
""2023-11-15 16:40:42.387 [pool-24-thread-1] DEBUG com.modak.bots.flowcontroller.FlowController - Inside startFlows() if block
""2023-11-15 16:40:42.387 [pool-24-thread-1] DEBUG com.modak.bots.flowcontroller.FlowController - flowsToBeStartedMap.keySet() is : [ingestion_261_17000664380239952]
""2023-11-15 16:40:42.387 [pool-24-thread-1] DEBUG com.modak.bots.flowcontroller.FlowController - checking the dependencies of flow ingestion_261_17000664380239952
""2023-11-15 16:40:42.387 [pool-24-thread-1] DEBUG com.modak.bots.flowcontroller.FlowController - dependencies are : []
""2023-11-15 16:40:42.387 [pool-24-thread-1] DEBUG com.modak.bots.flowcontroller.FlowController - isAllDependenciesCompleted value is  : true
""2023-11-15 16:40:42.387 [pool-24-thread-1] DEBUG com.modak.bots.flowcontroller.FlowController - completedFlowsStatusMap value is : {}
""2023-11-15 16:40:42.387 [pool-24-thread-1] DEBUG com.modak.bots.flowcontroller.FlowController - isAllDependenciesCompleted value is : true
""2023-11-15 16:40:42.387 [pool-24-thread-1] DEBUG com.modak.bots.flowcontroller.FlowController - flowTasks ingestion_261_17000664380239952 all dependencies [] are completed
""2023-11-15 16:40:42.388 [pool-24-thread-1] DEBUG com.modak.bots.flowcontroller.FlowController - flowInputMap when isAllDependenciesCompleted is true : {flowOutputTemplates=[{template_name=delete_almaren_code_from_kosh, template_group=templates/artifact_ingestion/flow_controller.stg}, {template_name=delete_created_credentials, template_group=templates/artifact_ingestion/flow_controller.stg}, {template_name=insert_pre_agg_stats_template, template_group=templates/artifact_ingestion/flow_controller.stg}], batch_id=17000664380239952, configuration={parallel=1, flowTimeoutHrs=23}, loggers={post_loggers=[{template_name=flow_post_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_post_log_db, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], pre_loggers=[{template_name=flow_pre_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_pre_log_db, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}]}, flowName=ingestion_261_17000664380239952, job_type_id=1, flow_type=ingestion, uiInfo={description=Auto generated by flow controller for flow ingestion_261_17000664380239952}, flowTasks=[{input_data={jwt_ttl=82800000, process_id=17000664381264241, flow_number=1, source_database_name_lowercase=development-db, batch_id=17000664380239952, workflow_name=artifact_generation, where_condition=37234, suffix=, job_type_id=1, ingestion_table_format=, job_schedule_id=1568, relative_file_path=, data_movement_name=ss_compass_adb_validation, source_schema_name_lowercase=acuity-develop, variables={env_variables={}, user_variables={}, payload_variables={}}, source_database_name_uppercase=DEVELOPMENT-DB, job_scheduled_user_id=Manaswini Chinthalapudi, source_schema_name_uppercase=ACUITY-DEVELOP, source_schema_name=acuity-develop, environment=modak, batch_name=Ingestion_20231115, source_database_name=development-db, authtoken_job_type=default, data_movement_id=261, last_run_timestamp=2023-11-07 12:42:00.86365, is_relative_file_path=false}, flowTaskId=2611, bot_metadata={tags={process_id=17000664381264241, batch_name=Ingestion_20231115, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365}}, retry_template={retry_template_name=artifact_generation_auth_token_msg_retry, retry_template_group=templates/artifact_ingestion/flow_controller.stg}, loggers={scheduled_loggers=[{template_name=flow_task_scheduled_log, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], post_loggers=[{template_name=flow_task_post_log_db, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_task_post_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], pre_loggers=[{template_name=flow_task_running_log, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_task_pre_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], retry_loggers=[{template_name=flow_task_retry_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}]}, completionCriteria={success={botTopics=[nabu_2_completion], criteria=[AND, {bot_metadata.tags.process_id=17000664381264241, opOperator===}, {opOperator===, bot_metadata.message_context=end_of_the_flow}]}, error={botTopics=[nabu_2_errorbot], criteria=[AND, {bot_metadata.tags.process_id=17000664381264241, opOperator===}, {opOperator===, bot_metadata.message_context=taskstatus_bot_error_msg}]}, retry=[AND, {error_data.retry_attempt=0, opOperator=<}, {error_data.error_json=(?i).*exception.*, opOperator=~}]}, app_template_details={template_name=generate_input_data, template_group=templates/artifact_ingestion/flow_controller.stg}, output_message_templates=[{template_name=artifact_generation_auth_token_msg, template_group=templates/artifact_ingestion/flow_controller.stg}], processor={classname=com.modak.bots.processor.NullProcessor, props={}}, flowTaskName=spark_ingestion_almaren_261_1}], job_schedule_id=1568, data_movement_id=261, inputFlows=[], outputFlows=[], flowId=17000664409915681, metaflowData={tags={tags=[ingestion_261_17000664380239952]}}}
""2023-11-15 16:40:42.391 [Thread-1028] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id ae1221b1-79cf-4e20-b13f-e78d177d8f8a has started processing message with message_id e46e13cd-f64e-4931-af39-dbb136291c99 and thread_id 1263 
""2023-11-15 16:40:42.391 [Thread-1028] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:40:42.391 [Thread-1028] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=f4fca0e9-0d78-4928-b49f-ecea9eb3b5cf, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=e46e13cd-f64e-4931-af39-dbb136291c99, task_retry_intervals_secs=[], bot_id=9a243656-a8f6-45a1-bf1a-431a00d18e91, message_topic=nabu_2_taskmonitor, tags={process_id=1700066438126424, initial_ts=1700066438126, batch_name=, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, TaskMonitorBot]}}
""2023-11-15 16:40:42.415 [pool-24-thread-1] INFO  com.modak.bots.flowcontroller.Flow - Flow ingestion_261_17000664380239952 with FlowId 17000664409915681 subscribed topics : [nabu_2_errorbot, nabu_2_completion]
""2023-11-15 16:40:42.416 [pool-24-thread-1] INFO  com.modak.bots.flowcontroller.Flow - topics : [nabu_2_errorbot, nabu_2_completion]
""2023-11-15 16:40:42.425 [pool-24-thread-1] INFO  com.modak.bots.flowcontroller.Flow - topic : nabu_2_errorbot
""2023-11-15 16:40:42.426 [pool-24-thread-1] INFO  com.modak.bots.flowcontroller.Flow - not null
""2023-11-15 16:40:42.426 [pool-24-thread-1] INFO  com.modak.bots.flowcontroller.Flow - groupId fc_1700066442425856
""2023-11-15 16:40:42.426 [pool-24-thread-1] INFO  com.modak.bots.flowcontroller.Flow - topic : nabu_2_completion
""2023-11-15 16:40:42.426 [pool-24-thread-1] INFO  com.modak.bots.flowcontroller.Flow - not null
""2023-11-15 16:40:42.426 [pool-24-thread-1] INFO  com.modak.bots.flowcontroller.Flow - groupId fc_1700066442425856
""2023-11-15 16:40:42.426 [pool-24-thread-1] INFO  com.modak.bots.flowcontroller.Flow - subscribeTopicList : [{routing=nabu_2_errorbot, is_durable_queue=false, queue=fc_1700066442425856}, {routing=nabu_2_completion, is_durable_queue=false, queue=fc_1700066442425856}]
""2023-11-15 16:40:42.426 [pool-24-thread-1] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - messageBusConfig : {messageBusClassName=com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusPullAdapter, privateKeyPath=NABU_PRIVATE_KEY_PATH, rabbitMQConnectionConfig={control_topic=NABU_CONTROL_TOPIC, rabbitmq_ssl_enabled=NABU_RABBITMQ_SSL_ENABLED, control_messagebus_classname=com.modak.bots.messagebus.rabbitmq.RabbitMQControlMessageBusAdapter, heart_beat_frequency=5, heart_beat_duration=NABU_RABBITMQ_HEARTBEAT_DURATION, status_topic=NABU_STATUS_TOPIC, public_key_path=NABU_PUBLIC_KEY_PATH, password=NABU_RABBITMQ_ACCOUNT_PASS, rabbitmq_port=NABU_RABBITMQ_PORT, exchange=NABU_BOTWORKS_EXCHANGE_NAME, num_connections=5, rabbitmq_host=NABU_RABBITMQ_HOSTNAME, username=NABU_RABBITMQ_ACCOUNT, encrypted_password=N, virtual_host=NABU_RABBITMQ_VIRTUAL_HOST}, maximumMessageSize=1, botTopics=[{routing=nabu_2_errorbot, is_durable_queue=false, queue=fc_1700066442425856}, {routing=nabu_2_completion, is_durable_queue=false, queue=fc_1700066442425856}], publicKeyPath=NABU_PUBLIC_KEY_PATH}
""2023-11-15 16:40:42.427 [pool-24-thread-1] DEBUG com.modak.utils.connectionutils.rabbitmq.RabbitMQNabuConnectionFactory - rabbitMQConnectionConfig is : {control_topic=NABU_CONTROL_TOPIC, rabbitmq_ssl_enabled=NABU_RABBITMQ_SSL_ENABLED, control_messagebus_classname=com.modak.bots.messagebus.rabbitmq.RabbitMQControlMessageBusAdapter, heart_beat_frequency=5, heart_beat_duration=NABU_RABBITMQ_HEARTBEAT_DURATION, status_topic=NABU_STATUS_TOPIC, public_key_path=NABU_PUBLIC_KEY_PATH, password=NABU_RABBITMQ_ACCOUNT_PASS, rabbitmq_port=NABU_RABBITMQ_PORT, exchange=NABU_BOTWORKS_EXCHANGE_NAME, num_connections=10, rabbitmq_host=NABU_RABBITMQ_HOSTNAME, username=NABU_RABBITMQ_ACCOUNT, encrypted_password=N, virtual_host=NABU_RABBITMQ_VIRTUAL_HOST}
""2023-11-15 16:40:42.428 [Thread-1028] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 1700066438126424, 'FlowControllerBot', 'flowcontroller_message_to_generate_flows', 'generate_flows', 10 , TO_TIMESTAMP(1700066442082::double precision / 1000) ,'9a243656-a8f6-45a1-bf1a-431a00d18e91');
""2023-11-15 16:40:42.429 [Thread-1028] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id ae1221b1-79cf-4e20-b13f-e78d177d8f8a has started process logic with message_id e46e13cd-f64e-4931-af39-dbb136291c99 and thread_id 1263
""2023-11-15 16:40:42.452 [pool-24-thread-1] INFO  com.modak.utils.connectionutils.rabbitmq.RabbitMQNabuConnectionFactory - Using Existing RabbitMQ connections
""2023-11-15 16:40:42.452 [pool-24-thread-1] INFO  com.modak.utils.connectionutils.rabbitmq.RabbitMQNabuConnectionFactory - Returning connection of address amqp://srv_account_rabbitmq@10.213.53.98:5672/
""2023-11-15 16:40:42.527 [pool-24-thread-1] DEBUG com.modak.bots.flowcontroller.Flow - parallelTaskCount for taskexecutors is 1
""2023-11-15 16:40:42.527 [pool-24-thread-1] DEBUG com.modak.bots.flowcontroller.FlowController - flow ingestion_261_17000664380239952 got submitted, the flowid of the flow 17000664409915681
""2023-11-15 16:40:42.548 [pool-24-thread-1] DEBUG com.modak.bots.flowcontroller.FlowController - runningFutureObjectsMap value is : {ingestion_261_17000664380239952=java.util.concurrent.FutureTask@169c88b3}
""2023-11-15 16:40:42.548 [pool-24-thread-1] DEBUG com.modak.bots.flowcontroller.FlowController - triggered startFlows outside of loop
""2023-11-15 16:40:42.548 [Thread-1028] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id ae1221b1-79cf-4e20-b13f-e78d177d8f8a has finished process logic with message_id e46e13cd-f64e-4931-af39-dbb136291c99 and thread_id 1263
""2023-11-15 16:40:42.548 [pool-24-thread-1] DEBUG com.modak.bots.flowcontroller.FlowController - runningFutureObjectsMap is : {ingestion_261_17000664380239952=java.util.concurrent.FutureTask@169c88b3}
""2023-11-15 16:40:42.548 [Thread-1028] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:40:42.548 [Thread-1028] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id e46e13cd-f64e-4931-af39-dbb136291c99
""2023-11-15 16:40:42.740 [Thread-1228] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "d45f4c45-40e4-4736-8f0a-a29027c9a073", "parent_id": "904f67cb-f816-4d44-bbad-71773cb9268b", "bot_id": "5645838a-33b2-48a4-86c1-4538fa4c0a4c", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":1700066438126424, "initial_ts":1700066438126, "batch_id":17000664380239952, "batch_name":"", "job_schedule_id":1568, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"5645838a-33b2-48a4-86c1-4538fa4c0a4c", "bot_name":"DBOpsBot", "process_context":"data_movement_deciding", "task_name":"data_movement_deciding_msg", "process_id":"1700066438126424", "task_ts":1700066441795, "batch_id":"17000664380239952", "status_code_id": 6 } } ] }
""2023-11-15 16:40:42.742 [Thread-1228] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:40:42.746 [Thread-1228] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:40:42.746 [Thread-1228] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:40:42.746 [Thread-1228] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot finished processing message with id 904f67cb-f816-4d44-bbad-71773cb9268b
""2023-11-15 16:40:42.756 [Thread-1028] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id ae1221b1-79cf-4e20-b13f-e78d177d8f8a has started processing message with message_id d45f4c45-40e4-4736-8f0a-a29027c9a073 and thread_id 1263 
""2023-11-15 16:40:42.756 [Thread-1028] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:40:42.756 [Thread-1028] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=904f67cb-f816-4d44-bbad-71773cb9268b, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=d45f4c45-40e4-4736-8f0a-a29027c9a073, task_retry_intervals_secs=[], bot_id=5645838a-33b2-48a4-86c1-4538fa4c0a4c, message_topic=nabu_2_taskmonitor, tags={process_id=1700066438126424, initial_ts=1700066438126, batch_name=, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, TaskMonitorBot]}}
""2023-11-15 16:40:42.767 [Thread-1028] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 1700066438126424, 'DBOpsBot', 'data_movement_deciding', 'data_movement_deciding_msg', 6 , TO_TIMESTAMP(1700066441795::double precision / 1000) ,'5645838a-33b2-48a4-86c1-4538fa4c0a4c');
""2023-11-15 16:40:42.767 [Thread-1028] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id ae1221b1-79cf-4e20-b13f-e78d177d8f8a has started process logic with message_id d45f4c45-40e4-4736-8f0a-a29027c9a073 and thread_id 1263
""2023-11-15 16:40:42.771 [Thread-1028] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id ae1221b1-79cf-4e20-b13f-e78d177d8f8a has finished process logic with message_id d45f4c45-40e4-4736-8f0a-a29027c9a073 and thread_id 1263
""2023-11-15 16:40:42.771 [Thread-1028] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:40:42.771 [Thread-1028] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id d45f4c45-40e4-4736-8f0a-a29027c9a073
""2023-11-15 16:40:53.079 [Thread-1185] INFO  com.modak.bots.basebot.AbstractBaseBot - AuthTokenBot with bot_id 0e719426-7af5-4bee-b503-754bf0377dde has started processing message with message_id 01dbc31e-91a6-4ec5-9293-eb00cfa1e28f and thread_id 1448 
""2023-11-15 16:40:53.079 [Thread-1185] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:40:53.079 [Thread-1185] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=f4fca0e9-0d78-4928-b49f-ecea9eb3b5cf, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=generating_token_for_credentials, message_id=01dbc31e-91a6-4ec5-9293-eb00cfa1e28f, task_retry_intervals_secs=[], bot_id=9a243656-a8f6-45a1-bf1a-431a00d18e91, message_topic=nabu_2_authtoken, tags={process_id=17000664381264241, initial_ts=1700066438126, batch_name=Ingestion_20231115, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, job_scheduled_user_id=Manaswini Chinthalapudi, data_movement_id=261, last_run_timestamp=2023-11-07 12:42:00.86365, include_blobs=, retry_attempt=0, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken]}}
""2023-11-15 16:40:53.094 [Thread-1185] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
doNothing
""2023-11-15 16:40:53.107 [Thread-1185] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 16:40:53.109 [Thread-1185] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:40:53.119 [Thread-1185] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:40:53.119 [Thread-1185] INFO  com.modak.bots.basebot.AbstractBaseBot - AuthTokenBot with bot_id 0e719426-7af5-4bee-b503-754bf0377dde has started process logic with message_id 01dbc31e-91a6-4ec5-9293-eb00cfa1e28f and thread_id 1448
""2023-11-15 16:40:53.156 [Thread-1268] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 1b2aa280-8a50-4145-a5ec-9e43e0244f78 has started processing message with message_id a41d81e1-ff4f-491e-aead-8d2e5d86330a and thread_id 1543 
""2023-11-15 16:40:53.156 [Thread-1268] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:40:53.156 [Thread-1268] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=01dbc31e-91a6-4ec5-9293-eb00cfa1e28f, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=a41d81e1-ff4f-491e-aead-8d2e5d86330a, task_retry_intervals_secs=[], bot_id=0e719426-7af5-4bee-b503-754bf0377dde, message_topic=nabu_2_taskmonitor, tags={process_id=17000664381264241, initial_ts=1700066438126, batch_name=Ingestion_20231115, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, TaskMonitorBot]}}
""2023-11-15 16:40:53.224 [Thread-1268] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 17000664381264241, 'AuthTokenBot', 'generating_token_for_credentials', 'generating_token_for_credentials', 10 , TO_TIMESTAMP(1700066453079::double precision / 1000) ,'0e719426-7af5-4bee-b503-754bf0377dde');
""2023-11-15 16:40:53.224 [Thread-1268] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 1b2aa280-8a50-4145-a5ec-9e43e0244f78 has started process logic with message_id a41d81e1-ff4f-491e-aead-8d2e5d86330a and thread_id 1543
""2023-11-15 16:40:53.279 [Thread-1185] INFO  com.modak.bots.AuthTokenBot - connection closed!
""2023-11-15 16:40:53.279 [Thread-1185] DEBUG com.modak.bots.AuthTokenBot - redisConfig map is : {minConnectionsIdleSize=NABU_REDIS_MIN_CONNECTION_IDLE_SIZE, password=NABU_REDIS_PASSWORD, PrivateKey=NABU_PRIVATE_KEY_PATH, redis_url=NABU_REDIS_URL, connection_pool_size=NABU_REDIS_CONNECTION_POOL_SIZE, idle_connection_timeout=NABU_REDIS_IDLE_CONNECTION_TIME_OUT, connection_timeout=NABU_REDIS_CONNECTION_TIME_OUT, encrypted_password=N}
""2023-11-15 16:40:53.280 [Thread-1185] INFO  com.modak.bots.AuthTokenBot - authMapType: authTokenBotMap
""2023-11-15 16:40:53.280 [Thread-1185] DEBUG com.modak.utils.jwt.AuthTokenGenerator - redisson object value is null
""2023-11-15 16:40:53.412 [Thread-1268] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 1b2aa280-8a50-4145-a5ec-9e43e0244f78 has finished process logic with message_id a41d81e1-ff4f-491e-aead-8d2e5d86330a and thread_id 1543
""2023-11-15 16:40:53.412 [Thread-1268] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:40:53.412 [Thread-1268] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id a41d81e1-ff4f-491e-aead-8d2e5d86330a
""2023-11-15 16:40:58.783 [Thread-1185] INFO  com.modak.bots.basebot.AbstractBaseBot - AuthTokenBot with bot_id 0e719426-7af5-4bee-b503-754bf0377dde has finished process logic with message_id 01dbc31e-91a6-4ec5-9293-eb00cfa1e28f and thread_id 1448
""2023-11-15 16:40:58.783 [Thread-1185] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : true
""2023-11-15 16:40:58.783 [Thread-1185] INFO  com.modak.bots.basebot.AbstractBaseBot -  skipBotLogic == false && useIncomingData == true ..,so both inputData map and botLogic output map is send as output message
""2023-11-15 16:40:58.783 [Thread-1185] INFO  com.modak.bots.basebot.AbstractBaseBot - botLogicOutput : { "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDY2NDU3NzgzNDI0MCwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0OTI1OCwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2NjQ1N30.cgEzDcSlWhMY65PdNscgXY1oBYM75LZUbp00acf6_d1WRUOrXXGi5pcvwkRNDv0JIxun7nmcSCqy2CKZ38-eHnEqqAoxh2CIRwXTdBlsYYFyfkXHYapfaXinAi82pkDk0yJQOs-m-vAf1cbV4ue4Zk6bHKbJeu_j5_x8HU3PKeF0pz0lA-tpeoFRlq_tLUXqApH5t7QuTIzOSq7Aujo6yOSm_inHTBzTWxUyVaBCitbKs_j3Oq-P5c-Y5W3r9oAvDNbMASikxmdxfJBp_rI2QYHdxazW9UvVh_ZpRPwOIbi7EAe9-B6BBxAxItPBTo4M-GFi-zvZZXXYMX57edoRDA", "end_point" : "http:\/\/dev-dha.humana.com:8889\/fireshots\/credentialsFetchWebService" }
""2023-11-15 16:40:58.925 [Thread-1185] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "DBOpsBot", "bot_metadata": { "message_id": "f35551cc-fccd-4d73-9573-3222224d04be", "parent_id": "01dbc31e-91a6-4ec5-9293-eb00cfa1e28f", "bot_id": "0e719426-7af5-4bee-b503-754bf0377dde", "message_topic":"nabu_2_jdbc", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":17000664381264241, "initial_ts":1700066438126, "batch_id":17000664380239952, "batch_name":"Ingestion_20231115", "job_schedule_id":1568, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "2023-11-07 12:42:00.86365", "environment": "modak", "ignore_job_termination" : false, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot" ],"task_dependency":true}, "task_retry_intervals_secs": [ ], "message_context": "generating pipeline start timestamp" }, "bot_tasks": [ { "task_name": "generating_relative_file_path", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "pre_task_logging_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "pre_log_template" }, "app_template_details": { "template_group": "templates/artifact_ingestion/ingestion_templates.stg", "template_name": "get_pipeline_run_timestamp_object_name" }, "input_data":{ "input_data" : { "jwt_ttl" : "82800000", "process_id" : "17000664381264241", "flow_number" : 1, "source_database_name_lowercase" : "development-db", "batch_id" : "17000664380239952", "workflow_name" : "artifact_generation", "where_condition" : "37234", "suffix" : "", "job_type_id" : "1", "ingestion_table_format" : "", "job_schedule_id" : 1568, "relative_file_path" : "", "data_movement_name" : "ss_compass_adb_validation", "source_schema_name_lowercase" : "acuity-develop", "currentBotMessageMap" : { "parent_id" : "f4fca0e9-0d78-4928-b49f-ecea9eb3b5cf", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "message_context" : "generating_token_for_credentials", "message_id" : "01dbc31e-91a6-4ec5-9293-eb00cfa1e28f", "task_retry_intervals_secs" : [], "bot_id" : "9a243656-a8f6-45a1-bf1a-431a00d18e91", "message_topic" : "nabu_2_authtoken", "tags" : { "process_id" : 17000664381264241, "initial_ts" : 1700066438126, "batch_name" : "Ingestion_20231115", "environment" : "modak", "batch_id" : 17000664380239952, "job_schedule_id" : 1568, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "data_movement_id" : 261, "last_run_timestamp" : "2023-11-07 12:42:00.86365", "include_blobs" : "", "retry_attempt" : 0, "tags" : [ "AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken" ] } }, "variables" : { "env_variables" : {}, "user_variables" : {}, "payload_variables" : {} }, "source_database_name_uppercase" : "DEVELOPMENT-DB", "botLogicOutputMap" : { "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDY2NDU3NzgzNDI0MCwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0OTI1OCwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2NjQ1N30.cgEzDcSlWhMY65PdNscgXY1oBYM75LZUbp00acf6_d1WRUOrXXGi5pcvwkRNDv0JIxun7nmcSCqy2CKZ38-eHnEqqAoxh2CIRwXTdBlsYYFyfkXHYapfaXinAi82pkDk0yJQOs-m-vAf1cbV4ue4Zk6bHKbJeu_j5_x8HU3PKeF0pz0lA-tpeoFRlq_tLUXqApH5t7QuTIzOSq7Aujo6yOSm_inHTBzTWxUyVaBCitbKs_j3Oq-P5c-Y5W3r9oAvDNbMASikxmdxfJBp_rI2QYHdxazW9UvVh_ZpRPwOIbi7EAe9-B6BBxAxItPBTo4M-GFi-zvZZXXYMX57edoRDA", "end_point" : "http:\/\/dev-dha.humana.com:8889\/fireshots\/credentialsFetchWebService" }, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "source_schema_name_uppercase" : "ACUITY-DEVELOP", "source_schema_name" : "acuity-develop", "environment" : "modak", "batch_name" : "Ingestion_20231115", "source_database_name" : "development-db", "authtoken_job_type" : "default", "data_movement_id" : "261", "last_run_timestamp" : "2023-11-07 12:42:00.86365", "is_relative_file_path" : false }, "template_execution_type": "sequential", "useTransactionControl": true }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "generating_relative_file_path", "useIncomingData":true }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "task_status_success_msg" } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "error_template_create_msg" } ] } ] }
""2023-11-15 16:40:58.928 [Thread-1185] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_jdbc
""2023-11-15 16:40:58.933 [Thread-1185] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_jdbc
""2023-11-15 16:40:58.933 [Thread-1185] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : true
""2023-11-15 16:40:58.934 [Thread-1185] INFO  com.modak.bots.basebot.AbstractBaseBot -  skipBotLogic == false && useIncomingData == true ..,so both inputData map and botLogic output map is send as output message
""2023-11-15 16:40:58.934 [Thread-1185] INFO  com.modak.bots.basebot.AbstractBaseBot - botLogicOutput : { "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDY2NDU3NzgzNDI0MCwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0OTI1OCwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2NjQ1N30.cgEzDcSlWhMY65PdNscgXY1oBYM75LZUbp00acf6_d1WRUOrXXGi5pcvwkRNDv0JIxun7nmcSCqy2CKZ38-eHnEqqAoxh2CIRwXTdBlsYYFyfkXHYapfaXinAi82pkDk0yJQOs-m-vAf1cbV4ue4Zk6bHKbJeu_j5_x8HU3PKeF0pz0lA-tpeoFRlq_tLUXqApH5t7QuTIzOSq7Aujo6yOSm_inHTBzTWxUyVaBCitbKs_j3Oq-P5c-Y5W3r9oAvDNbMASikxmdxfJBp_rI2QYHdxazW9UvVh_ZpRPwOIbi7EAe9-B6BBxAxItPBTo4M-GFi-zvZZXXYMX57edoRDA", "end_point" : "http:\/\/dev-dha.humana.com:8889\/fireshots\/credentialsFetchWebService" }
""2023-11-15 16:40:58.958 [Thread-1185] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "687920b2-f75c-4df9-aeb8-1ee261f90de8", "parent_id": "01dbc31e-91a6-4ec5-9293-eb00cfa1e28f", "bot_id": "0e719426-7af5-4bee-b503-754bf0377dde", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":17000664381264241, "initial_ts":1700066438126, "batch_id":17000664380239952, "batch_name":"Ingestion_20231115", "job_schedule_id":1568, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "2023-11-07 12:42:00.86365", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"0e719426-7af5-4bee-b503-754bf0377dde", "bot_name":"AuthTokenBot", "process_context":"generating_token_for_credentials", "task_name":"generating_token_for_credentials", "process_id":"17000664381264241", "task_ts":1700066458783, "batch_id":"17000664380239952", "status_code_id": 6 } } ] }
""2023-11-15 16:40:58.960 [Thread-1185] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:40:58.975 [Thread-1228] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 5645838a-33b2-48a4-86c1-4538fa4c0a4c has started processing message with message_id f35551cc-fccd-4d73-9573-3222224d04be and thread_id 1497 
""2023-11-15 16:40:58.976 [Thread-1228] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:40:58.976 [Thread-1228] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=01dbc31e-91a6-4ec5-9293-eb00cfa1e28f, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=generating pipeline start timestamp, message_id=f35551cc-fccd-4d73-9573-3222224d04be, task_retry_intervals_secs=[], bot_id=0e719426-7af5-4bee-b503-754bf0377dde, message_topic=nabu_2_jdbc, tags={process_id=17000664381264241, batch_id=17000664380239952, job_scheduled_user_id=Manaswini Chinthalapudi, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot], initial_ts=1700066438126, batch_name=Ingestion_20231115, environment=modak, job_schedule_id=1568, data_movement_id=261, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, task_dependency=true, ignore_job_termination=false}}
""2023-11-15 16:40:58.982 [Thread-1185] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:40:58.982 [Thread-1185] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:40:58.982 [Thread-1185] INFO  com.modak.bots.basebot.AbstractBaseBot - AuthTokenBot finished processing message with id 01dbc31e-91a6-4ec5-9293-eb00cfa1e28f
""2023-11-15 16:40:58.984 [Thread-1076] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id aec66b87-c359-43a6-adee-0e9c6b3f0e45 has started processing message with message_id 687920b2-f75c-4df9-aeb8-1ee261f90de8 and thread_id 1319 
""2023-11-15 16:40:58.984 [Thread-1076] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:40:58.984 [Thread-1076] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=01dbc31e-91a6-4ec5-9293-eb00cfa1e28f, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=687920b2-f75c-4df9-aeb8-1ee261f90de8, task_retry_intervals_secs=[], bot_id=0e719426-7af5-4bee-b503-754bf0377dde, message_topic=nabu_2_taskmonitor, tags={process_id=17000664381264241, initial_ts=1700066438126, batch_name=Ingestion_20231115, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, TaskMonitorBot]}}
""2023-11-15 16:40:59.006 [Thread-1076] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 17000664381264241, 'AuthTokenBot', 'generating_token_for_credentials', 'generating_token_for_credentials', 6 , TO_TIMESTAMP(1700066458783::double precision / 1000) ,'0e719426-7af5-4bee-b503-754bf0377dde');
""2023-11-15 16:40:59.006 [Thread-1076] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id aec66b87-c359-43a6-adee-0e9c6b3f0e45 has started process logic with message_id 687920b2-f75c-4df9-aeb8-1ee261f90de8 and thread_id 1319
""2023-11-15 16:40:59.038 [Thread-1076] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id aec66b87-c359-43a6-adee-0e9c6b3f0e45 has finished process logic with message_id 687920b2-f75c-4df9-aeb8-1ee261f90de8 and thread_id 1319
""2023-11-15 16:40:59.038 [Thread-1076] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:40:59.038 [Thread-1076] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 687920b2-f75c-4df9-aeb8-1ee261f90de8
""2023-11-15 16:40:59.279 [Thread-1228] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
{ "input_data": { "data_movement_id" : 261, "variables": { "env_variables": { }, "user_variables": { }, "payload_variables": { } }, "where_condition":"37234" }, "sequential_templates":[ { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_env_variables", "query_output_key": "get_env_variables", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_user_variables", "query_output_key": "get_user_variables", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "generate_variables", "query_output_key": "generate_variables", "query_type":"json", "encryption_details" : { "encryption" : "no", "encryption_type" : "" } }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "fetch_source_type", "query_output_key": "fetch_source_type", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_pipeline_run_timestamp", "query_output_key": "pipeline_run_timestamp", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_object_name", "query_output_key": "object_name", "query_type":"select" } ], "output_keys":["generate_variables","fetch_source_type","pipeline_run_timestamp","object_name"] }
""2023-11-15 16:40:59.294 [Thread-1228] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 16:40:59.296 [Thread-1228] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:40:59.327 [Thread-1228] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:40:59.327 [Thread-1228] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 5645838a-33b2-48a4-86c1-4538fa4c0a4c has started process logic with message_id f35551cc-fccd-4d73-9573-3222224d04be and thread_id 1497
""2023-11-15 16:40:59.354 [Thread-932] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 474a4057-d037-4153-80b2-b8f5bfa887b3 has started processing message with message_id 22c9159d-81b6-418d-9adb-b48abfe0f677 and thread_id 1151 
""2023-11-15 16:40:59.354 [Thread-932] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:40:59.354 [Thread-932] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=f35551cc-fccd-4d73-9573-3222224d04be, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=22c9159d-81b6-418d-9adb-b48abfe0f677, task_retry_intervals_secs=[], bot_id=5645838a-33b2-48a4-86c1-4538fa4c0a4c, message_topic=nabu_2_taskmonitor, tags={process_id=17000664381264241, initial_ts=1700066438126, batch_name=Ingestion_20231115, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, TaskMonitorBot]}}
""2023-11-15 16:40:59.365 [Thread-932] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 17000664381264241, 'DBOpsBot', 'generating pipeline start timestamp', 'generating_relative_file_path', 10 , TO_TIMESTAMP(1700066458976::double precision / 1000) ,'5645838a-33b2-48a4-86c1-4538fa4c0a4c');
""2023-11-15 16:40:59.366 [Thread-932] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 474a4057-d037-4153-80b2-b8f5bfa887b3 has started process logic with message_id 22c9159d-81b6-418d-9adb-b48abfe0f677 and thread_id 1151
""2023-11-15 16:40:59.461 [Thread-932] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 474a4057-d037-4153-80b2-b8f5bfa887b3 has finished process logic with message_id 22c9159d-81b6-418d-9adb-b48abfe0f677 and thread_id 1151
""2023-11-15 16:40:59.461 [Thread-932] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:40:59.461 [Thread-932] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 22c9159d-81b6-418d-9adb-b48abfe0f677
""2023-11-15 16:41:00.013 [Thread-1228] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select
json_object_agg(ev.env_name,ev.env_value) as env_variables
from nabu.environment_variables ev
where is_deleted = false
""2023-11-15 16:41:00.292 [Thread-1228] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select
json_object_agg(a.user_variables_details->>'variable',a.user_variables_details->>'value') as user_variables
from (
select
	json_array_elements(dmp.data_movement_additional_info ->'user_variables_details') as user_variables_details
	from nabu.data_movement_physical dmp
	where dmp.data_movement_id = 261
	and dmp.valid_to_ts = '9999-12-31'
)a
""2023-11-15 16:41:00.698 [Thread-1228] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : {
    "env_variables": {},
    "rest_api_variables": {},
    "user_variables": {},
    "payload_variables": {
},
}
""2023-11-15 16:41:00.901 [Thread-1228] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with CTE1 as (
select distinct dm.data_movement_id,dcml.metadata_category as source_type, dscl.dataplace_sub_component_type as source from nabu.data_movement_details_physical dm inner join nabu.dataplace_physical dp on dp.dataplace_id=dm.source_dataplace_id
inner join  nabu.dataplace_component_mapping_lookup dcml on dcml.dataplace_sub_component_id =dp.dataplace_sub_component_id
inner join nabu.dataplace_sub_component_lookup dscl on dcml.dataplace_sub_component_id =dscl.dataplace_sub_component_id
where dm.data_movement_id=261 and dp.valid_to_ts='9999-12-31 00:00:00' and dm.valid_to_ts ='9999-12-31 00:00:00'
),
CTE2 as (
select distinct dm.data_movement_id,dcml.metadata_category as destination_type, dscl.dataplace_sub_component_type as destination,dscl.dataplace_sub_component_id as id from nabu.data_movement_details_physical dm inner join nabu.dataplace_physical dp on dp.dataplace_id=dm.destination_dataplace_id
inner join  nabu.dataplace_component_mapping_lookup dcml on dcml.dataplace_sub_component_id =dp.dataplace_sub_component_id
inner join nabu.dataplace_sub_component_lookup dscl on dcml.dataplace_sub_component_id =dscl.dataplace_sub_component_id
where dm.data_movement_id=261 and dp.valid_to_ts='9999-12-31 00:00:00' and dm.valid_to_ts ='9999-12-31 00:00:00'
)
select a.data_movement_id,a.source_type as source_metadata_category,b.destination_type as destination_metadata_category, a.source , b.destination  ,
 case when(a.source_type = 'file') then true else false end as is_source_filetype ,
 case when(a.source_type = 'salesforce') then true else false end as is_source_salesforce,
 case when(a.source_type = 'collection') then true else false end as is_source_mongodb,
 case when(b.destination_type = 'file') then true else false end as is_destination_filetype
,case when b.id in (7,11,25,27) then true else false end as is_ordinalpos_startwith_zero,
case when b.destination='redshift' then true else false end as is_destination_redshift
from CTE1 a
inner join
CTE2 b on a.data_movement_id=b.data_movement_id
""2023-11-15 16:41:01.137 [Thread-1228] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with pipeline_ts as(
select flow_ts, data_movement_id, job_type_id,
to_char(flow_ts::timestamp,'dd Month yyyy HH24:mi:ss ')||(SELECT abbrev  FROM pg_timezone_names WHERE name = current_setting('TIMEZONE')) as pipeline_run_time, flow_ts::timestamp(6) as pipeline_start_ts
from
(select *,ROW_NUMBER () OVER (order by flow_ts desc) rank from nabu.flow_status
where data_movement_id = 261
and status_code_id = 11
)a where rank=1) select flow_ts,data_movement_id,job_type_id,pipeline_run_time,pipeline_start_ts,
pipeline_start_ts :: time as pipeline_start_time, EXTRACT(second  FROM   pipeline_start_ts)  as pipeline_start_second,EXTRACT(minute  FROM    pipeline_start_ts)  as pipeline_start_minute,EXTRACT(hour FROM   pipeline_start_ts)  as pipeline_start_hour, EXTRACT(Day  FROM   pipeline_start_ts)  as pipeline_start_day,EXTRACT(month  FROM   pipeline_start_ts)  as pipeline_start_month,EXTRACT(year  FROM   pipeline_start_ts)  as pipeline_start_year,date(pipeline_start_ts) as pipeline_start_date from pipeline_ts;
""2023-11-15 16:41:01.433 [Thread-1228] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with flow_tables as (
select table_id,schema_id,table_name as source_object_name,upper(table_name) as source_object_name_uppercase,lower(table_name) as source_object_name_lowercase,
(b.advance_option_details->>'advanced_table_options')::json->>'new_table_name' as new_table_for_rename,
(b.advance_option_details->'advanced_table_options'->'columns_options'-> 'modified_columns')::json as modified_columns,
(b.advance_option_details->'advanced_table_options'->'columns_options'-> 'virtual_column')::json as virtual_column,
(b.advance_option_details->'advanced_table_options'->'reorder_columns')::json as reorder_columns,
schema_name as schema_name,dataplace_id,estimated_rows
from nabu.dataplace_table_metadata_physical a
left outer join nabu.advanced_options_object_details b
on a.table_id = b.object_id
where a.table_id in (37234)
and b.data_movement_id = 261
and a.valid_to_ts = '9999-12-31'
and b.valid_to_ts = '9999-12-31'
)
select source_object_name,source_object_name_uppercase,source_object_name_lowercase,
new_table_for_rename,modified_columns,virtual_column,reorder_columns
from flow_tables;
""2023-11-15 16:41:01.441 [Thread-1228] DEBUG com.modak.bots.DBOpsBot - to execute query timeTakenInMillis : 2114
""2023-11-15 16:41:01.442 [Thread-1228] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 5645838a-33b2-48a4-86c1-4538fa4c0a4c has finished process logic with message_id f35551cc-fccd-4d73-9573-3222224d04be and thread_id 1497
""2023-11-15 16:41:01.442 [Thread-1228] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : true
""2023-11-15 16:41:01.442 [Thread-1228] INFO  com.modak.bots.basebot.AbstractBaseBot -  skipBotLogic == false && useIncomingData == true ..,so both inputData map and botLogic output map is send as output message
""2023-11-15 16:41:01.442 [Thread-1228] INFO  com.modak.bots.basebot.AbstractBaseBot - botLogicOutput : { "generate_variables" : "{\n    \"env_variables\": {},\n    \"rest_api_variables\": {},\n    \"user_variables\": {},\n    \"payload_variables\": {\n},\n}", "pipeline_run_timestamp" : [ { "flow_ts" : "2023-11-15 16:40:42.694181", "data_movement_id" : 261, "job_type_id" : 1, "pipeline_run_time" : "15 November  2023 16:40:42 UTC", "pipeline_start_ts" : "2023-11-15 16:40:42.694181", "pipeline_start_time" : "16:40:42", "pipeline_start_second" : 42.694181, "pipeline_start_minute" : 40.0, "pipeline_start_hour" : 16.0, "pipeline_start_day" : 15.0, "pipeline_start_month" : 11.0, "pipeline_start_year" : 2023.0, "pipeline_start_date" : "2023-11-15" } ], "object_name" : [ { "source_object_name" : "aaaa", "source_object_name_uppercase" : "AAAA", "source_object_name_lowercase" : "aaaa", "new_table_for_rename" : "", "modified_columns" : [], "virtual_column" : [], "reorder_columns" : [] } ], "fetch_source_type" : [ { "data_movement_id" : 261, "source_metadata_category" : "relational", "destination_metadata_category" : "file", "source" : "sql_server", "destination" : "adls_gen2", "is_source_filetype" : false, "is_source_salesforce" : false, "is_source_mongodb" : false, "is_destination_filetype" : true, "is_ordinalpos_startwith_zero" : false, "is_destination_redshift" : false } ] }
""2023-11-15 16:41:01.471 [Thread-1228] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "DBOpsBot", "bot_metadata": { "message_id": "d118c62f-238e-4e7f-91ec-bad84dc5f37a", "parent_id": "f35551cc-fccd-4d73-9573-3222224d04be", "bot_id": "5645838a-33b2-48a4-86c1-4538fa4c0a4c", "message_topic":"nabu_2_jdbc", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":17000664381264241, "initial_ts":1700066438126, "batch_id":17000664380239952, "batch_name":"Ingestion_20231115", "job_schedule_id":1568, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "2023-11-07 12:42:00.86365", "environment": "modak", "ignore_job_termination" : false, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot" ],"task_dependency":true}, "task_retry_intervals_secs": [ ], "message_context": "generating relative file path" }, "bot_tasks": [ { "task_name": "generating_relative_file_path", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "skipLogicPattern": "doNothing", "pre_task_logging_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "pre_log_template" }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "doNothingTemplate" }, "input_data":{ "query_input" : { "environment": "modak", "data_movement_id": "261", "data_movement_name": "ss_compass_adb_validation", "process_id": "17000664381264241", "batch_id": "17000664380239952", "batch_name": "Ingestion_20231115", "workflow_name": "artifact_generation", "flow_number": 1, "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDY2NDU3NzgzNDI0MCwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0OTI1OCwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2NjQ1N30.cgEzDcSlWhMY65PdNscgXY1oBYM75LZUbp00acf6_d1WRUOrXXGi5pcvwkRNDv0JIxun7nmcSCqy2CKZ38-eHnEqqAoxh2CIRwXTdBlsYYFyfkXHYapfaXinAi82pkDk0yJQOs-m-vAf1cbV4ue4Zk6bHKbJeu_j5_x8HU3PKeF0pz0lA-tpeoFRlq_tLUXqApH5t7QuTIzOSq7Aujo6yOSm_inHTBzTWxUyVaBCitbKs_j3Oq-P5c-Y5W3r9oAvDNbMASikxmdxfJBp_rI2QYHdxazW9UvVh_ZpRPwOIbi7EAe9-B6BBxAxItPBTo4M-GFi-zvZZXXYMX57edoRDA", "end_point" : "http://dev-dha.humana.com:8889/fireshots/credentialsFetchWebService", "where_condition": "37234", "job_schedule_id": 1568, "job_type_id": "1", "job_scheduled_user_id": "Manaswini Chinthalapudi", "is_relative_file_path": false, "source_schema_name": "acuity-develop", "source_database_name": "development-db", "source_database_name_uppercase": "DEVELOPMENT-DB", "source_database_name_lowercase": "development-db", "source_schema_name_lowercase": "acuity-develop", "source_schema_name_uppercase": "ACUITY-DEVELOP", "relative_file_path": "", "ingestion_table_format": "", "suffix": "", "new_table_for_rename": "", "modified_columns": [ ], "virtual_column": [ ], "reorder_columns": [ ], "last_run_timestamp": "2023-11-07 12:42:00.86365" }, "variables": { "env_variables": {}, "rest_api_variables": {}, "user_variables": {}, "payload_variables": { }, }, "pipelineInfoMap": { "pipeline_id" : 261, "pipeline_name" : "ss_compass_adb_validation", "pipeline_lastrun_ts" : "2023-11-07 12:42:00.86365", "pipeline_run_id" : 17000664380239952, "source_schema_name" : "acuity-develop", "source_database_name": "development-db", "source_schema_name_lowercase" : "acuity-develop", "source_database_name_lowercase": "development-db", "source_schema_name_uppercase" : "ACUITY-DEVELOP", "source_database_name_uppercase": "DEVELOPMENT-DB", "pipeline_start_ts" : "2023-11-15 16:40:42.694181", "pipeline_start_year" : "2023.0", "pipeline_start_month" : "2023.0", "pipeline_start_day" : "15.0", "pipeline_start_date" : "2023-11-15", "pipeline_start_time" : "16:40:42", "pipeline_start_hour" : "16.0", "pipeline_start_minute" : "40.0", "pipeline_start_second" : "42.694181", "source_object_name": "aaaa", "source_object_name_lowercase":"aaaa", "source_object_name_uppercase":"AAAA", "file_name_with_extension" : "", "file_name_with_extension_uppercase" : "", "file_name_with_extension_lowercase" : "", "parent_folder_structure" : "", "parent_folder_structure_uppercase" : "", "parent_folder_structure_lowercase" : "" }, }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/ingestion_flow.stg", "template_name": "get_metadata_and_generate_almaren", "useIncomingData":true }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "task_status_success_msg", "useIncomingData":true } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "error_template_create_msg" } ] } ] }
""2023-11-15 16:41:01.474 [Thread-1228] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_jdbc
""2023-11-15 16:41:01.483 [Thread-1228] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_jdbc
""2023-11-15 16:41:01.484 [Thread-1228] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-15 16:41:01.493 [Thread-1228] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "9a310c49-cc31-4d74-9b79-9f9278c8ec1f", "parent_id": "f35551cc-fccd-4d73-9573-3222224d04be", "bot_id": "5645838a-33b2-48a4-86c1-4538fa4c0a4c", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":17000664381264241, "initial_ts":1700066438126, "batch_id":17000664380239952, "batch_name":"Ingestion_20231115", "job_schedule_id":1568, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "2023-11-07 12:42:00.86365", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"5645838a-33b2-48a4-86c1-4538fa4c0a4c", "bot_name":"DBOpsBot", "process_context":"generating pipeline start timestamp", "task_name":"generating_relative_file_path", "process_id":"17000664381264241", "task_ts":1700066461442, "batch_id":"17000664380239952", "status_code_id": 6 } } ] }
""2023-11-15 16:41:01.494 [Thread-1228] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:41:01.498 [Thread-1228] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:41:01.499 [Thread-1228] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:41:01.499 [Thread-1228] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot finished processing message with id f35551cc-fccd-4d73-9573-3222224d04be
""2023-11-15 16:41:01.622 [Thread-144] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 1ea57a4f-404a-4c9a-9ed1-68213b1fee5d has started processing message with message_id d118c62f-238e-4e7f-91ec-bad84dc5f37a and thread_id 229 
""2023-11-15 16:41:01.622 [Thread-144] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:41:01.622 [Thread-144] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=f35551cc-fccd-4d73-9573-3222224d04be, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=generating relative file path, message_id=d118c62f-238e-4e7f-91ec-bad84dc5f37a, task_retry_intervals_secs=[], bot_id=5645838a-33b2-48a4-86c1-4538fa4c0a4c, message_topic=nabu_2_jdbc, tags={process_id=17000664381264241, batch_id=17000664380239952, job_scheduled_user_id=Manaswini Chinthalapudi, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot], initial_ts=1700066438126, batch_name=Ingestion_20231115, environment=modak, job_schedule_id=1568, data_movement_id=261, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, task_dependency=true, ignore_job_termination=false}}
""2023-11-15 16:41:01.638 [Thread-1316] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 0388a1e3-013c-4965-a5ca-7e2c53ae3741 has started processing message with message_id 9a310c49-cc31-4d74-9b79-9f9278c8ec1f and thread_id 1599 
""2023-11-15 16:41:01.638 [Thread-1316] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:41:01.638 [Thread-1316] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=f35551cc-fccd-4d73-9573-3222224d04be, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=9a310c49-cc31-4d74-9b79-9f9278c8ec1f, task_retry_intervals_secs=[], bot_id=5645838a-33b2-48a4-86c1-4538fa4c0a4c, message_topic=nabu_2_taskmonitor, tags={process_id=17000664381264241, initial_ts=1700066438126, batch_name=Ingestion_20231115, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, TaskMonitorBot]}}
""2023-11-15 16:41:01.655 [Thread-144] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
doNothing
""2023-11-15 16:41:01.655 [Thread-1316] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 17000664381264241, 'DBOpsBot', 'generating pipeline start timestamp', 'generating_relative_file_path', 6 , TO_TIMESTAMP(1700066461442::double precision / 1000) ,'5645838a-33b2-48a4-86c1-4538fa4c0a4c');
""2023-11-15 16:41:01.655 [Thread-1316] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 0388a1e3-013c-4965-a5ca-7e2c53ae3741 has started process logic with message_id 9a310c49-cc31-4d74-9b79-9f9278c8ec1f and thread_id 1599
""2023-11-15 16:41:01.693 [Thread-144] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 16:41:01.695 [Thread-144] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:41:01.698 [Thread-144] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:41:01.698 [Thread-144] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : true
""2023-11-15 16:41:01.771 [Thread-1316] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 0388a1e3-013c-4965-a5ca-7e2c53ae3741 has finished process logic with message_id 9a310c49-cc31-4d74-9b79-9f9278c8ec1f and thread_id 1599
""2023-11-15 16:41:01.771 [Thread-1316] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:41:01.772 [Thread-1316] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 9a310c49-cc31-4d74-9b79-9f9278c8ec1f
""2023-11-15 16:41:01.840 [Thread-628] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 36eb6878-e0a2-4c36-aa72-014700443066 has started processing message with message_id f89649ba-8da2-4110-a7fa-b9966b75a45c and thread_id 794 
""2023-11-15 16:41:01.840 [Thread-628] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:41:01.840 [Thread-628] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=d118c62f-238e-4e7f-91ec-bad84dc5f37a, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=f89649ba-8da2-4110-a7fa-b9966b75a45c, task_retry_intervals_secs=[], bot_id=1ea57a4f-404a-4c9a-9ed1-68213b1fee5d, message_topic=nabu_2_taskmonitor, tags={process_id=17000664381264241, initial_ts=1700066438126, batch_name=Ingestion_20231115, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot, TaskMonitorBot]}}
""2023-11-15 16:41:01.850 [Thread-628] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 17000664381264241, 'DBOpsBot', 'generating relative file path', 'generating_relative_file_path', 10 , TO_TIMESTAMP(1700066461622::double precision / 1000) ,'1ea57a4f-404a-4c9a-9ed1-68213b1fee5d');
""2023-11-15 16:41:01.850 [Thread-628] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 36eb6878-e0a2-4c36-aa72-014700443066 has started process logic with message_id f89649ba-8da2-4110-a7fa-b9966b75a45c and thread_id 794
""2023-11-15 16:41:02.117 [Thread-628] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 36eb6878-e0a2-4c36-aa72-014700443066 has finished process logic with message_id f89649ba-8da2-4110-a7fa-b9966b75a45c and thread_id 794
""2023-11-15 16:41:02.117 [Thread-628] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:41:02.117 [Thread-628] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id f89649ba-8da2-4110-a7fa-b9966b75a45c
""2023-11-15 16:41:02.312 [Thread-144] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "DBOpsBot", "bot_metadata": { "message_id": "4e8bcd3a-7fb0-4043-aba4-6d226c053fa0", "parent_id": "d118c62f-238e-4e7f-91ec-bad84dc5f37a", "bot_id": "1ea57a4f-404a-4c9a-9ed1-68213b1fee5d", "message_topic":"nabu_2_jdbc", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":17000664381264241, "initial_ts":1700066438126, "batch_id":17000664380239952, "batch_name":"Ingestion_20231115", "job_schedule_id":1568, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "2023-11-07 12:42:00.86365", "environment": "modak", "ignore_job_termination" : false, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot", "KoshBot" ],"task_dependency":true}, "task_retry_intervals_secs": [ ], "message_context": "get_metadata_and_generate_almaren" }, "bot_tasks": [ { "task_name": "get_metadata_and_generate_almaren", "data_processor": { "classname": "com.modak.bots.processor.FilePathProcessor", "props": {} }, "skipLogicPattern": "doNothing", "pre_task_logging_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "pre_log_template" }, "app_template_details": { "template_group": "templates/artifact_ingestion/ingestion_templates.stg", "template_name": "table_metadata_query" }, "input_data": { "template_execution_type": "sequential", "useTransactionControl": true, "environment": "modak", "data_movement_id": "261", "data_movement_name": "ss_compass_adb_validation", "process_id": "17000664381264241", "batch_id": "17000664380239952", "batch_name": "Ingestion_20231115", "workflow_name": "artifact_generation", "flow_number": 1, "where_condition": "37234", "job_schedule_id": 1568, "job_type_id": "1", "job_scheduled_user_id": "Manaswini Chinthalapudi", "is_relative_file_path": false, "source_schema_name": "acuity-develop", "source_database_name": "development-db", "source_schema_name_uppercase": "ACUITY-DEVELOP", "source_database_name_uppercase": "DEVELOPMENT-DB", "source_schema_name_lowercase": "acuity-develop", "source_database_name_lowercase": "development-db", "relative_file_path": "", "last_run_timestamp": "2023-11-07 12:42:00.86365", "jwt_token":"eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDY2NDU3NzgzNDI0MCwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0OTI1OCwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2NjQ1N30.cgEzDcSlWhMY65PdNscgXY1oBYM75LZUbp00acf6_d1WRUOrXXGi5pcvwkRNDv0JIxun7nmcSCqy2CKZ38-eHnEqqAoxh2CIRwXTdBlsYYFyfkXHYapfaXinAi82pkDk0yJQOs-m-vAf1cbV4ue4Zk6bHKbJeu_j5_x8HU3PKeF0pz0lA-tpeoFRlq_tLUXqApH5t7QuTIzOSq7Aujo6yOSm_inHTBzTWxUyVaBCitbKs_j3Oq-P5c-Y5W3r9oAvDNbMASikxmdxfJBp_rI2QYHdxazW9UvVh_ZpRPwOIbi7EAe9-B6BBxAxItPBTo4M-GFi-zvZZXXYMX57edoRDA", "end_point":"http://dev-dha.humana.com:8889/fireshots/credentialsFetchWebService", "processor_input": [ { "key": "relative_file_path", "value": "", "option_type": "file" }, { "key": "new_table_for_rename", "value": "", "option_type": "db" }, { "key": "modified_columns", "value": [ ], "value_type": "list", "keys_to_replace": [ { "path": "column_info.destination_column_name", "decryption": "" }, { "path": "column_info.source_casting_exp", "decryption": "BASE64" } ], "option_type": "db" }, { "key": "virtual_column", "value": [ ], "value_type": "list", "keys_to_replace": [ { "path": "column_name", "decryption": "" }, { "path": "spark_sql_expression", "decryption": "BASE64" } ], "option_type": "db" }, { "key": "reorder_columns", "value": [ ], "value_type": "list", "keys_to_replace": [ { "path": "column_name", "decryption": "" } ], "option_type": "db" }, { "key": "ingestion_table_format", "value": "", "option_type": "db" }, { "key": "suffix", "value": "", "option_type": "db" } ], "variables": { "env_variables": { }, "user_variables": { }, "payload_variables": { } }, "option_type":"", "pipelineInfoMap":{"source_database_name_lowercase" : "development-db","pipeline_start_time" : "16:40:42","parent_folder_structure_uppercase" : "","file_name_with_extension_lowercase" : "","pipeline_start_ts" : "2023-11-15 16:40:42.694181","source_object_name_uppercase" : "AAAA","pipeline_start_month" : "2023.0","pipeline_start_date" : "2023-11-15","pipeline_start_second" : "42.694181","pipeline_id" : "261","pipeline_run_id" : "17000664380239952","source_schema_name_lowercase" : "acuity-develop","pipeline_lastrun_ts" : "2023-11-07 12:42:00.86365","pipeline_start_hour" : "16.0","source_database_name_uppercase" : "DEVELOPMENT-DB","parent_folder_structure_lowercase" : "","source_object_name" : "aaaa","file_name_with_extension_uppercase" : "","parent_folder_structure" : "","pipeline_name" : "ss_compass_adb_validation","source_schema_name_uppercase" : "ACUITY-DEVELOP","source_schema_name" : "acuity-develop","pipeline_start_year" : "2023.0","source_object_name_lowercase" : "aaaa","source_database_name" : "development-db","pipeline_start_minute" : "40.0","pipeline_start_day" : "15.0","file_name_with_extension" : ""}, "retry_attempt" : 0 }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/ingestion_flow.stg", "template_name": "ingestion_deciding_msg" }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "task_status_success_msg" } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "error_template_create_msg" } ] } ] }
""2023-11-15 16:41:02.315 [Thread-144] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_jdbc
""2023-11-15 16:41:02.319 [Thread-144] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_jdbc
""2023-11-15 16:41:02.320 [Thread-144] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : true
""2023-11-15 16:41:02.326 [Thread-88] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 84c43ca6-2712-4cd9-b2d9-b0fe3f69b476 has started processing message with message_id 4e8bcd3a-7fb0-4043-aba4-6d226c053fa0 and thread_id 164 
""2023-11-15 16:41:02.326 [Thread-88] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:41:02.326 [Thread-88] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=d118c62f-238e-4e7f-91ec-bad84dc5f37a, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=get_metadata_and_generate_almaren, message_id=4e8bcd3a-7fb0-4043-aba4-6d226c053fa0, task_retry_intervals_secs=[], bot_id=1ea57a4f-404a-4c9a-9ed1-68213b1fee5d, message_topic=nabu_2_jdbc, tags={process_id=17000664381264241, batch_id=17000664380239952, job_scheduled_user_id=Manaswini Chinthalapudi, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot, KoshBot], initial_ts=1700066438126, batch_name=Ingestion_20231115, environment=modak, job_schedule_id=1568, data_movement_id=261, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, task_dependency=true, ignore_job_termination=false}}
""2023-11-15 16:41:02.333 [Thread-144] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "b983ee49-b937-4952-887c-c1136b62d9b4", "parent_id": "d118c62f-238e-4e7f-91ec-bad84dc5f37a", "bot_id": "1ea57a4f-404a-4c9a-9ed1-68213b1fee5d", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":17000664381264241, "initial_ts":1700066438126, "batch_id":17000664380239952, "batch_name":"Ingestion_20231115", "job_schedule_id":1568, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "2023-11-07 12:42:00.86365", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"1ea57a4f-404a-4c9a-9ed1-68213b1fee5d", "bot_name":"DBOpsBot", "process_context":"generating relative file path", "task_name":"generating_relative_file_path", "process_id":"17000664381264241", "task_ts":1700066461698, "batch_id":"17000664380239952", "status_code_id": 6 } } ] }
""2023-11-15 16:41:02.339 [Thread-144] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:41:02.343 [Thread-144] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:41:02.343 [Thread-144] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:41:02.343 [Thread-144] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot finished processing message with id d118c62f-238e-4e7f-91ec-bad84dc5f37a
""2023-11-15 16:41:02.343 [Thread-88] INFO  com.modak.bots.processor.FilePathProcessor - Processed input data:
{ "process_id" : "17000664381264241", "flow_number" : 1, "source_database_name_lowercase" : "development-db", "batch_id" : "17000664380239952", "workflow_name" : "artifact_generation", "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDY2NDU3NzgzNDI0MCwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0OTI1OCwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2NjQ1N30.cgEzDcSlWhMY65PdNscgXY1oBYM75LZUbp00acf6_d1WRUOrXXGi5pcvwkRNDv0JIxun7nmcSCqy2CKZ38-eHnEqqAoxh2CIRwXTdBlsYYFyfkXHYapfaXinAi82pkDk0yJQOs-m-vAf1cbV4ue4Zk6bHKbJeu_j5_x8HU3PKeF0pz0lA-tpeoFRlq_tLUXqApH5t7QuTIzOSq7Aujo6yOSm_inHTBzTWxUyVaBCitbKs_j3Oq-P5c-Y5W3r9oAvDNbMASikxmdxfJBp_rI2QYHdxazW9UvVh_ZpRPwOIbi7EAe9-B6BBxAxItPBTo4M-GFi-zvZZXXYMX57edoRDA", "end_point" : "http:\/\/dev-dha.humana.com:8889\/fireshots\/credentialsFetchWebService", "where_condition" : "37234", "reorder_columns" : [], "suffix" : "", "job_type_id" : "1", "ingestion_table_format" : "", "job_schedule_id" : 1568, "data_movement_name" : "ss_compass_adb_validation", "relative_file_path" : "", "retry_attempt" : 0, "source_schema_name_lowercase" : "acuity-develop", "currentBotMessageMap" : { "parent_id" : "d118c62f-238e-4e7f-91ec-bad84dc5f37a", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "message_context" : "get_metadata_and_generate_almaren", "message_id" : "4e8bcd3a-7fb0-4043-aba4-6d226c053fa0", "task_retry_intervals_secs" : [], "bot_id" : "1ea57a4f-404a-4c9a-9ed1-68213b1fee5d", "message_topic" : "nabu_2_jdbc", "tags" : { "process_id" : 17000664381264241, "batch_id" : 17000664380239952, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "tags" : [ "AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot", "KoshBot" ], "initial_ts" : 1700066438126, "batch_name" : "Ingestion_20231115", "environment" : "modak", "job_schedule_id" : 1568, "data_movement_id" : 261, "last_run_timestamp" : "2023-11-07 12:42:00.86365", "retry_attempt" : 0, "task_dependency" : true, "ignore_job_termination" : false } }, "variables" : { "env_variables" : {}, "user_variables" : {}, "payload_variables" : {} }, "source_database_name_uppercase" : "DEVELOPMENT-DB", "processor_input" : [ { "option_type" : "file", "value" : "", "key" : "relative_file_path" }, { "option_type" : "db", "value" : "", "key" : "new_table_for_rename" }, { "value_type" : "list", "keys_to_replace" : [ { "path" : "column_info.destination_column_name", "decryption" : "" }, { "path" : "column_info.source_casting_exp", "decryption" : "BASE64" } ], "option_type" : "db", "value" : [], "key" : "modified_columns" }, { "value_type" : "list", "keys_to_replace" : [ { "path" : "column_name", "decryption" : "" }, { "path" : "spark_sql_expression", "decryption" : "BASE64" } ], "option_type" : "db", "value" : [], "key" : "virtual_column" }, { "value_type" : "list", "keys_to_replace" : [ { "path" : "column_name", "decryption" : "" } ], "option_type" : "db", "value" : [], "key" : "reorder_columns" }, { "option_type" : "db", "value" : "", "key" : "ingestion_table_format" }, { "option_type" : "db", "value" : "", "key" : "suffix" } ], "option_type" : "", "job_scheduled_user_id" : "Manaswini Chinthalapudi", "pipelineInfoMap" : { "source_database_name_lowercase" : "development-db", "pipeline_start_time" : "16:40:42", "current_day_of_year" : 319, "parent_folder_structure_uppercase" : "", "file_name_with_extension_lowercase" : "", "current_day" : "15", "pipeline_start_ts" : "2023-11-15 16:40:42.694181", "source_object_name_uppercase" : "AAAA", "pipeline_start_month" : "11", "current_year" : "2023", "pipeline_start_date" : "2023-11-15", "current_second" : "02", "current_timestamp" : "2023-11-15 16:41:02", "pipeline_start_second" : "42", "pipeline_id" : "261", "pipeline_run_id" : "17000664380239952", "current_timestamp_iso" : "2023-11-15T16:41:02.329", "source_schema_name_lowercase" : "acuity-develop", "pipeline_lastrun_ts" : "2023-11-07 12:42:00.86365", "current_time" : "16:41:02", "pipeline_start_hour" : "16", "current_hour" : "16", "source_database_name_uppercase" : "DEVELOPMENT-DB", "current_week_of_month" : 3, "parent_folder_structure_lowercase" : "", "source_object_name" : "aaaa", "file_name_with_extension_uppercase" : "", "current_week_of_year" : 46, "parent_folder_structure" : "", "pipeline_name" : "ss_compass_adb_validation", "source_schema_name_uppercase" : "ACUITY-DEVELOP", "source_schema_name" : "acuity-develop", "pipeline_start_year" : "2023", "source_object_name_lowercase" : "aaaa", "current_date" : "2023-11-15", "source_database_name" : "development-db", "pipeline_start_minute" : "40", "current_minute" : "41", "current_month" : "11", "pipeline_start_day" : "15", "current_day_of_month" : 15, "file_name_with_extension" : "" }, "virtual_column" : [], "new_table_for_rename" : "", "source_schema_name_uppercase" : "ACUITY-DEVELOP", "source_schema_name" : "acuity-develop", "environment" : "modak", "batch_name" : "Ingestion_20231115", "source_database_name" : "development-db", "modified_columns" : [], "data_movement_id" : "261", "last_run_timestamp" : "2023-11-07 12:42:00.86365", "template_execution_type" : "sequential", "is_relative_file_path" : false, "useTransactionControl" : true }
""2023-11-15 16:41:02.450 [Thread-408] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ed3cd22-40fc-41f0-a1bf-2e8df394dc31 has started processing message with message_id b983ee49-b937-4952-887c-c1136b62d9b4 and thread_id 537 
""2023-11-15 16:41:02.450 [Thread-408] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:41:02.450 [Thread-408] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=d118c62f-238e-4e7f-91ec-bad84dc5f37a, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=b983ee49-b937-4952-887c-c1136b62d9b4, task_retry_intervals_secs=[], bot_id=1ea57a4f-404a-4c9a-9ed1-68213b1fee5d, message_topic=nabu_2_taskmonitor, tags={process_id=17000664381264241, initial_ts=1700066438126, batch_name=Ingestion_20231115, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot, TaskMonitorBot]}}
""2023-11-15 16:41:02.465 [Thread-408] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 17000664381264241, 'DBOpsBot', 'generating relative file path', 'generating_relative_file_path', 6 , TO_TIMESTAMP(1700066461698::double precision / 1000) ,'1ea57a4f-404a-4c9a-9ed1-68213b1fee5d');
""2023-11-15 16:41:02.465 [Thread-408] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ed3cd22-40fc-41f0-a1bf-2e8df394dc31 has started process logic with message_id b983ee49-b937-4952-887c-c1136b62d9b4 and thread_id 537
""2023-11-15 16:41:02.545 [Thread-408] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ed3cd22-40fc-41f0-a1bf-2e8df394dc31 has finished process logic with message_id b983ee49-b937-4952-887c-c1136b62d9b4 and thread_id 537
""2023-11-15 16:41:02.545 [Thread-408] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:41:02.545 [Thread-408] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id b983ee49-b937-4952-887c-c1136b62d9b4
""2023-11-15 16:41:02.836 [Thread-88] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
{ "input_data": { "is_relative_file_path" : false, "data_movement_id" : 261, "flow_number" : 1, "where_condition":"37234", "process_id" : 17000664381264241, "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDY2NDU3NzgzNDI0MCwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0OTI1OCwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2NjQ1N30.cgEzDcSlWhMY65PdNscgXY1oBYM75LZUbp00acf6_d1WRUOrXXGi5pcvwkRNDv0JIxun7nmcSCqy2CKZ38-eHnEqqAoxh2CIRwXTdBlsYYFyfkXHYapfaXinAi82pkDk0yJQOs-m-vAf1cbV4ue4Zk6bHKbJeu_j5_x8HU3PKeF0pz0lA-tpeoFRlq_tLUXqApH5t7QuTIzOSq7Aujo6yOSm_inHTBzTWxUyVaBCitbKs_j3Oq-P5c-Y5W3r9oAvDNbMASikxmdxfJBp_rI2QYHdxazW9UvVh_ZpRPwOIbi7EAe9-B6BBxAxItPBTo4M-GFi-zvZZXXYMX57edoRDA", "end_point" : "http://dev-dha.humana.com:8889/fireshots/credentialsFetchWebService", "batch_id": 17000664380239952, "batch_name": "Ingestion_20231115", "job_type_id": "1", "job_scheduled_user_id":"Manaswini Chinthalapudi", "job_schedule_id":1568, "variables": { "env_variables": { }, "user_variables": { }, "payload_variables": { } }, "relative_file_path":"", "ingestion_table_format":"", "suffix":"", "new_table_for_rename":"", "modified_columns":[ ], "virtual_column":[ ], "reorder_columns":[ ], "last_run_timestamp":"2023-11-07 12:42:00.86365", "source_database_name_uppercase":"DEVELOPMENT-DB", "source_database_name":"development-db", "source_database_name_lowercase":"development-db", "source_schema_name_lowercase":"acuity-develop", "source_schema_name_uppercase":"ACUITY-DEVELOP", "retry_attempt" : "0" }, "sequential_templates":[ { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "check_compute_engine_validity_data_movement", "query_output_key": "check_compute_engine_validity", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_pipeline_run_timestamp", "query_output_key": "pipeline_run_timestamp", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "fetch_source_type", "query_output_key": "fetch_source_type", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "fetching_script_inputs", "query_output_key": "spark_script_inputs", "query_type":"select", "env_values":["NABU_ENV"] }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_table_adv_opt_partition_details", "query_output_key": "table_adv_opt_details_partition_details", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_remove_duplicates_data", "query_output_key": "remove_duplicates_data", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_sort_columns_data", "query_output_key": "sort_columns_data", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_table_adv_opt_details", "query_output_key": "table_adv_opt_details", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "advanced_options_tables_flags", "query_output_key": "advanced_options_tables_flags", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "advanced_options_tables_flags_status", "query_output_key": "advanced_options_tables_flags_status", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "sort_by_columns_data", "query_output_key": "sort_by_columns_data", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "incremental_load_details", "query_output_key": "incremental_load_details", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_place_holders_with_default_and_max_values", "query_output_key": "place_holders_with_default_and_max_values", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "replace_place_holders_in_wherecondition_with_default_and_max_values", "query_output_key": "updated_wherecondition_replaced_with_default_and_max_values", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_incremental_max_columns_with_column_ids", "query_output_key": "incremental_max_columns_with_column_ids", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "generate_list_of_maps_of_incremental_columns", "query_output_key": "list_of_maps_of_incremental_columns", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_already_renamed_condition", "query_output_key": "get_already_renamed_condition", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_ingestion_information", "query_output_key": "table_metadata_output", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "is_cdc", "query_output_key": "is_cdc", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "cdc_schema_drift_new_table", "query_output_key": "cdc_schema_drift_new_table", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_cdc_type", "query_output_key": "get_cdc_type", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_cdc_info", "query_output_key": "get_cdc_info", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_prev_cdc_id", "query_output_key": "get_prev_cdc_id", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_new_cdc_id", "query_output_key": "get_new_cdc_id", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "update_cdc_xref", "query_output_key": "update_cdc_xref", "query_type":"update" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "insert_cdc_xref", "query_output_key": "insert_cdc_xref", "query_type":"insert" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_cdc_audit_cols", "query_output_key": "get_cdc_audit_cols", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_view_info", "query_output_key": "get_view_info", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_already_ingested_condition", "query_output_key": "get_already_ingested_condition", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_partition_information_test", "query_output_key": "table_partition_output", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "fetch_object_column_metadata", "query_output_key": "column_metadata_output", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "fetch_destination_transformation_query_details", "query_output_key": "destination_transformation_query_details_output", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "generate_primary_cols_output", "query_output_key": "generate_primary_cols_output", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_varchar_columns_destination", "query_output_key": "get_varchar_columns_destination", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_varchar_columns", "query_output_key": "get_varchar_columns", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_partition_cols", "query_output_key": "get_partition_cols", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_non_partition_cols", "query_output_key": "get_non_partition_cols", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "fetch_ingested_details", "query_output_key": "fetch_ingested_details", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "target_schemadrift_details", "query_output_key": "target_schemadrift_details", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "target_schemadrift_flag", "query_output_key": "target_schemadrift_flag", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_ingestion_mode", "query_output_key": "ingestion_mode", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_cdc_last_run_table", "query_output_key": "get_cdc_last_run_table", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "cdc_first_time", "query_output_key": "cdc_first_time", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "fetch_virtual_column_details", "query_output_key": "virtual_column_metadata_output", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_list_of_maps_of_partition_columns", "query_output_key": "get_list_of_maps_of_partition_columns", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "insert_into_process_id_table_map", "query_output_key": "insert_into_process_id_table_map", "query_type":"insert" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_spark_configs", "query_output_key": "get_spark_configs", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "generate_spark_configs_json", "query_output_key": "generate_spark_configs_json", "query_type":"json", "encryption_details" : { "encryption" : "yes", "encryption_type" : "BASE64" } }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "generate_extra_configs_json_ingestion", "query_output_key": "generate_extra_configs_json_ingestion", "query_type":"select", "env_values":["NABU_ENV"] }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "generate_extra_configs_json", "query_output_key": "generate_extra_configs_json", "query_type":"json", "env_values":["NABU_ENV"], "encryption_details" : { "encryption" : "yes", "encryption_type" : "BASE64" } }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "fetching_credential_inputs", "query_output_key": "fetching_credential_inputs", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "aes_encrypted_token", "query_output_key": "aes_encrypted_token", "query_type":"json", "encryption_details" : { "encryption" : "yes", "encryption_type" : "AES" } }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "generate_file_content_json", "query_output_key": "generate_file_content_json", "query_type":"json", "encryption_details" : { "encryption" : "yes", "encryption_type" : "BASE64" } }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "generate_base64_pipeline_timeout_json", "query_output_key": "generate_base64_pipeline_timeout_json", "query_type":"json", "encryption_details" : { "encryption" : "yes", "encryption_type" : "BASE64" } }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "generate_yeedu_metastore_credential", "query_output_key": "generate_yeedu_metastore_credential", "query_type":"json", "encryption_details" : { "encryption" : "yes", "encryption_type" : "BASE64" } }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "generate_credential_json", "query_output_key": "base64_encrypted_json_creds", "query_type":"json", "encryption_details" : { "encryption" : "yes", "encryption_type" : "BASE64" } }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "convert_base64_encrypted_json_creds_to_rsa", "query_output_key": "base64_rsa_compressed_encrypted_creds", "query_type":"json", "encryption_details" : { "encryption" : "yes", "encryption_type" : "RSA_BASE64" } }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "generate_source_input_json_for_checkpoint", "query_output_key": "input_json_for_checkpoint_status", "query_type":"json", "encryption_details" : { "encryption" : "yes", "encryption_type" : "BASE64" } }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "emr_input_json", "query_output_key": "emr_input_json", "query_type":"json", "encryption_details" : { "encryption" : "yes", "encryption_type" : "BASE64" } }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "yeedu_input_json", "query_output_key": "yeedu_input_json", "query_type":"json", "encryption_details" : { "encryption" : "yes", "encryption_type" : "BASE64" } }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "generate_almaren_artifact", "query_output_key": "encrypted_script", "query_type":"json", "env_values":["NABU_ENV"], "encryption_details" : { "encryption" : "yes", "encryption_type" : "GZIP_BASE64" } }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "insert_almaren_code", "query_output_key": "insert_almaren_code", "query_type":"insert" } ], "output_keys":["emr_input_json","yeedu_input_json","get_cdc_last_run_table","check_compute_engine_validity","get_list_of_maps_of_partition_columns","ingestion_mode","advanced_options_tables_flags_status","get_partition_cols","get_non_partition_cols","table_partition_output","fetch_source_type","table_metadata_output","get_already_ingested_condition","column_metadata_output","input_data","table_adv_opt_details","incremental_load_details", "place_holders_with_default_and_max_values", "updated_wherecondition_replaced_with_default_and_max_values", "incremental_max_columns_with_column_ids", "list_of_maps_of_incremental_columns", "base64_rsa_compressed_encrypted_creds","input_json_for_checkpoint_status","spark_script_inputs","remove_duplicates_data","sort_by_columns_data","destination_transformation_query_details_output","get_cdc_info","get_cdc_type","get_cdc_audit_cols","cdc_first_time","get_view_info","target_schemadrift_details","target_schemadrift_flag","cdc_schema_drift_new_table","get_spark_configs","generate_spark_configs_json", "generate_extra_configs_json","generate_file_content_json","fetching_credential_inputs","generate_yeedu_metastore_credential","generate_base64_pipeline_timeout_json","get_varchar_columns","get_varchar_columns_destination"] }
""2023-11-15 16:41:02.849 [Thread-88] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 16:41:02.851 [Thread-88] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:41:02.855 [Thread-88] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:41:02.855 [Thread-88] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 84c43ca6-2712-4cd9-b2d9-b0fe3f69b476 has started process logic with message_id 4e8bcd3a-7fb0-4043-aba4-6d226c053fa0 and thread_id 164
""2023-11-15 16:41:02.860 [Thread-932] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 474a4057-d037-4153-80b2-b8f5bfa887b3 has started processing message with message_id 5272bb4a-6360-4238-b8f4-962b9278efae and thread_id 1151 
""2023-11-15 16:41:02.860 [Thread-932] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:41:02.860 [Thread-932] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=4e8bcd3a-7fb0-4043-aba4-6d226c053fa0, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=5272bb4a-6360-4238-b8f4-962b9278efae, task_retry_intervals_secs=[], bot_id=84c43ca6-2712-4cd9-b2d9-b0fe3f69b476, message_topic=nabu_2_taskmonitor, tags={process_id=17000664381264241, initial_ts=1700066438126, batch_name=Ingestion_20231115, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot, KoshBot, TaskMonitorBot]}}
""2023-11-15 16:41:02.874 [Thread-932] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 17000664381264241, 'DBOpsBot', 'get_metadata_and_generate_almaren', 'get_metadata_and_generate_almaren', 10 , TO_TIMESTAMP(1700066462326::double precision / 1000) ,'84c43ca6-2712-4cd9-b2d9-b0fe3f69b476');
""2023-11-15 16:41:02.874 [Thread-932] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 474a4057-d037-4153-80b2-b8f5bfa887b3 has started process logic with message_id 5272bb4a-6360-4238-b8f4-962b9278efae and thread_id 1151
""2023-11-15 16:41:02.900 [Thread-932] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 474a4057-d037-4153-80b2-b8f5bfa887b3 has finished process logic with message_id 5272bb4a-6360-4238-b8f4-962b9278efae and thread_id 1151
""2023-11-15 16:41:02.900 [Thread-932] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:41:02.900 [Thread-932] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 5272bb4a-6360-4238-b8f4-962b9278efae
""2023-11-15 16:41:03.091 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select
case when ce.valid_to_ts = '9999-12-31' then true else false
end as is_valid_compute_engine
from nabu.data_movement_physical dmp
left outer join nabu.compute_engine ce
on dmp.compute_engine_id = ce.compute_engine_id
where dmp.data_movement_id = 261
and dmp.valid_to_ts ='9999-12-31'
""2023-11-15 16:41:03.388 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with pipeline_ts as(
select flow_ts, data_movement_id, job_type_id,
to_char(flow_ts::timestamp,'dd Month yyyy HH24:mi:ss ')||(SELECT abbrev  FROM pg_timezone_names WHERE name = current_setting('TIMEZONE')) as pipeline_run_time, flow_ts::timestamp(6) as pipeline_start_ts
from
(select *,ROW_NUMBER () OVER (order by flow_ts desc) rank from nabu.flow_status
where data_movement_id = 261
and status_code_id = 11
)a where rank=1) select flow_ts,data_movement_id,job_type_id,pipeline_run_time,pipeline_start_ts,
pipeline_start_ts :: time as pipeline_start_time, EXTRACT(second  FROM   pipeline_start_ts)  as pipeline_start_second,EXTRACT(minute  FROM    pipeline_start_ts)  as pipeline_start_minute,EXTRACT(hour FROM   pipeline_start_ts)  as pipeline_start_hour, EXTRACT(Day  FROM   pipeline_start_ts)  as pipeline_start_day,EXTRACT(month  FROM   pipeline_start_ts)  as pipeline_start_month,EXTRACT(year  FROM   pipeline_start_ts)  as pipeline_start_year,date(pipeline_start_ts) as pipeline_start_date from pipeline_ts;
""2023-11-15 16:41:03.675 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with CTE1 as (
select distinct dm.data_movement_id,dcml.metadata_category as source_type, dscl.dataplace_sub_component_type as source from nabu.data_movement_details_physical dm inner join nabu.dataplace_physical dp on dp.dataplace_id=dm.source_dataplace_id
inner join  nabu.dataplace_component_mapping_lookup dcml on dcml.dataplace_sub_component_id =dp.dataplace_sub_component_id
inner join nabu.dataplace_sub_component_lookup dscl on dcml.dataplace_sub_component_id =dscl.dataplace_sub_component_id
where dm.data_movement_id=261 and dp.valid_to_ts='9999-12-31 00:00:00' and dm.valid_to_ts ='9999-12-31 00:00:00'
),
CTE2 as (
select distinct dm.data_movement_id,dcml.metadata_category as destination_type, dscl.dataplace_sub_component_type as destination,dscl.dataplace_sub_component_id as id from nabu.data_movement_details_physical dm inner join nabu.dataplace_physical dp on dp.dataplace_id=dm.destination_dataplace_id
inner join  nabu.dataplace_component_mapping_lookup dcml on dcml.dataplace_sub_component_id =dp.dataplace_sub_component_id
inner join nabu.dataplace_sub_component_lookup dscl on dcml.dataplace_sub_component_id =dscl.dataplace_sub_component_id
where dm.data_movement_id=261 and dp.valid_to_ts='9999-12-31 00:00:00' and dm.valid_to_ts ='9999-12-31 00:00:00'
)
select a.data_movement_id,a.source_type as source_metadata_category,b.destination_type as destination_metadata_category, a.source , b.destination  ,
 case when(a.source_type = 'file') then true else false end as is_source_filetype ,
 case when(a.source_type = 'salesforce') then true else false end as is_source_salesforce,
 case when(a.source_type = 'collection') then true else false end as is_source_mongodb,
 case when(b.destination_type = 'file') then true else false end as is_destination_filetype
,case when b.id in (7,11,25,27) then true else false end as is_ordinalpos_startwith_zero,
case when b.destination='redshift' then true else false end as is_destination_redshift
from CTE1 a
inner join
CTE2 b on a.data_movement_id=b.data_movement_id
""2023-11-15 16:41:03.840 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with fetch_ssh_configuration as (
select  case when c.config_json->>'hostname' = '' or c.config_json->>'hostname' is null then 'null' else c.config_json->>'hostname' end as ssh_host,
        case when c.config_json->>'username' = '' or c.config_json->>'username' is null then 'null' else c.config_json->>'username' end as ssh_username,
        b.compute_engine_info->>'spark_version'  as spark_version,
        b.compute_engine_info->>'scala_version'  as scala_version,
        b.compute_engine_info->>'cluster_type' as cluster_ui,
        b.compute_engine_info->>'yeedu_rest_url' as rest_url,
case when b.compute_engine_info->>'cloud_provider'= '' or b.compute_engine_info->>'cloud_provider' is null  then 'null'
    else b.compute_engine_info->>'cloud_provider' end as cloud_type,
case when b.compute_engine_info->>'nabu_external_path'= '' or b.compute_engine_info->>'nabu_external_path' is null  then 'null'
    else b.compute_engine_info->>'nabu_external_path' end as spark_location,
b.compute_engine_info->>'s3_bucket_path' as s3_bucket_path,
case when b.compute_engine_info->>'cluster_library_path' is not null or b.compute_engine_info->>'cluster_library_path' != '' then trim(trailing '/' from (b.compute_engine_info->>'cluster_library_path'))
	else 'null' end as cluster_library_path ,
case when b.compute_engine_info->>'cluster_id' is not null or b.compute_engine_info->>'cluster_id' != ''  then b.compute_engine_info->>'cluster_id'
	else 'null' end as cluster_id ,
case when b.compute_engine_info->>'cluster' is not null or b.compute_engine_info->>'cluster' != '' then b.compute_engine_info->>'cluster'
	else 'null' end as dataproc_cluster ,
case when b.compute_engine_info->>'project' is not null or b.compute_engine_info->>'project' != '' then b.compute_engine_info->>'project'
	else 'null' end as dataproc_project ,
case when b.compute_engine_info->>'region' is not null or b.compute_engine_info->>'region' != '' then b.compute_engine_info->>'region'
	else 'null' end as region ,
	b.additional_info ->>'external_jars_map' as b64_external_jars_map,
	b.compute_engine_info->>'is_bucket_encrypted' as is_bucket_encrypted,
	b.compute_engine_info->>'execution_role' as execution_role,
	b.compute_engine_info->>'logGroupName' as logGroupName,
	b.compute_engine_info->>'release_label' as release_label,
	b.compute_engine_info->>'cloud_watch' as cloud_watch,
	b.compute_engine_info->>'s3logs' as s3logs,
        c.config_json->>'kerberos' as kerberos,
        a.data_movement_id , a.data_movement_name,b.engine_mapping_id,b.compute_engine_info
      from nabu.data_movement_physical a
inner join nabu.compute_engine b on a.compute_engine_id = b.compute_engine_id
inner join nabu.config c on  b.compute_engine_config_id = c.config_id
where a.data_movement_id =261 and a.valid_to_ts = '9999-12-31 00:00:00.000' and b.valid_to_ts = '9999-12-31 00:00:00.000'
)
select ssh_host,ssh_username,kerberos::boolean,d.spark_location,d.data_movement_name,d.cluster_library_path,lower(engine_sub_type) as engine_sub_type,d.spark_version,d.scala_version,d.cloud_type,d.cluster_ui,d.rest_url,
cluster_id,dataproc_project,region,dataproc_cluster,s3_bucket_path,is_bucket_encrypted,
execution_role,logGroupName,release_label,cloud_watch,s3logs,
case when engine_sub_type ~*'cdh|cdp' and kerberos ='false'
          then additional_properties ->> 'non_kerberos_sub_engine_path'
          else additional_properties ->> 'default_sub_engine_path' end as engine_path,replace(encode(compute_engine_info::text::bytea,'base64'),E'\n','') as compute_engine_info,
case when engine_sub_type ~*'cdh|cdp|insight|standalone' then spark_location||'/nabu-spark-bots/keys/privateKey'
     when engine_sub_type ~*'cde' then '/app/mount/privateKey'
     when lower(engine_sub_type) ~*'dataproc|glue|ec2' then 'privateKey'
     when lower(engine_sub_type) ~*'databricks cluster' then cluster_library_path||'/dev-v3-1-2-0/nabu/17000664381264241/0/privateKey'
     when lower(engine_sub_type) ~*'databricks' then '/dbfs/tmp/dev-v3-1-2-0/nabu/17000664381264241/0/privateKey'
     when lower(engine_sub_type) ~*'eks' then '/home/hadoop/privateKey'
     when lower(engine_sub_type) ~*'yeedu' then '/yeedu/object-storage-manager/privateKey'
     else null
     end as private_key_path,b64_external_jars_map
from fetch_ssh_configuration d
inner join nabu.engine_mapping_lookup e on d.engine_mapping_id = e.engine_mapping_id
inner join nabu.engine_sub_type_lookup f on f.engine_sub_type_id = e.engine_sub_type_id
""2023-11-15 16:41:04.041 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with advanced_option_details as(
    select object_id, data_movement_id, (advance_option_details->'advanced_table_options')::json as advanced_table_options
    from nabu.advanced_options_object_details aood
    where object_id = 37234 and
    data_movement_id = 261 and
    valid_to_ts='9999-12-31'
)
,parallel_hash_ingestion as(
    select ((advanced_table_options->'parallel_hash_ingestion')->>'enable')::boolean as is_parallel_hash_ingestion,
    ((advanced_table_options->'parallel_hash_ingestion')->>'max_connections')::int as hash_max_conns,
    ((advanced_table_options->'parallel_hash_ingestion')->>'int_column_name') as hash_int_column_name,
    object_id, data_movement_id
    from advanced_option_details
)
, parallel_ingestion as(
    select ((advanced_table_options->'parallel_ingestion')->>'enable')::boolean as is_parallel_ingestion,
    ((advanced_table_options->'parallel_ingestion')->>'max_connections')::int as max_conns,
    object_id, data_movement_id
    from advanced_option_details
)
select
a.object_id,a.data_movement_id,
is_parallel_ingestion,
is_parallel_hash_ingestion,
hash_int_column_name,
case when is_parallel_ingestion then max_conns
	when is_parallel_hash_ingestion then hash_max_conns
	else 2
end as maximum_parallel_connections
from advanced_option_details a
left outer join parallel_hash_ingestion b
on a.object_id = b.object_id
and a.data_movement_id = b.data_movement_id
left outer join parallel_ingestion c
on a.object_id = c.object_id
and a.data_movement_id = c.data_movement_id
""2023-11-15 16:41:04.252 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with duplicate_columns as(
select
case when((partition_columns ->>'renamed_column')='')
then (partition_columns ->>'column_name')
else
(partition_columns ->>'renamed_column')
end as partition_column_name,
(partition_columns ->>'column_name') as original_column_name
from(
select json_array_elements (advance_option_details ->'advanced_table_options'->'remove_duplicates'->'key_columns' )::json as partition_columns from nabu.advanced_options_object_details where data_movement_id =261 and
valid_to_ts ='9999-12-31' and object_id in (37234)
) jsonarray
),
valid_columns as(
select Exists(
SELECT array_element AS missing_elements
FROM (
  SELECT original_column_name AS array_element from duplicate_columns
) AS array_elements
WHERE array_element <> ALL (
SELECT column_name FROM nabu.dataplace_column_metadata_physical dcmp where table_id in (37234) and valid_to_ts = '9999-12-31'
)
)
)

select * from valid_columns, duplicate_columns
""2023-11-15 16:41:04.508 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with sort_columns as(
SELECT
(sort_columns ->>'column_name') as sort_column_name,
concat((sort_columns ->>'column_name'),'_tmp_rm') as sort_column_order_by_name,
(sort_columns ->> 'sort_by') as sort_order,
case when((sort_columns ->> 'sort_null_values')= '')
then (sort_columns ->>'')
else
(sort_columns->> 'sort_null_values')
end as sort_null_value,
(sort_columns ->>'column_name') as original_column_name
from
(
select
json_array_elements (advance_option_details ->'advanced_table_options'->'remove_duplicates'->'sort_columns' ) as sort_columns from nabu.advanced_options_object_details where data_movement_id =261 and
valid_to_ts ='9999-12-31' and object_id in (37234)
) sort
),
valid_columns as(
select Exists(
SELECT array_element AS missing_elements
FROM (
  SELECT original_column_name AS array_element from sort_columns
) AS array_elements
WHERE array_element <> ALL (
SELECT column_name FROM nabu.dataplace_column_metadata_physical dcmp where table_id in (37234) and valid_to_ts = '9999-12-31'
)
)
)

select * from valid_columns, sort_columns
""2023-11-15 16:41:04.702 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : Select *, (advance_option_details->'advanced_table_options'->>'dataplace_id')::int as dataplace_id from nabu.advanced_options_object_details where object_id =37234 and data_movement_id=261 and valid_to_ts='9999-12-31'
""2023-11-15 16:41:04.895 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select advance_option_details ->> 'advanced_option_flags'  as advanced_options_flags
from nabu.advanced_options_object_details
where data_movement_id= 261
and valid_to_ts ='9999-12-31'
and object_id in (37234)
""2023-11-15 16:41:05.129 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select * from json_to_record(
'{
"table_name": "aaaa",
"table_id": 37234,
"dataplace_id": 42,
"schema_id": 453,
"incremental_load": false,
"columns_options":  
																					 false 
,
"modified_columns": false,
"excluded_column_ids": false,
"virtual_column": false,
"reorder_columns": false,
"remove_duplicates": false,
"sort_by_columns": false,
"table_partitions": false,
"new_table_name": false,
"parallel_ingestion": false,
"parallel_hash_ingestion": false,
"CDC": false,
"ingest_using_query": false,
"ingestion_mode": true,
"enable_cache": false
}'
) as x(
incremental_load boolean ,
columns_options boolean ,
modified_columns boolean ,
excluded_column_ids boolean ,
virtual_column boolean ,
reorder_columns boolean ,
remove_duplicates boolean ,
sort_by_columns boolean ,
table_partitions boolean ,
new_table_name boolean ,
parallel_ingestion boolean ,
CDC boolean ,
ingest_using_query boolean ,
ingestion_mode boolean ,
enable_cache boolean 
)

""2023-11-15 16:41:05.370 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with sort_columns as(
select
columns_list ->>'order_by' as order_by,
case when((columns_list ->> 'sort_null_values')= '')
        then (columns_list ->>'')
    else concat('_',replace((columns_list->> 'sort_null_values'),' ','_'))
end as sort_null_value,
case when(columns_list ->>'renamed_column' ='')
        then columns_list ->>'column_name'
	else columns_list ->>'renamed_column'
end as final_column_name,
columns_list ->>'column_name' as original_column_name
from (
select
json_array_elements(((advance_option_details ->>'advanced_table_options')::json->>'sort_by_columns')::json) as columns_list
from nabu.advanced_options_object_details
where data_movement_id= 261 and valid_to_ts ='9999-12-31' and object_id in (37234)
)as advance_option_flags
),
valid_columns as(
select Exists(
SELECT array_element AS missing_elements
FROM (
  SELECT original_column_name AS array_element from sort_columns
) AS array_elements
WHERE array_element <> ALL (
SELECT column_name FROM nabu.dataplace_column_metadata_physical dcmp where table_id in (37234) and valid_to_ts = '9999-12-31'
)
)
)
select * from sort_columns,valid_columns
""2023-11-15 16:41:05.558 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select 1

""2023-11-15 16:41:05.735 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select 1

""2023-11-15 16:41:05.918 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select 1

""2023-11-15 16:41:06.266 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select 1

""2023-11-15 16:41:06.454 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select 1

""2023-11-15 16:41:06.631 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select
	case
		when a.object_id_count>0 then true
		else false
	end as table_renamed_exists
from
	(
            select
                count(*) as object_id_count
            from
                nabu.advanced_options_obj_checkpoint
            where
                advanced_option_obj_type_id = (
                select
                    advanced_options_obj_type_id
                from
                    nabu.advanced_options_obj_lookup
                where
                    advanced_options_obj_type = 'Renaming Table'
                )
                and
          object_id in (37234)
                and
          data_movement_id = 261
                and valid_to_ts = '9999-12-31'
   ) a
""2023-11-15 16:41:06.831 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with flow_tables as (
select table_id,schema_id,table_name,schema_name,dataplace_id,estimated_rows
from nabu.dataplace_table_metadata_physical
where table_id in (37234)
and valid_to_ts = '9999-12-31'
),
data_movement_schema_drift_table_ids as(
select * from(select data_movement_id, dataplace_id, schema_directory_id, object_id, cru_ts, row_number() over(partition by object_id order by cru_ts desc) as rownum
from nabu.data_movement_schema_drift_details
where data_movement_id = 261
and object_id in (37234))a
where rownum = 1
),
rename_table_advance_option as(
select a.data_movement_id ,a.object_id , '' as new_table_for_rename,
((a.advance_option_details->>'advanced_option_flags')::json->>'new_table_name')::boolean as rename_flag,
case when '' is null  then false
when '' = '' then false
else ((a.advance_option_details->>'advanced_option_flags')::json->>'new_table_name')::boolean end as rename_table_condition,
case when b.object_id is null then false else true end as already_ingested,
(select case when object_id_count = 0 then true else false end as already_renamed_flag from (
SELECT  count(*) as object_id_count
FROM nabu.advanced_options_obj_checkpoint
where
advanced_option_obj_type_id = (SELECT advanced_options_obj_type_id
FROM nabu.advanced_options_obj_lookup
WHERE advanced_options_obj_type = 'Renaming Table'
) and
object_id in (37234) and
data_movement_id = 261)a)
from nabu.advanced_options_object_details a
left join nabu.structured_jobtotable b
on a.data_movement_id =b.data_movement_id
and a.object_id =b.object_id
where
a.data_movement_id = 261
and a.object_id in (37234)
and a.valid_to_ts = '9999-12-31'
),
get_non_schema_drifted_table_ids as(
select a.dataplace_id,a.schema_id, a.dataplace_component_type_id,a.table_id
from nabu.dataplace_table_schema_drift_details a
inner join
data_movement_schema_drift_table_ids b
on a.table_id = b.object_id
and a.schema_id = b.schema_directory_id
and a.dataplace_id = b.dataplace_id
where a.valid_to_ts = '9999-12-31'
and a.crt_ts < b.cru_ts
and b.data_movement_id = 261
and table_id in (37234)
union
select a.dataplace_id,a.schema_id, a.dataplace_component_type_id,a.table_id
from nabu.dataplace_table_schema_drift_details a
inner join
nabu.structured_jobtotable b
on a.table_id = b.object_id
and a.dataplace_id = b.dataplace_id
where b.data_movement_id = 261
and a.valid_to_ts = '9999-12-31'
and table_id in (37234)
and b.cru_ts > a.crt_ts
and b.object_type = 'S'
union
select a.dataplace_id,a.schema_id, a.dataplace_component_type_id,a.table_id
from nabu.dataplace_table_schema_drift_details a
where table_id in (37234)
and a.valid_to_ts = '9999-12-31'
and table_id not in (select object_id as table_id from nabu.structured_jobtotable b
where b.data_movement_id = 261 and b.object_type = 'S'
)
),
dataplace_schema_drifted_tables as(
select * from nabu.dataplace_table_schema_drift_details dtsdd where dataplace_id in
(select source_dataplace_id from nabu.data_movement_details_physical dmdp
where data_movement_id = 261
and valid_to_ts = '9999-12-31')
and dtsdd.valid_to_ts = '9999-12-31'
),
flag_for_schema_drifted_tables as(
select a.table_id, a.schema_id,a.table_name,a.schema_id,a.dataplace_id,case when b.table_id is null and 1 != 6
and c.table_id is not null then true
else false
end as schema_drift_flag
from flow_tables a
left join
get_non_schema_drifted_table_ids b
on a.table_id = b.table_id
left join
dataplace_schema_drifted_tables c
on a.table_id = c.table_id
),
source_dataplace_details as (
select a.dataplace_id as source_dataplace_id,
case when 'file' = 'relational' then true else false end as is_create_table,
case when  (b.dataplace_sub_component_type='mysql') then true else false end as is_mysql,
case when  (b.dataplace_sub_component_type='bigquery') then true else false end as is_bigquery,
case when (b.dataplace_sub_component_type in ('db2_z_os','oracle')) then true else false end as is_needed_partition_name_without_column_name,
case when  (b.dataplace_sub_component_type='hive' or b.dataplace_sub_component_type='cloudera_hive') then ((dataplace_info->>'jdbc_info')::json)->>'jdbc_url'
else dataplace_info->>'host_name' end as source_url,
case when (b.dataplace_sub_component_type='hive' or b.dataplace_sub_component_type='cloudera_hive')  then trim(((dataplace_info->>'jdbc_info')::json)->>'database_name')
else trim(dataplace_info->>'database_name') end as source_db,
case when  (b.dataplace_sub_component_type='snowflake') then trim(dataplace_info->>'warehouse_name') end as warehouse_name,
case when  (lower(b.dataplace_sub_component_type)='sas') then dataplace_info->>'location_path' end as source_directory,
case when b.dataplace_sub_component_type = 'oracle' then dataplace_info->>'jdbc_url' end as oracle_jdbc_url,
case when b.dataplace_sub_component_type = 'hive' or b.dataplace_sub_component_type = 'cloudera_hive' then
(dataplace_info->>'jdbc_info')::json->>'database_name'
else dataplace_info->>'database_name' end as database_name,
case when ((b.dataplace_sub_component_type='hive' or b.dataplace_sub_component_type='cloudera_hive')) then true else false end as is_source_hive,
case when ((b.dataplace_sub_component_type='hive' or b.dataplace_sub_component_type='cloudera_hive') and dataplace_info->>'connection_mode' = 'Cluster mode') then true else false end as is_source_spark_hive,
lower(case when b.dataplace_sub_component_type  = 'cloudera_hive' then 'hive' else b.dataplace_sub_component_type end) as source_type,
case when dataplace_info->>'jdbc_url' like 'jdbc:sqlserver:%' then 'com.microsoft.sqlserver.jdbc.SQLServerDriver'
else b.additional_info ->>'jdbc_driver' end as source_jdbc_driver,
--b.additional_info->>'jdbc_driver' as source_jdbc_driver,
a.credential_id ,dataplace_info,
dataplace_info->>'project_id'  as project,
dataplace_info->>'bucket_name'  as bucket_name,
additional_info->>'default_credential' as source_default_credential_exists,
(dataplace_info->>'is_jdbc_url')::boolean as is_source_jdbc_url,
(dataplace_info->>'jdbc_url') as source_jdbc_url,
(dataplace_info->>'filesystem_info')::JSON->>'endpoint' as source_endpoint
from nabu.dataplace_physical a, nabu.dataplace_sub_component_lookup b
where a.dataplace_sub_component_id = b.dataplace_sub_component_id
and a.valid_to_ts = '9999-12-31'
and a.dataplace_id in (select dataplace_id from flow_tables)
),
source_credential_details as (
select a.*,b.credential_id as source_credential_id,b.credential_type_id as source_credential_type_id
from source_dataplace_details a left outer join nabu.credential_info b
on a.credential_id = b.credential_id
and b.valid_to_ts = '9999-12-31'
),
data_movement_details as (
select ingestion_table_format,valid_db_name,valid_schema_name,destination_dataplace_id ,destination_schema_directory_id ,intermediate_type,archive_files_path,is_archive_data,is_lazy_mode,is_record_process_enabled,file_format,pipeline_flow_timeout,
destination_file_format,source_dataplace_id, data_movement_id,verification_threshold, schema_drift_option, table_suffix, is_empty_suffix, table_timestamp from (
select destination_dataplace_id ,destination_schema_directory_id , source_dataplace_id, a.data_movement_id,
'' as ingestion_table_format,
((data_movement_additional_info->>'ingestion_table_format')::json->>'database_name')::boolean as valid_db_name,
((data_movement_additional_info->>'ingestion_table_format')::json->>'schema_name')::boolean as valid_schema_name,
(((data_movement_additional_info->>'flow_details')::json->>'archive_data')::json->>'archive_files_path') as archive_files_path,
(((data_movement_additional_info->>'flow_details')::json->>'archive_data')::json->>'file_format') as file_format,
(((data_movement_additional_info->>'flow_details')::json->>'archive_data')::json->>'enabled')::boolean as is_archive_data,
(((data_movement_additional_info->>'flow_details')::json->>'enable_cache'))::boolean as is_lazy_mode,
(((data_movement_additional_info->>'flow_details')::json->>'enable_count'))::boolean as is_record_process_enabled,
case
when d.metadata_category = 'file' or d.dataplace_sub_component_id =11 then 'parquet'
when lower(((dataplace_info->>'filesystem_info')::json)->>'file_system_type') is null and d.dataplace_sub_component_id not in (11) and  d.metadata_category in('relational','collection') then 'default'
when lower(((dataplace_info->>'filesystem_info')::json)->>'file_system_type') !='' and  d.metadata_category in('relational','collection') then 'parquet'
else
'parquet' end as destination_file_format,
case
when
coalesce(((data_movement_additional_info->'flow_details'->>'verification_details')::json->>'skip_verification'),'false')::boolean = 'false' then COALESCE(((data_movement_additional_info->'flow_details'->>'verification_details')::json->>'verification_threshold')::float/100,0.1)
else 1
end as verification_threshold,
case
when d.metadata_category = 'file' or d.dataplace_sub_component_id =11 then 'parquet'
when lower(((dataplace_info->>'filesystem_info')::json)->>'file_system_type') is null and d.dataplace_sub_component_id not in (11) and  d.metadata_category in('relational','collection') then 'default'
when lower(((dataplace_info->>'filesystem_info')::json)->>'file_system_type') !='' and  d.metadata_category in('relational','collection') then 'parquet'
else
'parquet' end as intermediate_type,
case when ((((data_movement_additional_info->>'flow_details')::json->>'schema_drift')::json)->>'advanced_options_sub_type') is null then 'drop_create_table'
else ((((data_movement_additional_info->>'flow_details')::json->>'schema_drift')::json)->>'advanced_options_sub_type') end as schema_drift_option,
('') as table_suffix,
coalesce((data_movement_additional_info->'flow_details'->>'flow_timeout')::int,(data_movement_additional_info->'flow_details'->>'pipeline_flow_timeout')::int,'72')  as pipeline_flow_timeout,
coalesce(TRIM(''), '') = '' as is_empty_suffix,
((((((data_movement_additional_info->>'flow_details')::json->>'schema_drift')::json)->>'config')::json)->>'timestamp')::text as table_timestamp
from nabu.data_movement_physical a
inner join  (select distinct  destination_dataplace_id ,destination_schema_directory_id , source_dataplace_id, data_movement_id  from nabu.data_movement_details_physical
where valid_to_ts = '9999-12-31' and data_movement_id = 261 )b on a.data_movement_id = b.data_movement_id
inner join nabu.dataplace_physical c on c.dataplace_id = b.destination_dataplace_id
inner join nabu.dataplace_component_mapping_lookup  d on d.dataplace_sub_component_id  = c.dataplace_sub_component_id
where d.dataplace_component_type_id =c.dataplace_component_type_id  and c.valid_to_ts = '9999-12-31'
)a
)
--select * from data_movement_details
,
source_details as (
select b.* ,new_table_for_rename,case when (coalesce(rename_table_condition,false) and (not already_renamed_flag))=true then true else false end as rename_table_condition,coalesce(already_ingested,false) as already_ingested
,c.rename_flag from
(select a.*,c.*
from flow_tables a
inner join data_movement_details c
on a.dataplace_id = c.source_dataplace_id
)b left join rename_table_advance_option c on
b.data_movement_id = c.data_movement_id
)
--select * from source_details
,
source_level_details as (
select *,
case when a.rename_flag = true then regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(new_table_for_rename,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '')
else regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace((coalesce(ingestion_table_format,'') || coalesce(db_name,'') || coalesce(source_schema_name,'') || table_name),'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') end as destination_table_name,
regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace((coalesce(ingestion_table_format,'') || coalesce(db_name,'') || coalesce(source_schema_name,'') || table_name),'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') as actual_destination_table_name,
regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace((coalesce(ingestion_table_format,'') || coalesce(db_name,'') || coalesce(source_schema_name,'') || table_name),'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') as source_table_name
--coalesce(ingestion_table_format,'') || coalesce(db_name,'') || coalesce(source_schema_name,'') || table_name as destination_table_name
from (
select b.*,a.*,
case when valid_db_name is true then database_name || '_' else '' end as db_name,
case when valid_schema_name is true then schema_name || '_' else '' end as source_schema_name
from source_credential_details a
inner join source_details b on a.source_dataplace_id = b.dataplace_id
)a
),
file_system_credentials as (
select c.credential_id,d.dataplace_id ,c.credential_name,c.credential_type_id, credential_type,extract(epoch from c.mod_ts) as credential_epoch from nabu.dataplace_physical d left outer join nabu.credential_info c
on (((dataplace_info->>'filesystem_info')::json)->>'credential_id')::integer = c.credential_id left join nabu.credential_type_lookup ct on c.credential_type_id = ct.credential_type_id
where d.dataplace_id in (select destination_dataplace_id from data_movement_details)
),
dest_dataplace_details as (
-- For the destination dataplace, get it's details
select a.dataplace_id as destination_dataplace_id,
case when  (b.dataplace_sub_component_type='hive' or b.dataplace_sub_component_type='cloudera_hive') then ((dataplace_info->>'jdbc_info')::json)->>'jdbc_url'
else dataplace_info->>'host_name' end as destination_url,
case when b.dataplace_sub_component_type = 'oracle' then dataplace_info->>'jdbc_url' end as destination_oracle_jdbc_url,
case
when ((b.dataplace_sub_component_type='hive' or b.dataplace_sub_component_type='cloudera_hive')
and dataplace_info->>'connection_mode' = 'Cluster mode') then ((dataplace_info->>'filesystem_info')::json)->>'ingestion_root_path'
when (b.dataplace_sub_component_type= 'azure_synapse') then ((dataplace_info->>'filesystem_info')::json)->>'ingestion_root_path'
when (b.dataplace_sub_component_type = 'bigquery') then dataplace_info->>'ingestion_root_path'
when (b.dataplace_sub_component_type = 'gcs') then dataplace_info->>'ingestion_root_path'
when (b.dataplace_sub_component_type = 'redshift') then ((dataplace_info->>'filesystem_info')::json)->>'ingestion_root_path'
when (b.dataplace_sub_component_type = 'snowflake') then ((dataplace_info->>'filesystem_info')::json)->>'ingestion_root_path'
when ((b.dataplace_sub_component_type = 'adls_gen2')) then ((dataplace_info->>'ingestion_root_path'))
when ((b.dataplace_sub_component_type = 's3')) then ((dataplace_info->>'ingestion_root_path'))
else null
end as path,
case when (b.dataplace_sub_component_type='hive' or b.dataplace_sub_component_type='cloudera_hive') then true else false end as is_destination_hive,
case when (b.dataplace_sub_component_type in ('s3','hdfs','adls_gen2')) then false else true end as apply_transformation,
case when (b.dataplace_sub_component_type in ('mysql','postgres','sql_server','oracle')) then true else false end as is_jdbcmode,
case
when ((b.dataplace_sub_component_type='hive' or b.dataplace_sub_component_type='cloudera_hive')
and dataplace_info->>'connection_mode' = 'Cluster mode') then ((dataplace_info->>'filesystem_info')::json)->>'endpoint'
else null
end as filesystem_endpoint,
case
when (b.dataplace_sub_component_type ='hive' or b.dataplace_sub_component_type='cloudera_hive')
and dataplace_info->>'connection_mode' = 'Cluster mode' then lower(((dataplace_info->>'filesystem_info')::json)->>'file_system_type')
when (b.dataplace_sub_component_type  = 'azure_synapse') then ((dataplace_info->>'filesystem_info')::json)->>'file_system_type'
when (b.dataplace_sub_component_type = 'bigquery') then 'gcs'
when (b.dataplace_sub_component_type  = 'redshift' and dmd.intermediate_type = 'parquet') then ((dataplace_info->>'filesystem_info')::json)->>'file_system_type'
when (b.dataplace_sub_component_type in('adls_gen2','s3','gcs','adls_gen1')) then b.additional_info->>'file_system_type'
when (b.dataplace_sub_component_type  = 'snowflake') then ((dataplace_info->>'filesystem_info')::json)->>'file_system_type'
else null
end as  file_system_type,
case
when (b.dataplace_sub_component_type ='hive' or b.dataplace_sub_component_type='cloudera_hive') and dataplace_info->>'connection_mode' = 'Cluster mode' and  lower(((dataplace_info->>'filesystem_info')::json)->>'file_system_type') = 's3a' then true else false end as is_apache_jdbc_driver,
case
when ((b.dataplace_sub_component_type = 'hive')) then ((dataplace_info->>'filesystem_info')::json)->>'credential_id'
when ((b.dataplace_sub_component_type  = 'azure_synapse')) then ((dataplace_info->>'filesystem_info')::json)->>'credential_id'
when ((b.dataplace_sub_component_type = 'bigquery')) then  cast(a.credential_id as text)
when ((b.dataplace_sub_component_type = 'redshift' and dmd.intermediate_type = 'parquet')) then ((dataplace_info->>'filesystem_info')::json)->>'credential_id'
when ((b.dataplace_sub_component_type = 'snowflake')) then ((dataplace_info->>'filesystem_info')::json)->>'credential_id'
else null end as filesystem_credential_id,
case
when ((b.dataplace_sub_component_type  = 'hive')) then cast(coalesce (fs.credential_type_id,'1') as text)
when ((b.dataplace_sub_component_type = 'azure_synapse')) then cast(fs.credential_type_id as text)
when ((b.dataplace_sub_component_type = 'bigquery')) then cast(ci.credential_type_id as text)
when ((b.dataplace_sub_component_type = 'redshift' and dmd.intermediate_type = 'parquet')) then cast(fs.credential_type_id as text)
when ((b.dataplace_sub_component_type = 'snowflake')) then cast(fs.credential_type_id as text)
else null end as filesystem_credential_type_id,
case
when ((b.dataplace_sub_component_type = 'azure_synapse')) then ((dataplace_info->>'filesystem_info')::json)->>'directory_name'
when ((b.dataplace_sub_component_type = 'snowflake')) then ((dataplace_info->>'filesystem_info')::json)->>'directory_name'
else null
end as adls_gen2_directory_name,
case
when ((b.dataplace_sub_component_type = 'redshift' and dmd.intermediate_type = 'parquet')) then ((dataplace_info->>'filesystem_info')::json)->>'bucket'
when ((b.dataplace_sub_component_type = 's3')) then dataplace_info->>'bucket'
when ((b.dataplace_sub_component_type = 'snowflake')) then ((dataplace_info->>'filesystem_info')::json)->>'bucket'
else null
end as s3_bucket,
case
when ((b.dataplace_sub_component_type = 'azure_synapse')) then ((dataplace_info->>'filesystem_info')::json)->>'container'
when ((b.dataplace_sub_component_type = 'adls_gen2')) then ((dataplace_info->>'container'))
when ((b.dataplace_sub_component_type = 'snowflake')) then ((dataplace_info->>'filesystem_info')::json)->>'container'
else null
end as adls_gen2_container,
case
when ((b.dataplace_sub_component_type = 'bigquery')) then dataplace_info->>'bucket_name'
when ((b.dataplace_sub_component_type = 'gcs')) then dataplace_info->>'bucket_name'
else null
end as gcs_bucket,
case
when ((b.dataplace_sub_component_type = 'azure_synapse')) then ((dataplace_info->>'filesystem_info')::json)->>'accountName'
when ((b.dataplace_sub_component_type = 'adls_gen2')) then ((dataplace_info->>'accountName'))
when ((b.dataplace_sub_component_type = 'adls_gen1')) then ((dataplace_info->>'data_lake_name'))
when ((b.dataplace_sub_component_type = 'snowflake')) then ((dataplace_info->>'filesystem_info')::json)->>'accountName'
else null
end as storage_account,
case when (b.dataplace_sub_component_type='hive' or b.dataplace_sub_component_type='cloudera_hive')  then ((dataplace_info->>'jdbc_info')::json)->>'database_name'
else dataplace_info->>'database_name' end as destination_db,
case when  (lower(b.dataplace_sub_component_type)='sas') then dataplace_info->>'location_path' end as destination_directory,
case when ((b.dataplace_sub_component_type='hive' or b.dataplace_sub_component_type='cloudera_hive') and dataplace_info->>'connection_mode' = 'Cluster mode') then true else false end as is_spark_hive,
lower(case when b.dataplace_sub_component_type  = 'cloudera_hive' then 'hive' else b.dataplace_sub_component_type end) as destination_type,
lower(case when ((b.dataplace_sub_component_type='hive' or b.dataplace_sub_component_type='cloudera_hive') and dataplace_info->>'connection_mode' = 'Cluster mode') then (select coalesce ((data_movement_additional_info->>'flow_details')::json->>'destination_file_format','parquet') from nabu.data_movement_physical dmp where data_movement_id=261) else b.dataplace_sub_component_type end) as target_type,
case when dataplace_info->>'jdbc_url' like 'jdbc:sqlserver:%' then 'com.microsoft.sqlserver.jdbc.SQLServerDriver'
else b.additional_info ->>'jdbc_driver' end as destination_jdbc_driver,
--b.additional_info->>'jdbc_driver' as destination_jdbc_driver,
b.dataplace_sub_component_id as destination_dataplace_sub_component_id,
a.credential_id as destination_credential_id,a.dataplace_component_type_id as destination_dataplace_component_type_id,
b.additional_info->>'default_credential' as dest_default_credential_exists,
(dataplace_info->>'filesystem_info')::JSON->>'endpoint' as destination_endpoint,
fs.credential_type as filesystem_credential_type,
fs.credential_epoch as filesystem_credential_epoch
from nabu.dataplace_physical a left join nabu.credential_info ci on a.credential_id = ci.credential_id  ,
 nabu.dataplace_sub_component_lookup b, file_system_credentials fs, data_movement_details dmd
where a.dataplace_sub_component_id = b.dataplace_sub_component_id
and a.valid_to_ts = '9999-12-31'
and a.dataplace_id in (select destination_dataplace_id from data_movement_details)
),
dest_credential_details as (
select a.*,b.credential_type_id as destination_credential_type_id,
case when (a.file_system_type = 's3a') then true else false end as is_file_system_type_s3a,
case when (a.filesystem_credential_type_id = '2' or a.filesystem_credential_id is null) then true else false end as is_filesystem_credential_type_aws,
case when (b.credential_type_id = 8 or b.credential_type_id =9) then 'kerberos'
when(b.credential_type_id = 17 or b.credential_type_id =18) then 'kerberos_file_content'
else 'auth_token' end as authentication_type,
b.credential_id ||'_'||extract(epoch from b.mod_ts::timestamp(0)) as credential_pattern,
ct.credential_type as destination_credential_type
from dest_dataplace_details a left outer join nabu.credential_info b
on a.destination_credential_id = b.credential_id
left join nabu.credential_type_lookup ct on b.credential_type_id = ct.credential_type_id
and b.valid_to_ts = '9999-12-31'
),
get_engine_type as (
select bcw.data_movement_engine_type as datamovement_engine_type,dmp.data_movement_id from nabu.data_movement_physical dmp
inner join nabu.bot_configuration_workflow bcw on dmp.workflow_id=bcw.workflow_id
where data_movement_id =261
),
intermediate_details as (
select intermediate_type,source_dataplace_id,archive_files_path,is_archive_data,is_lazy_mode,is_record_process_enabled,file_format,pipeline_flow_timeout from data_movement_details
)
select
true as is_destination_file,a.dataplace_id,a.schema_id,a.schema_name,a.table_id,
table_timestamp, table_suffix, h.schema_drift_flag,false as is_source_filetype,
case when schema_drift_option = 'new_table' and is_empty_suffix= false and table_timestamp <> '' and h.schema_drift_flag = true then concat(destination_table_name,'_',table_suffix,'_' ,to_char(current_timestamp ,table_timestamp))
when schema_drift_option = 'new_table' and is_empty_suffix= false and table_timestamp = '' and h.schema_drift_flag = true then concat(destination_table_name,'_',table_suffix)
when schema_drift_option = 'new_table' and is_empty_suffix= true and table_timestamp <> '' and h.schema_drift_flag = true then concat(destination_table_name,'_',to_char(current_timestamp ,table_timestamp))
else destination_table_name end as destination_table_name,
source_table_name as source_table_name,
case when schema_drift_option = 'bkp_table' and is_empty_suffix= false and table_timestamp <> '' and h.schema_drift_flag = true then concat(destination_table_name,'_',table_suffix,'_' ,to_char(current_timestamp ,table_timestamp))
when schema_drift_option = 'bkp_table' and is_empty_suffix= false and table_timestamp = '' and h.schema_drift_flag = true then concat(destination_table_name,'_',table_suffix)
when schema_drift_option = 'bkp_table' and is_empty_suffix= true and table_timestamp <> '' and h.schema_drift_flag = true then concat(destination_table_name,'_',to_char(current_timestamp ,table_timestamp))
else destination_table_name end as destination_backup_table_name,
project,a.table_name,source_url,source_credential_id,source_credential_type_id,source_jdbc_driver,source_type,
estimated_rows,a.schema_name as destination_schema_name,a.destination_schema_directory_id as destination_schema_id,
a.destination_dataplace_id,destination_dataplace_sub_component_id,rename_table_condition,already_ingested,
a.verification_threshold, destination_url,17000664381264241 as process_id,
17000664380239952 as batch_id,
'Ingestion_20231115' as batch_name,261 as data_movement_id,
'37234' as where_condition,trim(id.archive_files_path,'(\/)') as archive_files_path,id.is_archive_data,id.is_lazy_mode,id.is_record_process_enabled,id.file_format,
trim(path,'(\/)')as path,
case when trim(path,'(\/)')='' then false else true end as is_ingestion_root_path,
bucket_name,project,filesystem_endpoint,
case when (id.intermediate_type in ('default')) then true else false end as is_default,
file_system_type,destination_oracle_jdbc_url,oracle_jdbc_url,dest_default_credential_exists::boolean,source_default_credential_exists::boolean,
is_spark_hive, destination_db,destination_directory, destination_type,target_type, destination_file_format,destination_jdbc_driver,1 as flow_number,
source_directory, destination_credential_id,
trim('','(\/)') as relative_file_path,false as is_relative_file_path, destination_credential_type_id,destination_schema_directory_id,authentication_type,credential_pattern,is_apache_jdbc_driver,ingestion_table_format,source_db,warehouse_name,is_source_hive,is_source_spark_hive,
case when schema_drift_option = 'bkp_table' and h.schema_drift_flag = true
then true END as create_backup_table, schema_drift_option,destination_dataplace_component_type_id,
e.filesystem_credential_id,e.filesystem_credential_type_id,e.filesystem_credential_type,e.is_filesystem_credential_type_aws,e.is_file_system_type_s3a,
e.adls_gen2_directory_name,e.adls_gen2_container,e.storage_account,e.s3_bucket,e.gcs_bucket,is_mysql,is_bigquery,is_needed_partition_name_without_column_name,a.is_create_table,a.intermediate_type,g.datamovement_engine_type,is_jdbcmode,apply_transformation,is_destination_hive,
'eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDY2NDU3NzgzNDI0MCwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0OTI1OCwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2NjQ1N30.cgEzDcSlWhMY65PdNscgXY1oBYM75LZUbp00acf6_d1WRUOrXXGi5pcvwkRNDv0JIxun7nmcSCqy2CKZ38-eHnEqqAoxh2CIRwXTdBlsYYFyfkXHYapfaXinAi82pkDk0yJQOs-m-vAf1cbV4ue4Zk6bHKbJeu_j5_x8HU3PKeF0pz0lA-tpeoFRlq_tLUXqApH5t7QuTIzOSq7Aujo6yOSm_inHTBzTWxUyVaBCitbKs_j3Oq-P5c-Y5W3r9oAvDNbMASikxmdxfJBp_rI2QYHdxazW9UvVh_ZpRPwOIbi7EAe9-B6BBxAxItPBTo4M-GFi-zvZZXXYMX57edoRDA' as jwt_token, 'http://dev-dha.humana.com:8889/fireshots/credentialsFetchWebService' as end_point,
case when source_endpoint is null then 's3.amazonaws.com' else source_endpoint end as source_endpoint,
case when destination_endpoint is null then 's3.amazonaws.com' else destination_endpoint end as destination_endpoint,
case when (e.filesystem_credential_type = 'Azure Active Directory' or destination_credential_type ='Azure Active Directory') then true else false end as is_azure_oauth,
case when (e.filesystem_credential_type = 'AWS IAM role attached to EC2 instance' or destination_credential_type ='AWS IAM role attached to EC2 instance')
then true else false end as is_aws_iam_attached_to_EC2_instance,
e.filesystem_credential_epoch,
a.is_source_jdbc_url, a.source_jdbc_url,id.pipeline_flow_timeout,
f.directory_name as destination_schema_name,upper(destination_table_name) as upper_case_destination_table_name,id.source_dataplace_id,g.datamovement_engine_type,id.intermediate_type,is_create_table
from nabu.dataplace_file_system_component f,
source_level_details a,  dest_credential_details e,get_engine_type g,
flag_for_schema_drifted_tables h, intermediate_details id
where a.destination_dataplace_id = e.destination_dataplace_id
and a.data_movement_id = 261
and f.dataplace_id = e.destination_dataplace_id
and a.destination_schema_directory_id = f.directory_id
and f.valid_to_ts = '9999-12-31'
and a.table_id = h.table_id
and a.data_movement_id = g.data_movement_id
""2023-11-15 16:41:07.040 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with cdc_columns as(
select array(
select (cdc_columns_list ) AS column_array
from(
select json_array_elements(advance_option_details->'advanced_table_options'->'CDC'->'columns_ids') as cdc_columns_list
from nabu.advanced_options_object_details where data_movement_id =261 and
valid_to_ts ='9999-12-31' and object_id in (37234)
) jsonarray
) as cdc_column_array
),
valid_columns as(
select Exists(
SELECT array_element AS missing_elements
FROM (
  SELECT unnest(cdc_column_array)::text AS array_element from cdc_columns
) AS array_elements
WHERE array_element <> ALL (
SELECT column_id::text FROM nabu.dataplace_column_metadata_physical dcmp where table_id in (37234) and valid_to_ts = '9999-12-31'
)
)
)
select * from valid_columns, cdc_columns
""2023-11-15 16:41:07.270 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select case when 'drop_create_table'='new_table' and false=true then true else false end as drift_new_table
""2023-11-15 16:41:07.460 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select case when (advance_option_details->'advanced_table_options'->'CDC'->>'add_audit_columns')::boolean
then true else false end as cdctype2,
'17000664381264241'||'_aaaa' as temp_path,
(advance_option_details->'advanced_option_flags'->>'CDC')::boolean as cdc_applied,
case when json_array_length(advance_option_details->'advanced_table_options'->'CDC'->'columns_ids')>0 then true else false end as is_primary
from nabu.advanced_options_object_details aood where data_movement_id =261 and object_id =37234 and valid_to_ts ='9999-12-31'
""2023-11-15 16:41:07.649 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select case when lower(advance_option_details->'advanced_table_options'->'CDC'->>'hash_type') like '%sha%' then 'sha2' else lower(advance_option_details->'advanced_table_options'->'CDC'->>'hash_type') end as hash_type,
(advance_option_details->'advanced_table_options'->'CDC'->>'add_audit_columns')::boolean as add_audit_columns,
(advance_option_details->'advanced_table_options'->'CDC'->>'create_view')::boolean as create_view,
advance_option_details->'advanced_table_options'->'CDC'->>'view_name' as view_name,
case when lower(advance_option_details->'advanced_table_options'->'CDC'->>'hash_type') like '%sha%' then true else false end as is_sha2,
regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(advance_option_details->'advanced_table_options'->'CDC'->'audit_columns'->>'start_date_column_name','=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') as start_date_column_name,
regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(advance_option_details->'advanced_table_options'->'CDC'->'audit_columns'->>'end_date_column_name','=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') as end_date_column_name,
regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(advance_option_details->'advanced_table_options'->'CDC'->'audit_columns'->>'process_id_column_name','=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') as job_id_column_name,
regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(advance_option_details->'advanced_table_options'->'CDC'->'audit_columns'->>'prev_process_id_column_name','=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') as prev_job_id_column_name
from nabu.advanced_options_object_details aood where data_movement_id =261 and object_id =37234 and valid_to_ts ='9999-12-31'
""2023-11-15 16:41:07.840 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select case when process_id=17000664381264241 then prev_process_id else process_id end as prev_process_id from
(
    select *,ROW_NUMBER () OVER (order by cdc_start_ts desc) rank
    from nabu.cdc_xref cx where data_movement_id =261 and object_id =37234
and cdc_end_ts!='9999-12-31'
)a where rank=1
""2023-11-15 16:41:08.057 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select 17000664381264241 as process_id,cast((extract(epoch from now())*10000) as bigint) as prev_process_id
""2023-11-15 16:41:08.476 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : 
""2023-11-15 16:41:08.660 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : 
""2023-11-15 16:41:08.849 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select a.field_name ,b.destination_datatype_name, true::boolean as is_auditcol from(
select regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(advance_option_details->'advanced_table_options'->'CDC'->'audit_columns'->>'start_date_column_name','=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') as field_name, 'string' as intermediate_datatype_name
from nabu.advanced_options_object_details aood where data_movement_id =261 and object_id =37234 and valid_to_ts ='9999-12-31'
union all
select regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(advance_option_details->'advanced_table_options'->'CDC'->'audit_columns'->>'end_date_column_name','=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') as field_name,'string' as intermediate_datatype_name
from nabu.advanced_options_object_details aood where data_movement_id =261 and object_id =37234 and valid_to_ts ='9999-12-31'
union all
select regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(advance_option_details->'advanced_table_options'->'CDC'->'audit_columns'->>'process_id_column_name','=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') as field_name,'long' as intermediate_datatype_name
from nabu.advanced_options_object_details aood where data_movement_id =261 and object_id =37234 and valid_to_ts ='9999-12-31'
union all
select regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(advance_option_details->'advanced_table_options'->'CDC'->'audit_columns'->>'prev_process_id_column_name','=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') as field_name,'long' as intermediate_datatype_name
from nabu.advanced_options_object_details aood where data_movement_id =261 and object_id =37234 and valid_to_ts ='9999-12-31'
)a inner join (
select intermediate_datatype_name ,destination_datatype_name  from nabu.datatype_mapping dm where source_type ='virtual' and destination_type ='adls_gen2' and intermediate_type='parquet'
)b
on a.intermediate_datatype_name=b.intermediate_datatype_name
""2023-11-15 16:41:09.058 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select 1 as id

""2023-11-15 16:41:09.233 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with ingested_object_count as(
select
	count(object_id) as count
from
	nabu.structured_jobtotable
where
	data_movement_id = 261
	and dataplace_id =
 42 and object_id = 37234 )
select
	case
		when count>0 then true
		else false
	end as already_ingested
from
	ingested_object_count
""2023-11-15 16:41:09.525 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with cte1 as(
select schema_name,table_name,partition_name,column_name,column_id,partition_function_name ,
case when partition_position is null then 1 else partition_position end as partition_position,sub_partition_name,
case when sub_partition_name is not null then true
else false
end as is_sub_partition
from
(select
t.schema_name,t.table_name,t.partition_name,t4.column_name,t4.column_id,t.partition_function_name , t.partition_position ,t2.sub_partition_name
from (select pi2.schema_name ,pi2.partition_name , pti.partition_function_name  , pi2.partition_position,
pti.partition_type,pti.table_id,pti.table_name
from nabu.partition_table_info pti
left join nabu.partitions_info pi2 on pti.table_id = pi2.table_id
where pti.table_id in (37234) and pti.valid_to_ts = '9999-12-31' and pi2.valid_to_ts = '9999-12-31' ) t
left join
(select sub_partition_name,spi.partition_name from nabu.sub_partitions_info spi
where spi.table_id in (37234) and spi.valid_to_ts = '9999-12-31') t2 on t.partition_name = t2.partition_name
left join (select column_name,column_id,pci.table_id from nabu.partition_column_info pci
where pci.table_id in (37234) and pci.valid_to_ts = '9999-12-31') t4 on t.table_id  = t4.table_id
)t3
)
select a.*,
case when is_int is true then a.partition_name else concat(column_name,'=', E'\'', split_part(partition_name, '=',2),E'\'') end as column_value
from(
select cte1.*, case when data_type like '%decimal%' or data_type like '%int%' then true else false end as is_int
from cte1,
nabu.dataplace_column_metadata_physical a where a.column_id = cte1.column_id and cte1.partition_name = partition_name
and a.valid_to_ts ='9999-12-31'
)    a

""2023-11-15 16:41:09.721 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with datatype_mapping as (
  	  		select
          		lower(source_type) as source_type ,
          		lower(intermediate_type) as intermediate_type ,
      		    false as is_create_table,
          		lower(destination_type) as destination_type ,
          		lower(source_datatype_name) as source_datatype_name ,
          		intermediate_datatype_name ,source_cast_type,
          		intermediate_cast_type ,
          		source_stg_function ,
          		destination_datatype_name,
          		intermediate_stg_function ,
          		lower(datamovement_engine_type) as datamovement_engine_type
          	from(
             select *,row_number() over (partition by source_type ,source_datatype_name ) as rno
             from nabu.datatype_mapping dmt
          	 where lower(source_type) =lower('sql_server') and
          	 lower(intermediate_type) = lower('parquet') and
    		 lower(destination_type) = 'bucket'
          	 )a
          	 where rno=1
  ),
  obj_details as(
    select advance_option_details from nabu.advanced_options_object_details where data_movement_id= 261 and valid_to_ts ='9999-12-31' and object_id in (37234)
  ),
  exculde_columns as(
    select unnest(string_to_array(btrim((column_options->>'excluded_column_ids'),'[||]'),','))::int as excluded_column_ids from
    (      select (advance_option_details->'advanced_table_options'->'columns_options')::JSON as column_options from obj_details  )a
    ),
  ignore_datatypes as(
       select coalesce (lower(ignore_data_types),' ') as data_types from (
       select replace((json_array_elements(data_movement_additional_info->'flow_details'->'ignore_data_types'))::text,'"','') as ignore_data_types
       from nabu.data_movement_physical
       where data_movement_id = 261 and valid_to_ts='9999-12-31'
       union
      select source_datatype_name as ignore_data_types
      from nabu.user_defined_trans_for_unsupported_datatype
      where advanced_options_sub_type_id =16 and data_movement_id = 261 and valid_to_ts='9999-12-31'
       )a
  ),
  column_metadata as (
  select a.*,
  		case when cdc.column_id is not null then true else false end as is_cdc_col,
          b.advanced_options_sub_type_id,
          b.additional_info
   from
    (
  	select
  		cmp.column_name,data_length,cmp.ordinal_position,
  		case when data_scale=0 then true else false end as data_scale_org,
  		case when data_scale is null then 0
  		    else data_scale
  		end as data_scale,data_precision,
  		lower(data_type) as metadata_datatype,
  		cmp.is_nullable,cmp.column_id,cmp.table_id,cmp.table_name,cmp.schema_name,
  		case
                when ('oracle' = lower('sql_server')) and data_type ~* 'time zone' and length(regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '')||'_utc') > 30
                then 'c_'||column_id
                when ('oracle' = lower('sql_server')) and length(regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '')) > 30
                then 'c_'||column_id
                when ('oracle' = lower('adls_gen2')) and length (column_name) > 30
                then 'c_'||column_id
          		else regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') end as field_name,
        regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') as field_name_replaced,
        case when ('oracle' = lower('sql_server')) and length(regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '')) > 30 and lower('adls_gen2') !='oracle'
            then true else false end as is_long_col_name,
  		case
  			when data_type ~* 'INTERVAL' then regexp_replace(lower(data_type),'[^A-Za-z ]', '', 'g')
  			when data_type like 'array%' and dp.dataplace_sub_component_id =7  then regexp_replace(lower(data_type), '^(\w+)\W.*','\1','g')
            when data_type like 'struct%' and dp.dataplace_sub_component_id =7 then regexp_replace(lower(data_type), '^(\w+)\W.*','\1','g')
            when data_type like 'map%' and dp.dataplace_sub_component_id =7 then regexp_replace(lower(data_type), '^(\w+)\W.*','\1','g')
            when data_type ~* 'varchar*' and dp.dataplace_sub_component_id =7 then 'varchar'
            when data_type ~* 'decimal*' and dp.dataplace_sub_component_id = 7 then 'decimal'
  			else lower(data_type)
  		end as data_type
  	from nabu.dataplace_column_metadata_physical cmp left outer join nabu.dataplace_physical dp on cmp.dataplace_id = dp.dataplace_id where cmp.table_id = 37234  and cmp.valid_to_ts='9999-12-31'
  and 
     data_type is not null
    and cmp.column_id not in (select excluded_column_ids from exculde_columns)
    ) a
    left outer join
         (
         select data_movement_id,
                 lower(source_datatype_name) AS source_datatype,
                 advanced_options_sub_type_id,
                 additional_info
          from nabu.user_defined_trans_for_unsupported_datatype
          where data_movement_id = 261
            and valid_to_ts='9999-12-31'
        ) b on a.data_type = b.source_datatype
        left outer join(
        select json_array_elements_text(advance_option_details->'advanced_table_options'->'CDC'->'columns_ids')::int as column_id
		from nabu.advanced_options_object_details aood where data_movement_id =261 and object_id =37234 and valid_to_ts ='9999-12-31'
        )cdc
        on a.column_id=cdc.column_id
   ),
   source_level_casting as(
      select (modified_columns ->>'column_id')::int as column_id,
      trim(convert_from(decode(modified_columns ->'column_info'->>'source_casting_exp','base64'), 'UTF8')) as sql_expr,
      lower(modified_columns ->'column_info'->>'destination_column_type') as destination_column_type,
      (modified_columns ->'column_info'->>'destination_column_name') as destination_column_name
      from(
        select json_array_elements(('[
]')) :: json as modified_columns from obj_details
      )modified_details
         ),
  initial_column_mapping as (
  select
  	a.column_name,a.data_type,a.data_length,a.ordinal_position,a.is_nullable,table_name,schema_name , a.metadata_datatype, a.column_id,a.table_id,
  	source_type,intermediate_type,datamovement_engine_type ,b.source_datatype_name,source_cast_type,b.intermediate_datatype_name,
  	case
  	           when(a.advanced_options_sub_type_id = 17) then 'UserText'
  	           when(a.advanced_options_sub_type_id = 31) then 'SQLServerStringConvert'
  	           when(a.advanced_options_sub_type_id = 14) then 'AsIs'
  	           when(a.advanced_options_sub_type_id = 15) then 'ReplaceWithNull'
  	else b.source_stg_function
  	end as source_stg_function,
  	case when (a.advanced_options_sub_type_id = 17) then a.additional_info ->> 'target_value' else null end as user_text,
  	a.data_scale,a.data_precision,data_scale_org,
  	    'adls_gen2' as destination_type,
  		b.intermediate_datatype_name as destination_datatype_name,
    	case when(a.advanced_options_sub_type_id in (14,15,17,31)) then 'AnyToString'
    	when b.intermediate_stg_function = 'AsIs' then 'parquet_AsIs' else b.intermediate_stg_function end as intermediate_stg_function,
    	case
    	    when (b.source_datatype_name in ('bit','datetimeoffset','time','datetime2','smalldatetime','datetime')) then concat(b.source_datatype_name,'_to_varchar')
    	    else null
    	 end as inconsistent_datatype,
  	a.field_name,a.field_name_replaced, a.is_long_col_name,
  	case when ( 'oracle' = lower('sql_server')) and length(a.field_name)>30
              then 'c_'||a.column_id
              else a.field_name
            end as intermediate_field_name, a.is_cdc_col
  from column_metadata as a left join datatype_mapping as b
  on a.data_type = b.source_datatype_name
  where a.ordinal_position is not null
 -- and b.datamovement_engine_type = lower('Spark')
  ),
  partition_columns as(
  select
  case when(columns_list->>'renamed_column' = '')
          then columns_list->>'column_name'
          else columns_list->>'renamed_column'
  end as final_column_name,
  (columns_list->>'column_id')::int as column_id
  from(
  select json_array_elements(((advance_option_details->>'advanced_table_options')::json->>'table_partitions')::json) as columns_list from nabu.advanced_options_object_details aood
  where data_movement_id= 261 and valid_to_ts ='9999-12-31' and object_id in (37234)
  )table_partitions_data
  )
  select false::boolean as is_virtual,a.column_id,
    case when slc.column_id is not null then true else false end as is_source_casting_enabled ,
    case when pc.column_id is not null then true else false end as is_partitioned_col, a.column_name,
    replace(a.column_name,'''','''''')as replaced_column_name,a.data_type,a.data_length,a.ordinal_position,a.is_nullable,table_name,schema_name ,false as is_mysql,
    false as is_bigquery,false as is_source_hive,
	a.source_type,a.source_datatype_name,source_cast_type,a.intermediate_datatype_name,a.table_id,
    case when slc.column_id is not null then
    (
    case
            when slc.sql_expr like '%)____%' then slc.sql_expr
            else concat (slc.sql_expr,' as ',slc.destination_column_name)
        end
    )
    --when (c.intermediate_stg_function = 'parquet_inconsistentInteger_convert' ) then 'AnyToStringConvert'
    else coalesce(c.source_stg_function,a.source_stg_function)
    end as source_stg_function,
	a.data_scale,
	case when slc.column_id is not null then
		(
		case when a.data_precision <= 38 then a.data_precision
			else 38
		end
		)
		else a.data_precision
	end as data_precision,
	case when (a.data_precision = 0 or a.data_precision is null) then true else false end as is_precision,
    case when a.data_scale <= 37 then true else false end as is_precision_scale,
    case when a.destination_type='redshift_relational' then true else false end as is_redshift_relational_destination,
    case when a.destination_type = 'oracle' then true else false end as is_oracle_destination,
    case when a.destination_datatype_name ~*'varchar|boolean' then true else false end as is_varchar,
	case  when slc.column_id is not null then
            (
            case
	        when slc.destination_column_type in('decimal','numeric') then
	        (
	        case when a.data_precision <=38 then concat(slc.destination_column_type,'(',a.data_precision,',',a.data_scale,')')
	        	else concat(slc.destination_column_type,'(38,',a.data_scale,')')
	        end
	        )
            when slc.destination_column_type in ('varchar','char') then
            (
            case
	            when data_length is null then concat( slc.destination_column_type,'(255)')
            	else concat( slc.destination_column_type,'(',a.data_length ,')')
            end
            )
            else (slc.destination_column_type)
            end
            )
            when c.destination_datatype_name ='STRING/DECIMAL'  then
            (
            case
            	 when a.data_precision =0 then concat('DECIMAL','(',38,',',a.data_scale,')')
            	 when a.data_precision <=38 and a.data_scale <=37 then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
                 else 'STRING'
            end
            )
            when c.destination_datatype_name ='STRING/DECIMAL/INTEGER'  then
            (
            CASE
         when (a.data_scale = 0 and (a.data_precision between 0 and 2)) then 'TINYINT'
         when (a.data_scale = 0 and (a.data_precision between 3 and 4)) then 'SMALLINT'
         when (a.data_scale = 0 and (a.data_precision between 5 and 9)) then 'INT'
         when (a.data_scale = 0 and (a.data_precision between 10 and 17)) then 'BIGINT'
         when (a.data_scale = 0 and (a.data_precision between 18 and 38)) then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
         when (a.data_scale <= 37 and (a.data_precision <= 38)) then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
         else 'STRING'
     end
	)
            when c.destination_datatype_name ='DoublePrecision/DECIMAL/INTEGER'  then
            (
                        case when (data_scale_org and data_precision is null) then 'integer'
                     when (a.data_scale = 0 and (a.data_precision between 0 and 2)) then 'TINYINT'
                     when (a.data_scale = 0 and (a.data_precision between 3 and 4)) then 'SMALLINT'
                     when (a.data_scale = 0 and (a.data_precision between 5 and 9)) then 'INT'
                     when (a.data_scale = 0 and (a.data_precision between 10 and 17)) then 'BIGINT'
                     when (a.data_scale = 0 and (a.data_precision between 18 and 38)) then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
                     when (a.data_scale <= 37 and (a.data_precision <= 38)) then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
                     else 'double precision'
                     end
            )
                when ('sql_server' = 'oracle') then
                (
                    case
                        when data_type ~* 'time zone' and c.option_number = 0 and 'azure_synapse' in('bigquery','redshift','azure_synapse','snowflake') then 'VARCHAR(50)'
                        when data_type ~* 'time zone' and c.option_number = 0 and 'azure_synapse' in('hive') then 'STRING'
                        else coalesce(c.destination_datatype_name,a.destination_datatype_name)
                    end
                )
                when ('sql_server' = 'postgres') then
                (
                    case
                        when data_type ~* 'timestamp with time zone' and c.option_number = 0 and 'azure_synapse' in('bigquery','redshift','azure_synapse','snowflake') then 'VARCHAR(50)'
                        when data_type ~* 'timestamp with time zone' and c.option_number = 0 and 'azure_synapse' in('hive') then 'STRING'
                        else coalesce(c.destination_datatype_name,a.destination_datatype_name)
                    end
                )
                when ('sql_server' = 'sql_server') then
                (
                    case
                        when data_type ~* 'datetimeoffset' and c.option_number = 0 and 'azure_synapse' in('bigquery','redshift','azure_synapse','snowflake') then 'VARCHAR(50)'
                        when data_type ~* 'datetimeoffset' and c.option_number = 0 and 'azure_synapse' in('hive') then 'STRING'
                        else coalesce(c.destination_datatype_name,a.destination_datatype_name)
                    end
                )
            else coalesce(c.destination_datatype_name,a.destination_datatype_name)
            end as destination_datatype_name,
    case when slc.column_id is not null then
            (
    		case when slc.destination_column_type in('double','double precision') then 'ParquetStringToDoubleConvert'
    			when slc.destination_column_type in('decimal','money','numeric','smallmoney','number') then 'ParquetStringToDecimalConvert'
    			when slc.destination_column_type in('int','integer','int64') then 'ParquetStringToIntConvert'
    			when slc.destination_column_type in('timestamp','datetime2') then 'ParquetStringToTimestampConvert'
    			when slc.destination_column_type = 'bigint' then 'ParquetStringToBigIntConvert'
    			when slc.destination_column_type = 'tinyint' then 'ParquetStringToTinyIntConvert'
    			when slc.destination_column_type = 'smallint' then 'ParquetStringToSmallIntConvert'
    			when slc.destination_column_type in('float','float64','real') then 'ParquetStringToFloatConvert'
    			when slc.destination_column_type in('char','nchar') then 'ParquetStringToCharConvert'
    			when slc.destination_column_type in('varchar','nvarchar') then 'ParquetStringToVarcharConvert'
    			when slc.destination_column_type in('binary','varbinary','bytes') then 'ParquetStringToBinaryConvert'
    			when slc.destination_column_type = 'date' then 'ParquetStringToDateConvert'
    			when slc.destination_column_type in('string','text') then 'AnyToString'
    			when slc.destination_column_type in('boolean','bool') then 'AnyToBoolean'
    			when slc.destination_column_type = 'array' then 'AnyToArray'
    			when slc.destination_column_type = 'map' then 'AnyToMap'
    			when slc.destination_column_type = 'struct' then 'AnyToStruct'
                else coalesce(c.intermediate_stg_function,a.intermediate_stg_function)
                end
            )
            when coalesce(c.intermediate_stg_function,a.intermediate_stg_function) = 'AsIs' then lower('parquet')||'_AsIs'
            when (c.intermediate_stg_function = 'parquet_inconsistentInteger_convert') then (
                case when (data_scale=0 and (data_precision between 0 and 2)) then 'ParquetStringToTinyIntConvert'
                 when (data_scale=0 and (data_precision between 3 and 4)) then 'ParquetStringToSmallIntConvert'
                 when (data_scale=0 and (data_precision between 5 and 9)) then 'ParquetStringToIntConvert'
                 when (data_scale=0 and (data_precision between 10 and 17)) then 'ParquetStringToBigIntConvert'
                 when (data_scale=0 and (data_precision between 18 and 38)) then 'ParquetStringToDecimalConvert'
                 when (data_scale <= 37 and (data_precision <= 38)) then a.intermediate_stg_function else 'parquet_AsIs'
                 end
            )
            when (c.intermediate_stg_function = 'parquet_inconsistentDouble_convert') then (
                case when (data_scale_org and data_precision is null) then 'ParquetStringToIntConvert'
				 when (data_scale=0 and (data_precision between 0 and 2)) then 'ParquetStringToTinyIntConvert'
                 when (data_scale=0 and (data_precision between 3 and 4)) then 'ParquetStringToSmallIntConvert'
                 when (data_scale=0 and (data_precision between 5 and 9)) then 'ParquetStringToIntConvert'
                 when (data_scale=0 and (data_precision between 10 and 17)) then 'ParquetStringToBigIntConvert'
                 when (data_scale=0 and (data_precision between 18 and 38)) then 'ParquetStringToDecimalConvert'
                 when (data_scale <= 37 and (data_precision <= 38)) then a.intermediate_stg_function else 'ParquetStringToDoubleConvert'
                 end
            )
            else coalesce(c.intermediate_stg_function,a.intermediate_stg_function)
            end as intermediate_stg_function,
        	a.inconsistent_datatype,

	--coalesce(c.destination_datatype_name,a.destination_datatype_name) as destination_datatype_name,
    --	case when coalesce(c.intermediate_stg_function,a.intermediate_stg_function) = 'AsIs' then lower('parquet')||'_AsIs'
    --    else coalesce(c.intermediate_stg_function,a.intermediate_stg_function) end as intermediate_stg_function,a.inconsistent_datatype,

	--renaming of columns options logic
	case
	    when a.is_long_col_name then 'c_'||a.column_id
	    when((true = false) and (true =false)  and a.column_id in (select column_id from source_level_casting) )
        then (select slc.destination_column_name from source_level_casting slc where slc.column_id = a.column_id)
	    when pc.column_id is not null then pc.final_column_name
	    else a.field_name
	end as field_name,
	case
    	    when((true = false) and (true =false)  and a.column_id in (select column_id from source_level_casting) )
            then (select slc.destination_column_name from source_level_casting slc where slc.column_id = a.column_id)
    	    when pc.column_id is not null then pc.final_column_name else a.field_name_replaced
    	    end as field_name_replaced,a.is_long_col_name,
	case
		when ('sql_server' = 'oracle') then
        (
            case
                when data_type ~* 'time zone' and c.option_number = 0 then true
                else false
            end
        )
		when ('sql_server' in ('postgres','redshift','redshift_relational') and a.destination_type!='hive') then
        (
        	case
                when data_type ~* 'timestamp with time zone' and c.option_number = 0 then true
                else false
            end
        )
        when ('sql_server' = 'sql_server') then
        (
        	case
                when data_type = 'datetimeoffset' and c.option_number = 0 then true
                else false
            end
        )
        else false
	end as isTimeZone , user_text, a.is_cdc_col
  from initial_column_mapping a left outer join (select a.*,lower(b.engine_type) as datamovement_engine_type from nabu.user_defined_trans_for_inconsistent_datatype a inner join nabu.engine_lookup b on a.engine_id = b.engine_id where data_movement_id = 261 and valid_to='9999-12-31' ) c
  on a.source_type = c.source_type
  and a.intermediate_type = c.intermediate_type
  and a.destination_type = c.destination_type
  and a.datamovement_engine_type = c.datamovement_engine_type
  and a.inconsistent_datatype = c.inconsistent_datatype
  left outer join partition_columns pc on a.column_id = pc.column_id
  left outer join source_level_casting slc on a.column_id = slc.column_id and slc.sql_expr !=''
union all
  select false::boolean as is_virtual,0 as column_id,
    false as is_source_casting_enabled ,
    false as is_partitioned_col, a.column_name,
    replace(a.column_name,'''','''''')as replaced_column_name,a.data_type,a.data_length,a.ordinal_position,a.is_nullable,table_name,schema_name ,false as is_mysql,
    false as is_bigquery,false as is_source_hive,
	a.source_type,a.source_datatype_name,source_cast_type,a.intermediate_datatype_name,a.table_id,
    c.source_stg_function,
	a.data_scale,
	a.data_precision,
	case when (a.data_precision = 0 or a.data_precision is null) then true else false end as is_precision,
    case when a.data_scale <= 37 then true else false end as is_precision_scale,
    case when a.destination_type='redshift_relational' then true else false end as is_redshift_relational_destination,
    case when a.destination_type = 'oracle' then true else false end as is_oracle_destination,
    case when c.destination_datatype_name ~*'varchar|boolean' then true else false end as is_varchar,
	c.destination_datatype_name,
    case when coalesce(c.intermediate_stg_function,a.intermediate_stg_function) = 'AsIs' then lower('parquet')||'_AsIs'
            when (c.intermediate_stg_function = 'parquet_inconsistentInteger_convert' and data_scale=0) then (
                case when (data_scale=0 and (data_precision between 0 and 2)) then 'ParquetStringToTinyIntConvert'
                 when (data_scale=0 and (data_precision between 3 and 4)) then 'ParquetStringToSmallIntConvert'
                 when (data_scale=0 and (data_precision between 5 and 9)) then 'ParquetStringToIntConvert'
                 when (data_scale=0 and (data_precision between 10 and 17)) then 'ParquetStringToBigIntConvert'
                 when (data_scale=0 and (data_precision between 18 and 38)) then 'ParquetStringToDecimalConvert'
                 when (data_scale <= 37 and (a.data_precision <= 38)) then a.intermediate_stg_function else 'parquet_AsIs'
                 end
            )
            else coalesce(c.intermediate_stg_function,a.intermediate_stg_function)
            end as intermediate_stg_function,
        	a.inconsistent_datatype,

	--c.destination_datatype_name,
    --c.intermediate_stg_function,
    --a.inconsistent_datatype,

	--renaming of columns options logic
		case
        	    when((true = false) and (true =false)  and a.column_id in (select column_id from source_level_casting) )
                then (select slc.destination_column_name||'_utc' from source_level_casting slc where slc.column_id = a.column_id)
        	    when pc.column_id is not null then pc.final_column_name||'_utc'
        	    else a.field_name||'_utc'
        	end as field_name,
        	case
            	    when((true = false) and (true =false)  and a.column_id in (select column_id from source_level_casting) )
                    then (select slc.destination_column_name||'_utc' from source_level_casting slc where slc.column_id = a.column_id)
            	    when pc.column_id is not null then pc.final_column_name else a.field_name_replaced||'_utc'
            	    end as field_name_replaced,a.is_long_col_name,
    false as isTimeZone , user_text, a.is_cdc_col
  from initial_column_mapping a left outer join (select a.*,lower(b.engine_type) as datamovement_engine_type from nabu.user_defined_trans_for_inconsistent_datatype a inner join nabu.engine_lookup b on a.engine_id = b.engine_id where data_movement_id = 261 and valid_to='9999-12-31' ) c
  on a.source_type = c.source_type
  and a.intermediate_type = c.intermediate_type
  and a.destination_type = c.destination_type
  and a.datamovement_engine_type = c.datamovement_engine_type
  and a.inconsistent_datatype = c.inconsistent_datatype
  left outer join partition_columns pc on a.column_id = pc.column_id
  left outer join source_level_casting slc on a.column_id = slc.column_id and slc.sql_expr !=''
  where(
	case
		when ('sql_server' = 'oracle') then
        (
            case
                when data_type ~* 'time zone' and c.option_number = 0 then true
                else false
            end
        )
		when ('sql_server'  in ('postgres','redshift','redshift_relational') and a.destination_type!='hive') then
        (
        	case
                when data_type ~* 'timestamp with time zone' and c.option_number = 0 then true
                else false
            end
        )
        when ('sql_server' = 'sql_server') then
        (
        	case
                when data_type = 'datetimeoffset' and c.option_number = 0 then true
                else false
            end
        )
        else false
	end ) = true
  group by a.column_name,a.column_id,pc.final_column_name,pc.column_id,a.data_type,a.data_length,a.ordinal_position,a.is_nullable,table_name,schema_name,a.source_type,a.source_datatype_name,source_cast_type,a.intermediate_datatype_name,a.inconsistent_datatype,a.table_id,c.source_stg_function,
  a.data_scale,a.data_precision,a.destination_type,is_varchar,c.destination_datatype_name,c.intermediate_stg_function,a.intermediate_stg_function,a.field_name,a.field_name_replaced,a.is_long_col_name,c.option_number,a.user_text,a.is_cdc_col
  order by ordinal_position
""2023-11-15 16:41:09.924 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with obj_details as(
         select advance_option_details from nabu.advanced_options_object_details where data_movement_id= 261 and valid_to_ts ='9999-12-31' and object_id in (37234)
),exculde_columns as(
   select unnest(string_to_array(btrim((column_options->>'excluded_column_ids'),'[||]'),','))::int as excluded_column_ids from
   ( select (advance_option_details->'advanced_table_options'->'columns_options')::JSON as column_options from obj_details )a
),
reorder_columns as (
    select * from (
        select reorder_json->>'column_name' as column_name,cast(reorder_json->>'column_id' as bigint) as column_id,
        cast(reorder_json->>'is_virtual' as boolean) as is_virtual,cast(reorder_json->>'order' as int) as reorder_position
      from (
      select json_array_elements(('[
]'))::json as reorder_json from obj_details)aa)RT
        where column_name not in ((select dcmp.column_name from nabu.dataplace_column_metadata_physical dcmp where column_id in (select * from exculde_columns) and valid_to_ts = '99991231') )
  ) ,
     virtual_columns as(
       select column_name,true as is_virtual,bb.virtual_intermediate_stg_function,bb.virtual_destination_datatype_name ,false as is_partitioned_col from
               (
                   ( select * from
                     (	 SELECT (jsonarray ->>'column_name')::text as column_name,(jsonarray ->>'column_type')::text as column_type,(jsonarray ->>'spark_sql_expression')::text as spark_sql_expression
                     	 from (  select json_array_elements(('[
]')) :: json as jsonarray from obj_details )x
                     )y
                   )z	left join (select datatype_name,spark_sql_datatype from nabu.spark_datatypes)d on d.datatype_name = z.column_type
               )aa
               inner join ( select intermediate_datatype_name,intermediate_stg_function as virtual_intermediate_stg_function , destination_datatype_name as virtual_destination_datatype_name from nabu.datatype_mapping
               where source_type= 'virtual' and
               lower(destination_type)=
 'bucket' and
               lower(intermediate_type) = lower('parquet') )bb  on bb.intermediate_datatype_name = aa.spark_sql_datatype
      )
    select *, row_number() over (order by ordinal_position) as ingested_colorder
  from
  --calling the column metadata query here
  ( with datatype_mapping as (
  	  		select
          		lower(source_type) as source_type ,
          		lower(intermediate_type) as intermediate_type ,
      		    false as is_create_table,
          		lower(destination_type) as destination_type ,
          		lower(source_datatype_name) as source_datatype_name ,
          		intermediate_datatype_name ,source_cast_type,
          		intermediate_cast_type ,
          		source_stg_function ,
          		destination_datatype_name,
          		intermediate_stg_function ,
          		lower(datamovement_engine_type) as datamovement_engine_type
          	from(
             select *,row_number() over (partition by source_type ,source_datatype_name ) as rno
             from nabu.datatype_mapping dmt
          	 where lower(source_type) =lower('sql_server') and
          	 lower(intermediate_type) = lower('parquet') and
    		 lower(destination_type) = 'bucket'
          	 )a
          	 where rno=1
  ),
  obj_details as(
    select advance_option_details from nabu.advanced_options_object_details where data_movement_id= 261 and valid_to_ts ='9999-12-31' and object_id in (37234)
  ),
  exculde_columns as(
    select unnest(string_to_array(btrim((column_options->>'excluded_column_ids'),'[||]'),','))::int as excluded_column_ids from
    (      select (advance_option_details->'advanced_table_options'->'columns_options')::JSON as column_options from obj_details  )a
    ),
  ignore_datatypes as(
       select coalesce (lower(ignore_data_types),' ') as data_types from (
       select replace((json_array_elements(data_movement_additional_info->'flow_details'->'ignore_data_types'))::text,'"','') as ignore_data_types
       from nabu.data_movement_physical
       where data_movement_id = 261 and valid_to_ts='9999-12-31'
       union
      select source_datatype_name as ignore_data_types
      from nabu.user_defined_trans_for_unsupported_datatype
      where advanced_options_sub_type_id =16 and data_movement_id = 261 and valid_to_ts='9999-12-31'
       )a
  ),
  column_metadata as (
  select a.*,
  		case when cdc.column_id is not null then true else false end as is_cdc_col,
          b.advanced_options_sub_type_id,
          b.additional_info
   from
    (
  	select
  		cmp.column_name,data_length,cmp.ordinal_position,
  		case when data_scale=0 then true else false end as data_scale_org,
  		case when data_scale is null then 0
  		    else data_scale
  		end as data_scale,data_precision,
  		lower(data_type) as metadata_datatype,
  		cmp.is_nullable,cmp.column_id,cmp.table_id,cmp.table_name,cmp.schema_name,
  		case
                when ('oracle' = lower('sql_server')) and data_type ~* 'time zone' and length(regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '')||'_utc') > 30
                then 'c_'||column_id
                when ('oracle' = lower('sql_server')) and length(regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '')) > 30
                then 'c_'||column_id
                when ('oracle' = lower('adls_gen2')) and length (column_name) > 30
                then 'c_'||column_id
          		else regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') end as field_name,
        regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') as field_name_replaced,
        case when ('oracle' = lower('sql_server')) and length(regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '')) > 30 and lower('adls_gen2') !='oracle'
            then true else false end as is_long_col_name,
  		case
  			when data_type ~* 'INTERVAL' then regexp_replace(lower(data_type),'[^A-Za-z ]', '', 'g')
  			when data_type like 'array%' and dp.dataplace_sub_component_id =7  then regexp_replace(lower(data_type), '^(\w+)\W.*','\1','g')
            when data_type like 'struct%' and dp.dataplace_sub_component_id =7 then regexp_replace(lower(data_type), '^(\w+)\W.*','\1','g')
            when data_type like 'map%' and dp.dataplace_sub_component_id =7 then regexp_replace(lower(data_type), '^(\w+)\W.*','\1','g')
            when data_type ~* 'varchar*' and dp.dataplace_sub_component_id =7 then 'varchar'
            when data_type ~* 'decimal*' and dp.dataplace_sub_component_id = 7 then 'decimal'
  			else lower(data_type)
  		end as data_type
  	from nabu.dataplace_column_metadata_physical cmp left outer join nabu.dataplace_physical dp on cmp.dataplace_id = dp.dataplace_id where cmp.table_id = 37234  and cmp.valid_to_ts='9999-12-31'
  and 
     data_type is not null
    and cmp.column_id not in (select excluded_column_ids from exculde_columns)
    ) a
    left outer join
         (
         select data_movement_id,
                 lower(source_datatype_name) AS source_datatype,
                 advanced_options_sub_type_id,
                 additional_info
          from nabu.user_defined_trans_for_unsupported_datatype
          where data_movement_id = 261
            and valid_to_ts='9999-12-31'
        ) b on a.data_type = b.source_datatype
        left outer join(
        select json_array_elements_text(advance_option_details->'advanced_table_options'->'CDC'->'columns_ids')::int as column_id
		from nabu.advanced_options_object_details aood where data_movement_id =261 and object_id =37234 and valid_to_ts ='9999-12-31'
        )cdc
        on a.column_id=cdc.column_id
   ),
   source_level_casting as(
      select (modified_columns ->>'column_id')::int as column_id,
      trim(convert_from(decode(modified_columns ->'column_info'->>'source_casting_exp','base64'), 'UTF8')) as sql_expr,
      lower(modified_columns ->'column_info'->>'destination_column_type') as destination_column_type,
      (modified_columns ->'column_info'->>'destination_column_name') as destination_column_name
      from(
        select json_array_elements(('[
]')) :: json as modified_columns from obj_details
      )modified_details
         ),
  initial_column_mapping as (
  select
  	a.column_name,a.data_type,a.data_length,a.ordinal_position,a.is_nullable,table_name,schema_name , a.metadata_datatype, a.column_id,a.table_id,
  	source_type,intermediate_type,datamovement_engine_type ,b.source_datatype_name,source_cast_type,b.intermediate_datatype_name,
  	case
  	           when(a.advanced_options_sub_type_id = 17) then 'UserText'
  	           when(a.advanced_options_sub_type_id = 31) then 'SQLServerStringConvert'
  	           when(a.advanced_options_sub_type_id = 14) then 'AsIs'
  	           when(a.advanced_options_sub_type_id = 15) then 'ReplaceWithNull'
  	else b.source_stg_function
  	end as source_stg_function,
  	case when (a.advanced_options_sub_type_id = 17) then a.additional_info ->> 'target_value' else null end as user_text,
  	a.data_scale,a.data_precision,data_scale_org,
  	    'adls_gen2' as destination_type,
  		b.intermediate_datatype_name as destination_datatype_name,
    	case when(a.advanced_options_sub_type_id in (14,15,17,31)) then 'AnyToString'
    	when b.intermediate_stg_function = 'AsIs' then 'parquet_AsIs' else b.intermediate_stg_function end as intermediate_stg_function,
    	case
    	    when (b.source_datatype_name in ('bit','datetimeoffset','time','datetime2','smalldatetime','datetime')) then concat(b.source_datatype_name,'_to_varchar')
    	    else null
    	 end as inconsistent_datatype,
  	a.field_name,a.field_name_replaced, a.is_long_col_name,
  	case when ( 'oracle' = lower('sql_server')) and length(a.field_name)>30
              then 'c_'||a.column_id
              else a.field_name
            end as intermediate_field_name, a.is_cdc_col
  from column_metadata as a left join datatype_mapping as b
  on a.data_type = b.source_datatype_name
  where a.ordinal_position is not null
 -- and b.datamovement_engine_type = lower('Spark')
  ),
  partition_columns as(
  select
  case when(columns_list->>'renamed_column' = '')
          then columns_list->>'column_name'
          else columns_list->>'renamed_column'
  end as final_column_name,
  (columns_list->>'column_id')::int as column_id
  from(
  select json_array_elements(((advance_option_details->>'advanced_table_options')::json->>'table_partitions')::json) as columns_list from nabu.advanced_options_object_details aood
  where data_movement_id= 261 and valid_to_ts ='9999-12-31' and object_id in (37234)
  )table_partitions_data
  )
  select false::boolean as is_virtual,a.column_id,
    case when slc.column_id is not null then true else false end as is_source_casting_enabled ,
    case when pc.column_id is not null then true else false end as is_partitioned_col, a.column_name,
    replace(a.column_name,'''','''''')as replaced_column_name,a.data_type,a.data_length,a.ordinal_position,a.is_nullable,table_name,schema_name ,false as is_mysql,
    false as is_bigquery,false as is_source_hive,
	a.source_type,a.source_datatype_name,source_cast_type,a.intermediate_datatype_name,a.table_id,
    case when slc.column_id is not null then
    (
    case
            when slc.sql_expr like '%)____%' then slc.sql_expr
            else concat (slc.sql_expr,' as ',slc.destination_column_name)
        end
    )
    --when (c.intermediate_stg_function = 'parquet_inconsistentInteger_convert' ) then 'AnyToStringConvert'
    else coalesce(c.source_stg_function,a.source_stg_function)
    end as source_stg_function,
	a.data_scale,
	case when slc.column_id is not null then
		(
		case when a.data_precision <= 38 then a.data_precision
			else 38
		end
		)
		else a.data_precision
	end as data_precision,
	case when (a.data_precision = 0 or a.data_precision is null) then true else false end as is_precision,
    case when a.data_scale <= 37 then true else false end as is_precision_scale,
    case when a.destination_type='redshift_relational' then true else false end as is_redshift_relational_destination,
    case when a.destination_type = 'oracle' then true else false end as is_oracle_destination,
    case when a.destination_datatype_name ~*'varchar|boolean' then true else false end as is_varchar,
	case  when slc.column_id is not null then
            (
            case
	        when slc.destination_column_type in('decimal','numeric') then
	        (
	        case when a.data_precision <=38 then concat(slc.destination_column_type,'(',a.data_precision,',',a.data_scale,')')
	        	else concat(slc.destination_column_type,'(38,',a.data_scale,')')
	        end
	        )
            when slc.destination_column_type in ('varchar','char') then
            (
            case
	            when data_length is null then concat( slc.destination_column_type,'(255)')
            	else concat( slc.destination_column_type,'(',a.data_length ,')')
            end
            )
            else (slc.destination_column_type)
            end
            )
            when c.destination_datatype_name ='STRING/DECIMAL'  then
            (
            case
            	 when a.data_precision =0 then concat('DECIMAL','(',38,',',a.data_scale,')')
            	 when a.data_precision <=38 and a.data_scale <=37 then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
                 else 'STRING'
            end
            )
            when c.destination_datatype_name ='STRING/DECIMAL/INTEGER'  then
            (
            CASE
         when (a.data_scale = 0 and (a.data_precision between 0 and 2)) then 'TINYINT'
         when (a.data_scale = 0 and (a.data_precision between 3 and 4)) then 'SMALLINT'
         when (a.data_scale = 0 and (a.data_precision between 5 and 9)) then 'INT'
         when (a.data_scale = 0 and (a.data_precision between 10 and 17)) then 'BIGINT'
         when (a.data_scale = 0 and (a.data_precision between 18 and 38)) then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
         when (a.data_scale <= 37 and (a.data_precision <= 38)) then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
         else 'STRING'
     end
	)
            when c.destination_datatype_name ='DoublePrecision/DECIMAL/INTEGER'  then
            (
                        case when (data_scale_org and data_precision is null) then 'integer'
                     when (a.data_scale = 0 and (a.data_precision between 0 and 2)) then 'TINYINT'
                     when (a.data_scale = 0 and (a.data_precision between 3 and 4)) then 'SMALLINT'
                     when (a.data_scale = 0 and (a.data_precision between 5 and 9)) then 'INT'
                     when (a.data_scale = 0 and (a.data_precision between 10 and 17)) then 'BIGINT'
                     when (a.data_scale = 0 and (a.data_precision between 18 and 38)) then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
                     when (a.data_scale <= 37 and (a.data_precision <= 38)) then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
                     else 'double precision'
                     end
            )
                when ('sql_server' = 'oracle') then
                (
                    case
                        when data_type ~* 'time zone' and c.option_number = 0 and 'azure_synapse' in('bigquery','redshift','azure_synapse','snowflake') then 'VARCHAR(50)'
                        when data_type ~* 'time zone' and c.option_number = 0 and 'azure_synapse' in('hive') then 'STRING'
                        else coalesce(c.destination_datatype_name,a.destination_datatype_name)
                    end
                )
                when ('sql_server' = 'postgres') then
                (
                    case
                        when data_type ~* 'timestamp with time zone' and c.option_number = 0 and 'azure_synapse' in('bigquery','redshift','azure_synapse','snowflake') then 'VARCHAR(50)'
                        when data_type ~* 'timestamp with time zone' and c.option_number = 0 and 'azure_synapse' in('hive') then 'STRING'
                        else coalesce(c.destination_datatype_name,a.destination_datatype_name)
                    end
                )
                when ('sql_server' = 'sql_server') then
                (
                    case
                        when data_type ~* 'datetimeoffset' and c.option_number = 0 and 'azure_synapse' in('bigquery','redshift','azure_synapse','snowflake') then 'VARCHAR(50)'
                        when data_type ~* 'datetimeoffset' and c.option_number = 0 and 'azure_synapse' in('hive') then 'STRING'
                        else coalesce(c.destination_datatype_name,a.destination_datatype_name)
                    end
                )
            else coalesce(c.destination_datatype_name,a.destination_datatype_name)
            end as destination_datatype_name,
    case when slc.column_id is not null then
            (
    		case when slc.destination_column_type in('double','double precision') then 'ParquetStringToDoubleConvert'
    			when slc.destination_column_type in('decimal','money','numeric','smallmoney','number') then 'ParquetStringToDecimalConvert'
    			when slc.destination_column_type in('int','integer','int64') then 'ParquetStringToIntConvert'
    			when slc.destination_column_type in('timestamp','datetime2') then 'ParquetStringToTimestampConvert'
    			when slc.destination_column_type = 'bigint' then 'ParquetStringToBigIntConvert'
    			when slc.destination_column_type = 'tinyint' then 'ParquetStringToTinyIntConvert'
    			when slc.destination_column_type = 'smallint' then 'ParquetStringToSmallIntConvert'
    			when slc.destination_column_type in('float','float64','real') then 'ParquetStringToFloatConvert'
    			when slc.destination_column_type in('char','nchar') then 'ParquetStringToCharConvert'
    			when slc.destination_column_type in('varchar','nvarchar') then 'ParquetStringToVarcharConvert'
    			when slc.destination_column_type in('binary','varbinary','bytes') then 'ParquetStringToBinaryConvert'
    			when slc.destination_column_type = 'date' then 'ParquetStringToDateConvert'
    			when slc.destination_column_type in('string','text') then 'AnyToString'
    			when slc.destination_column_type in('boolean','bool') then 'AnyToBoolean'
    			when slc.destination_column_type = 'array' then 'AnyToArray'
    			when slc.destination_column_type = 'map' then 'AnyToMap'
    			when slc.destination_column_type = 'struct' then 'AnyToStruct'
                else coalesce(c.intermediate_stg_function,a.intermediate_stg_function)
                end
            )
            when coalesce(c.intermediate_stg_function,a.intermediate_stg_function) = 'AsIs' then lower('parquet')||'_AsIs'
            when (c.intermediate_stg_function = 'parquet_inconsistentInteger_convert') then (
                case when (data_scale=0 and (data_precision between 0 and 2)) then 'ParquetStringToTinyIntConvert'
                 when (data_scale=0 and (data_precision between 3 and 4)) then 'ParquetStringToSmallIntConvert'
                 when (data_scale=0 and (data_precision between 5 and 9)) then 'ParquetStringToIntConvert'
                 when (data_scale=0 and (data_precision between 10 and 17)) then 'ParquetStringToBigIntConvert'
                 when (data_scale=0 and (data_precision between 18 and 38)) then 'ParquetStringToDecimalConvert'
                 when (data_scale <= 37 and (data_precision <= 38)) then a.intermediate_stg_function else 'parquet_AsIs'
                 end
            )
            when (c.intermediate_stg_function = 'parquet_inconsistentDouble_convert') then (
                case when (data_scale_org and data_precision is null) then 'ParquetStringToIntConvert'
				 when (data_scale=0 and (data_precision between 0 and 2)) then 'ParquetStringToTinyIntConvert'
                 when (data_scale=0 and (data_precision between 3 and 4)) then 'ParquetStringToSmallIntConvert'
                 when (data_scale=0 and (data_precision between 5 and 9)) then 'ParquetStringToIntConvert'
                 when (data_scale=0 and (data_precision between 10 and 17)) then 'ParquetStringToBigIntConvert'
                 when (data_scale=0 and (data_precision between 18 and 38)) then 'ParquetStringToDecimalConvert'
                 when (data_scale <= 37 and (data_precision <= 38)) then a.intermediate_stg_function else 'ParquetStringToDoubleConvert'
                 end
            )
            else coalesce(c.intermediate_stg_function,a.intermediate_stg_function)
            end as intermediate_stg_function,
        	a.inconsistent_datatype,

	--coalesce(c.destination_datatype_name,a.destination_datatype_name) as destination_datatype_name,
    --	case when coalesce(c.intermediate_stg_function,a.intermediate_stg_function) = 'AsIs' then lower('parquet')||'_AsIs'
    --    else coalesce(c.intermediate_stg_function,a.intermediate_stg_function) end as intermediate_stg_function,a.inconsistent_datatype,

	--renaming of columns options logic
	case
	    when a.is_long_col_name then 'c_'||a.column_id
	    when((true = false) and (true =false)  and a.column_id in (select column_id from source_level_casting) )
        then (select slc.destination_column_name from source_level_casting slc where slc.column_id = a.column_id)
	    when pc.column_id is not null then pc.final_column_name
	    else a.field_name
	end as field_name,
	case
    	    when((true = false) and (true =false)  and a.column_id in (select column_id from source_level_casting) )
            then (select slc.destination_column_name from source_level_casting slc where slc.column_id = a.column_id)
    	    when pc.column_id is not null then pc.final_column_name else a.field_name_replaced
    	    end as field_name_replaced,a.is_long_col_name,
	case
		when ('sql_server' = 'oracle') then
        (
            case
                when data_type ~* 'time zone' and c.option_number = 0 then true
                else false
            end
        )
		when ('sql_server' in ('postgres','redshift','redshift_relational') and a.destination_type!='hive') then
        (
        	case
                when data_type ~* 'timestamp with time zone' and c.option_number = 0 then true
                else false
            end
        )
        when ('sql_server' = 'sql_server') then
        (
        	case
                when data_type = 'datetimeoffset' and c.option_number = 0 then true
                else false
            end
        )
        else false
	end as isTimeZone , user_text, a.is_cdc_col
  from initial_column_mapping a left outer join (select a.*,lower(b.engine_type) as datamovement_engine_type from nabu.user_defined_trans_for_inconsistent_datatype a inner join nabu.engine_lookup b on a.engine_id = b.engine_id where data_movement_id = 261 and valid_to='9999-12-31' ) c
  on a.source_type = c.source_type
  and a.intermediate_type = c.intermediate_type
  and a.destination_type = c.destination_type
  and a.datamovement_engine_type = c.datamovement_engine_type
  and a.inconsistent_datatype = c.inconsistent_datatype
  left outer join partition_columns pc on a.column_id = pc.column_id
  left outer join source_level_casting slc on a.column_id = slc.column_id and slc.sql_expr !=''
union all
  select false::boolean as is_virtual,0 as column_id,
    false as is_source_casting_enabled ,
    false as is_partitioned_col, a.column_name,
    replace(a.column_name,'''','''''')as replaced_column_name,a.data_type,a.data_length,a.ordinal_position,a.is_nullable,table_name,schema_name ,false as is_mysql,
    false as is_bigquery,false as is_source_hive,
	a.source_type,a.source_datatype_name,source_cast_type,a.intermediate_datatype_name,a.table_id,
    c.source_stg_function,
	a.data_scale,
	a.data_precision,
	case when (a.data_precision = 0 or a.data_precision is null) then true else false end as is_precision,
    case when a.data_scale <= 37 then true else false end as is_precision_scale,
    case when a.destination_type='redshift_relational' then true else false end as is_redshift_relational_destination,
    case when a.destination_type = 'oracle' then true else false end as is_oracle_destination,
    case when c.destination_datatype_name ~*'varchar|boolean' then true else false end as is_varchar,
	c.destination_datatype_name,
    case when coalesce(c.intermediate_stg_function,a.intermediate_stg_function) = 'AsIs' then lower('parquet')||'_AsIs'
            when (c.intermediate_stg_function = 'parquet_inconsistentInteger_convert' and data_scale=0) then (
                case when (data_scale=0 and (data_precision between 0 and 2)) then 'ParquetStringToTinyIntConvert'
                 when (data_scale=0 and (data_precision between 3 and 4)) then 'ParquetStringToSmallIntConvert'
                 when (data_scale=0 and (data_precision between 5 and 9)) then 'ParquetStringToIntConvert'
                 when (data_scale=0 and (data_precision between 10 and 17)) then 'ParquetStringToBigIntConvert'
                 when (data_scale=0 and (data_precision between 18 and 38)) then 'ParquetStringToDecimalConvert'
                 when (data_scale <= 37 and (a.data_precision <= 38)) then a.intermediate_stg_function else 'parquet_AsIs'
                 end
            )
            else coalesce(c.intermediate_stg_function,a.intermediate_stg_function)
            end as intermediate_stg_function,
        	a.inconsistent_datatype,

	--c.destination_datatype_name,
    --c.intermediate_stg_function,
    --a.inconsistent_datatype,

	--renaming of columns options logic
		case
        	    when((true = false) and (true =false)  and a.column_id in (select column_id from source_level_casting) )
                then (select slc.destination_column_name||'_utc' from source_level_casting slc where slc.column_id = a.column_id)
        	    when pc.column_id is not null then pc.final_column_name||'_utc'
        	    else a.field_name||'_utc'
        	end as field_name,
        	case
            	    when((true = false) and (true =false)  and a.column_id in (select column_id from source_level_casting) )
                    then (select slc.destination_column_name||'_utc' from source_level_casting slc where slc.column_id = a.column_id)
            	    when pc.column_id is not null then pc.final_column_name else a.field_name_replaced||'_utc'
            	    end as field_name_replaced,a.is_long_col_name,
    false as isTimeZone , user_text, a.is_cdc_col
  from initial_column_mapping a left outer join (select a.*,lower(b.engine_type) as datamovement_engine_type from nabu.user_defined_trans_for_inconsistent_datatype a inner join nabu.engine_lookup b on a.engine_id = b.engine_id where data_movement_id = 261 and valid_to='9999-12-31' ) c
  on a.source_type = c.source_type
  and a.intermediate_type = c.intermediate_type
  and a.destination_type = c.destination_type
  and a.datamovement_engine_type = c.datamovement_engine_type
  and a.inconsistent_datatype = c.inconsistent_datatype
  left outer join partition_columns pc on a.column_id = pc.column_id
  left outer join source_level_casting slc on a.column_id = slc.column_id and slc.sql_expr !=''
  where(
	case
		when ('sql_server' = 'oracle') then
        (
            case
                when data_type ~* 'time zone' and c.option_number = 0 then true
                else false
            end
        )
		when ('sql_server'  in ('postgres','redshift','redshift_relational') and a.destination_type!='hive') then
        (
        	case
                when data_type ~* 'timestamp with time zone' and c.option_number = 0 then true
                else false
            end
        )
        when ('sql_server' = 'sql_server') then
        (
        	case
                when data_type = 'datetimeoffset' and c.option_number = 0 then true
                else false
            end
        )
        else false
	end ) = true
  group by a.column_name,a.column_id,pc.final_column_name,pc.column_id,a.data_type,a.data_length,a.ordinal_position,a.is_nullable,table_name,schema_name,a.source_type,a.source_datatype_name,source_cast_type,a.intermediate_datatype_name,a.inconsistent_datatype,a.table_id,c.source_stg_function,
  a.data_scale,a.data_precision,a.destination_type,is_varchar,c.destination_datatype_name,c.intermediate_stg_function,a.intermediate_stg_function,a.field_name,a.field_name_replaced,a.is_long_col_name,c.option_number,a.user_text,a.is_cdc_col
  order by ordinal_position)a

""2023-11-15 16:41:10.177 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with obj_details as(
         select advance_option_details from nabu.advanced_options_object_details where data_movement_id= 261 and valid_to_ts ='9999-12-31' and object_id in (37234)
),exculde_columns as(
   select unnest(string_to_array(btrim((column_options->>'excluded_column_ids'),'[||]'),','))::int as excluded_column_ids from
   ( select (advance_option_details->'advanced_table_options'->'columns_options')::JSON as column_options from obj_details )a
),
reorder_columns as (
    select * from (
        select reorder_json->>'column_name' as column_name,cast(reorder_json->>'column_id' as bigint) as column_id,
        cast(reorder_json->>'is_virtual' as boolean) as is_virtual,cast(reorder_json->>'order' as int) as reorder_position
      from (
      select json_array_elements(('[
]'))::json as reorder_json from obj_details)aa)RT
        where column_name not in ((select column_name from nabu.dataplace_column_metadata_physical dtmp where column_id in (select * from exculde_columns) ) )
  ) ,
     virtual_columns as(
       select column_name,true as is_virtual,bb.virtual_intermediate_stg_function,bb.virtual_destination_datatype_name ,false as is_partitioned_col from
               (
                   ( select * from
                     (	 SELECT (jsonarray ->>'column_name')::text as column_name,(jsonarray ->>'column_type')::text as column_type,(jsonarray ->>'spark_sql_expression')::text as spark_sql_expression
                     	 from (  select json_array_elements(('[
]')) :: json as jsonarray from obj_details )x
                     )y
                   )z	left join (select datatype_name,spark_sql_datatype from nabu.spark_datatypes)d on d.datatype_name = z.column_type
               )aa
               inner join ( select intermediate_datatype_name,intermediate_stg_function as virtual_intermediate_stg_function , destination_datatype_name as virtual_destination_datatype_name from nabu.datatype_mapping
               where source_type= 'virtual' and lower(destination_type)=lower('adls_gen2') and
               lower(intermediate_type) = lower('parquet') )bb  on bb.intermediate_datatype_name = aa.spark_sql_datatype
      ),
  cdc_cols as (
    select *, row_number() over (order by ordinal_position) as ingested_colorder
  from
  --calling the column metadata query here
  ( with datatype_mapping as (
  	  		select
          		lower(source_type) as source_type ,
          		lower(intermediate_type) as intermediate_type ,
      		    false as is_create_table,
          		lower(destination_type) as destination_type ,
          		lower(source_datatype_name) as source_datatype_name ,
          		intermediate_datatype_name ,source_cast_type,
          		intermediate_cast_type ,
          		source_stg_function ,
          		destination_datatype_name,
          		intermediate_stg_function ,
          		lower(datamovement_engine_type) as datamovement_engine_type
          	from(
             select *,row_number() over (partition by source_type ,source_datatype_name ) as rno
             from nabu.datatype_mapping dmt
          	 where lower(source_type) =lower('sql_server') and
          	 lower(intermediate_type) = lower('parquet') and
    		 lower(destination_type) = 'bucket'
          	 )a
          	 where rno=1
  ),
  obj_details as(
    select advance_option_details from nabu.advanced_options_object_details where data_movement_id= 261 and valid_to_ts ='9999-12-31' and object_id in (37234)
  ),
  exculde_columns as(
    select unnest(string_to_array(btrim((column_options->>'excluded_column_ids'),'[||]'),','))::int as excluded_column_ids from
    (      select (advance_option_details->'advanced_table_options'->'columns_options')::JSON as column_options from obj_details  )a
    ),
  ignore_datatypes as(
       select coalesce (lower(ignore_data_types),' ') as data_types from (
       select replace((json_array_elements(data_movement_additional_info->'flow_details'->'ignore_data_types'))::text,'"','') as ignore_data_types
       from nabu.data_movement_physical
       where data_movement_id = 261 and valid_to_ts='9999-12-31'
       union
      select source_datatype_name as ignore_data_types
      from nabu.user_defined_trans_for_unsupported_datatype
      where advanced_options_sub_type_id =16 and data_movement_id = 261 and valid_to_ts='9999-12-31'
       )a
  ),
  column_metadata as (
  select a.*,
  		case when cdc.column_id is not null then true else false end as is_cdc_col,
          b.advanced_options_sub_type_id,
          b.additional_info
   from
    (
  	select
  		cmp.column_name,data_length,cmp.ordinal_position,
  		case when data_scale=0 then true else false end as data_scale_org,
  		case when data_scale is null then 0
  		    else data_scale
  		end as data_scale,data_precision,
  		lower(data_type) as metadata_datatype,
  		cmp.is_nullable,cmp.column_id,cmp.table_id,cmp.table_name,cmp.schema_name,
  		case
                when ('oracle' = lower('sql_server')) and data_type ~* 'time zone' and length(regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '')||'_utc') > 30
                then 'c_'||column_id
                when ('oracle' = lower('sql_server')) and length(regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '')) > 30
                then 'c_'||column_id
                when ('oracle' = lower('adls_gen2')) and length (column_name) > 30
                then 'c_'||column_id
          		else regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') end as field_name,
        regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '') as field_name_replaced,
        case when ('oracle' = lower('sql_server')) and length(regexp_replace(lower(trim(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(column_name,'=','_eq_'),'^','_ccf_'),'~','_til_'),',','_com_'),';','_sc_'),']','_csb_'),'[','_osb_'),'`','_bq_'),'>','_gt_'),'<','_lt_'),'$','_dlr_' ),'"','') ,'|','_pe_' ),'}','_rbr_' ),'{','_lbr_' ),'#','_hash_' ) ,'*','_astk_' ) ,'(','_op_' ) , ')','_cp_' ) ,'@','_at_' ),'.','_dot_' ),' ','_' ),'&','_amp_' ),'+','_pls_' ),'-','_hyp_' ),'?','_qtn_' ),':','_cln_' ),'/','_fs_' ),'''','_sq_' ),'%','_prst_' ),'!','_exp_'))),'^[_]+', '')) > 30 and lower('adls_gen2') !='oracle'
            then true else false end as is_long_col_name,
  		case
  			when data_type ~* 'INTERVAL' then regexp_replace(lower(data_type),'[^A-Za-z ]', '', 'g')
  			when data_type like 'array%' and dp.dataplace_sub_component_id =7  then regexp_replace(lower(data_type), '^(\w+)\W.*','\1','g')
            when data_type like 'struct%' and dp.dataplace_sub_component_id =7 then regexp_replace(lower(data_type), '^(\w+)\W.*','\1','g')
            when data_type like 'map%' and dp.dataplace_sub_component_id =7 then regexp_replace(lower(data_type), '^(\w+)\W.*','\1','g')
            when data_type ~* 'varchar*' and dp.dataplace_sub_component_id =7 then 'varchar'
            when data_type ~* 'decimal*' and dp.dataplace_sub_component_id = 7 then 'decimal'
  			else lower(data_type)
  		end as data_type
  	from nabu.dataplace_column_metadata_physical cmp left outer join nabu.dataplace_physical dp on cmp.dataplace_id = dp.dataplace_id where cmp.table_id = 37234  and cmp.valid_to_ts='9999-12-31'
  and 
     data_type is not null
    and cmp.column_id not in (select excluded_column_ids from exculde_columns)
    ) a
    left outer join
         (
         select data_movement_id,
                 lower(source_datatype_name) AS source_datatype,
                 advanced_options_sub_type_id,
                 additional_info
          from nabu.user_defined_trans_for_unsupported_datatype
          where data_movement_id = 261
            and valid_to_ts='9999-12-31'
        ) b on a.data_type = b.source_datatype
        left outer join(
        select json_array_elements_text(advance_option_details->'advanced_table_options'->'CDC'->'columns_ids')::int as column_id
		from nabu.advanced_options_object_details aood where data_movement_id =261 and object_id =37234 and valid_to_ts ='9999-12-31'
        )cdc
        on a.column_id=cdc.column_id
   ),
   source_level_casting as(
      select (modified_columns ->>'column_id')::int as column_id,
      trim(convert_from(decode(modified_columns ->'column_info'->>'source_casting_exp','base64'), 'UTF8')) as sql_expr,
      lower(modified_columns ->'column_info'->>'destination_column_type') as destination_column_type,
      (modified_columns ->'column_info'->>'destination_column_name') as destination_column_name
      from(
        select json_array_elements(('[
]')) :: json as modified_columns from obj_details
      )modified_details
         ),
  initial_column_mapping as (
  select
  	a.column_name,a.data_type,a.data_length,a.ordinal_position,a.is_nullable,table_name,schema_name , a.metadata_datatype, a.column_id,a.table_id,
  	source_type,intermediate_type,datamovement_engine_type ,b.source_datatype_name,source_cast_type,b.intermediate_datatype_name,
  	case
  	           when(a.advanced_options_sub_type_id = 17) then 'UserText'
  	           when(a.advanced_options_sub_type_id = 31) then 'SQLServerStringConvert'
  	           when(a.advanced_options_sub_type_id = 14) then 'AsIs'
  	           when(a.advanced_options_sub_type_id = 15) then 'ReplaceWithNull'
  	else b.source_stg_function
  	end as source_stg_function,
  	case when (a.advanced_options_sub_type_id = 17) then a.additional_info ->> 'target_value' else null end as user_text,
  	a.data_scale,a.data_precision,data_scale_org,
  	    'adls_gen2' as destination_type,
  		b.intermediate_datatype_name as destination_datatype_name,
    	case when(a.advanced_options_sub_type_id in (14,15,17,31)) then 'AnyToString'
    	when b.intermediate_stg_function = 'AsIs' then 'parquet_AsIs' else b.intermediate_stg_function end as intermediate_stg_function,
    	case
    	    when (b.source_datatype_name in ('bit','datetimeoffset','time','datetime2','smalldatetime','datetime')) then concat(b.source_datatype_name,'_to_varchar')
    	    else null
    	 end as inconsistent_datatype,
  	a.field_name,a.field_name_replaced, a.is_long_col_name,
  	case when ( 'oracle' = lower('sql_server')) and length(a.field_name)>30
              then 'c_'||a.column_id
              else a.field_name
            end as intermediate_field_name, a.is_cdc_col
  from column_metadata as a left join datatype_mapping as b
  on a.data_type = b.source_datatype_name
  where a.ordinal_position is not null
 -- and b.datamovement_engine_type = lower('Spark')
  ),
  partition_columns as(
  select
  case when(columns_list->>'renamed_column' = '')
          then columns_list->>'column_name'
          else columns_list->>'renamed_column'
  end as final_column_name,
  (columns_list->>'column_id')::int as column_id
  from(
  select json_array_elements(((advance_option_details->>'advanced_table_options')::json->>'table_partitions')::json) as columns_list from nabu.advanced_options_object_details aood
  where data_movement_id= 261 and valid_to_ts ='9999-12-31' and object_id in (37234)
  )table_partitions_data
  )
  select false::boolean as is_virtual,a.column_id,
    case when slc.column_id is not null then true else false end as is_source_casting_enabled ,
    case when pc.column_id is not null then true else false end as is_partitioned_col, a.column_name,
    replace(a.column_name,'''','''''')as replaced_column_name,a.data_type,a.data_length,a.ordinal_position,a.is_nullable,table_name,schema_name ,false as is_mysql,
    false as is_bigquery,false as is_source_hive,
	a.source_type,a.source_datatype_name,source_cast_type,a.intermediate_datatype_name,a.table_id,
    case when slc.column_id is not null then
    (
    case
            when slc.sql_expr like '%)____%' then slc.sql_expr
            else concat (slc.sql_expr,' as ',slc.destination_column_name)
        end
    )
    --when (c.intermediate_stg_function = 'parquet_inconsistentInteger_convert' ) then 'AnyToStringConvert'
    else coalesce(c.source_stg_function,a.source_stg_function)
    end as source_stg_function,
	a.data_scale,
	case when slc.column_id is not null then
		(
		case when a.data_precision <= 38 then a.data_precision
			else 38
		end
		)
		else a.data_precision
	end as data_precision,
	case when (a.data_precision = 0 or a.data_precision is null) then true else false end as is_precision,
    case when a.data_scale <= 37 then true else false end as is_precision_scale,
    case when a.destination_type='redshift_relational' then true else false end as is_redshift_relational_destination,
    case when a.destination_type = 'oracle' then true else false end as is_oracle_destination,
    case when a.destination_datatype_name ~*'varchar|boolean' then true else false end as is_varchar,
	case  when slc.column_id is not null then
            (
            case
	        when slc.destination_column_type in('decimal','numeric') then
	        (
	        case when a.data_precision <=38 then concat(slc.destination_column_type,'(',a.data_precision,',',a.data_scale,')')
	        	else concat(slc.destination_column_type,'(38,',a.data_scale,')')
	        end
	        )
            when slc.destination_column_type in ('varchar','char') then
            (
            case
	            when data_length is null then concat( slc.destination_column_type,'(255)')
            	else concat( slc.destination_column_type,'(',a.data_length ,')')
            end
            )
            else (slc.destination_column_type)
            end
            )
            when c.destination_datatype_name ='STRING/DECIMAL'  then
            (
            case
            	 when a.data_precision =0 then concat('DECIMAL','(',38,',',a.data_scale,')')
            	 when a.data_precision <=38 and a.data_scale <=37 then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
                 else 'STRING'
            end
            )
            when c.destination_datatype_name ='STRING/DECIMAL/INTEGER'  then
            (
            CASE
         when (a.data_scale = 0 and (a.data_precision between 0 and 2)) then 'TINYINT'
         when (a.data_scale = 0 and (a.data_precision between 3 and 4)) then 'SMALLINT'
         when (a.data_scale = 0 and (a.data_precision between 5 and 9)) then 'INT'
         when (a.data_scale = 0 and (a.data_precision between 10 and 17)) then 'BIGINT'
         when (a.data_scale = 0 and (a.data_precision between 18 and 38)) then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
         when (a.data_scale <= 37 and (a.data_precision <= 38)) then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
         else 'STRING'
     end
	)
            when c.destination_datatype_name ='DoublePrecision/DECIMAL/INTEGER'  then
            (
                        case when (data_scale_org and data_precision is null) then 'integer'
                     when (a.data_scale = 0 and (a.data_precision between 0 and 2)) then 'TINYINT'
                     when (a.data_scale = 0 and (a.data_precision between 3 and 4)) then 'SMALLINT'
                     when (a.data_scale = 0 and (a.data_precision between 5 and 9)) then 'INT'
                     when (a.data_scale = 0 and (a.data_precision between 10 and 17)) then 'BIGINT'
                     when (a.data_scale = 0 and (a.data_precision between 18 and 38)) then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
                     when (a.data_scale <= 37 and (a.data_precision <= 38)) then concat('DECIMAL','(',a.data_precision,',',a.data_scale,')')
                     else 'double precision'
                     end
            )
                when ('sql_server' = 'oracle') then
                (
                    case
                        when data_type ~* 'time zone' and c.option_number = 0 and 'azure_synapse' in('bigquery','redshift','azure_synapse','snowflake') then 'VARCHAR(50)'
                        when data_type ~* 'time zone' and c.option_number = 0 and 'azure_synapse' in('hive') then 'STRING'
                        else coalesce(c.destination_datatype_name,a.destination_datatype_name)
                    end
                )
                when ('sql_server' = 'postgres') then
                (
                    case
                        when data_type ~* 'timestamp with time zone' and c.option_number = 0 and 'azure_synapse' in('bigquery','redshift','azure_synapse','snowflake') then 'VARCHAR(50)'
                        when data_type ~* 'timestamp with time zone' and c.option_number = 0 and 'azure_synapse' in('hive') then 'STRING'
                        else coalesce(c.destination_datatype_name,a.destination_datatype_name)
                    end
                )
                when ('sql_server' = 'sql_server') then
                (
                    case
                        when data_type ~* 'datetimeoffset' and c.option_number = 0 and 'azure_synapse' in('bigquery','redshift','azure_synapse','snowflake') then 'VARCHAR(50)'
                        when data_type ~* 'datetimeoffset' and c.option_number = 0 and 'azure_synapse' in('hive') then 'STRING'
                        else coalesce(c.destination_datatype_name,a.destination_datatype_name)
                    end
                )
            else coalesce(c.destination_datatype_name,a.destination_datatype_name)
            end as destination_datatype_name,
    case when slc.column_id is not null then
            (
    		case when slc.destination_column_type in('double','double precision') then 'ParquetStringToDoubleConvert'
    			when slc.destination_column_type in('decimal','money','numeric','smallmoney','number') then 'ParquetStringToDecimalConvert'
    			when slc.destination_column_type in('int','integer','int64') then 'ParquetStringToIntConvert'
    			when slc.destination_column_type in('timestamp','datetime2') then 'ParquetStringToTimestampConvert'
    			when slc.destination_column_type = 'bigint' then 'ParquetStringToBigIntConvert'
    			when slc.destination_column_type = 'tinyint' then 'ParquetStringToTinyIntConvert'
    			when slc.destination_column_type = 'smallint' then 'ParquetStringToSmallIntConvert'
    			when slc.destination_column_type in('float','float64','real') then 'ParquetStringToFloatConvert'
    			when slc.destination_column_type in('char','nchar') then 'ParquetStringToCharConvert'
    			when slc.destination_column_type in('varchar','nvarchar') then 'ParquetStringToVarcharConvert'
    			when slc.destination_column_type in('binary','varbinary','bytes') then 'ParquetStringToBinaryConvert'
    			when slc.destination_column_type = 'date' then 'ParquetStringToDateConvert'
    			when slc.destination_column_type in('string','text') then 'AnyToString'
    			when slc.destination_column_type in('boolean','bool') then 'AnyToBoolean'
    			when slc.destination_column_type = 'array' then 'AnyToArray'
    			when slc.destination_column_type = 'map' then 'AnyToMap'
    			when slc.destination_column_type = 'struct' then 'AnyToStruct'
                else coalesce(c.intermediate_stg_function,a.intermediate_stg_function)
                end
            )
            when coalesce(c.intermediate_stg_function,a.intermediate_stg_function) = 'AsIs' then lower('parquet')||'_AsIs'
            when (c.intermediate_stg_function = 'parquet_inconsistentInteger_convert') then (
                case when (data_scale=0 and (data_precision between 0 and 2)) then 'ParquetStringToTinyIntConvert'
                 when (data_scale=0 and (data_precision between 3 and 4)) then 'ParquetStringToSmallIntConvert'
                 when (data_scale=0 and (data_precision between 5 and 9)) then 'ParquetStringToIntConvert'
                 when (data_scale=0 and (data_precision between 10 and 17)) then 'ParquetStringToBigIntConvert'
                 when (data_scale=0 and (data_precision between 18 and 38)) then 'ParquetStringToDecimalConvert'
                 when (data_scale <= 37 and (data_precision <= 38)) then a.intermediate_stg_function else 'parquet_AsIs'
                 end
            )
            when (c.intermediate_stg_function = 'parquet_inconsistentDouble_convert') then (
                case when (data_scale_org and data_precision is null) then 'ParquetStringToIntConvert'
				 when (data_scale=0 and (data_precision between 0 and 2)) then 'ParquetStringToTinyIntConvert'
                 when (data_scale=0 and (data_precision between 3 and 4)) then 'ParquetStringToSmallIntConvert'
                 when (data_scale=0 and (data_precision between 5 and 9)) then 'ParquetStringToIntConvert'
                 when (data_scale=0 and (data_precision between 10 and 17)) then 'ParquetStringToBigIntConvert'
                 when (data_scale=0 and (data_precision between 18 and 38)) then 'ParquetStringToDecimalConvert'
                 when (data_scale <= 37 and (data_precision <= 38)) then a.intermediate_stg_function else 'ParquetStringToDoubleConvert'
                 end
            )
            else coalesce(c.intermediate_stg_function,a.intermediate_stg_function)
            end as intermediate_stg_function,
        	a.inconsistent_datatype,

	--coalesce(c.destination_datatype_name,a.destination_datatype_name) as destination_datatype_name,
    --	case when coalesce(c.intermediate_stg_function,a.intermediate_stg_function) = 'AsIs' then lower('parquet')||'_AsIs'
    --    else coalesce(c.intermediate_stg_function,a.intermediate_stg_function) end as intermediate_stg_function,a.inconsistent_datatype,

	--renaming of columns options logic
	case
	    when a.is_long_col_name then 'c_'||a.column_id
	    when((true = false) and (true =false)  and a.column_id in (select column_id from source_level_casting) )
        then (select slc.destination_column_name from source_level_casting slc where slc.column_id = a.column_id)
	    when pc.column_id is not null then pc.final_column_name
	    else a.field_name
	end as field_name,
	case
    	    when((true = false) and (true =false)  and a.column_id in (select column_id from source_level_casting) )
            then (select slc.destination_column_name from source_level_casting slc where slc.column_id = a.column_id)
    	    when pc.column_id is not null then pc.final_column_name else a.field_name_replaced
    	    end as field_name_replaced,a.is_long_col_name,
	case
		when ('sql_server' = 'oracle') then
        (
            case
                when data_type ~* 'time zone' and c.option_number = 0 then true
                else false
            end
        )
		when ('sql_server' in ('postgres','redshift','redshift_relational') and a.destination_type!='hive') then
        (
        	case
                when data_type ~* 'timestamp with time zone' and c.option_number = 0 then true
                else false
            end
        )
        when ('sql_server' = 'sql_server') then
        (
        	case
                when data_type = 'datetimeoffset' and c.option_number = 0 then true
                else false
            end
        )
        else false
	end as isTimeZone , user_text, a.is_cdc_col
  from initial_column_mapping a left outer join (select a.*,lower(b.engine_type) as datamovement_engine_type from nabu.user_defined_trans_for_inconsistent_datatype a inner join nabu.engine_lookup b on a.engine_id = b.engine_id where data_movement_id = 261 and valid_to='9999-12-31' ) c
  on a.source_type = c.source_type
  and a.intermediate_type = c.intermediate_type
  and a.destination_type = c.destination_type
  and a.datamovement_engine_type = c.datamovement_engine_type
  and a.inconsistent_datatype = c.inconsistent_datatype
  left outer join partition_columns pc on a.column_id = pc.column_id
  left outer join source_level_casting slc on a.column_id = slc.column_id and slc.sql_expr !=''
union all
  select false::boolean as is_virtual,0 as column_id,
    false as is_source_casting_enabled ,
    false as is_partitioned_col, a.column_name,
    replace(a.column_name,'''','''''')as replaced_column_name,a.data_type,a.data_length,a.ordinal_position,a.is_nullable,table_name,schema_name ,false as is_mysql,
    false as is_bigquery,false as is_source_hive,
	a.source_type,a.source_datatype_name,source_cast_type,a.intermediate_datatype_name,a.table_id,
    c.source_stg_function,
	a.data_scale,
	a.data_precision,
	case when (a.data_precision = 0 or a.data_precision is null) then true else false end as is_precision,
    case when a.data_scale <= 37 then true else false end as is_precision_scale,
    case when a.destination_type='redshift_relational' then true else false end as is_redshift_relational_destination,
    case when a.destination_type = 'oracle' then true else false end as is_oracle_destination,
    case when c.destination_datatype_name ~*'varchar|boolean' then true else false end as is_varchar,
	c.destination_datatype_name,
    case when coalesce(c.intermediate_stg_function,a.intermediate_stg_function) = 'AsIs' then lower('parquet')||'_AsIs'
            when (c.intermediate_stg_function = 'parquet_inconsistentInteger_convert' and data_scale=0) then (
                case when (data_scale=0 and (data_precision between 0 and 2)) then 'ParquetStringToTinyIntConvert'
                 when (data_scale=0 and (data_precision between 3 and 4)) then 'ParquetStringToSmallIntConvert'
                 when (data_scale=0 and (data_precision between 5 and 9)) then 'ParquetStringToIntConvert'
                 when (data_scale=0 and (data_precision between 10 and 17)) then 'ParquetStringToBigIntConvert'
                 when (data_scale=0 and (data_precision between 18 and 38)) then 'ParquetStringToDecimalConvert'
                 when (data_scale <= 37 and (a.data_precision <= 38)) then a.intermediate_stg_function else 'parquet_AsIs'
                 end
            )
            else coalesce(c.intermediate_stg_function,a.intermediate_stg_function)
            end as intermediate_stg_function,
        	a.inconsistent_datatype,

	--c.destination_datatype_name,
    --c.intermediate_stg_function,
    --a.inconsistent_datatype,

	--renaming of columns options logic
		case
        	    when((true = false) and (true =false)  and a.column_id in (select column_id from source_level_casting) )
                then (select slc.destination_column_name||'_utc' from source_level_casting slc where slc.column_id = a.column_id)
        	    when pc.column_id is not null then pc.final_column_name||'_utc'
        	    else a.field_name||'_utc'
        	end as field_name,
        	case
            	    when((true = false) and (true =false)  and a.column_id in (select column_id from source_level_casting) )
                    then (select slc.destination_column_name||'_utc' from source_level_casting slc where slc.column_id = a.column_id)
            	    when pc.column_id is not null then pc.final_column_name else a.field_name_replaced||'_utc'
            	    end as field_name_replaced,a.is_long_col_name,
    false as isTimeZone , user_text, a.is_cdc_col
  from initial_column_mapping a left outer join (select a.*,lower(b.engine_type) as datamovement_engine_type from nabu.user_defined_trans_for_inconsistent_datatype a inner join nabu.engine_lookup b on a.engine_id = b.engine_id where data_movement_id = 261 and valid_to='9999-12-31' ) c
  on a.source_type = c.source_type
  and a.intermediate_type = c.intermediate_type
  and a.destination_type = c.destination_type
  and a.datamovement_engine_type = c.datamovement_engine_type
  and a.inconsistent_datatype = c.inconsistent_datatype
  left outer join partition_columns pc on a.column_id = pc.column_id
  left outer join source_level_casting slc on a.column_id = slc.column_id and slc.sql_expr !=''
  where(
	case
		when ('sql_server' = 'oracle') then
        (
            case
                when data_type ~* 'time zone' and c.option_number = 0 then true
                else false
            end
        )
		when ('sql_server'  in ('postgres','redshift','redshift_relational') and a.destination_type!='hive') then
        (
        	case
                when data_type ~* 'timestamp with time zone' and c.option_number = 0 then true
                else false
            end
        )
        when ('sql_server' = 'sql_server') then
        (
        	case
                when data_type = 'datetimeoffset' and c.option_number = 0 then true
                else false
            end
        )
        else false
	end ) = true
  group by a.column_name,a.column_id,pc.final_column_name,pc.column_id,a.data_type,a.data_length,a.ordinal_position,a.is_nullable,table_name,schema_name,a.source_type,a.source_datatype_name,source_cast_type,a.intermediate_datatype_name,a.inconsistent_datatype,a.table_id,c.source_stg_function,
  a.data_scale,a.data_precision,a.destination_type,is_varchar,c.destination_datatype_name,c.intermediate_stg_function,a.intermediate_stg_function,a.field_name,a.field_name_replaced,a.is_long_col_name,c.option_number,a.user_text,a.is_cdc_col
  order by ordinal_position)a
 )
 select * from cdc_cols where is_cdc_col=true
""2023-11-15 16:41:10.389 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with cte1 as (
select data_type,column_name,table_id,data_length
from nabu.dataplace_column_metadata_physical dcmp
where dataplace_id=5
and table_name='aaaa'
and (data_type ~* 'varchar|character varying|boolean')
and valid_to_ts ='9999-12-31'
),
cte2 as(
select distinct column_name as field_name,
CASE
                        when data_type='boolean' then 'boolean'
                        when (data_length between 1 and 65535) then concat('VARCHAR','(',data_length,')')
                        when 'adls_gen2' = 'oracle' then 'varchar(4000)'
                        else 'varchar(65535)'
                end as destination_datatype_name from cte1
)
select * from cte2;
""2023-11-15 16:41:10.580 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query :     select field_name,destination_datatype_name from(select
        column_data->>'field_name' as field_name,
        column_data->>'source_field_name' as source_field_name,
        column_data->>'column_name' as column_name,
        column_data->>'column_id' as column_id,
        column_data->>'source_datatype_name' as source_datatype_name,
        (column_data->>'ingested_colorder')::int as ingested_colorder,
        column_data->>'destination_datatype_name' as destination_datatype_name,
        (column_data->>'is_partitioned_col')::boolean as is_partitioned_col,
        column_data->>'data_length' as data_length,
        column_data->>'data_scale' as data_scale,
        column_data->>'data_precision' as data_precision,
        (column_data->>'is_virtual')::boolean as is_virtual,
        (column_data->>'is_varchar')::boolean as is_varchar
    from(select json_array_elements(('[{
    "field_name": "entity_id",
    "source_field_name": "entity_id",
    "column_name": "entity_id",
    "column_id": "956158",
    "source_datatype_name": "varchar",
    "ingested_colorder": "1",
    "destination_datatype_name": "string",
    "data_length": "255",
    "data_scale": "0",
    "data_precision": "0",
    "is_partitioned_col":  false ,
    "is_virtual":  false ,
    "is_varchar" :  false 
},{
    "field_name": "entity_type",
    "source_field_name": "entity_type",
    "column_name": "entity_type",
    "column_id": "956159",
    "source_datatype_name": "varchar",
    "ingested_colorder": "2",
    "destination_datatype_name": "string",
    "data_length": "255",
    "data_scale": "0",
    "data_precision": "0",
    "is_partitioned_col":  false ,
    "is_virtual":  false ,
    "is_varchar" :  false 
}]')::json) as column_data)column_metadata
   )partition_col_data where is_varchar = true
    order by ingested_colorder

""2023-11-15 16:41:10.939 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query :     select field_name,source_field_name,column_name,column_id, source_datatype_name,ingested_colorder, destination_datatype_name, is_partitioned_col,is_virtual,false :: boolean as is_auditcol, row_number() over (order by column_name)+5 as pos,data_length,data_scale,data_precision
from(select
        column_data->>'field_name' as field_name,
        column_data->>'source_field_name' as source_field_name,
        column_data->>'column_name' as column_name,
        column_data->>'column_id' as column_id,
        column_data->>'source_datatype_name' as source_datatype_name,
        (column_data->>'ingested_colorder')::int as ingested_colorder,
        column_data->>'destination_datatype_name' as destination_datatype_name,
        (column_data->>'is_partitioned_col')::boolean as is_partitioned_col,
        column_data->>'data_length' as data_length,
        column_data->>'data_scale' as data_scale,
        column_data->>'data_precision' as data_precision,
        (column_data->>'is_virtual')::boolean as is_virtual,
        (column_data->>'is_varchar')::boolean as is_varchar
    from(select json_array_elements(('[{
    "field_name": "entity_id",
    "source_field_name": "entity_id",
    "column_name": "entity_id",
    "column_id": "956158",
    "source_datatype_name": "varchar",
    "ingested_colorder": "1",
    "destination_datatype_name": "string",
    "data_length": "255",
    "data_scale": "0",
    "data_precision": "0",
    "is_partitioned_col":  false ,
    "is_virtual":  false ,
    "is_varchar" :  false 
},{
    "field_name": "entity_type",
    "source_field_name": "entity_type",
    "column_name": "entity_type",
    "column_id": "956159",
    "source_datatype_name": "varchar",
    "ingested_colorder": "2",
    "destination_datatype_name": "string",
    "data_length": "255",
    "data_scale": "0",
    "data_precision": "0",
    "is_partitioned_col":  false ,
    "is_virtual":  false ,
    "is_varchar" :  false 
}]')::json) as column_data)column_metadata
   )partition_col_data where is_partitioned_col = true and is_virtual = false
    order by ingested_colorder

""2023-11-15 16:41:11.260 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query :     select field_name,source_field_name,column_name,column_id, source_datatype_name,ingested_colorder, destination_datatype_name, is_partitioned_col,is_virtual,false :: boolean as is_auditcol,data_length,data_scale,data_precision
from(select
        column_data->>'field_name' as field_name,
        column_data->>'source_field_name' as source_field_name,
        column_data->>'column_name' as column_name,
        column_data->>'column_id' as column_id,
        column_data->>'source_datatype_name' as source_datatype_name,
        (column_data->>'ingested_colorder')::int as ingested_colorder,
        column_data->>'destination_datatype_name' as destination_datatype_name,
        (column_data->>'is_partitioned_col')::boolean as is_partitioned_col,
        column_data->>'data_length' as data_length,
        column_data->>'data_scale' as data_scale,
        column_data->>'data_precision' as data_precision,
        (column_data->>'is_virtual')::boolean as is_virtual,
        (column_data->>'is_varchar')::boolean as is_varchar
    from(select json_array_elements(('[{
    "field_name": "entity_id",
    "source_field_name": "entity_id",
    "column_name": "entity_id",
    "column_id": "956158",
    "source_datatype_name": "varchar",
    "ingested_colorder": "1",
    "destination_datatype_name": "string",
    "data_length": "255",
    "data_scale": "0",
    "data_precision": "0",
    "is_partitioned_col":  false ,
    "is_virtual":  false ,
    "is_varchar" :  false 
},{
    "field_name": "entity_type",
    "source_field_name": "entity_type",
    "column_name": "entity_type",
    "column_id": "956159",
    "source_datatype_name": "varchar",
    "ingested_colorder": "2",
    "destination_datatype_name": "string",
    "data_length": "255",
    "data_scale": "0",
    "data_precision": "0",
    "is_partitioned_col":  false ,
    "is_virtual":  false ,
    "is_varchar" :  false 
}]')::json) as column_data)column_metadata
    )partition_col_data where is_partitioned_col = false
    order by ingested_colorder

""2023-11-15 16:41:11.449 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select table_name,table_id from
nabu.dataplace_table_metadata_physical where dataplace_id = 5
and schema_id = 3
and table_name = 'aaaa'  and valid_to_ts = '9999-12-31'
""2023-11-15 16:41:11.643 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select false as schema_drifted,false as target_schemadrift_ignore_table,false as target_schemadrift_backup_table,false as target_schemadrift_new_table,
'aaaa' as destination_table_name,
'aaaa' as backup_table_name

""2023-11-15 16:41:11.824 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with cte_for_newtable_opt as (
--This cte is for the subsequent run after targetdrift with schema drift 3rd option
select case when num > 0 then true else false end as nextrun_after_targetdrift from
(
        select count(*) as num from nabu.data_movement_schema_drift_details dmsdd where (data_movement_id,process_id) =
	(
             select t.data_movement_id,t.process_id from (
		select data_movement_id,process_id from nabu.flow_task_status a where batch_id in
            (select batch_id from nabu.flow_status fs2 where data_movement_id =261 and status_code_id =12 order by flow_ts desc limit 1)
            and object_id = 37234 and status_code_id = 15 order by flow_task_ts desc limit 1)  t
	)
	and advanced_options_sub_type_id = 6
)a
),
target_drift_flag as (
select false as schema_drifted
)
select case when (not schema_drifted and nextrun_after_targetdrift) then true else false end as nextrun_after_targetdrift
from cte_for_newtable_opt,target_drift_flag
""2023-11-15 16:41:12.034 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select
	data_movement_id ,
	case
	    when (false or false ) then 'Overwrite'
		when lower((advance_option_details->'advanced_table_options'->>'ingestion_mode')::json->>'mode')= 'drop & re-create' then 'Overwrite'
		else (advance_option_details->'advanced_table_options'->>'ingestion_mode')::json->>'mode'
	end as save_mode,
	case
	    when (false or false or
	    false ) then 'overwrite'
		when lower((advance_option_details->'advanced_table_options'->>'ingestion_mode')::json->>'mode')= 'drop & re-create' then 'overwrite'
		else lower((advance_option_details->'advanced_table_options'->>'ingestion_mode')::json->>'mode')
	end as mode,
	(advance_option_details->'advanced_option_flags'->>'ingestion_mode')::bool as ingestion_mode_key,
	case
	    when (false or false or
	    false) then true
		when lower((advance_option_details->'advanced_table_options'->>'ingestion_mode')::json->>'mode') = 'drop & re-create' then true
		else false
	end as drop_create_condition
from
	nabu.advanced_options_object_details
where
	data_movement_id = 261
	and
valid_to_ts = '9999-12-31'
	and
object_id = 37234
""2023-11-15 16:41:12.212 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with last_run_details as(
    select case when coalesce(additional_info->>'table_name','')!='aaaa' then true
    else false end as cdc_first,
    coalesce(additional_info->>'table_name','') as last_run_table_name
    from (
        select *,ROW_NUMBER () OVER (order by valid_from_ts desc) rank
        from nabu.advanced_options_obj_checkpoint aooc
        where data_movement_id =261
        and source_dataplace_id = 42 
        and advanced_option_obj_type_id =8
        and object_id =37234
        and valid_to_ts ='9999-12-31'
    )a where rank=1
),
prev_target_path as(
    select
    file_absolute_path from nabu.dataplace_file_metadata
    where directory_id = 3
    and file_id = (select destination_table_id from
                     (select row_number() over(partition by data_movement_id order by crt_ts desc)r, destination_table_id,file_absolute_path from nabu.data_entity_lineage del
                     inner join nabu.dataplace_file_metadata dtmp
                     on del.destination_table_id = dtmp.file_id inner join last_run_details lrd
                     on lrd.last_run_table_name= dtmp.file_name where dataplace_id = 5 and data_movement_id=261)a
                     where r=1)
    and file_name = (select last_run_table_name from last_run_details)
    and dataplace_id = 5
    and valid_to_ts ='9999-12-31'
)
select
case when (select prev_target_path from prev_target_path) is null then true
	else (select cdc_first from last_run_details)
end as cdc_first,
(select * from prev_target_path) as prev_target_path,
'abfss://dataproc@idea15pisplznonprodsa2.dfs.core.windows.net/261/42/development-db/acuity-develop/aaaa.parquet' as target_path,
'/261/42/development-db/acuity-develop/aaaa.parquet' as relative_path
""2023-11-15 16:41:12.479 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select case when false = true then true
when false = true then true
when (
select coalesce(additional_info->>'schema_drift_newtable','false')::bool as drifted_table  from
(
    select *,ROW_NUMBER () OVER (order by valid_from_ts desc) rank from nabu.advanced_options_obj_checkpoint aooc
where data_movement_id =261
and source_dataplace_id = 42 
     and advanced_option_obj_type_id =8 and object_id =37234
    and valid_to_ts ='9999-12-31'
)a where rank=1
)=true then true
when (
true
)=true then true
when count(*)>0 then false else true end as cdc_first_time from nabu.advanced_options_obj_checkpoint
where data_movement_id =261
and source_dataplace_id = 42 
and object_id =37234
and advanced_option_obj_type_id =8
and valid_to_ts ='9999-12-31'
""2023-11-15 16:41:12.671 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query :  select decoded_expression|| ' as ' || column_name || '' as spark_expression from
(
    select *,lower(convert_from(decode(spark_sql_expression,'base64'), 'UTF8')) as decoded_expression from
	(
	    SELECT (jsonarray ->>'column_name')::text as column_name,(jsonarray ->>'column_type')::text as column_type,(jsonarray ->>'spark_sql_expression')::text as spark_sql_expression
	from
	(   select json_array_elements(('[
]')) :: json as jsonarray
		from nabu.advanced_options_object_details
		where data_movement_id =261 and object_id=37234 and valid_to_ts ='9999-12-31')a)b)c

""2023-11-15 16:41:12.865 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select 'null' 
""2023-11-15 16:41:13.072 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query :  INSERT INTO nabu.process_id_table_map (data_movement_id, process_id, object_id, process_started_ts, batch_id, batch_name) VALUES
 (261, 17000664381264241, 37234, current_timestamp, 17000664380239952, 'Ingestion_20231115')
 
""2023-11-15 16:41:13.250 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with get_compute_engine_id as (
select compute_engine_id,0 as retry_attempt from nabu.data_movement_physical dmp
where data_movement_id = 261 and valid_to_ts = '9999-12-31 00:00:00.000'
),
get_max_priority_number as (
select cescd.compute_engine_id, max(spark_configuration_priority_number) as max_priority_number
from nabu.compute_engine_spark_config_details cescd
inner join get_compute_engine_id gcei
on cescd.compute_engine_id = gcei.compute_engine_id
where valid_to_ts = '9999-12-31 00:00:00.000'
group by cescd.compute_engine_id
),
get_priority_number as (
select gmpn.compute_engine_id,
case when gmpn.max_priority_number  >  gcei.retry_attempt then gcei.retry_attempt+1 else gmpn.max_priority_number end as priority_number
from get_max_priority_number gmpn, get_compute_engine_id gcei
),
extra_configs as(
select cescd.compute_engine_id, cescd.spark_configuration_type_id,cescd.spark_configuration_priority_json as config_json, cescd.spark_configuration_priority_json->>'default_configs' as spark_configs_json,
(cescd.spark_configuration_priority_json->>'default_configs')::json->>'fetch_size' as fetch_size,
(cescd.spark_configuration_priority_json->>'default_configs')::json->>'solr_batch_size' as solr_batch_size,
(cescd.spark_configuration_priority_json->>'default_configs')::json->>'cluster_name' as cluster_id,
cescd.spark_configuration_priority_json->>'extra_configs' as extra_configs
from nabu.compute_engine_spark_config_details cescd
inner join get_priority_number gpn
on cescd.compute_engine_id = gpn.compute_engine_id
and cescd.spark_configuration_priority_number = gpn.priority_number
where cescd.valid_to_ts = '9999-12-31 00:00:00.000'
)
select compute_engine_id,cluster_id, config_json, spark_configuration_type_id, spark_configs_json,(concat('{"spark.nabu.fetch_size": "',fetch_size ,'", "spark.nabu.solr_batch_size": "', solr_batch_size,'"}')::jsonb || extra_configs::jsonb) ::json as extra_configs_json from extra_configs
""2023-11-15 16:41:13.421 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : {
    "solr_batch_size":"10000","parallel_threads":"10","fetch_size":"10000"
    }
""2023-11-15 16:41:13.613 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select '{"spark.nabu.fetch_size": "10000", "spark.nabu.solr_batch_size": "10000"}' ::jsonb
  || '{
    "spark.nabu.compute_engine":"azure_databricks",
    "spark.nabu.compute_engine_libs_path":"/dbfs/tmp/dev-v3-1-2-0/nabu/17000664381264241/0/application.conf",
    "spark.driver.nabu_privateKey":"/dbfs/tmp/dev-v3-1-2-0/nabu/17000664381264241/0/privateKey",
    "spark.nabu.application_name":"nabu-sparkbot-ingestion",
    "spark.driver.source_aws_endPoint": "s3.amazonaws.com",
    "spark.driver.target_aws_endPoint": "s3.amazonaws.com"
}'::jsonb
 as configs_json
""2023-11-15 16:41:14.120 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : {
"extraConfigMap": {"spark.nabu.fetch_size": "10000", "spark.nabu.compute_engine": "azure_databricks", "spark.nabu.solr_batch_size": "10000", "spark.nabu.application_name": "nabu-sparkbot-ingestion", "spark.driver.nabu_privateKey": "/dbfs/tmp/dev-v3-1-2-0/nabu/17000664381264241/0/privateKey", "spark.driver.source_aws_endPoint": "s3.amazonaws.com", "spark.driver.target_aws_endPoint": "s3.amazonaws.com", "spark.nabu.compute_engine_libs_path": "/dbfs/tmp/dev-v3-1-2-0/nabu/17000664381264241/0/application.conf"}
}
""2023-11-15 16:41:14.312 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with fetch_ssh_configuration as (
select b.credential_id as spark_credential_id,(b.additional_info ->> 'hive_credential_id')::int as metastore_credential_id
      from nabu.data_movement_physical a
inner join nabu.compute_engine b on a.compute_engine_id = b.compute_engine_id
inner join nabu.config c on  b.compute_engine_config_id = c.config_id
where a.data_movement_id =261
and a.valid_to_ts ='9999-12-31'
 and b.valid_to_ts ='9999-12-31'
)
select fsc.spark_credential_id,fsc.metastore_credential_id,ci.credential_type_id ,ctl.credential_type,fsc.spark_credential_id||'_'||extract(epoch from mod_ts::timestamp(0)) as credential_pattern ,
(select credential_type_id from nabu.credential_info ci2 where ci2.credential_id = fsc.metastore_credential_id) as metastore_credential_type_id
from fetch_ssh_configuration fsc
inner join nabu.credential_info ci on fsc.spark_credential_id=ci.credential_id
inner join nabu.credential_type_lookup ctl  on ci.credential_type_id =ctl.credential_type_id;
""2023-11-15 16:41:14.507 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDY2NDU3NzgzNDI0MCwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0OTI1OCwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2NjQ1N30.cgEzDcSlWhMY65PdNscgXY1oBYM75LZUbp00acf6_d1WRUOrXXGi5pcvwkRNDv0JIxun7nmcSCqy2CKZ38-eHnEqqAoxh2CIRwXTdBlsYYFyfkXHYapfaXinAi82pkDk0yJQOs-m-vAf1cbV4ue4Zk6bHKbJeu_j5_x8HU3PKeF0pz0lA-tpeoFRlq_tLUXqApH5t7QuTIzOSq7Aujo6yOSm_inHTBzTWxUyVaBCitbKs_j3Oq-P5c-Y5W3r9oAvDNbMASikxmdxfJBp_rI2QYHdxazW9UvVh_ZpRPwOIbi7EAe9-B6BBxAxItPBTo4M-GFi-zvZZXXYMX57edoRDA
""2023-11-15 16:41:14.694 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : {
  "credential_id": "41",
  "credential_type_id": "15",
  "credential_type": "File Content",
  "token": "c6950582a12b558ab648cdb72008173b2e8428fb55daad74015225691eec78ee7b5c4e34312ded70ae5e7ee483b7d7ea0c23e24e458ed1f54da3ccd7dbcfe870a61e5c9c5087e7fb6dc16b6f8f5e4bede4c0e03b3db6afa7b729cb9bca8103cbe4b1bcd2bc5b32c24827fdf91c8c11cf36bf5171a9962c1ca54f8ec842067a848b923c69d299c6b7524c0954293040309a1f8fd39f782d1bd8643f32a65fa357056ebdf0d549e20f0f1a056e812638234a4f55e0597f06ae7f4700645c0f2d879a02d5524ea234c20d9eef46d15fedba5bf95e6bb830facdcaae1706fca6180bdb0035a93e24d5754f7d2f8c3358bbabcb5c9f2ddba0aa998cf99cd18cc9e918c0c97c981efec3efb72b5cb55700cb1e8299307b288a784b806b8493367544de99739f24a96454ee719210ebd273e3436a42584280a230609c3a56b7de66aaadd4ee0657d4575bb6920012fbfedb66af244d519925fc3e44af2f4ba674dc33bc2ee4db2f4aff3e9ebd4ea65a1676adac8f4a06479e8a4547eee8e4e2c39b015bd7f814c388c0551d3f22afd121bdfcef969cd71d6b7b350be1761d59b65032ccdbda718686605aa8f4750fc2728593d92d9adf5f84ed53a079d609d0762d54d70245fb2ef2249357978b34220a1c8c45322ef4dedac114a8c96a559d3aec32f3e613fa8eeaff028a837bb12ab0ec6254018106c654ecb783d4ed33390dc68ad83be8eb88e3b714c40532209942376690930f7d748e1a4b19749466350993b2e5b42db4522bca13a6a9c5d2633848df813d3077e7ba7805289fe046b50091995d46c07a0c81366671b74152b5b3f70bc8",
  "credential_endpoint_url": "http://dev-dha.humana.com:8889/fireshots/credentialsFetchWebService",
  "file_path": "1568_261_17000664380239952",
  "credential_file_pattern" : "41_1699342575"
}
""2023-11-15 16:41:14.874 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : {
"pipeline_timeout" : 23
}
""2023-11-15 16:41:15.063 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : {
  "credential_id": "",
  "credential_type_id": "",
  "token": "c6950582a12b558ab648cdb72008173b2e8428fb55daad74015225691eec78ee7b5c4e34312ded70ae5e7ee483b7d7ea0c23e24e458ed1f54da3ccd7dbcfe870a61e5c9c5087e7fb6dc16b6f8f5e4bede4c0e03b3db6afa7b729cb9bca8103cbe4b1bcd2bc5b32c24827fdf91c8c11cf36bf5171a9962c1ca54f8ec842067a848b923c69d299c6b7524c0954293040309a1f8fd39f782d1bd8643f32a65fa357056ebdf0d549e20f0f1a056e812638234a4f55e0597f06ae7f4700645c0f2d879a02d5524ea234c20d9eef46d15fedba5bf95e6bb830facdcaae1706fca6180bdb0035a93e24d5754f7d2f8c3358bbabcb5c9f2ddba0aa998cf99cd18cc9e918c0c97c981efec3efb72b5cb55700cb1e8299307b288a784b806b8493367544de99739f24a96454ee719210ebd273e3436a42584280a230609c3a56b7de66aaadd4ee0657d4575bb6920012fbfedb66af244d519925fc3e44af2f4ba674dc33bc2ee4db2f4aff3e9ebd4ea65a1676adac8f4a06479e8a4547eee8e4e2c39b015bd7f814c388c0551d3f22afd121bdfcef969cd71d6b7b350be1761d59b65032ccdbda718686605aa8f4750fc2728593d92d9adf5f84ed53a079d609d0762d54d70245fb2ef2249357978b34220a1c8c45322ef4dedac114a8c96a559d3aec32f3e613fa8eeaff028a837bb12ab0ec6254018106c654ecb783d4ed33390dc68ad83be8eb88e3b714c40532209942376690930f7d748e1a4b19749466350993b2e5b42db4522bca13a6a9c5d2633848df813d3077e7ba7805289fe046b50091995d46c07a0c81366671b74152b5b3f70bc8",
  "credential_endpoint_url": "http://dev-dha.humana.com:8889/fireshots/credentialsFetchWebService"
}
""2023-11-15 16:41:15.296 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : {
  "sourceCredentials": {
    "token": "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDY2NDU3NzgzNDI0MCwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0OTI1OCwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2NjQ1N30.cgEzDcSlWhMY65PdNscgXY1oBYM75LZUbp00acf6_d1WRUOrXXGi5pcvwkRNDv0JIxun7nmcSCqy2CKZ38-eHnEqqAoxh2CIRwXTdBlsYYFyfkXHYapfaXinAi82pkDk0yJQOs-m-vAf1cbV4ue4Zk6bHKbJeu_j5_x8HU3PKeF0pz0lA-tpeoFRlq_tLUXqApH5t7QuTIzOSq7Aujo6yOSm_inHTBzTWxUyVaBCitbKs_j3Oq-P5c-Y5W3r9oAvDNbMASikxmdxfJBp_rI2QYHdxazW9UvVh_ZpRPwOIbi7EAe9-B6BBxAxItPBTo4M-GFi-zvZZXXYMX57edoRDA",
    "credential_id": 37 ,
    "credential_type_id": 1 ,
    "end_point": "http://dev-dha.humana.com:8889/fireshots/credentialsFetchWebService"
  },
  "targetCredentials":{
    "token": "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDY2NDU3NzgzNDI0MCwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0OTI1OCwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2NjQ1N30.cgEzDcSlWhMY65PdNscgXY1oBYM75LZUbp00acf6_d1WRUOrXXGi5pcvwkRNDv0JIxun7nmcSCqy2CKZ38-eHnEqqAoxh2CIRwXTdBlsYYFyfkXHYapfaXinAi82pkDk0yJQOs-m-vAf1cbV4ue4Zk6bHKbJeu_j5_x8HU3PKeF0pz0lA-tpeoFRlq_tLUXqApH5t7QuTIzOSq7Aujo6yOSm_inHTBzTWxUyVaBCitbKs_j3Oq-P5c-Y5W3r9oAvDNbMASikxmdxfJBp_rI2QYHdxazW9UvVh_ZpRPwOIbi7EAe9-B6BBxAxItPBTo4M-GFi-zvZZXXYMX57edoRDA",
    "credential_id": 2 ,
    "credential_type_id": 5 ,
    "end_point": "http://dev-dha.humana.com:8889/fireshots/credentialsFetchWebService"
  }  }
""2023-11-15 16:41:15.481 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : ewogICJzb3VyY2VDcmVkZW50aWFscyI6IHsKICAgICJ0b2tlbiI6ICJleUpoYkdjaU9pSlNVekkxTmlKOS5leUpwYzNNaU9pSkdTVkpGVTBoUFZGTmZRVkJRVEVsRFFWUkpUMDRpTENKelpYTnphVzl1WDJsa0lqb3hOekF3TURZMk5EVTNOemd6TkRJME1Dd2ljbVZ4ZFdWemRHVmtYM1Z6WlhKZmFXUWlPaUpOWVc1aGMzZHBibWtnUTJocGJuUm9ZV3hoY0hWa2FTSXNJbVY0Y0NJNk1UY3dNREUwT1RJMU9Dd2lkWE5sY2tsa0lqb2lZbTkwY3kxemNuWXRZV05qYjNWdWRDSXNJbWxoZENJNk1UY3dNREEyTmpRMU4zMC5jZ0V6RGNTbFdoTVk2NVBkTnNjZ1hZMW9CWU03NUxaVWJwMDBhY2Y2X2QxV1JVT3JYWEdpNXBjdndrUk5EdjBKSXh1bjdubWNTQ3F5MkNLWjM4LWVIbkVxcUFveGgyQ0lSd1hUZEJsc1lZRnlma1hIWWFwZmFYaW5BaTgycGtEazB5SlFPcy1tLXZBZjFjYlY0dWU0Wms2YkhLYkpldV9qNV94OEhVM1BLZUYwcHowbEEtdHBlb0ZSbHFfdExVWHFBcEg1dDdRdVRJek9TcTdBdWpvNnlPU21faW5IVEJ6VFd4VXlWYUJDaXRiS3NfajNPcS1QNWMtWTVXM3I5b0F2RE5iTUFTaWt4bWR4ZkpCcF9ySTJRWUhkeGF6VzlVdlZoX1pwUlB3T0liaTdFQWU5LUI2QkJ4QXhJdFBCVG80TS1HRmktenZaWlhYWU1YNTdlZG9SREEiLAogICAgImNyZWRlbnRpYWxfaWQiOiAzNyAsCiAgICAiY3JlZGVudGlhbF90eXBlX2lkIjogMSAsCiAgICAiZW5kX3BvaW50IjogImh0dHA6Ly9kZXYtZGhhLmh1bWFuYS5jb206ODg4OS9maXJlc2hvdHMvY3JlZGVudGlhbHNGZXRjaFdlYlNlcnZpY2UiCiAgfSwKICAidGFyZ2V0Q3JlZGVudGlhbHMiOnsKICAgICJ0b2tlbiI6ICJleUpoYkdjaU9pSlNVekkxTmlKOS5leUpwYzNNaU9pSkdTVkpGVTBoUFZGTmZRVkJRVEVsRFFWUkpUMDRpTENKelpYTnphVzl1WDJsa0lqb3hOekF3TURZMk5EVTNOemd6TkRJME1Dd2ljbVZ4ZFdWemRHVmtYM1Z6WlhKZmFXUWlPaUpOWVc1aGMzZHBibWtnUTJocGJuUm9ZV3hoY0hWa2FTSXNJbVY0Y0NJNk1UY3dNREUwT1RJMU9Dd2lkWE5sY2tsa0lqb2lZbTkwY3kxemNuWXRZV05qYjNWdWRDSXNJbWxoZENJNk1UY3dNREEyTmpRMU4zMC5jZ0V6RGNTbFdoTVk2NVBkTnNjZ1hZMW9CWU03NUxaVWJwMDBhY2Y2X2QxV1JVT3JYWEdpNXBjdndrUk5EdjBKSXh1bjdubWNTQ3F5MkNLWjM4LWVIbkVxcUFveGgyQ0lSd1hUZEJsc1lZRnlma1hIWWFwZmFYaW5BaTgycGtEazB5SlFPcy1tLXZBZjFjYlY0dWU0Wms2YkhLYkpldV9qNV94OEhVM1BLZUYwcHowbEEtdHBlb0ZSbHFfdExVWHFBcEg1dDdRdVRJek9TcTdBdWpvNnlPU21faW5IVEJ6VFd4VXlWYUJDaXRiS3NfajNPcS1QNWMtWTVXM3I5b0F2RE5iTUFTaWt4bWR4ZkpCcF9ySTJRWUhkeGF6VzlVdlZoX1pwUlB3T0liaTdFQWU5LUI2QkJ4QXhJdFBCVG80TS1HRmktenZaWlhYWU1YNTdlZG9SREEiLAogICAgImNyZWRlbnRpYWxfaWQiOiAyICwKICAgICJjcmVkZW50aWFsX3R5cGVfaWQiOiA1ICwKICAgICJlbmRfcG9pbnQiOiAiaHR0cDovL2Rldi1kaGEuaHVtYW5hLmNvbTo4ODg5L2ZpcmVzaG90cy9jcmVkZW50aWFsc0ZldGNoV2ViU2VydmljZSIKICB9ICB9
""2023-11-15 16:41:15.775 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : {
"processId":17000664381264241,
"dataplaceId":42,
"tableId":37234,
"datamovementId":261,
"jobScheduledUserId":"Manaswini Chinthalapudi",
"jobScheduleId":1568,
"batchId":17000664380239952,
"lastRunTimestamp":"2023-11-07 12:42:00.86365",
"retryNum": "0"
}
""2023-11-15 16:41:15.963 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : {
  "cluster_id": "0922-003138-orn9r0te",
  "cluster_region": "null",
  "compute_eng_creds_json": "ewogICJjcmVkZW50aWFsX2lkIjogIjQxIiwKICAiY3JlZGVudGlhbF90eXBlX2lkIjogIjE1IiwKICAiY3JlZGVudGlhbF90eXBlIjogIkZpbGUgQ29udGVudCIsCiAgInRva2VuIjogImM2OTUwNTgyYTEyYjU1OGFiNjQ4Y2RiNzIwMDgxNzNiMmU4NDI4ZmI1NWRhYWQ3NDAxNTIyNTY5MWVlYzc4ZWU3YjVjNGUzNDMxMmRlZDcwYWU1ZTdlZTQ4M2I3ZDdlYTBjMjNlMjRlNDU4ZWQxZjU0ZGEzY2NkN2RiY2ZlODcwYTYxZTVjOWM1MDg3ZTdmYjZkYzE2YjZmOGY1ZTRiZWRlNGMwZTAzYjNkYjZhZmE3YjcyOWNiOWJjYTgxMDNjYmU0YjFiY2QyYmM1YjMyYzI0ODI3ZmRmOTFjOGMxMWNmMzZiZjUxNzFhOTk2MmMxY2E1NGY4ZWM4NDIwNjdhODQ4YjkyM2M2OWQyOTljNmI3NTI0YzA5NTQyOTMwNDAzMDlhMWY4ZmQzOWY3ODJkMWJkODY0M2YzMmE2NWZhMzU3MDU2ZWJkZjBkNTQ5ZTIwZjBmMWEwNTZlODEyNjM4MjM0YTRmNTVlMDU5N2YwNmFlN2Y0NzAwNjQ1YzBmMmQ4NzlhMDJkNTUyNGVhMjM0YzIwZDllZWY0NmQxNWZlZGJhNWJmOTVlNmJiODMwZmFjZGNhYWUxNzA2ZmNhNjE4MGJkYjAwMzVhOTNlMjRkNTc1NGY3ZDJmOGMzMzU4YmJhYmNiNWM5ZjJkZGJhMGFhOTk4Y2Y5OWNkMThjYzllOTE4YzBjOTdjOTgxZWZlYzNlZmI3MmI1Y2I1NTcwMGNiMWU4Mjk5MzA3YjI4OGE3ODRiODA2Yjg0OTMzNjc1NDRkZTk5NzM5ZjI0YTk2NDU0ZWU3MTkyMTBlYmQyNzNlMzQzNmE0MjU4NDI4MGEyMzA2MDljM2E1NmI3ZGU2NmFhYWRkNGVlMDY1N2Q0NTc1YmI2OTIwMDEyZmJmZWRiNjZhZjI0NGQ1MTk5MjVmYzNlNDRhZjJmNGJhNjc0ZGMzM2JjMmVlNGRiMmY0YWZmM2U5ZWJkNGVhNjVhMTY3NmFkYWM4ZjRhMDY0NzllOGE0NTQ3ZWVlOGU0ZTJjMzliMDE1YmQ3ZjgxNGMzODhjMDU1MWQzZjIyYWZkMTIxYmRmY2VmOTY5Y2Q3MWQ2YjdiMzUwYmUxNzYxZDU5YjY1MDMyY2NkYmRhNzE4Njg2NjA1YWE4ZjQ3NTBmYzI3Mjg1OTNkOTJkOWFkZjVmODRlZDUzYTA3OWQ2MDlkMDc2MmQ1NGQ3MDI0NWZiMmVmMjI0OTM1Nzk3OGIzNDIyMGExYzhjNDUzMjJlZjRkZWRhYzExNGE4Yzk2YTU1OWQzYWVjMzJmM2U2MTNmYThlZWFmZjAyOGE4MzdiYjEyYWIwZWM2MjU0MDE4MTA2YzY1NGVjYjc4M2Q0ZWQzMzM5MGRjNjhhZDgzYmU4ZWI4OGUzYjcxNGM0MDUzMjIwOTk0MjM3NjY5MDkzMGY3ZDc0OGUxYTRiMTk3NDk0NjYzNTA5OTNiMmU1YjQyZGI0NTIyYmNhMTNhNmE5YzVkMjYzMzg0OGRmODEzZDMwNzdlN2JhNzgwNTI4OWZlMDQ2YjUwMDkxOTk1ZDQ2YzA3YTBjODEzNjY2NzFiNzQxNTJiNWIzZjcwYmM4IiwKICAiY3JlZGVudGlhbF9lbmRwb2ludF91cmwiOiAiaHR0cDovL2Rldi1kaGEuaHVtYW5hLmNvbTo4ODg5L2ZpcmVzaG90cy9jcmVkZW50aWFsc0ZldGNoV2ViU2VydmljZSIsCiAgImZpbGVfcGF0aCI6ICIxNTY4XzI2MV8xNzAwMDY2NDM4MDIzOTk1MiIsCiAgImNyZWRlbnRpYWxfZmlsZV9wYXR0ZXJuIiA6ICI0MV8xNjk5MzQyNTc1Igp9",
  "s3_path": "",
  "b64_input_json": "ewoicHJvY2Vzc0lkIjoxNzAwMDY2NDM4MTI2NDI0MSwKImRhdGFwbGFjZUlkIjo0MiwKInRhYmxlSWQiOjM3MjM0LAoiZGF0YW1vdmVtZW50SWQiOjI2MSwKImpvYlNjaGVkdWxlZFVzZXJJZCI6Ik1hbmFzd2luaSBDaGludGhhbGFwdWRpIiwKImpvYlNjaGVkdWxlSWQiOjE1NjgsCiJiYXRjaElkIjoxNzAwMDY2NDM4MDIzOTk1MiwKImxhc3RSdW5UaW1lc3RhbXAiOiIyMDIzLTExLTA3IDEyOjQyOjAwLjg2MzY1IiwKInJldHJ5TnVtIjogIjAiCn0=",
  "extra_config": "ewoiZXh0cmFDb25maWdNYXAiOiB7InNwYXJrLm5hYnUuZmV0Y2hfc2l6ZSI6ICIxMDAwMCIsICJzcGFyay5uYWJ1LmNvbXB1dGVfZW5naW5lIjogImF6dXJlX2RhdGFicmlja3MiLCAic3BhcmsubmFidS5zb2xyX2JhdGNoX3NpemUiOiAiMTAwMDAiLCAic3BhcmsubmFidS5hcHBsaWNhdGlvbl9uYW1lIjogIm5hYnUtc3Bhcmtib3QtaW5nZXN0aW9uIiwgInNwYXJrLmRyaXZlci5uYWJ1X3ByaXZhdGVLZXkiOiAiL2RiZnMvdG1wL2Rldi12My0xLTItMC9uYWJ1LzE3MDAwNjY0MzgxMjY0MjQxLzAvcHJpdmF0ZUtleSIsICJzcGFyay5kcml2ZXIuc291cmNlX2F3c19lbmRQb2ludCI6ICJzMy5hbWF6b25hd3MuY29tIiwgInNwYXJrLmRyaXZlci50YXJnZXRfYXdzX2VuZFBvaW50IjogInMzLmFtYXpvbmF3cy5jb20iLCAic3BhcmsubmFidS5jb21wdXRlX2VuZ2luZV9saWJzX3BhdGgiOiAiL2RiZnMvdG1wL2Rldi12My0xLTItMC9uYWJ1LzE3MDAwNjY0MzgxMjY0MjQxLzAvYXBwbGljYXRpb24uY29uZiJ9Cn0=",
  "batch_id": 17000664380239952,
  "retry_num": "0",
  "spark_configs": "ewogICAgInNvbHJfYmF0Y2hfc2l6ZSI6IjEwMDAwIiwicGFyYWxsZWxfdGhyZWFkcyI6IjEwIiwiZmV0Y2hfc2l6ZSI6IjEwMDAwIgogICAgfQ==",
  "is_bucket_encrypted": "",
  "b64_external_jars_map" : ""
}
""2023-11-15 16:41:16.145 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : {
"cluster_id": "",
"b64_input_json": "ewoicHJvY2Vzc0lkIjoxNzAwMDY2NDM4MTI2NDI0MSwKImRhdGFwbGFjZUlkIjo0MiwKInRhYmxlSWQiOjM3MjM0LAoiZGF0YW1vdmVtZW50SWQiOjI2MSwKImpvYlNjaGVkdWxlZFVzZXJJZCI6Ik1hbmFzd2luaSBDaGludGhhbGFwdWRpIiwKImpvYlNjaGVkdWxlSWQiOjE1NjgsCiJiYXRjaElkIjoxNzAwMDY2NDM4MDIzOTk1MiwKImxhc3RSdW5UaW1lc3RhbXAiOiIyMDIzLTExLTA3IDEyOjQyOjAwLjg2MzY1IiwKInJldHJ5TnVtIjogIjAiCn0=",
"extra_config": "ewoiZXh0cmFDb25maWdNYXAiOiB7InNwYXJrLm5hYnUuZmV0Y2hfc2l6ZSI6ICIxMDAwMCIsICJzcGFyay5uYWJ1LmNvbXB1dGVfZW5naW5lIjogImF6dXJlX2RhdGFicmlja3MiLCAic3BhcmsubmFidS5zb2xyX2JhdGNoX3NpemUiOiAiMTAwMDAiLCAic3BhcmsubmFidS5hcHBsaWNhdGlvbl9uYW1lIjogIm5hYnUtc3Bhcmtib3QtaW5nZXN0aW9uIiwgInNwYXJrLmRyaXZlci5uYWJ1X3ByaXZhdGVLZXkiOiAiL2RiZnMvdG1wL2Rldi12My0xLTItMC9uYWJ1LzE3MDAwNjY0MzgxMjY0MjQxLzAvcHJpdmF0ZUtleSIsICJzcGFyay5kcml2ZXIuc291cmNlX2F3c19lbmRQb2ludCI6ICJzMy5hbWF6b25hd3MuY29tIiwgInNwYXJrLmRyaXZlci50YXJnZXRfYXdzX2VuZFBvaW50IjogInMzLmFtYXpvbmF3cy5jb20iLCAic3BhcmsubmFidS5jb21wdXRlX2VuZ2luZV9saWJzX3BhdGgiOiAiL2RiZnMvdG1wL2Rldi12My0xLTItMC9uYWJ1LzE3MDAwNjY0MzgxMjY0MjQxLzAvYXBwbGljYXRpb24uY29uZiJ9Cn0=",
"compute_eng_creds_json" : "ewogICJjcmVkZW50aWFsX2lkIjogIjQxIiwKICAiY3JlZGVudGlhbF90eXBlX2lkIjogIjE1IiwKICAiY3JlZGVudGlhbF90eXBlIjogIkZpbGUgQ29udGVudCIsCiAgInRva2VuIjogImM2OTUwNTgyYTEyYjU1OGFiNjQ4Y2RiNzIwMDgxNzNiMmU4NDI4ZmI1NWRhYWQ3NDAxNTIyNTY5MWVlYzc4ZWU3YjVjNGUzNDMxMmRlZDcwYWU1ZTdlZTQ4M2I3ZDdlYTBjMjNlMjRlNDU4ZWQxZjU0ZGEzY2NkN2RiY2ZlODcwYTYxZTVjOWM1MDg3ZTdmYjZkYzE2YjZmOGY1ZTRiZWRlNGMwZTAzYjNkYjZhZmE3YjcyOWNiOWJjYTgxMDNjYmU0YjFiY2QyYmM1YjMyYzI0ODI3ZmRmOTFjOGMxMWNmMzZiZjUxNzFhOTk2MmMxY2E1NGY4ZWM4NDIwNjdhODQ4YjkyM2M2OWQyOTljNmI3NTI0YzA5NTQyOTMwNDAzMDlhMWY4ZmQzOWY3ODJkMWJkODY0M2YzMmE2NWZhMzU3MDU2ZWJkZjBkNTQ5ZTIwZjBmMWEwNTZlODEyNjM4MjM0YTRmNTVlMDU5N2YwNmFlN2Y0NzAwNjQ1YzBmMmQ4NzlhMDJkNTUyNGVhMjM0YzIwZDllZWY0NmQxNWZlZGJhNWJmOTVlNmJiODMwZmFjZGNhYWUxNzA2ZmNhNjE4MGJkYjAwMzVhOTNlMjRkNTc1NGY3ZDJmOGMzMzU4YmJhYmNiNWM5ZjJkZGJhMGFhOTk4Y2Y5OWNkMThjYzllOTE4YzBjOTdjOTgxZWZlYzNlZmI3MmI1Y2I1NTcwMGNiMWU4Mjk5MzA3YjI4OGE3ODRiODA2Yjg0OTMzNjc1NDRkZTk5NzM5ZjI0YTk2NDU0ZWU3MTkyMTBlYmQyNzNlMzQzNmE0MjU4NDI4MGEyMzA2MDljM2E1NmI3ZGU2NmFhYWRkNGVlMDY1N2Q0NTc1YmI2OTIwMDEyZmJmZWRiNjZhZjI0NGQ1MTk5MjVmYzNlNDRhZjJmNGJhNjc0ZGMzM2JjMmVlNGRiMmY0YWZmM2U5ZWJkNGVhNjVhMTY3NmFkYWM4ZjRhMDY0NzllOGE0NTQ3ZWVlOGU0ZTJjMzliMDE1YmQ3ZjgxNGMzODhjMDU1MWQzZjIyYWZkMTIxYmRmY2VmOTY5Y2Q3MWQ2YjdiMzUwYmUxNzYxZDU5YjY1MDMyY2NkYmRhNzE4Njg2NjA1YWE4ZjQ3NTBmYzI3Mjg1OTNkOTJkOWFkZjVmODRlZDUzYTA3OWQ2MDlkMDc2MmQ1NGQ3MDI0NWZiMmVmMjI0OTM1Nzk3OGIzNDIyMGExYzhjNDUzMjJlZjRkZWRhYzExNGE4Yzk2YTU1OWQzYWVjMzJmM2U2MTNmYThlZWFmZjAyOGE4MzdiYjEyYWIwZWM2MjU0MDE4MTA2YzY1NGVjYjc4M2Q0ZWQzMzM5MGRjNjhhZDgzYmU4ZWI4OGUzYjcxNGM0MDUzMjIwOTk0MjM3NjY5MDkzMGY3ZDc0OGUxYTRiMTk3NDk0NjYzNTA5OTNiMmU1YjQyZGI0NTIyYmNhMTNhNmE5YzVkMjYzMzg0OGRmODEzZDMwNzdlN2JhNzgwNTI4OWZlMDQ2YjUwMDkxOTk1ZDQ2YzA3YTBjODEzNjY2NzFiNzQxNTJiNWIzZjcwYmM4IiwKICAiY3JlZGVudGlhbF9lbmRwb2ludF91cmwiOiAiaHR0cDovL2Rldi1kaGEuaHVtYW5hLmNvbTo4ODg5L2ZpcmVzaG90cy9jcmVkZW50aWFsc0ZldGNoV2ViU2VydmljZSIsCiAgImZpbGVfcGF0aCI6ICIxNTY4XzI2MV8xNzAwMDY2NDM4MDIzOTk1MiIsCiAgImNyZWRlbnRpYWxfZmlsZV9wYXR0ZXJuIiA6ICI0MV8xNjk5MzQyNTc1Igp9",
"cluster_ui": "",
"retry_num": "0",
"spark_configs": "ewogICAgInNvbHJfYmF0Y2hfc2l6ZSI6IjEwMDAwIiwicGFyYWxsZWxfdGhyZWFkcyI6IjEwIiwiZmV0Y2hfc2l6ZSI6IjEwMDAwIgogICAgfQ==",
"b64_hive_creds_json": "ewogICJjcmVkZW50aWFsX2lkIjogIiIsCiAgImNyZWRlbnRpYWxfdHlwZV9pZCI6ICIiLAogICJ0b2tlbiI6ICJjNjk1MDU4MmExMmI1NThhYjY0OGNkYjcyMDA4MTczYjJlODQyOGZiNTVkYWFkNzQwMTUyMjU2OTFlZWM3OGVlN2I1YzRlMzQzMTJkZWQ3MGFlNWU3ZWU0ODNiN2Q3ZWEwYzIzZTI0ZTQ1OGVkMWY1NGRhM2NjZDdkYmNmZTg3MGE2MWU1YzljNTA4N2U3ZmI2ZGMxNmI2ZjhmNWU0YmVkZTRjMGUwM2IzZGI2YWZhN2I3MjljYjliY2E4MTAzY2JlNGIxYmNkMmJjNWIzMmMyNDgyN2ZkZjkxYzhjMTFjZjM2YmY1MTcxYTk5NjJjMWNhNTRmOGVjODQyMDY3YTg0OGI5MjNjNjlkMjk5YzZiNzUyNGMwOTU0MjkzMDQwMzA5YTFmOGZkMzlmNzgyZDFiZDg2NDNmMzJhNjVmYTM1NzA1NmViZGYwZDU0OWUyMGYwZjFhMDU2ZTgxMjYzODIzNGE0ZjU1ZTA1OTdmMDZhZTdmNDcwMDY0NWMwZjJkODc5YTAyZDU1MjRlYTIzNGMyMGQ5ZWVmNDZkMTVmZWRiYTViZjk1ZTZiYjgzMGZhY2RjYWFlMTcwNmZjYTYxODBiZGIwMDM1YTkzZTI0ZDU3NTRmN2QyZjhjMzM1OGJiYWJjYjVjOWYyZGRiYTBhYTk5OGNmOTljZDE4Y2M5ZTkxOGMwYzk3Yzk4MWVmZWMzZWZiNzJiNWNiNTU3MDBjYjFlODI5OTMwN2IyODhhNzg0YjgwNmI4NDkzMzY3NTQ0ZGU5OTczOWYyNGE5NjQ1NGVlNzE5MjEwZWJkMjczZTM0MzZhNDI1ODQyODBhMjMwNjA5YzNhNTZiN2RlNjZhYWFkZDRlZTA2NTdkNDU3NWJiNjkyMDAxMmZiZmVkYjY2YWYyNDRkNTE5OTI1ZmMzZTQ0YWYyZjRiYTY3NGRjMzNiYzJlZTRkYjJmNGFmZjNlOWViZDRlYTY1YTE2NzZhZGFjOGY0YTA2NDc5ZThhNDU0N2VlZThlNGUyYzM5YjAxNWJkN2Y4MTRjMzg4YzA1NTFkM2YyMmFmZDEyMWJkZmNlZjk2OWNkNzFkNmI3YjM1MGJlMTc2MWQ1OWI2NTAzMmNjZGJkYTcxODY4NjYwNWFhOGY0NzUwZmMyNzI4NTkzZDkyZDlhZGY1Zjg0ZWQ1M2EwNzlkNjA5ZDA3NjJkNTRkNzAyNDVmYjJlZjIyNDkzNTc5NzhiMzQyMjBhMWM4YzQ1MzIyZWY0ZGVkYWMxMTRhOGM5NmE1NTlkM2FlYzMyZjNlNjEzZmE4ZWVhZmYwMjhhODM3YmIxMmFiMGVjNjI1NDAxODEwNmM2NTRlY2I3ODNkNGVkMzMzOTBkYzY4YWQ4M2JlOGViODhlM2I3MTRjNDA1MzIyMDk5NDIzNzY2OTA5MzBmN2Q3NDhlMWE0YjE5NzQ5NDY2MzUwOTkzYjJlNWI0MmRiNDUyMmJjYTEzYTZhOWM1ZDI2MzM4NDhkZjgxM2QzMDc3ZTdiYTc4MDUyODlmZTA0NmI1MDA5MTk5NWQ0NmMwN2EwYzgxMzY2NjcxYjc0MTUyYjViM2Y3MGJjOCIsCiAgImNyZWRlbnRpYWxfZW5kcG9pbnRfdXJsIjogImh0dHA6Ly9kZXYtZGhhLmh1bWFuYS5jb206ODg4OS9maXJlc2hvdHMvY3JlZGVudGlhbHNGZXRjaFdlYlNlcnZpY2UiCn0=",
"batch_id":17000664380239952,
"process_id" :17000664381264241,
"rest_url": "",
"b64_external_jars_map" : ""
}
""2023-11-15 16:41:16.331 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : 

import scala.util.{Try, Failure, Success}
import org.apache.log4j.{Level, Logger, LogManager}
import com.modak.common._
import com.modak.common.authenticateCredentials._
import com.modak.common.advanceTableOptions._
import com.modak.common.token._
import com.modak.common.token.Token._
import com.modak.checkpoint._
import com.modak.utils._
import io.circe.generic.auto._
import io.circe.syntax._
import org.apache.spark.sql._
import org.apache.spark.sql.functions._
import org.apache.spark.storage._
import org.apache.spark.sql.SaveMode
import com.modak.partitionUtils.HashPartitionJDBCUtils
import scala.collection.JavaConverters._
import java.util
import com.github.music.of.the.ainur.almaren.builder.Core.Implicit
import com.github.music.of.the.ainur.almaren.Almaren
import com.modak.common.curation._
    val logger = LogManager.getLogger("com.Artifact")
    logger.setLevel(Level.INFO)
    val almaren = Almaren("nabu-sparkbot-ingestion")
    val spark = almaren.spark.getOrCreate()
    spark.conf.set("spark.driver.nabu_credentials", "rO0ABXVyAAJbQqzzF/gGCFTgAgAAeHAAAAEAVy+9AQow7FXoD3z0ooJjPC+HrI5N52yIITSaL9yRvE3fFebDEBpUbP1qvJhLwLTo+6fqeYvorPcJGHVOzB+Iqo+4m/AMDDiIgWaXz5hy8QfjV7PwWwarCUa5mj+NtOgTKwyw4WNnFcphnkE34tLJad1s2vF1qQHUgOCtysAB0fD2JA5BeEsUprhbts03GzeY8OCgy0kqiYHEoKRaS8cBWUQ81oeyo7fW8mdSsKVpY8wi3b2npBin83TSMAUXtFbeCjOOr7HC/3DMYHQUM5xaZCNH7zeYWSMgAlTn1c+y42/1lX0UE1c2qtplYC8Ky+yYikmWcrfsLOy5xJEB7L+KRHVxAH4AAAAAA5BHFNPNX+74skXzppe3RfD/xrCll8g7yP06oIux1cYJaH6Z7Tz988miRj5z+4nzKfiAIw+MdVKnOwsvawBMOpAR/WDGsqWEKC7EsNrjsBFm1HQ5tPFHcClV0HYlKZR5ejgDCOvBGBZ/tQsIzKYl+dX92uH4Lgcbr9ns5Yi5CM3R0+q/Z+5xzabCGcz54a7EjH1zT9y0wYp17VgEW9nccBtkkCmXJgDD1tijNxwK7I61N36cNTaMdQR71U1npaMyzuT0dQ6kgrputCx75rpIMsDwEkYi9ay/LBgamfQiKPa7SDIzBjv5OgCrfU15BWr0OMRFAbu4rLF8s8PO9BrKQrA3JOsJwl8dQ47dhhJsDJgS8QAndbeJgjkT0Nsa18RE9pZ0HVVpSPhJR4aJvRlyFas6EOxbgVcPIrOgb9ahXBrFPblowqfD1iJ+z1brU00RxP/cbjwyZOf6WJvFUzQqzqVEUJyJC4np9grL7zrPsMO8lseQ45QZQ7uhSsDztsV3OrzFK+mqSUtrVQzmkABaHyutr4dz3mPa9QtcZCX/EshdwWwqf7+8WnuSwT40xMECKEL06BjuBZRtAPMhxX8Zo+eEA2mQmk2V2raRX0bluYFVsz2vnxcH1ntp9k/YgPZeGNWpUI/KQ/CbUjbX7NX1FV+63fmJT2SRWj32vCOBu4K8405WNQ82YRJmP0k/vMTeq/XfF0tguDEBT31ra0tTYcKCUqIZ0+wTBakLiFVEM1xj7A/u+7n7rsQkrKs31eNRo+2C8klBPjv6v/Ju0F9JbNJtqUiFOxlUq/wNRSm68xH6ZOFDG51BcZfxlkWvJOdvYoTVlylv67hH3pZgFK2GhXwl9Bhw6+eljQ+fP6eAncyFejNtvAuWGl5xf3ZgtPc/15c8rj2+DPRqcd+rv6M7oftuvIqGbs/gA1vDEbVVTT6J0TxEiEMpC0iYHmyAremaLDkBKWIns10eBeegTF1/bZ7yNWcDS6tX/0ensUmI5hLTA1tKsul7NuEjbU88KabhKtWknSmMnDix+feQ+D3yMuNIZroXqOeyDW+VkOpMNJNfrv5lPlVoiklns4VyGc/XasVA63bVnUxRtgVNwO1ZyyfAIe7F46dIakC1HAHHTkmPwSJe965Ty+pACqPLVvEtrHJtETL5CKW2spRW3SnmhGLdr4R01j/XFamcyFWvWmeSfwXG25kzHBrJN+5mGxFPFto=")
    spark.conf.set("spark.driver.nabu_privateKey", "/dbfs/tmp/dev-v3-1-2-0/nabu/17000664381264241/0/privateKey")
    spark.conf.set("spark.driver.nabu_inputjson", "ewoicHJvY2Vzc0lkIjoxNzAwMDY2NDM4MTI2NDI0MSwKImRhdGFwbGFjZUlkIjo0MiwKInRhYmxlSWQiOjM3MjM0LAoiZGF0YW1vdmVtZW50SWQiOjI2MSwKImpvYlNjaGVkdWxlZFVzZXJJZCI6Ik1hbmFzd2luaSBDaGludGhhbGFwdWRpIiwKImpvYlNjaGVkdWxlSWQiOjE1NjgsCiJiYXRjaElkIjoxNzAwMDY2NDM4MDIzOTk1MiwKImxhc3RSdW5UaW1lc3RhbXAiOiIyMDIzLTExLTA3IDEyOjQyOjAwLjg2MzY1IiwKInJldHJ5TnVtIjogIjAiCn0=")
    val inputJson = Token.parsedInputJson
    val datamovementId = inputJson.datamovementId
    val jobScheduleId = inputJson.jobScheduleId
    val jobScheduledUserId = inputJson.jobScheduledUserId
    val batchId = inputJson.batchId
    val processId = inputJson.processId
    val lastRunTimestamp = inputJson.lastRunTimestamp
    val pipelineName = "ss_compass_adb_validation"
    val pipelineRunTimestamp = "2023-11-15 16:40:42.694181"
    val pipelinesourceschemaname = "acuity-develop"
    val pipelinesourcdatabasename = "development-db"
    val pipelinesourcedatabasenamelowercase = "development-db"
    val pipelinesourceschemanamelowercase = "acuity-develop"
    val pipelinesourceschemanameuppercase = "ACUITY-DEVELOP"
    val pipelinesourcedatabasenameuppercase = "DEVELOPMENT-DB"


    val checkpoint = Checkpoint(inputJson.processId, inputJson.dataplaceId, None, None, Some(inputJson.datamovementId))
    checkpoint.startDataMovement(inputJson.tableId)
    val systemVarMap: util.HashMap[String, AnyRef] = new util.HashMap[String,AnyRef]
    systemVarMap.put("pipeline_id",datamovementId.toString)
    systemVarMap.put("pipeline_name",pipelineName)
    systemVarMap.put("pipeline_lastrun_ts",lastRunTimestamp)
    systemVarMap.put("pipeline_start_ts",pipelineRunTimestamp)
    systemVarMap.put("pipeline_run_id",batchId.toString)
    systemVarMap.put("source_schema_name",pipelinesourceschemaname)
    systemVarMap.put("source_database_name",pipelinesourcdatabasename)
    systemVarMap.put("source_database_name_lowercase",pipelinesourcedatabasenamelowercase)
    systemVarMap.put("source_schema_name_lowercase",pipelinesourceschemanamelowercase)
    systemVarMap.put("source_schema_name_uppercase",pipelinesourceschemanameuppercase)
    systemVarMap.put("source_database_name_uppercase",pipelinesourcedatabasenameuppercase)


    CurationJavaUtils.populateDateVariables(systemVarMap)
  Try {

    val localVarMap : util.HashMap[String, AnyRef] = new util.HashMap[String,AnyRef]
          Util.setUpSparkConfiguration(s"fs.azure.account.key.${AzureGen2.target("rO0ABXVyAAJbQqzzF/gGCFTgAgAAeHAAAAEAVy+9AQow7FXoD3z0ooJjPC+HrI5N52yIITSaL9yRvE3fFebDEBpUbP1qvJhLwLTo+6fqeYvorPcJGHVOzB+Iqo+4m/AMDDiIgWaXz5hy8QfjV7PwWwarCUa5mj+NtOgTKwyw4WNnFcphnkE34tLJad1s2vF1qQHUgOCtysAB0fD2JA5BeEsUprhbts03GzeY8OCgy0kqiYHEoKRaS8cBWUQ81oeyo7fW8mdSsKVpY8wi3b2npBin83TSMAUXtFbeCjOOr7HC/3DMYHQUM5xaZCNH7zeYWSMgAlTn1c+y42/1lX0UE1c2qtplYC8Ky+yYikmWcrfsLOy5xJEB7L+KRHVxAH4AAAAAA5BHFNPNX+74skXzppe3RfD/xrCll8g7yP06oIux1cYJaH6Z7Tz988miRj5z+4nzKfiAIw+MdVKnOwsvawBMOpAR/WDGsqWEKC7EsNrjsBFm1HQ5tPFHcClV0HYlKZR5ejgDCOvBGBZ/tQsIzKYl+dX92uH4Lgcbr9ns5Yi5CM3R0+q/Z+5xzabCGcz54a7EjH1zT9y0wYp17VgEW9nccBtkkCmXJgDD1tijNxwK7I61N36cNTaMdQR71U1npaMyzuT0dQ6kgrputCx75rpIMsDwEkYi9ay/LBgamfQiKPa7SDIzBjv5OgCrfU15BWr0OMRFAbu4rLF8s8PO9BrKQrA3JOsJwl8dQ47dhhJsDJgS8QAndbeJgjkT0Nsa18RE9pZ0HVVpSPhJR4aJvRlyFas6EOxbgVcPIrOgb9ahXBrFPblowqfD1iJ+z1brU00RxP/cbjwyZOf6WJvFUzQqzqVEUJyJC4np9grL7zrPsMO8lseQ45QZQ7uhSsDztsV3OrzFK+mqSUtrVQzmkABaHyutr4dz3mPa9QtcZCX/EshdwWwqf7+8WnuSwT40xMECKEL06BjuBZRtAPMhxX8Zo+eEA2mQmk2V2raRX0bluYFVsz2vnxcH1ntp9k/YgPZeGNWpUI/KQ/CbUjbX7NX1FV+63fmJT2SRWj32vCOBu4K8405WNQ82YRJmP0k/vMTeq/XfF0tguDEBT31ra0tTYcKCUqIZ0+wTBakLiFVEM1xj7A/u+7n7rsQkrKs31eNRo+2C8klBPjv6v/Ju0F9JbNJtqUiFOxlUq/wNRSm68xH6ZOFDG51BcZfxlkWvJOdvYoTVlylv67hH3pZgFK2GhXwl9Bhw6+eljQ+fP6eAncyFejNtvAuWGl5xf3ZgtPc/15c8rj2+DPRqcd+rv6M7oftuvIqGbs/gA1vDEbVVTT6J0TxEiEMpC0iYHmyAremaLDkBKWIns10eBeegTF1/bZ7yNWcDS6tX/0ensUmI5hLTA1tKsul7NuEjbU88KabhKtWknSmMnDix+feQ+D3yMuNIZroXqOeyDW+VkOpMNJNfrv5lPlVoiklns4VyGc/XasVA63bVnUxRtgVNwO1ZyyfAIe7F46dIakC1HAHHTkmPwSJe965Ty+pACqPLVvEtrHJtETL5CKW2spRW3SnmhGLdr4R01j/XFamcyFWvWmeSfwXG25kzHBrJN+5mGxFPFto=","/dbfs/tmp/dev-v3-1-2-0/nabu/17000664381264241/0/privateKey").accountname}.dfs.core.windows.net", AzureGen2.target("rO0ABXVyAAJbQqzzF/gGCFTgAgAAeHAAAAEAVy+9AQow7FXoD3z0ooJjPC+HrI5N52yIITSaL9yRvE3fFebDEBpUbP1qvJhLwLTo+6fqeYvorPcJGHVOzB+Iqo+4m/AMDDiIgWaXz5hy8QfjV7PwWwarCUa5mj+NtOgTKwyw4WNnFcphnkE34tLJad1s2vF1qQHUgOCtysAB0fD2JA5BeEsUprhbts03GzeY8OCgy0kqiYHEoKRaS8cBWUQ81oeyo7fW8mdSsKVpY8wi3b2npBin83TSMAUXtFbeCjOOr7HC/3DMYHQUM5xaZCNH7zeYWSMgAlTn1c+y42/1lX0UE1c2qtplYC8Ky+yYikmWcrfsLOy5xJEB7L+KRHVxAH4AAAAAA5BHFNPNX+74skXzppe3RfD/xrCll8g7yP06oIux1cYJaH6Z7Tz988miRj5z+4nzKfiAIw+MdVKnOwsvawBMOpAR/WDGsqWEKC7EsNrjsBFm1HQ5tPFHcClV0HYlKZR5ejgDCOvBGBZ/tQsIzKYl+dX92uH4Lgcbr9ns5Yi5CM3R0+q/Z+5xzabCGcz54a7EjH1zT9y0wYp17VgEW9nccBtkkCmXJgDD1tijNxwK7I61N36cNTaMdQR71U1npaMyzuT0dQ6kgrputCx75rpIMsDwEkYi9ay/LBgamfQiKPa7SDIzBjv5OgCrfU15BWr0OMRFAbu4rLF8s8PO9BrKQrA3JOsJwl8dQ47dhhJsDJgS8QAndbeJgjkT0Nsa18RE9pZ0HVVpSPhJR4aJvRlyFas6EOxbgVcPIrOgb9ahXBrFPblowqfD1iJ+z1brU00RxP/cbjwyZOf6WJvFUzQqzqVEUJyJC4np9grL7zrPsMO8lseQ45QZQ7uhSsDztsV3OrzFK+mqSUtrVQzmkABaHyutr4dz3mPa9QtcZCX/EshdwWwqf7+8WnuSwT40xMECKEL06BjuBZRtAPMhxX8Zo+eEA2mQmk2V2raRX0bluYFVsz2vnxcH1ntp9k/YgPZeGNWpUI/KQ/CbUjbX7NX1FV+63fmJT2SRWj32vCOBu4K8405WNQ82YRJmP0k/vMTeq/XfF0tguDEBT31ra0tTYcKCUqIZ0+wTBakLiFVEM1xj7A/u+7n7rsQkrKs31eNRo+2C8klBPjv6v/Ju0F9JbNJtqUiFOxlUq/wNRSm68xH6ZOFDG51BcZfxlkWvJOdvYoTVlylv67hH3pZgFK2GhXwl9Bhw6+eljQ+fP6eAncyFejNtvAuWGl5xf3ZgtPc/15c8rj2+DPRqcd+rv6M7oftuvIqGbs/gA1vDEbVVTT6J0TxEiEMpC0iYHmyAremaLDkBKWIns10eBeegTF1/bZ7yNWcDS6tX/0ensUmI5hLTA1tKsul7NuEjbU88KabhKtWknSmMnDix+feQ+D3yMuNIZroXqOeyDW+VkOpMNJNfrv5lPlVoiklns4VyGc/XasVA63bVnUxRtgVNwO1ZyyfAIe7F46dIakC1HAHHTkmPwSJe965Ty+pACqPLVvEtrHJtETL5CKW2spRW3SnmhGLdr4R01j/XFamcyFWvWmeSfwXG25kzHBrJN+5mGxFPFto=","/dbfs/tmp/dev-v3-1-2-0/nabu/17000664381264241/0/privateKey").accountkey)

    val targetPathStatus = CurationUtils.getOutputPathStatus(spark,"abfss://dataproc@idea15pisplznonprodsa2.dfs.core.windows.net/261/42/development-db/acuity-develop/aaaa.parquet")
    val sourceDf = almaren.builder
                    .sourceJdbc("jdbc:sqlserver://hyp-acu-development-5de0.database.windows.net:1433;database=development-db;sslProtocol=TLSv1.2;encrypt=true","com.microsoft.sqlserver.jdbc.SQLServerDriver",
                    CurationJavaUtils.replaceSystemVariables("""SELECT
            |  
"entity_id" as "entity_id"
 ,
        |  
"entity_type" as "entity_type"
 
            | from "acuity-develop".[aaaa] """,systemVarMap,localVarMap,"DB").stripMargin,
                    Some(Ldap.source("rO0ABXVyAAJbQqzzF/gGCFTgAgAAeHAAAAEAVy+9AQow7FXoD3z0ooJjPC+HrI5N52yIITSaL9yRvE3fFebDEBpUbP1qvJhLwLTo+6fqeYvorPcJGHVOzB+Iqo+4m/AMDDiIgWaXz5hy8QfjV7PwWwarCUa5mj+NtOgTKwyw4WNnFcphnkE34tLJad1s2vF1qQHUgOCtysAB0fD2JA5BeEsUprhbts03GzeY8OCgy0kqiYHEoKRaS8cBWUQ81oeyo7fW8mdSsKVpY8wi3b2npBin83TSMAUXtFbeCjOOr7HC/3DMYHQUM5xaZCNH7zeYWSMgAlTn1c+y42/1lX0UE1c2qtplYC8Ky+yYikmWcrfsLOy5xJEB7L+KRHVxAH4AAAAAA5BHFNPNX+74skXzppe3RfD/xrCll8g7yP06oIux1cYJaH6Z7Tz988miRj5z+4nzKfiAIw+MdVKnOwsvawBMOpAR/WDGsqWEKC7EsNrjsBFm1HQ5tPFHcClV0HYlKZR5ejgDCOvBGBZ/tQsIzKYl+dX92uH4Lgcbr9ns5Yi5CM3R0+q/Z+5xzabCGcz54a7EjH1zT9y0wYp17VgEW9nccBtkkCmXJgDD1tijNxwK7I61N36cNTaMdQR71U1npaMyzuT0dQ6kgrputCx75rpIMsDwEkYi9ay/LBgamfQiKPa7SDIzBjv5OgCrfU15BWr0OMRFAbu4rLF8s8PO9BrKQrA3JOsJwl8dQ47dhhJsDJgS8QAndbeJgjkT0Nsa18RE9pZ0HVVpSPhJR4aJvRlyFas6EOxbgVcPIrOgb9ahXBrFPblowqfD1iJ+z1brU00RxP/cbjwyZOf6WJvFUzQqzqVEUJyJC4np9grL7zrPsMO8lseQ45QZQ7uhSsDztsV3OrzFK+mqSUtrVQzmkABaHyutr4dz3mPa9QtcZCX/EshdwWwqf7+8WnuSwT40xMECKEL06BjuBZRtAPMhxX8Zo+eEA2mQmk2V2raRX0bluYFVsz2vnxcH1ntp9k/YgPZeGNWpUI/KQ/CbUjbX7NX1FV+63fmJT2SRWj32vCOBu4K8405WNQ82YRJmP0k/vMTeq/XfF0tguDEBT31ra0tTYcKCUqIZ0+wTBakLiFVEM1xj7A/u+7n7rsQkrKs31eNRo+2C8klBPjv6v/Ju0F9JbNJtqUiFOxlUq/wNRSm68xH6ZOFDG51BcZfxlkWvJOdvYoTVlylv67hH3pZgFK2GhXwl9Bhw6+eljQ+fP6eAncyFejNtvAuWGl5xf3ZgtPc/15c8rj2+DPRqcd+rv6M7oftuvIqGbs/gA1vDEbVVTT6J0TxEiEMpC0iYHmyAremaLDkBKWIns10eBeegTF1/bZ7yNWcDS6tX/0ensUmI5hLTA1tKsul7NuEjbU88KabhKtWknSmMnDix+feQ+D3yMuNIZroXqOeyDW+VkOpMNJNfrv5lPlVoiklns4VyGc/XasVA63bVnUxRtgVNwO1ZyyfAIe7F46dIakC1HAHHTkmPwSJe965Ty+pACqPLVvEtrHJtETL5CKW2spRW3SnmhGLdr4R01j/XFamcyFWvWmeSfwXG25kzHBrJN+5mGxFPFto=","/dbfs/tmp/dev-v3-1-2-0/nabu/17000664381264241/0/privateKey").username), Some(Ldap.source("rO0ABXVyAAJbQqzzF/gGCFTgAgAAeHAAAAEAVy+9AQow7FXoD3z0ooJjPC+HrI5N52yIITSaL9yRvE3fFebDEBpUbP1qvJhLwLTo+6fqeYvorPcJGHVOzB+Iqo+4m/AMDDiIgWaXz5hy8QfjV7PwWwarCUa5mj+NtOgTKwyw4WNnFcphnkE34tLJad1s2vF1qQHUgOCtysAB0fD2JA5BeEsUprhbts03GzeY8OCgy0kqiYHEoKRaS8cBWUQ81oeyo7fW8mdSsKVpY8wi3b2npBin83TSMAUXtFbeCjOOr7HC/3DMYHQUM5xaZCNH7zeYWSMgAlTn1c+y42/1lX0UE1c2qtplYC8Ky+yYikmWcrfsLOy5xJEB7L+KRHVxAH4AAAAAA5BHFNPNX+74skXzppe3RfD/xrCll8g7yP06oIux1cYJaH6Z7Tz988miRj5z+4nzKfiAIw+MdVKnOwsvawBMOpAR/WDGsqWEKC7EsNrjsBFm1HQ5tPFHcClV0HYlKZR5ejgDCOvBGBZ/tQsIzKYl+dX92uH4Lgcbr9ns5Yi5CM3R0+q/Z+5xzabCGcz54a7EjH1zT9y0wYp17VgEW9nccBtkkCmXJgDD1tijNxwK7I61N36cNTaMdQR71U1npaMyzuT0dQ6kgrputCx75rpIMsDwEkYi9ay/LBgamfQiKPa7SDIzBjv5OgCrfU15BWr0OMRFAbu4rLF8s8PO9BrKQrA3JOsJwl8dQ47dhhJsDJgS8QAndbeJgjkT0Nsa18RE9pZ0HVVpSPhJR4aJvRlyFas6EOxbgVcPIrOgb9ahXBrFPblowqfD1iJ+z1brU00RxP/cbjwyZOf6WJvFUzQqzqVEUJyJC4np9grL7zrPsMO8lseQ45QZQ7uhSsDztsV3OrzFK+mqSUtrVQzmkABaHyutr4dz3mPa9QtcZCX/EshdwWwqf7+8WnuSwT40xMECKEL06BjuBZRtAPMhxX8Zo+eEA2mQmk2V2raRX0bluYFVsz2vnxcH1ntp9k/YgPZeGNWpUI/KQ/CbUjbX7NX1FV+63fmJT2SRWj32vCOBu4K8405WNQ82YRJmP0k/vMTeq/XfF0tguDEBT31ra0tTYcKCUqIZ0+wTBakLiFVEM1xj7A/u+7n7rsQkrKs31eNRo+2C8klBPjv6v/Ju0F9JbNJtqUiFOxlUq/wNRSm68xH6ZOFDG51BcZfxlkWvJOdvYoTVlylv67hH3pZgFK2GhXwl9Bhw6+eljQ+fP6eAncyFejNtvAuWGl5xf3ZgtPc/15c8rj2+DPRqcd+rv6M7oftuvIqGbs/gA1vDEbVVTT6J0TxEiEMpC0iYHmyAremaLDkBKWIns10eBeegTF1/bZ7yNWcDS6tX/0ensUmI5hLTA1tKsul7NuEjbU88KabhKtWknSmMnDix+feQ+D3yMuNIZroXqOeyDW+VkOpMNJNfrv5lPlVoiklns4VyGc/XasVA63bVnUxRtgVNwO1ZyyfAIe7F46dIakC1HAHHTkmPwSJe965Ty+pACqPLVvEtrHJtETL5CKW2spRW3SnmhGLdr4R01j/XFamcyFWvWmeSfwXG25kzHBrJN+5mGxFPFto=","/dbfs/tmp/dev-v3-1-2-0/nabu/17000664381264241/0/privateKey").password), Map("fetchsize" -> Constants.DB.fetchSize))
                    .batch.persist(StorageLevel.MEMORY_AND_DISK)
    val cnt = sourceDf.count
    val sourceMetrics = Metrics.collect
          Util.setUpSparkConfiguration(s"fs.azure.account.key.${AzureGen2.target("rO0ABXVyAAJbQqzzF/gGCFTgAgAAeHAAAAEAVy+9AQow7FXoD3z0ooJjPC+HrI5N52yIITSaL9yRvE3fFebDEBpUbP1qvJhLwLTo+6fqeYvorPcJGHVOzB+Iqo+4m/AMDDiIgWaXz5hy8QfjV7PwWwarCUa5mj+NtOgTKwyw4WNnFcphnkE34tLJad1s2vF1qQHUgOCtysAB0fD2JA5BeEsUprhbts03GzeY8OCgy0kqiYHEoKRaS8cBWUQ81oeyo7fW8mdSsKVpY8wi3b2npBin83TSMAUXtFbeCjOOr7HC/3DMYHQUM5xaZCNH7zeYWSMgAlTn1c+y42/1lX0UE1c2qtplYC8Ky+yYikmWcrfsLOy5xJEB7L+KRHVxAH4AAAAAA5BHFNPNX+74skXzppe3RfD/xrCll8g7yP06oIux1cYJaH6Z7Tz988miRj5z+4nzKfiAIw+MdVKnOwsvawBMOpAR/WDGsqWEKC7EsNrjsBFm1HQ5tPFHcClV0HYlKZR5ejgDCOvBGBZ/tQsIzKYl+dX92uH4Lgcbr9ns5Yi5CM3R0+q/Z+5xzabCGcz54a7EjH1zT9y0wYp17VgEW9nccBtkkCmXJgDD1tijNxwK7I61N36cNTaMdQR71U1npaMyzuT0dQ6kgrputCx75rpIMsDwEkYi9ay/LBgamfQiKPa7SDIzBjv5OgCrfU15BWr0OMRFAbu4rLF8s8PO9BrKQrA3JOsJwl8dQ47dhhJsDJgS8QAndbeJgjkT0Nsa18RE9pZ0HVVpSPhJR4aJvRlyFas6EOxbgVcPIrOgb9ahXBrFPblowqfD1iJ+z1brU00RxP/cbjwyZOf6WJvFUzQqzqVEUJyJC4np9grL7zrPsMO8lseQ45QZQ7uhSsDztsV3OrzFK+mqSUtrVQzmkABaHyutr4dz3mPa9QtcZCX/EshdwWwqf7+8WnuSwT40xMECKEL06BjuBZRtAPMhxX8Zo+eEA2mQmk2V2raRX0bluYFVsz2vnxcH1ntp9k/YgPZeGNWpUI/KQ/CbUjbX7NX1FV+63fmJT2SRWj32vCOBu4K8405WNQ82YRJmP0k/vMTeq/XfF0tguDEBT31ra0tTYcKCUqIZ0+wTBakLiFVEM1xj7A/u+7n7rsQkrKs31eNRo+2C8klBPjv6v/Ju0F9JbNJtqUiFOxlUq/wNRSm68xH6ZOFDG51BcZfxlkWvJOdvYoTVlylv67hH3pZgFK2GhXwl9Bhw6+eljQ+fP6eAncyFejNtvAuWGl5xf3ZgtPc/15c8rj2+DPRqcd+rv6M7oftuvIqGbs/gA1vDEbVVTT6J0TxEiEMpC0iYHmyAremaLDkBKWIns10eBeegTF1/bZ7yNWcDS6tX/0ensUmI5hLTA1tKsul7NuEjbU88KabhKtWknSmMnDix+feQ+D3yMuNIZroXqOeyDW+VkOpMNJNfrv5lPlVoiklns4VyGc/XasVA63bVnUxRtgVNwO1ZyyfAIe7F46dIakC1HAHHTkmPwSJe965Ty+pACqPLVvEtrHJtETL5CKW2spRW3SnmhGLdr4R01j/XFamcyFWvWmeSfwXG25kzHBrJN+5mGxFPFto=","/dbfs/tmp/dev-v3-1-2-0/nabu/17000664381264241/0/privateKey").accountname}.dfs.core.windows.net", AzureGen2.target("rO0ABXVyAAJbQqzzF/gGCFTgAgAAeHAAAAEAVy+9AQow7FXoD3z0ooJjPC+HrI5N52yIITSaL9yRvE3fFebDEBpUbP1qvJhLwLTo+6fqeYvorPcJGHVOzB+Iqo+4m/AMDDiIgWaXz5hy8QfjV7PwWwarCUa5mj+NtOgTKwyw4WNnFcphnkE34tLJad1s2vF1qQHUgOCtysAB0fD2JA5BeEsUprhbts03GzeY8OCgy0kqiYHEoKRaS8cBWUQ81oeyo7fW8mdSsKVpY8wi3b2npBin83TSMAUXtFbeCjOOr7HC/3DMYHQUM5xaZCNH7zeYWSMgAlTn1c+y42/1lX0UE1c2qtplYC8Ky+yYikmWcrfsLOy5xJEB7L+KRHVxAH4AAAAAA5BHFNPNX+74skXzppe3RfD/xrCll8g7yP06oIux1cYJaH6Z7Tz988miRj5z+4nzKfiAIw+MdVKnOwsvawBMOpAR/WDGsqWEKC7EsNrjsBFm1HQ5tPFHcClV0HYlKZR5ejgDCOvBGBZ/tQsIzKYl+dX92uH4Lgcbr9ns5Yi5CM3R0+q/Z+5xzabCGcz54a7EjH1zT9y0wYp17VgEW9nccBtkkCmXJgDD1tijNxwK7I61N36cNTaMdQR71U1npaMyzuT0dQ6kgrputCx75rpIMsDwEkYi9ay/LBgamfQiKPa7SDIzBjv5OgCrfU15BWr0OMRFAbu4rLF8s8PO9BrKQrA3JOsJwl8dQ47dhhJsDJgS8QAndbeJgjkT0Nsa18RE9pZ0HVVpSPhJR4aJvRlyFas6EOxbgVcPIrOgb9ahXBrFPblowqfD1iJ+z1brU00RxP/cbjwyZOf6WJvFUzQqzqVEUJyJC4np9grL7zrPsMO8lseQ45QZQ7uhSsDztsV3OrzFK+mqSUtrVQzmkABaHyutr4dz3mPa9QtcZCX/EshdwWwqf7+8WnuSwT40xMECKEL06BjuBZRtAPMhxX8Zo+eEA2mQmk2V2raRX0bluYFVsz2vnxcH1ntp9k/YgPZeGNWpUI/KQ/CbUjbX7NX1FV+63fmJT2SRWj32vCOBu4K8405WNQ82YRJmP0k/vMTeq/XfF0tguDEBT31ra0tTYcKCUqIZ0+wTBakLiFVEM1xj7A/u+7n7rsQkrKs31eNRo+2C8klBPjv6v/Ju0F9JbNJtqUiFOxlUq/wNRSm68xH6ZOFDG51BcZfxlkWvJOdvYoTVlylv67hH3pZgFK2GhXwl9Bhw6+eljQ+fP6eAncyFejNtvAuWGl5xf3ZgtPc/15c8rj2+DPRqcd+rv6M7oftuvIqGbs/gA1vDEbVVTT6J0TxEiEMpC0iYHmyAremaLDkBKWIns10eBeegTF1/bZ7yNWcDS6tX/0ensUmI5hLTA1tKsul7NuEjbU88KabhKtWknSmMnDix+feQ+D3yMuNIZroXqOeyDW+VkOpMNJNfrv5lPlVoiklns4VyGc/XasVA63bVnUxRtgVNwO1ZyyfAIe7F46dIakC1HAHHTkmPwSJe965Ty+pACqPLVvEtrHJtETL5CKW2spRW3SnmhGLdr4R01j/XFamcyFWvWmeSfwXG25kzHBrJN+5mGxFPFto=","/dbfs/tmp/dev-v3-1-2-0/nabu/17000664381264241/0/privateKey").accountkey)


    almaren.builder
        .sourceDataFrame(sourceDf)
        .alias("SOURCE_INTERMEDIATE_TABLE")
 .sql("""
           SELECT
           | `entity_id` as `entity_id`,
         | `entity_type` as `entity_type`
           from SOURCE_INTERMEDIATE_TABLE

 """.stripMargin)
        .batch.write
        .format("parquet")
        .mode("overwrite")
        .option("parquet.block.size", 64 * 1024 * 1024)
        .option("maxRecordsPerFile", 1000000)
        .option("path","abfss://dataproc@idea15pisplznonprodsa2.dfs.core.windows.net/261/42/development-db/acuity-develop/aaaa.parquet").save()
    val targetMetrics = Metrics.collect
    val metrics = MetricsType(sourceMetrics.bytesRead,sourceMetrics.recordsRead,targetMetrics.bytesWritten,targetMetrics.recordsWritten)
    (metrics,cnt)
  } match {
    case Success(s) =>
        logger.info(s"Success ${inputJson.tableId}")
        checkpoint.endDatamovementWithSuccess(inputJson.tableId, verificationStatus = true, s._1)
        checkpoint.insertDataMovementMetrics(inputJson.tableId, s._1,s._2)
    case Failure(f) =>
        logger.error(s"Failed ${inputJson.tableId}")
        logger.error(s"Error while ingestion", f)
        checkpoint.endDatamovementWithError(inputJson.tableId, f.getLocalizedMessage, verificationStatus = false)
        throw f
  }


""2023-11-15 16:41:16.522 [Thread-88] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : insert into nabu.pipeline_spark_job_details
(pipeline_id,batch_id,process_id,almaren_code,input_json,additional_info,job_type_id,retry_num,crt_ts)
values (261,17000664380239952,17000664381264241,'H4sIAAAAAAAAAO18XZeiutbuDzo3fEit9uJcFEpQlFgEkkDugLhECEgrKvDrz8Sq6q7q1Wvtvd+zb94x6sKBCiQz8/OZMx+LQ9tmsX3Lm+CQG7jIXOcqY9JmC+sPtvKs7cJ2E64uMvYUfI8kx6WI8fhn8PO9zPSabY3uCccnEVqXzMi19Gj9EbnMEPx+WTv9TRhS5cf7IXLnTcTRNeHwu9E2Kdfv8L62dvEtC60uM0iRDlaZGTp8n13j+89+EmPebWv9Jlx03tbwPNdv2dEqgN6T4JaWclxIly3zmlWvv9ElH6w/F7Xqcnc+yIUN7WrXjM+rhF+uU3vw/Qq0V7IGmgxGE+5dBJ3fpatuWeP/O/1rmdEpuP7rfhpySw123ar367e/HX/qsjI17VsK4/iH53Sg89cxttn0fuyVIIsG+KDyWpUwRnj226fxpPwb0KaGxKDX3FRX6aLZ577mgxisIncR0DM9Yxd5fYEruvzbz9VCz2oMsphff6Hzltf5NYntIjEKtW3wPYm9M1w1aLMQQNNHWn/RsRH6GmD8Y87vV2ogQ9BJLvTv+DS1raWTXhsWe+PZOonxiUI78PtBX1iRRaAz+N6PH+gcEwNdknDSyf4i+OtYtlVbgM4soT1DQNvwGT/zZLr/ZkvPv+qQbKVb6MnR6mSM22SwbgL0aOId2Bq8s4Zr3wHNk14dJdifcNmwrTDwjF7DqQ9XgYyDX8fbwBhPkq+vWczGlPvXzEhArsDfGrVZA23U6JJxNAg+uwbvfRz+pY6XYP/FwyYmPT8+H9YL20j4/ZCBPQuDDeul9tm2j6B7MfEzQ8J1fVrXD/rsvCGtqFEpF+v2rZ3L2zPX3GDam884vV2vIbXcaKg26wU8uxJFtrDBR+mgX+w69fljDMfDMavRUYb6q24Y3k0u9DargRZzkvvsuAlOh6kdkNtlvXrVt6mND7x+16uJ9pe8wsAnpInw8E7r+33QBasGXVVycTi+67tYea2sJx5bRdKwPxPTUyA34L8qspV/3C6ej3n17R5QL2GNsgPaHmmMnvZVchOaXBJFmoBLO+BsHVAE95nNmuq8o4hkJoxCFTeyxE++O7+FdRsEQ7fOq0qPSjrsqfIYwkW0VBZtBPIN4QruOYR6d8a9wI+REdaFL7WeZsPFEA1SPBa3XNllWMk1q+ZPwbHzcv7tjF3tFlDdIa7yhC4Lvjrp6aqaUS6+s1IGUpcm8GvJuKNn/HSOGvIidLKVpjIxkrusEmXuFtdUoyNeET8E/+rH/iCrpM8ZWjMuXwKTWLmGFr4rHL9qbUw9RWLM8pV3Shoy+ku82tdM7Jz5UpjVPTVRy2mBMq0LE+bPEs2LGXNmPp+rPf9mCpXPMk6iXOt4jqqZNKoxKb1r7nhtVh5G4A0OGEukI46C4u+RNh+wViy3I3YiptaUMYzjouAV3oVL+SSYiqmmgzyAXyUqN2al+cdvfYYOd0Zpn4xeL1f2hVN/FprVec9Umxp6DDKvc61/2UdsFlZsgbX7OdS9NWsKO1wS+1Wujh5UhRspe8cXFxOv8Jmv2nvu0pHWwtmaxRCAr9m5ublnz3dczz0ZH/pEV5uEHgxeSrovq9nO1Vtan/T98aJlTbsVtbLDOD9HnPDQsF6kiY0klosI4lnA1jemkRX45JjQbok1NkaN9z3XPDeL0JpGTKOOWCcavrDSXnPeb7la64K3DXHwi6y8VaBON4nQGMbtlvP7WaCD5TdsjZ2+SQxv2HFrxMAHTDH29fV9Yzo3frzo+1VbJBVeJeZJx65jEt6u/bilu7i6S13dfUAVQmMxvF+CXLXU6JYZKzZCI44P/jOtrJnULmYYJX1U+kaiWTShekXZ2vQZ7bPGLqJYPUkW3AVyjNSQQ75iWmAeTBx795DqI1lJlOqq3XFkbbV+IQzUCYXaULcLrGMHxrRIm0SPDAn4QTA/Ygtmru+RpoekAr8SkSFyklk+FkE0qkVedSSvnDGs5mPYSJAVIXgpq9QtNrlGNkL3Z5Siq3A9Fdbye6oH96jBhR8VIYnUnQOPmRJ3qtunUK21hLYGrXuL1GjEFXvZu17DahyEsfcijLWV8CIJGs+lrnfJTNmLKuhTejrvS3TMFb37yJvRxbxM6hZ0pn0RgNLCBrxP3JI8bntWMRY2ahOM5JovVZNXd3PfeEGu6S87tx8FczTMUEojqacIA79aLdeTMTK9J1JdzlmMIhaTgSn0lPHODmq03sdMy0tS7UvcUdexaExKsJ9kC7qVusRkE51lft4heZUMm2wZ3PeOjgKtQ9Hy2QjqVg9UG0oHBREvZnxZpNnQKUKdIWOoS0eP+41XUHW4J3Wvcyp4bp4GWVtg/weQO7nv+OXGuQx4zVaRkmCb1S3UnVtgeCytvQRrVuLDe5sxGUWtb9jSi6iS3/3RMwJtvgC5bndAF2ZyR6PDwJm3ycDm0mFuRIyoPJwnokoAD0qdOKATS7/Pa+cuERGJ1i1ZjDxePp/h7iLhnZ9CX4Rq/d49mUE41zejvGLTGynvhtD0R5+zHa2/nf3Kn6VGv6Bua+AmuYUNvZMS7LuyNnKFGLQDOtAz6N+MlBdlUTLbO2D71dwlTq771Ct5LWaZ28WyAnmvhMh0wrMVYPUyMVPnMOYIbLe6DMQoEmncraAuTHwErOq2ZGOIANfMBmwGOse+gw83ghgkbNz1vZuMvJYadf0b2EG5W3nf/WPnUOT1iRGcc7D2KJI30RBdVqonBmAfQ9p+LBzCPc5Agrg63dmqAIViOHf8ewo+NouVDXG7S2jvpJq3ZZq65qNzF+D7BZeUlM4tUSdzT6040UiEG5JsR1tlDWYZrfTU6WkQIS00sZ4t5U5S9j1RdLZzuiKpi61E8pwp3EXcctL4cBY1IxstGPdU16NKpXk9T3IK8YKSeKOLc2TaOKranWg8A/M+yJAAvN1dAPdrEJ9XyTBPACPyIErGRIkri4sQ9IBHjXzxWWvtubBDTk1SBoZwVJFqfh86aB0ics6YbVKtVbso0dmqOucOWubM9hnEZrny1mFDEHPuOthC7AP2pSofqWF1qSN9sVprtHzu0+M8AX/QJaZymSnijLNINDIh41pPzXYN/mATgX/NqJwRZbuA7+fr4ztWesPTE+6qkwe22iy8d/xSQU5gTJjrgZnY/D79TmKiQoNZa8jT1kfIXWoxbk3S5Yt5JeKkk6Xf+aE2bKPn2yvW+tbj8fnuLxMDL/2ZH63hutb88Nt9a9pDGospH9uKuPqBvd6xEuDMK2DeUcTBaf2O/WsyvTNhR8CQnh4boB/gx9MGxnBcX9YLT0lj3iZasZGqGljTlr7bn0Pe3vaO9RTEEhNUDVFFMHZ0GkbejjjVPQLfE2qqo3VREU2YSSXdVLUMbMdL62/3iKvp/hXuiywuLlSXJKXz71GEcVpp98hBt5S1K1Lago2Qa7g6l6iNcWRHTEdtZLSeDzBMap0HONqA2LlLa7RidVcxs7hwyEb3qk3Cqk0DrTJCfulT1+tI01Y++LWE4QVx0SpbsQps9TTRJw0S08b20lhuJ7wvlbpEdVsQ0FvQoFmGcEy5ekkr2sP/Ta7hNqzBjJD3PaHskmrqe2YWu32FzIgS4VeWE0UEE0c9RTo5+1RvX+mF/kYcUmNCX6yA8V2m30BfEkztU2XB+96+6sFqCp85EPMoQXvgD42n/qF9t21g/E88Qm/0WpvMJeuwZDRTQpvkI4AeaG+Zlc8fdPSB5yEvsXXptCNg9MNLaNO3fHrSiRG8qffh/sf3KtDXAvJqyBN08BHEEwto233VmfChM9Zfn3n+kAO4LfgbPOXaleS9Cnkw9f+Rnmtaz4/UgJyTEz1z2T++LxADffZ+R8f3zPCiKc8VKwY5JGFgjwP093E8R6C1TB1VTTkJ5P13yB03uTHVJ6bcC59+eR5sdv6oxfyObsDRt8RgY66p6nO+hkaJPD1TkBNxNkLOD/b9F3ov4Pc02rArc1UHfWgJ6ODHdnJX3QXvIb9iO7inJprBjsfYgPchp89N/GfCyTE2gVZXTXJ45GB/00YouUUhl51ytSKLn2E8z0e/fB78QevB5/Q4fO5xedL8JXyOM2MXBf1u6fxde2NmsmEa/8Tz7JGTvtE45Z5caftQB58mIBbO7+vDx7zQbnMX7GeqmxhzPa/xQ4cSwGWCW6BL9EGbeOSn/S13J70KOuGu/xUtv7TDJhynoP0iN/7HbX4aH4wFooRXguz+p2OF66TregH+HeTOICeZ+gGaQ9CRhWcHOoM8E8CvwwDn9C90sf6kk2kM8Rp0CXTmJqcaFCegu+g40fQ3bTqECRQ58yCibMcWuhMc15vFRzrdiSZ8zt056PhD15cf62Obz7r70S4uv/MHudsXwDuw0/shqiEOhT+v1Jh3Iiw+2ZJw0aT/N8jtu6muCO227/Fs4n9idPcMYpVcWJM9DdJ5jBlnkJWCnOH/z+1N/Hj4ksUnPzjuwc6A9xz8Hk7i56f1FPumGgjYbOroRY66CLADyD+/rB103TPATUqb+AH8zg9vddtHXSvi6M51rEFcv4qht7NGhYIL+V7H+KWvB48AH/yUH5u3YrG+/GbsQP/8nY72P2jv1QaP/c//6MOe/pM2Hn4pB78Um4CCjv1v/dRPrKFAHqxjNRomfmwnGUz1mp929Ofkb/KG/Cmn+swHe/j/anOizwA/fux/+PSp9gtIcYC2m3/Z1pstxuYjtnTJ73j3bl/x2zP83+Llu9/481WuHvge9ufDLsP15a/+5RfbDX9gS2uqRmVMFHkFermYYtUDx73SxOY/fd0b7bHR36Txbve/6+sf/eO/Pa53/xUbjzb+/OQT/yX//jt9yti+/wd96vnK/o/7/Iv82PxjO590+V2fPrzzkMlHOkEnN299L3/Uel9r3O/18ntm2oCBkCbopBdsoq19zJfE/ulXXX7oOCLDPrT/+OzL+9tUT39/br08/YPfuh8Cblm0ZnU8xQrXUnKwH3Me26qAcRTAGzt7t6vtT5/4qqfvH/TqR6cciMV29MiBtCkvEq2Y+PmKTU754NUwzmLfsEGEFsQIkNc0/1J3ah/Oqr2GnqZ5MAL884+WBuNvXvMX78V30IIjYQUUbRKF+n3TupATrwLgltBQA/8ryA2n+h8KmLA2o7Ipn5sg5SSbctTSvmVa+506/jlceR6mM91vlBcyEiX0bsG4DMiIa8jVj1MdIkfsSJeoh9z/FK2kz9xvZ1yLXjBlZKYXJFq7CpF42Vfrcxij22Yk3VZDgP9JG3IZJ6x4wrywdgjVqUpMupKxNNAA8b3AXP++0SwtMiQNTWnJkcRRbbmJaZ+yukP+SLTIaQuxRKPfCNePEQkRayINa6C3dlDaNVl6myBiC0HZCDwfIJ/Q8vF5JGareFS8BIa0fLfrp7oA4fMtrVG0c/GC6YzslugmYnXDkKHuXL2iJt6yxha7lWx9Yz1ALF2kfDbzdRJFFDG+Im5Ss2VazV/yUq6D4dtIHF2ECLEoYrOEtcuoOphTPZnpGIM8Lsyd9cnQWZCv3nzeJz5iyOf+kMfkniG13DmdtTGVSHnXMQMPosF+ZFb63mlRUEp/o3Uh8HcW0IP2WtNFUw17TSoriNThjEcypnrxNNmkr3s1WcxneYUv2bJosKkCfyluYcxmPscirNEaq5PJVidrtyy6lHnfcXw6Y9d6Cg3RBlSZG02vWNVdI1OOYEdmUOkvuYPCLaAKYuIeNHsbALLPNWuAfHlBaq0PkaNLZLuhi5cZSu4hUpdQb0PM2XehkWVkigXRvBRyfAJ5wlOoq8vGIMku8vRwSXxh4GNeTjUaJtKILSEfDv1F1291oC0unsD2l8TATzgiBdbY93CJnthSWf5KinzpmKyWkBEpyPXxQrrdOTD0JKyB3iUCe2x3+5XcYsiHfTobcY13DDCTQCjEI2I+5D8J1S2wRepPtdW6a/IHhsIzPLIhdxTONWIS3gFtqtiHcz+oJfhTAbl7FySRjKZcN6hbA9N5E5hezSJHD8CD+M4c00rYSUO1vOrd3cqfUeebFTTelsae7WvtS661JsiqolFgCrc4AX50gPYI7MXOanIUtG3SuqO+Y41J5MxoRa0cnYDHgucIB6kDfHbRRirvsqcQJ0fAuGZxFLooqaMGsK3jjqMTd7yBKPs4xamcC8fnarMxT33SeMxf2uEePYO/9L5LU6WRAZ5faw2i2NM0b5QDbma0tcLK17Lm2RKm52OzHegK42gsLuDvCF4ywpVjSl5EwK8nucLc1+bDvhLbjaH3VGdargTZ1/o5oF4RrpQuV2tNrE5jxuxixyBm6O2SL+YI/G01zf3kPDE3YxFnDYukHmj+qsCE4i2h9zuugFbqpbQhNnX00x4dZrz+dgY/YPu1TjJ+GVjpDQnzEt/1LpIplzX4CfzIde/iNchdy5fqvNVVQ1GriGbF4Ou8rdaRrYaPjLdHvpQ7vkQuO14M3xBdqIKB6l6cltMcE34JQK7heIBckcWRcma+UmFY64HvXm6y0qmInRt3wW+tSCMpQYEKRh9iHvymnOMt+MA+ZKf7xpQ0qNE5coHGimE/Lr5jzbnJ8GJmpRxyHZ3zqhv9EalIeeBjveXO7S6Bsr/LUhhbrdV9J7HC2tuFDekZVy7owIVB/1KzQmpoxm5VgO23L6QiKxyhBfC63rv9mZliExnE4HxOWd1b2QqsyCjWvmmnQhNbv5InvpKXHfVOckzOgKW+07Cr6VIoiJkl6JxKK0uTFQIJywvYa+3rbQP+oNyOjp6MxZCW6zNBdphzXG1Mz8CVZmaG0GQsvJzKYz6A3UTIgHhzZAokuBQbH5EZKBSKYnvpu0qErm4F09wpRz5xu0WoSy9r/N53wfdz1jAn6beGl4LP24EfdegoNL74BtjPGhnXPYhBU02pl043Sn43o4ahtPYY+MEt+JdTaJI4Nawoo/qVuGq2MYSCcTq+qbCklscb78ZX6AXihcOGjqfa/B5RaxPVYpAlu1C355CbnTPXGjHEZ2L4IHs0ssoB3fF4ptgMdLVhlWVGI0r3sarB3ypA/RpEWy/h3dKnhR06BU0NPZA63oioMjAjEB9sOzARsEgYJCZD6LQaYcTHYAts9MYcebGv42vGi1XkkgGj9d3npxt3IN/j2CIKELGhK2oIkzv5gHn3FII/CKvZGWLwau+IgEDe8AJ4+b9ej/2Ab17zcg3yXGi/fl1jICGfFZNPGizArcFxu7DtBy6iUmXlesphB/FaUx6iEfigCr6HGAi6Ps03PZHjvCEadpkrbYi3tgAeTjGSUMT34cUKGLpBJHO5OwdZniB/nm9SZS83WjGEEdvhyAMDUZQayN/FKpQVaE4lVFKBvTY2S9Rzn8dikzq9GSECtifqnDMh6/lAXbwhWsEjs11sNNVnw0XLwrkdUeKkVDXMQMm+ZKd9VBBRtxzr9jRXBbkMZknEuvTY7aQzB93tzH2ca0yzrqTG99S1ziTyNen0m4QHfT4CJitRT2nBhDZfypUaA7q+iyoAGUKsqRnKdXbP6+II+eUd3nwSrJoBTmr2kX3OOdiPw26h7hV0LEqITYxGhz4zmJVBlGdj0QmEx1AXd8BMZhrho19b9wCw8W6JKdV0m7FCI7WnAqN9icy1GTr+zdcI5rQgDB7YuygNNGuNJ9zFZBRxaWeIXAHrnPdRMGxHdOFLG1AmKv0Gabnbi2AstvuwszgHu2GyzEHvImdugQ/ZELo2o0W3pRXI2wHc8opp7QnrhY7YUcdKNmOu5UaX7BvILwAzAD9u+5W3zNz7TIzSostnI9OUvl+iElLWIlyKFOvkaRcdZhlXYVqyJ8Cr133V1SlFnhw6wAVim1WgjybosObhCGyPHucxceSYM4lCzQdPgXd53Y5BJTqwWYJjEpAK+Gr03HcKkTldSkumUsAggTY3gkou+HGu0Rh70JfIFl3Fl9UgAdNFriyTZm2BL9M5ryDKaSMtn895OE83I5vtwd4CTZb7kmqANVBaHfq9CiyQq8nj5x7roiEst7Ial0FDzpBvdNyZ5tKDHvKX71FTmOEoPVyinT+KMlKkiDghtMx7FqEr5Ch4H7c6W9qAQcQZYvtUD17ul7kOOMiLYuxIjZ2BNiuJq1vkeA3kdDXlaktdx6TaVLOHWFyyF6EBflW0B3wa56X9EjHPDbin45Xnk7IYd8h+gTgyhDrg/whvIhNvpAGyQo6GDXICLAN4um1ARwnEFvBDbCOM9gy07XLD6XfIQ7vYToHH4PHBzNxiQ0tShI0Is5Vyk9g3CJ3PklryRLe9vJo3SamKFBWLvBJBUvc3aSLIGVAbHrsnn3sDi57vtCmCLWDQtJEWr+aQwcqNrATbP/IrxAljmz1tl4CT7zsuh2gpn3JljxH9NstWWAF20ylrCTbZCXIIZ9+QkZX4JYfcLBy6LmeYyZXHadx2qQaxlxYW8HjALnnywdcnIBTp4jTQDzfQrZOYciSgEw+XGTMsnQI+wEt7FkFkDDXmA6ZfpA1bcOVpAbNxuiqSHWpvG4NBkPA6yvWzr5Ihr1EINnfMVkwQJSD384ysKUrAz1e5erbSYS6EDnGeyh0zbRaGkB+F82WipvnOgwn5RU9UcsYlrjPaUl/hkBmnKRdbRhrI1bnM8PIZ4r4FuZQnaNV2dGmft6bAzGWA34ualLYGue+0PogCfhmSyNYYUmWoYZZTlQLOh7tekWp9CzSiKEKztJT21qRnbMzMvMEkNb1tPvq9oFYIPnYAv3HOHC9ImwTQ7XwjI9vd0fYYVa2WMxBENZ9lCPo35Y4q3OGymE22H2nCISPtgxqnoikuqS6NsJpXUqkbQ+Ky572BS3kKl/jOa+mGo7cC3QF8rhbpKjeAv5dUOWehng1B0XWaLxWQX8iVsCVIOFuymSihbZMEyQAxkvuzvD4NG40EtEGlWHSAFQTGxryWK2ZAvrxKGv8mNMAlEG8SBUgGBUZY2nTvwDiofg9Ge1qP1EHMG6baT+SQc1B1cQi4xo9sBb5fCZ24fjg/8lJakZIlQb4h0eEG2OgKcaGDOHeC2GX7MdnmJrtgzdIJ4FsGfjA00DF1Oo0Z3ZUaOs4q0u4XXS2YcyZLbEUx24WsHTK96COIFwTlZ1Z3kBPqu7Cy6rxJ9AzZF1bP29ToIYcjEJ9lCbIvcl3YoDtHVltsjzwNcpKd1L71vFGWqJAnItD6pahCjs7BiNYBLdbM7Tq6klFYUwuXjEJ8uAcU99Tpuawgh6iKjXQgfC3BFvR8yE07ZCOOslo/Ea2v8pKE/hJ9h/5d8FMTPo2lkp1guJZ6sfJLdt5Xkz9od+BfO2IWLnWElo0aYI/1TbhTbWauZfHzbZon2cbJuI2czj9q960xrbejNz/KAfs8g64E427pDHAd8NK5+Ytf57era8JxmZnT2ryptlNtPs6zvGMb6kKeigAJxgRG9DxfO1gH232s/2RTzWjlX6fnIhPGv/r1+eJtrv1+BBxb56b/tB1e66KPuTnNbmEchR+xexrje7Zqr5nxmLuowKcO25pMtSig0VPbRraQc4KP9K9ZzbTtuDYA02n+cf5jXud1nkGvkuO8SEzWyhUEtPf5pAX8x1Gxbewib5A+4blf1kK+1iUpqX9ZD/lj7ekrf37/2b7XfWkLscE/revH9Wla/zvNc05rInfHb7d0pe5bjkr5YT7qlW5NFy69w5h/1Jt/HfOudDR/9P/4WcOk89/Ml/2Rm/hCgb/SnZeZcZ8zp49k6Vz9slMQi4d9bGsv4OMlp6BX3ts6bQUYZz5OuQ+MpZ9iR9481iF8B70rtwoDPHr7r3pfo7C+/BNPgh91RWuTAO5+15e8ZvfMBZ/DPtTQa1VADFT5cDiuj15EaI8CPdj82uaf8FkcvWkeG+Sr/kx5cFxDLjOti/j4H9D1ibZf34PPXYTrA8Tlw7p+rE/V9myuAW/UND/4l3Gt7gcBeVYWPoMuYz2NibXlkL3UU738+bhV3UO/Yri/Br78ZV7jl5ov8H2a42untd4w9ns0rUeGfGP7Nrf+2w+a1iLTE+RR03zDWx2cftVev2qvX7XXr9rrV+31q/b6VXv9qr3+b6m96hMufltTcfnCNl/Y5gvbfGGbL2zzhW2+sM0Xtvlfjm3uSYxHacwHsQBsM61bXhyOomZaYhRjGrdqfXzuXo72tHd+Wi99lSv/Spz19e2ZaHpm877W9Pefa1KD/zAO12kteW6oUS6KSLrzYdp7/r53PKIMR7onYg3tCJo7IcPbT3VPF1/ltPfhQ/1zmv+e5sQ/rbt/Wz8ZcTbVq8rXWrCupjXQielPe5kumctK+Uv9ir2uaxxFTBj47scep2Da91Sr5ud++mJcT/yvX9cWwrWE9vSsCa6pwaztkfwRxC30z1aCz4ZtAxixlq/7zr/2kn/tJf/aS/61l/xrL/nXXvKvveRfe8n/63vJ78etATlp49+kq9/hu5JH3Zj2ZG6jdecv5o992oD7TX8JsQU8rj8een+6lkG/HZ9v+eNMnGnPyDTPvm5/4hvy2IPyZ2hV0P6EoaY9F2bKrQp8EuAhCzDOetrn9rXn4qs29lUb+6qNfdXGvmpjX7Wxr9rY/+ba2I89F1Nt58Oe2x9nGm5rT095D32tP9a/ru81KDKtf6NimLDT5kPd6r2u9fqxpjM3imk9GdXmkMZgFGugCw4LI8qckCJK2JyC7/FJ+DiH8XFW52axPr6fD/Fh3RWKHLZkv67NWt0Piftj7Vgr3OfHerJf/vu8Ru7zO4/1ZgmMPR/sw+O81phY8VTLcdlf1qC9rj+zo0hnYaCxP0NqwRg88IHECxhBsU7soOrRY6/xcX38dW3ZL/x53Ze/sEx4RhOf79WA5brkgTH/ul7y7ZnpXFG1WXjTuQiDNAHjuvTXZwD7vu4r/tDOdVrrnhgXkKd6mvbBr5eJtl6cDn70PODF8/f10rkDdm4/jn9bv51HO51xydGM1mxaF1rluq3ySrSZO61lfO4nDD59/okO6R6mdY/FpNf5eLptX/f4P87MCFxVCe70OLbb3LQv+9q6Ae4bYKwQb9f/tD/oBpgf8H4wPHKEx7pA+3FexJYTyCH+eg4J/Fck3Jn2OQD+YxPWn9YDFrKmp89rU9/qnT/rrdN5F1jE055v/KAnc3tA05/Oxune7z/OJX2v2+qTbtHTX+u51nEfQ36ueyrhweU39wfBp3GTEXhfiEX/loeQD3R4Ftj5yCZdWBGVHX/zTAPtT3nOCseT3sHzP/Ry4/4Y3yUxLO3x/0o7gLynOvdhf38/b2Q6P+HnOcybld/CGP/PR315P5N1O+2hr79N+9p/PL9ekD8+nS3UkMfa05CTn+cyPT725zOIwTeJ13NNuh/nmqDHObY/afl81or2epayqrYLezojtxXAy7c1sRG0AzHvIcvpPI/pbOnp/Nz+k+5+PvflCnRM5ytprz7w55kkP+X0d+es3A/T2cN+2E99DD/Pbnnw8sf51hs3+QdeAv6t5wPw+0ims3QBnfwHvPxxxi3QP2TmepIJysGn5UfbTF11EdP5TR/OqgV+1P/ECxh3RX45m4UZSkudNzr/Xhb19mFPr2typ7kW4UznLuHpzGWwNzGdF12/nqUNPkd9WP/ugm2tHmdFfPDp5AT9mWs3gfHac/C///f/ATrENtRUXAAA','ewoicHJvY2Vzc0lkIjoxNzAwMDY2NDM4MTI2NDI0MSwKImRhdGFwbGFjZUlkIjo0MiwKInRhYmxlSWQiOjM3MjM0LAoiZGF0YW1vdmVtZW50SWQiOjI2MSwKImpvYlNjaGVkdWxlZFVzZXJJZCI6Ik1hbmFzd2luaSBDaGludGhhbGFwdWRpIiwKImpvYlNjaGVkdWxlSWQiOjE1NjgsCiJiYXRjaElkIjoxNzAwMDY2NDM4MDIzOTk1MiwKImxhc3RSdW5UaW1lc3RhbXAiOiIyMDIzLTExLTA3IDEyOjQyOjAwLjg2MzY1IiwKInJldHJ5TnVtIjogIjAiCn0=',null,1,0,current_timestamp)
""2023-11-15 16:41:16.531 [Thread-88] DEBUG com.modak.bots.DBOpsBot - to execute query timeTakenInMillis : 13676
""2023-11-15 16:41:16.531 [Thread-88] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 84c43ca6-2712-4cd9-b2d9-b0fe3f69b476 has finished process logic with message_id 4e8bcd3a-7fb0-4043-aba4-6d226c053fa0 and thread_id 164
""2023-11-15 16:41:16.531 [Thread-88] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-15 16:41:16.760 [Thread-88] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "DBOpsBot", "bot_metadata": { "message_id": "9ef48220-268b-40d5-8cd9-8f49fbd8f89c", "parent_id": "4e8bcd3a-7fb0-4043-aba4-6d226c053fa0", "bot_id": "84c43ca6-2712-4cd9-b2d9-b0fe3f69b476", "message_topic":"nabu_2_jdbc", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":17000664381264241, "initial_ts":1700066438126, "batch_id":17000664380239952, "batch_name":"Ingestion_20231115", "job_schedule_id":1568, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "2023-11-07 12:42:00.86365", "environment": "modak", "ignore_job_termination" : false, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot", "KoshBot", "DBOpsBot" ],"task_dependency":true}, "task_retry_intervals_secs": [ ], "message_context": "ingestion_deciding" }, "bot_tasks": [ { "task_name": "ingestion_deciding_msg", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "doNothingTemplate" }, "input_data": { "template_execution_type": "single", "query_type":"json", "query_input": { "target_schemadrift_flag" : [ { "nextrun_after_targetdrift" : false } ], "input_json_for_checkpoint_status" : "ewoicHJvY2Vzc0lkIjoxNzAwMDY2NDM4MTI2NDI0MSwKImRhdGFwbGFjZUlkIjo0MiwKInRhYmxlSWQiOjM3MjM0LAoiZGF0YW1vdmVtZW50SWQiOjI2MSwKImpvYlNjaGVkdWxlZFVzZXJJZCI6Ik1hbmFzd2luaSBDaGludGhhbGFwdWRpIiwKImpvYlNjaGVkdWxlSWQiOjE1NjgsCiJiYXRjaElkIjoxNzAwMDY2NDM4MDIzOTk1MiwKImxhc3RSdW5UaW1lc3RhbXAiOiIyMDIzLTExLTA3IDEyOjQyOjAwLjg2MzY1IiwKInJldHJ5TnVtIjogIjAiCn0=", "get_cdc_last_run_table" : [ { "cdc_first" : true, "prev_target_path" : null, "target_path" : "abfss:\/\/dataproc@idea15pisplznonprodsa2.dfs.core.windows.net\/261\/42\/development-db\/acuity-develop\/aaaa.parquet", "relative_path" : "\/261\/42\/development-db\/acuity-develop\/aaaa.parquet" } ], "get_cdc_type" : [ { "cdctype2" : false, "temp_path" : "17000664381264241_aaaa", "cdc_applied" : false, "is_primary" : false } ], "generate_yeedu_metastore_credential" : "ewogICJjcmVkZW50aWFsX2lkIjogIiIsCiAgImNyZWRlbnRpYWxfdHlwZV9pZCI6ICIiLAogICJ0b2tlbiI6ICJjNjk1MDU4MmExMmI1NThhYjY0OGNkYjcyMDA4MTczYjJlODQyOGZiNTVkYWFkNzQwMTUyMjU2OTFlZWM3OGVlN2I1YzRlMzQzMTJkZWQ3MGFlNWU3ZWU0ODNiN2Q3ZWEwYzIzZTI0ZTQ1OGVkMWY1NGRhM2NjZDdkYmNmZTg3MGE2MWU1YzljNTA4N2U3ZmI2ZGMxNmI2ZjhmNWU0YmVkZTRjMGUwM2IzZGI2YWZhN2I3MjljYjliY2E4MTAzY2JlNGIxYmNkMmJjNWIzMmMyNDgyN2ZkZjkxYzhjMTFjZjM2YmY1MTcxYTk5NjJjMWNhNTRmOGVjODQyMDY3YTg0OGI5MjNjNjlkMjk5YzZiNzUyNGMwOTU0MjkzMDQwMzA5YTFmOGZkMzlmNzgyZDFiZDg2NDNmMzJhNjVmYTM1NzA1NmViZGYwZDU0OWUyMGYwZjFhMDU2ZTgxMjYzODIzNGE0ZjU1ZTA1OTdmMDZhZTdmNDcwMDY0NWMwZjJkODc5YTAyZDU1MjRlYTIzNGMyMGQ5ZWVmNDZkMTVmZWRiYTViZjk1ZTZiYjgzMGZhY2RjYWFlMTcwNmZjYTYxODBiZGIwMDM1YTkzZTI0ZDU3NTRmN2QyZjhjMzM1OGJiYWJjYjVjOWYyZGRiYTBhYTk5OGNmOTljZDE4Y2M5ZTkxOGMwYzk3Yzk4MWVmZWMzZWZiNzJiNWNiNTU3MDBjYjFlODI5OTMwN2IyODhhNzg0YjgwNmI4NDkzMzY3NTQ0ZGU5OTczOWYyNGE5NjQ1NGVlNzE5MjEwZWJkMjczZTM0MzZhNDI1ODQyODBhMjMwNjA5YzNhNTZiN2RlNjZhYWFkZDRlZTA2NTdkNDU3NWJiNjkyMDAxMmZiZmVkYjY2YWYyNDRkNTE5OTI1ZmMzZTQ0YWYyZjRiYTY3NGRjMzNiYzJlZTRkYjJmNGFmZjNlOWViZDRlYTY1YTE2NzZhZGFjOGY0YTA2NDc5ZThhNDU0N2VlZThlNGUyYzM5YjAxNWJkN2Y4MTRjMzg4YzA1NTFkM2YyMmFmZDEyMWJkZmNlZjk2OWNkNzFkNmI3YjM1MGJlMTc2MWQ1OWI2NTAzMmNjZGJkYTcxODY4NjYwNWFhOGY0NzUwZmMyNzI4NTkzZDkyZDlhZGY1Zjg0ZWQ1M2EwNzlkNjA5ZDA3NjJkNTRkNzAyNDVmYjJlZjIyNDkzNTc5NzhiMzQyMjBhMWM4YzQ1MzIyZWY0ZGVkYWMxMTRhOGM5NmE1NTlkM2FlYzMyZjNlNjEzZmE4ZWVhZmYwMjhhODM3YmIxMmFiMGVjNjI1NDAxODEwNmM2NTRlY2I3ODNkNGVkMzMzOTBkYzY4YWQ4M2JlOGViODhlM2I3MTRjNDA1MzIyMDk5NDIzNzY2OTA5MzBmN2Q3NDhlMWE0YjE5NzQ5NDY2MzUwOTkzYjJlNWI0MmRiNDUyMmJjYTEzYTZhOWM1ZDI2MzM4NDhkZjgxM2QzMDc3ZTdiYTc4MDUyODlmZTA0NmI1MDA5MTk5NWQ0NmMwN2EwYzgxMzY2NjcxYjc0MTUyYjViM2Y3MGJjOCIsCiAgImNyZWRlbnRpYWxfZW5kcG9pbnRfdXJsIjogImh0dHA6Ly9kZXYtZGhhLmh1bWFuYS5jb206ODg4OS9maXJlc2hvdHMvY3JlZGVudGlhbHNGZXRjaFdlYlNlcnZpY2UiCn0=", "table_metadata_output" : [ { "is_destination_file" : true, "dataplace_id" : 42, "schema_id" : 453, "schema_name" : "acuity-develop", "table_id" : 37234, "table_timestamp" : "", "table_suffix" : "", "schema_drift_flag" : false, "is_source_filetype" : false, "destination_table_name" : "aaaa", "source_table_name" : "aaaa", "destination_backup_table_name" : "aaaa", "table_name" : "aaaa", "source_url" : null, "source_credential_id" : 37, "source_credential_type_id" : 1, "source_jdbc_driver" : "com.microsoft.sqlserver.jdbc.SQLServerDriver", "source_type" : "sql_server", "estimated_rows" : 4914, "destination_schema_id" : 3, "destination_dataplace_id" : 5, "destination_dataplace_sub_component_id" : 18, "rename_table_condition" : false, "already_ingested" : true, "verification_threshold" : 0.1, "destination_url" : null, "process_id" : 17000664381264241, "batch_id" : 17000664380239952, "batch_name" : "Ingestion_20231115", "data_movement_id" : 261, "where_condition" : "37234", "archive_files_path" : "", "is_archive_data" : false, "is_lazy_mode" : false, "is_record_process_enabled" : true, "file_format" : "", "path" : "", "is_ingestion_root_path" : false, "bucket_name" : null, "project" : null, "filesystem_endpoint" : null, "is_default" : false, "file_system_type" : "abfss", "destination_oracle_jdbc_url" : null, "oracle_jdbc_url" : null, "dest_default_credential_exists" : false, "source_default_credential_exists" : false, "is_spark_hive" : false, "destination_db" : null, "destination_directory" : null, "destination_type" : "adls_gen2", "target_type" : "adls_gen2", "destination_file_format" : "parquet", "destination_jdbc_driver" : null, "flow_number" : 1, "source_directory" : null, "destination_credential_id" : 2, "relative_file_path" : "", "is_relative_file_path" : false, "destination_credential_type_id" : 5, "destination_schema_directory_id" : 3, "authentication_type" : "auth_token", "credential_pattern" : "2_1686574260", "is_apache_jdbc_driver" : false, "ingestion_table_format" : "", "source_db" : "development-db", "warehouse_name" : null, "is_source_hive" : false, "is_source_spark_hive" : false, "create_backup_table" : null, "schema_drift_option" : "drop_create_table", "destination_dataplace_component_type_id" : 3, "filesystem_credential_id" : null, "filesystem_credential_type_id" : null, "filesystem_credential_type" : null, "is_filesystem_credential_type_aws" : true, "is_file_system_type_s3a" : false, "adls_gen2_directory_name" : null, "adls_gen2_container" : "dataproc", "storage_account" : "idea15pisplznonprodsa2", "s3_bucket" : null, "gcs_bucket" : null, "is_mysql" : false, "is_bigquery" : false, "is_needed_partition_name_without_column_name" : false, "is_jdbcmode" : false, "apply_transformation" : false, "is_destination_hive" : false, "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDY2NDU3NzgzNDI0MCwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0OTI1OCwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2NjQ1N30.cgEzDcSlWhMY65PdNscgXY1oBYM75LZUbp00acf6_d1WRUOrXXGi5pcvwkRNDv0JIxun7nmcSCqy2CKZ38-eHnEqqAoxh2CIRwXTdBlsYYFyfkXHYapfaXinAi82pkDk0yJQOs-m-vAf1cbV4ue4Zk6bHKbJeu_j5_x8HU3PKeF0pz0lA-tpeoFRlq_tLUXqApH5t7QuTIzOSq7Aujo6yOSm_inHTBzTWxUyVaBCitbKs_j3Oq-P5c-Y5W3r9oAvDNbMASikxmdxfJBp_rI2QYHdxazW9UvVh_ZpRPwOIbi7EAe9-B6BBxAxItPBTo4M-GFi-zvZZXXYMX57edoRDA", "end_point" : "http:\/\/dev-dha.humana.com:8889\/fireshots\/credentialsFetchWebService", "source_endpoint" : "s3.amazonaws.com", "destination_endpoint" : "s3.amazonaws.com", "is_azure_oauth" : false, "is_aws_iam_attached_to_ec2_instance" : false, "filesystem_credential_epoch" : null, "is_source_jdbc_url" : true, "source_jdbc_url" : "jdbc:sqlserver:\/\/hyp-acu-development-5de0.database.windows.net:1433;database=development-db;sslProtocol=TLSv1.2;encrypt=true", "pipeline_flow_timeout" : 23, "destination_schema_name" : "dataproc", "upper_case_destination_table_name" : "AAAA", "source_dataplace_id" : 42, "datamovement_engine_type" : "Spark", "intermediate_type" : "parquet", "is_create_table" : false } ], "get_cdc_audit_cols" : [], "get_list_of_maps_of_partition_columns" : [ { "?column?" : "null" } ], "get_cdc_info" : [ { "hash_type" : "", "add_audit_columns" : false, "create_view" : false, "view_name" : "v_aaaa", "is_sha2" : false, "start_date_column_name" : "valid_from_ts", "end_date_column_name" : "valid_to_ts", "job_id_column_name" : "process_id", "prev_job_id_column_name" : "prev_process_id" } ], "get_spark_configs" : [ { "compute_engine_id" : 11, "cluster_id" : null, "config_json" : { "extra_configs" : {}, "default_configs" : { "solr_batch_size" : "10000", "parallel_threads" : "10", "fetch_size" : "10000" } }, "spark_configuration_type_id" : 1, "spark_configs_json" : "{\n \"solr_batch_size\":\"10000\",\"parallel_threads\":\"10\",\"fetch_size\":\"10000\"\n }", "extra_configs_json" : { "spark.nabu.fetch_size" : "10000", "spark.nabu.solr_batch_size" : "10000" } } ], "advanced_options_tables_flags_status" : [ { "incremental_load" : false, "columns_options" : false, "modified_columns" : false, "excluded_column_ids" : false, "virtual_column" : false, "reorder_columns" : false, "remove_duplicates" : false, "sort_by_columns" : false, "table_partitions" : false, "new_table_name" : false, "parallel_ingestion" : false, "cdc" : null, "ingest_using_query" : false, "ingestion_mode" : true, "enable_cache" : false } ], "yeedu_input_json" : "ewoiY2x1c3Rlcl9pZCI6ICIiLAoiYjY0X2lucHV0X2pzb24iOiAiZXdvaWNISnZZMlZ6YzBsa0lqb3hOekF3TURZMk5ETTRNVEkyTkRJME1Td0tJbVJoZEdGd2JHRmpaVWxrSWpvME1pd0tJblJoWW14bFNXUWlPak0zTWpNMExBb2laR0YwWVcxdmRtVnRaVzUwU1dRaU9qSTJNU3dLSW1wdllsTmphR1ZrZFd4bFpGVnpaWEpKWkNJNklrMWhibUZ6ZDJsdWFTQkRhR2x1ZEdoaGJHRndkV1JwSWl3S0ltcHZZbE5qYUdWa2RXeGxTV1FpT2pFMU5qZ3NDaUppWVhSamFFbGtJam94TnpBd01EWTJORE00TURJek9UazFNaXdLSW14aGMzUlNkVzVVYVcxbGMzUmhiWEFpT2lJeU1ESXpMVEV4TFRBM0lERXlPalF5T2pBd0xqZzJNelkxSWl3S0luSmxkSEo1VG5WdElqb2dJakFpQ24wPSIsCiJleHRyYV9jb25maWciOiAiZXdvaVpYaDBjbUZEYjI1bWFXZE5ZWEFpT2lCN0luTndZWEpyTG01aFluVXVabVYwWTJoZmMybDZaU0k2SUNJeE1EQXdNQ0lzSUNKemNHRnlheTV1WVdKMUxtTnZiWEIxZEdWZlpXNW5hVzVsSWpvZ0ltRjZkWEpsWDJSaGRHRmljbWxqYTNNaUxDQWljM0JoY21zdWJtRmlkUzV6YjJ4eVgySmhkR05vWDNOcGVtVWlPaUFpTVRBd01EQWlMQ0FpYzNCaGNtc3VibUZpZFM1aGNIQnNhV05oZEdsdmJsOXVZVzFsSWpvZ0ltNWhZblV0YzNCaGNtdGliM1F0YVc1blpYTjBhVzl1SWl3Z0luTndZWEpyTG1SeWFYWmxjaTV1WVdKMVgzQnlhWFpoZEdWTFpYa2lPaUFpTDJSaVpuTXZkRzF3TDJSbGRpMTJNeTB4TFRJdE1DOXVZV0oxTHpFM01EQXdOalkwTXpneE1qWTBNalF4THpBdmNISnBkbUYwWlV0bGVTSXNJQ0p6Y0dGeWF5NWtjbWwyWlhJdWMyOTFjbU5sWDJGM2MxOWxibVJRYjJsdWRDSTZJQ0p6TXk1aGJXRjZiMjVoZDNNdVkyOXRJaXdnSW5Od1lYSnJMbVJ5YVhabGNpNTBZWEpuWlhSZllYZHpYMlZ1WkZCdmFXNTBJam9nSW5NekxtRnRZWHB2Ym1GM2N5NWpiMjBpTENBaWMzQmhjbXN1Ym1GaWRTNWpiMjF3ZFhSbFgyVnVaMmx1WlY5c2FXSnpYM0JoZEdnaU9pQWlMMlJpWm5NdmRHMXdMMlJsZGkxMk15MHhMVEl0TUM5dVlXSjFMekUzTURBd05qWTBNemd4TWpZME1qUXhMekF2WVhCd2JHbGpZWFJwYjI0dVkyOXVaaUo5Q24wPSIsCiJjb21wdXRlX2VuZ19jcmVkc19qc29uIiA6ICJld29nSUNKamNtVmtaVzUwYVdGc1gybGtJam9nSWpReElpd0tJQ0FpWTNKbFpHVnVkR2xoYkY5MGVYQmxYMmxrSWpvZ0lqRTFJaXdLSUNBaVkzSmxaR1Z1ZEdsaGJGOTBlWEJsSWpvZ0lrWnBiR1VnUTI5dWRHVnVkQ0lzQ2lBZ0luUnZhMlZ1SWpvZ0ltTTJPVFV3TlRneVlURXlZalUxT0dGaU5qUTRZMlJpTnpJd01EZ3hOek5pTW1VNE5ESTRabUkxTldSaFlXUTNOREF4TlRJeU5UWTVNV1ZsWXpjNFpXVTNZalZqTkdVek5ETXhNbVJsWkRjd1lXVTFaVGRsWlRRNE0ySTNaRGRsWVRCak1qTmxNalJsTkRVNFpXUXhaalUwWkdFelkyTmtOMlJpWTJabE9EY3dZVFl4WlRWak9XTTFNRGczWlRkbVlqWmtZekUyWWpabU9HWTFaVFJpWldSbE5HTXdaVEF6WWpOa1lqWmhabUUzWWpjeU9XTmlPV0pqWVRneE1ETmpZbVUwWWpGaVkyUXlZbU0xWWpNeVl6STBPREkzWm1SbU9URmpPR014TVdObU16WmlaalV4TnpGaE9UazJNbU14WTJFMU5HWTRaV000TkRJd05qZGhPRFE0WWpreU0yTTJPV1F5T1Rsak5tSTNOVEkwWXpBNU5UUXlPVE13TkRBek1EbGhNV1k0Wm1Rek9XWTNPREprTVdKa09EWTBNMll6TW1FMk5XWmhNelUzTURVMlpXSmtaakJrTlRRNVpUSXdaakJtTVdFd05UWmxPREV5TmpNNE1qTTBZVFJtTlRWbE1EVTVOMll3Tm1GbE4yWTBOekF3TmpRMVl6Qm1NbVE0TnpsaE1ESmtOVFV5TkdWaE1qTTBZekl3WkRsbFpXWTBObVF4TldabFpHSmhOV0ptT1RWbE5tSmlPRE13Wm1GalpHTmhZV1V4TnpBMlptTmhOakU0TUdKa1lqQXdNelZoT1RObE1qUmtOVGMxTkdZM1pESm1PR016TXpVNFltSmhZbU5pTldNNVpqSmtaR0poTUdGaE9UazRZMlk1T1dOa01UaGpZemxsT1RFNFl6QmpPVGRqT1RneFpXWmxZek5sWm1JM01tSTFZMkkxTlRjd01HTmlNV1U0TWprNU16QTNZakk0T0dFM09EUmlPREEyWWpnME9UTXpOamMxTkRSa1pUazVOek01WmpJMFlUazJORFUwWldVM01Ua3lNVEJsWW1ReU56TmxNelF6Tm1FME1qVTROREk0TUdFeU16QTJNRGxqTTJFMU5tSTNaR1UyTm1GaFlXUmtOR1ZsTURZMU4yUTBOVGMxWW1JMk9USXdNREV5Wm1KbVpXUmlOalpoWmpJME5HUTFNVGs1TWpWbVl6TmxORFJoWmpKbU5HSmhOamMwWkdNek0ySmpNbVZsTkdSaU1tWTBZV1ptTTJVNVpXSmtOR1ZoTmpWaE1UWTNObUZrWVdNNFpqUmhNRFkwTnpsbE9HRTBOVFEzWldWbE9HVTBaVEpqTXpsaU1ERTFZbVEzWmpneE5HTXpPRGhqTURVMU1XUXpaakl5WVdaa01USXhZbVJtWTJWbU9UWTVZMlEzTVdRMllqZGlNelV3WW1VeE56WXhaRFU1WWpZMU1ETXlZMk5rWW1SaE56RTROamcyTmpBMVlXRTRaalEzTlRCbVl6STNNamcxT1ROa09USmtPV0ZrWmpWbU9EUmxaRFV6WVRBM09XUTJNRGxrTURjMk1tUTFOR1EzTURJME5XWmlNbVZtTWpJME9UTTFOemszT0dJek5ESXlNR0V4WXpoak5EVXpNakpsWmpSa1pXUmhZekV4TkdFNFl6azJZVFUxT1dRellXVmpNekptTTJVMk1UTm1ZVGhsWldGbVpqQXlPR0U0TXpkaVlqRXlZV0l3WldNMk1qVTBNREU0TVRBMll6WTFOR1ZqWWpjNE0yUTBaV1F6TXpNNU1HUmpOamhoWkRnelltVTRaV0k0T0dVellqY3hOR00wTURVek1qSXdPVGswTWpNM05qWTVNRGt6TUdZM1pEYzBPR1V4WVRSaU1UazNORGswTmpZek5UQTVPVE5pTW1VMVlqUXlaR0kwTlRJeVltTmhNVE5oTm1FNVl6VmtNall6TXpnME9HUm1PREV6WkRNd056ZGxOMkpoTnpnd05USTRPV1psTURRMllqVXdNRGt4T1RrMVpEUTJZekEzWVRCak9ERXpOalkyTnpGaU56UXhOVEppTldJelpqY3dZbU00SWl3S0lDQWlZM0psWkdWdWRHbGhiRjlsYm1Sd2IybHVkRjkxY213aU9pQWlhSFIwY0RvdkwyUmxkaTFrYUdFdWFIVnRZVzVoTG1OdmJUbzRPRGc1TDJacGNtVnphRzkwY3k5amNtVmtaVzUwYVdGc2MwWmxkR05vVjJWaVUyVnlkbWxqWlNJc0NpQWdJbVpwYkdWZmNHRjBhQ0k2SUNJeE5UWTRYekkyTVY4eE56QXdNRFkyTkRNNE1ESXpPVGsxTWlJc0NpQWdJbU55WldSbGJuUnBZV3hmWm1sc1pWOXdZWFIwWlhKdUlpQTZJQ0kwTVY4eE5qazVNelF5TlRjMUlncDkiLAoiY2x1c3Rlcl91aSI6ICIiLAoicmV0cnlfbnVtIjogIjAiLAoic3BhcmtfY29uZmlncyI6ICJld29nSUNBZ0luTnZiSEpmWW1GMFkyaGZjMmw2WlNJNklqRXdNREF3SWl3aWNHRnlZV3hzWld4ZmRHaHlaV0ZrY3lJNklqRXdJaXdpWm1WMFkyaGZjMmw2WlNJNklqRXdNREF3SWdvZ0lDQWdmUT09IiwKImI2NF9oaXZlX2NyZWRzX2pzb24iOiAiZXdvZ0lDSmpjbVZrWlc1MGFXRnNYMmxrSWpvZ0lpSXNDaUFnSW1OeVpXUmxiblJwWVd4ZmRIbHdaVjlwWkNJNklDSWlMQW9nSUNKMGIydGxiaUk2SUNKak5qazFNRFU0TW1FeE1tSTFOVGhoWWpZME9HTmtZamN5TURBNE1UY3pZakpsT0RReU9HWmlOVFZrWVdGa056UXdNVFV5TWpVMk9URmxaV00zT0dWbE4ySTFZelJsTXpRek1USmtaV1EzTUdGbE5XVTNaV1UwT0ROaU4yUTNaV0V3WXpJelpUSTBaVFExT0dWa01XWTFOR1JoTTJOalpEZGtZbU5tWlRnM01HRTJNV1UxWXpsak5UQTROMlUzWm1JMlpHTXhObUkyWmpobU5XVTBZbVZrWlRSak1HVXdNMkl6WkdJMllXWmhOMkkzTWpsallqbGlZMkU0TVRBelkySmxOR0l4WW1Oa01tSmpOV0l6TW1NeU5EZ3lOMlprWmpreFl6aGpNVEZqWmpNMlltWTFNVGN4WVRrNU5qSmpNV05oTlRSbU9HVmpPRFF5TURZM1lUZzBPR0k1TWpOak5qbGtNams1WXpaaU56VXlOR013T1RVME1qa3pNRFF3TXpBNVlURm1PR1prTXpsbU56Z3laREZpWkRnMk5ETm1NekpoTmpWbVlUTTFOekExTm1WaVpHWXdaRFUwT1dVeU1HWXdaakZoTURVMlpUZ3hNall6T0RJek5HRTBaalUxWlRBMU9UZG1NRFpoWlRkbU5EY3dNRFkwTldNd1pqSmtPRGM1WVRBeVpEVTFNalJsWVRJek5HTXlNR1E1WldWbU5EWmtNVFZtWldSaVlUVmlaamsxWlRaaVlqZ3pNR1poWTJSallXRmxNVGN3Tm1aallUWXhPREJpWkdJd01ETTFZVGt6WlRJMFpEVTNOVFJtTjJReVpqaGpNek0xT0dKaVlXSmpZalZqT1dZeVpHUmlZVEJoWVRrNU9HTm1PVGxqWkRFNFkyTTVaVGt4T0dNd1l6azNZems0TVdWbVpXTXpaV1ppTnpKaU5XTmlOVFUzTURCallqRmxPREk1T1RNd04ySXlPRGhoTnpnMFlqZ3dObUk0TkRrek16WTNOVFEwWkdVNU9UY3pPV1l5TkdFNU5qUTFOR1ZsTnpFNU1qRXdaV0prTWpjelpUTTBNelpoTkRJMU9EUXlPREJoTWpNd05qQTVZek5oTlRaaU4yUmxOalpoWVdGa1pEUmxaVEEyTlRka05EVTNOV0ppTmpreU1EQXhNbVppWm1Wa1lqWTJZV1l5TkRSa05URTVPVEkxWm1NelpUUTBZV1l5WmpSaVlUWTNOR1JqTXpOaVl6SmxaVFJrWWpKbU5HRm1aak5sT1dWaVpEUmxZVFkxWVRFMk56WmhaR0ZqT0dZMFlUQTJORGM1WlRoaE5EVTBOMlZsWlRobE5HVXlZek01WWpBeE5XSmtOMlk0TVRSak16ZzRZekExTlRGa00yWXlNbUZtWkRFeU1XSmtabU5sWmprMk9XTmtOekZrTm1JM1lqTTFNR0psTVRjMk1XUTFPV0kyTlRBek1tTmpaR0prWVRjeE9EWTROall3TldGaE9HWTBOelV3Wm1NeU56STROVGt6WkRreVpEbGhaR1kxWmpnMFpXUTFNMkV3Tnpsa05qQTVaREEzTmpKa05UUmtOekF5TkRWbVlqSmxaakl5TkRrek5UYzVOemhpTXpReU1qQmhNV000WXpRMU16SXlaV1kwWkdWa1lXTXhNVFJoT0dNNU5tRTFOVGxrTTJGbFl6TXlaak5sTmpFelptRTRaV1ZoWm1Zd01qaGhPRE0zWW1JeE1tRmlNR1ZqTmpJMU5EQXhPREV3Tm1NMk5UUmxZMkkzT0ROa05HVmtNek16T1RCa1l6WTRZV1E0TTJKbE9HVmlPRGhsTTJJM01UUmpOREExTXpJeU1EazVOREl6TnpZMk9UQTVNekJtTjJRM05EaGxNV0UwWWpFNU56UTVORFkyTXpVd09Ua3pZakpsTldJME1tUmlORFV5TW1KallURXpZVFpoT1dNMVpESTJNek00TkRoa1pqZ3hNMlF6TURjM1pUZGlZVGM0TURVeU9EbG1aVEEwTm1JMU1EQTVNVGs1TldRME5tTXdOMkV3WXpneE16WTJOamN4WWpjME1UVXlZalZpTTJZM01HSmpPQ0lzQ2lBZ0ltTnlaV1JsYm5ScFlXeGZaVzVrY0c5cGJuUmZkWEpzSWpvZ0ltaDBkSEE2THk5a1pYWXRaR2hoTG1oMWJXRnVZUzVqYjIwNk9EZzRPUzltYVhKbGMyaHZkSE12WTNKbFpHVnVkR2xoYkhOR1pYUmphRmRsWWxObGNuWnBZMlVpQ24wPSIsCiJiYXRjaF9pZCI6MTcwMDA2NjQzODAyMzk5NTIsCiJwcm9jZXNzX2lkIiA6MTcwMDA2NjQzODEyNjQyNDEsCiJyZXN0X3VybCI6ICIiLAoiYjY0X2V4dGVybmFsX2phcnNfbWFwIiA6ICIiCn0=", "ingestion_mode" : [ { "data_movement_id" : 261, "save_mode" : "Overwrite", "mode" : "overwrite", "ingestion_mode_key" : true, "drop_create_condition" : true } ], "generate_extra_configs_json" : "ewoiZXh0cmFDb25maWdNYXAiOiB7InNwYXJrLm5hYnUuZmV0Y2hfc2l6ZSI6ICIxMDAwMCIsICJzcGFyay5uYWJ1LmNvbXB1dGVfZW5naW5lIjogImF6dXJlX2RhdGFicmlja3MiLCAic3BhcmsubmFidS5zb2xyX2JhdGNoX3NpemUiOiAiMTAwMDAiLCAic3BhcmsubmFidS5hcHBsaWNhdGlvbl9uYW1lIjogIm5hYnUtc3Bhcmtib3QtaW5nZXN0aW9uIiwgInNwYXJrLmRyaXZlci5uYWJ1X3ByaXZhdGVLZXkiOiAiL2RiZnMvdG1wL2Rldi12My0xLTItMC9uYWJ1LzE3MDAwNjY0MzgxMjY0MjQxLzAvcHJpdmF0ZUtleSIsICJzcGFyay5kcml2ZXIuc291cmNlX2F3c19lbmRQb2ludCI6ICJzMy5hbWF6b25hd3MuY29tIiwgInNwYXJrLmRyaXZlci50YXJnZXRfYXdzX2VuZFBvaW50IjogInMzLmFtYXpvbmF3cy5jb20iLCAic3BhcmsubmFidS5jb21wdXRlX2VuZ2luZV9saWJzX3BhdGgiOiAiL2RiZnMvdG1wL2Rldi12My0xLTItMC9uYWJ1LzE3MDAwNjY0MzgxMjY0MjQxLzAvYXBwbGljYXRpb24uY29uZiJ9Cn0=", "incremental_load_details" : [ { "?column?" : 1 } ], "place_holders_with_default_and_max_values" : [ { "?column?" : 1 } ], "incremental_max_columns_with_column_ids" : [ { "?column?" : 1 } ], "remove_duplicates_data" : [], "cdc_first_time" : [ { "cdc_first_time" : true } ], "generate_base64_pipeline_timeout_json" : "ewoicGlwZWxpbmVfdGltZW91dCIgOiAyMwp9", "table_partition_output" : [], "fetch_source_type" : [ { "data_movement_id" : 261, "source_metadata_category" : "relational", "destination_metadata_category" : "file", "source" : "sql_server", "destination" : "adls_gen2", "is_source_filetype" : false, "is_source_salesforce" : false, "is_source_mongodb" : false, "is_destination_filetype" : true, "is_ordinalpos_startwith_zero" : false, "is_destination_redshift" : false } ], "destination_transformation_query_details_output" : [ { "is_virtual" : false, "column_id" : 956158, "is_source_casting_enabled" : false, "is_partitioned_col" : false, "column_name" : "entity_id", "replaced_column_name" : "entity_id", "data_type" : "varchar", "data_length" : 255, "ordinal_position" : 1, "is_nullable" : false, "table_name" : "aaaa", "schema_name" : "acuity-develop", "is_mysql" : false, "is_bigquery" : false, "is_source_hive" : false, "source_type" : "sql_server", "source_datatype_name" : "varchar", "source_cast_type" : "AsIs", "intermediate_datatype_name" : "string", "table_id" : 37234, "source_stg_function" : "AsIs", "data_scale" : 0, "data_precision" : 0, "is_precision" : true, "is_precision_scale" : true, "is_redshift_relational_destination" : false, "is_oracle_destination" : false, "is_varchar" : false, "destination_datatype_name" : "string", "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "field_name" : "entity_id", "field_name_replaced" : "entity_id", "is_long_col_name" : false, "istimezone" : false, "user_text" : null, "is_cdc_col" : false, "ingested_colorder" : 1 }, { "is_virtual" : false, "column_id" : 956159, "is_source_casting_enabled" : false, "is_partitioned_col" : false, "column_name" : "entity_type", "replaced_column_name" : "entity_type", "data_type" : "varchar", "data_length" : 255, "ordinal_position" : 2, "is_nullable" : false, "table_name" : "aaaa", "schema_name" : "acuity-develop", "is_mysql" : false, "is_bigquery" : false, "is_source_hive" : false, "source_type" : "sql_server", "source_datatype_name" : "varchar", "source_cast_type" : "AsIs", "intermediate_datatype_name" : "string", "table_id" : 37234, "source_stg_function" : "AsIs", "data_scale" : 0, "data_precision" : 0, "is_precision" : true, "is_precision_scale" : true, "is_redshift_relational_destination" : false, "is_oracle_destination" : false, "is_varchar" : false, "destination_datatype_name" : "string", "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "field_name" : "entity_type", "field_name_replaced" : "entity_type", "is_long_col_name" : false, "istimezone" : false, "user_text" : null, "is_cdc_col" : false, "ingested_colorder" : 2 } ], "get_varchar_columns_destination" : [], "input_data" : { "flow_number" : 1, "process_id" : 17000664381264241, "source_database_name_lowercase" : "development-db", "batch_id" : 17000664380239952, "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDY2NDU3NzgzNDI0MCwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0OTI1OCwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2NjQ1N30.cgEzDcSlWhMY65PdNscgXY1oBYM75LZUbp00acf6_d1WRUOrXXGi5pcvwkRNDv0JIxun7nmcSCqy2CKZ38-eHnEqqAoxh2CIRwXTdBlsYYFyfkXHYapfaXinAi82pkDk0yJQOs-m-vAf1cbV4ue4Zk6bHKbJeu_j5_x8HU3PKeF0pz0lA-tpeoFRlq_tLUXqApH5t7QuTIzOSq7Aujo6yOSm_inHTBzTWxUyVaBCitbKs_j3Oq-P5c-Y5W3r9oAvDNbMASikxmdxfJBp_rI2QYHdxazW9UvVh_ZpRPwOIbi7EAe9-B6BBxAxItPBTo4M-GFi-zvZZXXYMX57edoRDA", "end_point" : "http:\/\/dev-dha.humana.com:8889\/fireshots\/credentialsFetchWebService", "where_condition" : "37234", "suffix" : "", "reorder_columns" : [], "job_type_id" : "1", "ingestion_table_format" : "", "job_schedule_id" : 1568, "relative_file_path" : "", "retry_attempt" : "0", "source_schema_name_lowercase" : "acuity-develop", "variables" : { "env_variables" : {}, "user_variables" : {}, "payload_variables" : {} }, "source_database_name_uppercase" : "DEVELOPMENT-DB", "job_scheduled_user_id" : "Manaswini Chinthalapudi", "virtual_column" : [], "new_table_for_rename" : "", "source_schema_name_uppercase" : "ACUITY-DEVELOP", "batch_name" : "Ingestion_20231115", "modified_columns" : [], "source_database_name" : "development-db", "data_movement_id" : 261, "last_run_timestamp" : "2023-11-07 12:42:00.86365", "is_relative_file_path" : false }, "table_adv_opt_details" : [ { "object_id" : 37234, "data_movement_id" : 261, "advance_option_details" : { "advanced_table_options" : { "columns_options" : { "modified_columns" : [], "virtual_column" : [], "excluded_column_ids" : [] }, "CDC" : { "audit_columns" : { "prev_process_id_column_name" : "prev_process_id", "end_date_column_name" : "valid_to_ts", "process_id_column_name" : "process_id", "start_date_column_name" : "valid_from_ts" }, "CDC_process_type" : "", "add_audit_columns" : false, "columns_ids" : [], "CDC_type" : "", "create_view" : false, "hash_type" : "", "view_name" : "v_aaaa" }, "sort_by_columns" : [], "incremental_load" : { "condition_values" : [], "where_clause" : "" }, "parallel_ingestion" : { "max_connections" : 1, "enable" : false }, "remove_duplicates" : { "sort_columns" : [], "key_columns" : [] }, "table_id" : 37234, "reorder_columns" : [], "table_name" : "aaaa", "parallel_hash_ingestion" : { "max_connections" : 8, "enable" : false }, "dataplace_id" : 42, "ingestion_mode" : { "mode" : "Drop & Re-create", "enable" : true }, "enable_cache" : { "enable" : false }, "ingest_using_query" : { "enable" : false, "sql_query" : "" }, "schema_id" : 453, "new_table_name" : "", "table_partitions" : [] }, "advanced_option_flags" : { "columns_options" : false, "CDC" : false, "sort_by_columns" : false, "incremental_load" : false, "parallel_ingestion" : false, "remove_duplicates" : false, "virtual_column" : false, "table_id" : 37234, "reorder_columns" : false, "table_name" : "aaaa", "parallel_hash_ingestion" : false, "dataplace_id" : 42, "modified_columns" : false, "ingestion_mode" : true, "enable_cache" : false, "ingest_using_query" : false, "schema_id" : 453, "new_table_name" : false, "excluded_column_ids" : false, "table_partitions" : false } }, "valid_from_ts" : "2023-11-15 09:31:16.466337", "valid_to_ts" : "9999-12-31 00:00:00.0", "cru_ts" : "2023-11-15 09:31:16.466337", "cru_by" : "Venkata Yeedi", "dataplace_id" : 42 } ], "check_compute_engine_validity" : [ { "is_valid_compute_engine" : true } ], "get_non_partition_cols" : [ { "field_name" : "entity_id", "source_field_name" : "entity_id", "column_name" : "entity_id", "column_id" : "956158", "source_datatype_name" : "varchar", "ingested_colorder" : 1, "destination_datatype_name" : "string", "is_partitioned_col" : false, "is_virtual" : false, "is_auditcol" : false, "data_length" : "255", "data_scale" : "0", "data_precision" : "0" }, { "field_name" : "entity_type", "source_field_name" : "entity_type", "column_name" : "entity_type", "column_id" : "956159", "source_datatype_name" : "varchar", "ingested_colorder" : 2, "destination_datatype_name" : "string", "is_partitioned_col" : false, "is_virtual" : false, "is_auditcol" : false, "data_length" : "255", "data_scale" : "0", "data_precision" : "0" } ], "get_partition_cols" : [], "list_of_maps_of_incremental_columns" : [ { "?column?" : 1 } ], "spark_script_inputs" : [ { "ssh_host" : "null", "ssh_username" : "null", "kerberos" : null, "spark_location" : "null", "data_movement_name" : "ss_compass_adb_validation", "cluster_library_path" : "\/dbfs\/tmp", "engine_sub_type" : "azure databricks", "spark_version" : "3.1", "scala_version" : "2.12", "cloud_type" : "null", "cluster_ui" : null, "rest_url" : null, "cluster_id" : "0922-003138-orn9r0te", "dataproc_project" : "null", "region" : "null", "dataproc_cluster" : "null", "s3_bucket_path" : null, "is_bucket_encrypted" : null, "execution_role" : null, "loggroupname" : null, "release_label" : null, "cloud_watch" : null, "s3logs" : null, "engine_path" : "azure_databricks", "compute_engine_info" : "ewoiY2x1c3Rlcl9pZCI6IjA5MjItMDAzMTM4LW9ybjlyMHRlIiwic3BhcmtfdmVyc2lvbl92YWx1ZSI6IjNfMSIsInNjYWxhX3ZlcnNpb25fdmFsdWUiOiIyXzEyIiwiY3JlZGVudGlhbHNfZmlsZXBhdGgiOiIiLCJjbHVzdGVyX2xpYnJhcnlfcGF0aCI6Ii9kYmZzL3RtcCIsInNwYXJrX3ZlcnNpb24iOiIzLjEiLCJzY2FsYV92ZXJzaW9uIjoiMi4xMiIKfQ==", "private_key_path" : "\/dbfs\/tmp\/dev-v3-1-2-0\/nabu\/17000664381264241\/0\/privateKey", "b64_external_jars_map" : null } ], "column_metadata_output" : [ { "is_virtual" : false, "column_id" : 956158, "is_source_casting_enabled" : false, "is_partitioned_col" : false, "column_name" : "entity_id", "replaced_column_name" : "entity_id", "data_type" : "varchar", "data_length" : 255, "ordinal_position" : 1, "is_nullable" : false, "table_name" : "aaaa", "schema_name" : "acuity-develop", "is_mysql" : false, "is_bigquery" : false, "is_source_hive" : false, "source_type" : "sql_server", "source_datatype_name" : "varchar", "source_cast_type" : "AsIs", "intermediate_datatype_name" : "string", "table_id" : 37234, "source_stg_function" : "AsIs", "data_scale" : 0, "data_precision" : 0, "is_precision" : true, "is_precision_scale" : true, "is_redshift_relational_destination" : false, "is_oracle_destination" : false, "is_varchar" : false, "destination_datatype_name" : "string", "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "field_name" : "entity_id", "field_name_replaced" : "entity_id", "is_long_col_name" : false, "istimezone" : false, "user_text" : null, "is_cdc_col" : false }, { "is_virtual" : false, "column_id" : 956159, "is_source_casting_enabled" : false, "is_partitioned_col" : false, "column_name" : "entity_type", "replaced_column_name" : "entity_type", "data_type" : "varchar", "data_length" : 255, "ordinal_position" : 2, "is_nullable" : false, "table_name" : "aaaa", "schema_name" : "acuity-develop", "is_mysql" : false, "is_bigquery" : false, "is_source_hive" : false, "source_type" : "sql_server", "source_datatype_name" : "varchar", "source_cast_type" : "AsIs", "intermediate_datatype_name" : "string", "table_id" : 37234, "source_stg_function" : "AsIs", "data_scale" : 0, "data_precision" : 0, "is_precision" : true, "is_precision_scale" : true, "is_redshift_relational_destination" : false, "is_oracle_destination" : false, "is_varchar" : false, "destination_datatype_name" : "string", "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "field_name" : "entity_type", "field_name_replaced" : "entity_type", "is_long_col_name" : false, "istimezone" : false, "user_text" : null, "is_cdc_col" : false } ], "updated_wherecondition_replaced_with_default_and_max_values" : [ { "?column?" : 1 } ], "cdc_schema_drift_new_table" : [ { "drift_new_table" : false } ], "emr_input_json" : "ewogICJjbHVzdGVyX2lkIjogIjA5MjItMDAzMTM4LW9ybjlyMHRlIiwKICAiY2x1c3Rlcl9yZWdpb24iOiAibnVsbCIsCiAgImNvbXB1dGVfZW5nX2NyZWRzX2pzb24iOiAiZXdvZ0lDSmpjbVZrWlc1MGFXRnNYMmxrSWpvZ0lqUXhJaXdLSUNBaVkzSmxaR1Z1ZEdsaGJGOTBlWEJsWDJsa0lqb2dJakUxSWl3S0lDQWlZM0psWkdWdWRHbGhiRjkwZVhCbElqb2dJa1pwYkdVZ1EyOXVkR1Z1ZENJc0NpQWdJblJ2YTJWdUlqb2dJbU0yT1RVd05UZ3lZVEV5WWpVMU9HRmlOalE0WTJSaU56SXdNRGd4TnpOaU1tVTROREk0Wm1JMU5XUmhZV1EzTkRBeE5USXlOVFk1TVdWbFl6YzRaV1UzWWpWak5HVXpORE14TW1SbFpEY3dZV1UxWlRkbFpUUTRNMkkzWkRkbFlUQmpNak5sTWpSbE5EVTRaV1F4WmpVMFpHRXpZMk5rTjJSaVkyWmxPRGN3WVRZeFpUVmpPV00xTURnM1pUZG1ZalprWXpFMllqWm1PR1kxWlRSaVpXUmxOR013WlRBellqTmtZalpoWm1FM1lqY3lPV05pT1dKallUZ3hNRE5qWW1VMFlqRmlZMlF5WW1NMVlqTXlZekkwT0RJM1ptUm1PVEZqT0dNeE1XTm1NelppWmpVeE56RmhPVGsyTW1NeFkyRTFOR1k0WldNNE5ESXdOamRoT0RRNFlqa3lNMk0yT1dReU9UbGpObUkzTlRJMFl6QTVOVFF5T1RNd05EQXpNRGxoTVdZNFptUXpPV1kzT0RKa01XSmtPRFkwTTJZek1tRTJOV1poTXpVM01EVTJaV0prWmpCa05UUTVaVEl3WmpCbU1XRXdOVFpsT0RFeU5qTTRNak0wWVRSbU5UVmxNRFU1TjJZd05tRmxOMlkwTnpBd05qUTFZekJtTW1RNE56bGhNREprTlRVeU5HVmhNak0wWXpJd1pEbGxaV1kwTm1ReE5XWmxaR0poTldKbU9UVmxObUppT0RNd1ptRmpaR05oWVdVeE56QTJabU5oTmpFNE1HSmtZakF3TXpWaE9UTmxNalJrTlRjMU5HWTNaREptT0dNek16VTRZbUpoWW1OaU5XTTVaakprWkdKaE1HRmhPVGs0WTJZNU9XTmtNVGhqWXpsbE9URTRZekJqT1Rkak9UZ3haV1psWXpObFptSTNNbUkxWTJJMU5UY3dNR05pTVdVNE1qazVNekEzWWpJNE9HRTNPRFJpT0RBMllqZzBPVE16TmpjMU5EUmtaVGs1TnpNNVpqSTBZVGsyTkRVMFpXVTNNVGt5TVRCbFltUXlOek5sTXpRek5tRTBNalU0TkRJNE1HRXlNekEyTURsak0yRTFObUkzWkdVMk5tRmhZV1JrTkdWbE1EWTFOMlEwTlRjMVltSTJPVEl3TURFeVptSm1aV1JpTmpaaFpqSTBOR1ExTVRrNU1qVm1Zek5sTkRSaFpqSm1OR0poTmpjMFpHTXpNMkpqTW1WbE5HUmlNbVkwWVdabU0yVTVaV0prTkdWaE5qVmhNVFkzTm1Ga1lXTTRaalJoTURZME56bGxPR0UwTlRRM1pXVmxPR1UwWlRKak16bGlNREUxWW1RM1pqZ3hOR016T0Roak1EVTFNV1F6WmpJeVlXWmtNVEl4WW1SbVkyVm1PVFk1WTJRM01XUTJZamRpTXpVd1ltVXhOell4WkRVNVlqWTFNRE15WTJOa1ltUmhOekU0TmpnMk5qQTFZV0U0WmpRM05UQm1ZekkzTWpnMU9UTmtPVEprT1dGa1pqVm1PRFJsWkRVellUQTNPV1EyTURsa01EYzJNbVExTkdRM01ESTBOV1ppTW1WbU1qSTBPVE0xTnprM09HSXpOREl5TUdFeFl6aGpORFV6TWpKbFpqUmtaV1JoWXpFeE5HRTRZemsyWVRVMU9XUXpZV1ZqTXpKbU0yVTJNVE5tWVRobFpXRm1aakF5T0dFNE16ZGlZakV5WVdJd1pXTTJNalUwTURFNE1UQTJZelkxTkdWallqYzRNMlEwWldRek16TTVNR1JqTmpoaFpEZ3pZbVU0WldJNE9HVXpZamN4TkdNME1EVXpNakl3T1RrME1qTTNOalk1TURrek1HWTNaRGMwT0dVeFlUUmlNVGszTkRrME5qWXpOVEE1T1ROaU1tVTFZalF5WkdJME5USXlZbU5oTVROaE5tRTVZelZrTWpZek16ZzBPR1JtT0RFelpETXdOemRsTjJKaE56Z3dOVEk0T1dabE1EUTJZalV3TURreE9UazFaRFEyWXpBM1lUQmpPREV6TmpZMk56RmlOelF4TlRKaU5XSXpaamN3WW1NNElpd0tJQ0FpWTNKbFpHVnVkR2xoYkY5bGJtUndiMmx1ZEY5MWNtd2lPaUFpYUhSMGNEb3ZMMlJsZGkxa2FHRXVhSFZ0WVc1aExtTnZiVG80T0RnNUwyWnBjbVZ6YUc5MGN5OWpjbVZrWlc1MGFXRnNjMFpsZEdOb1YyVmlVMlZ5ZG1salpTSXNDaUFnSW1acGJHVmZjR0YwYUNJNklDSXhOVFk0WHpJMk1WOHhOekF3TURZMk5ETTRNREl6T1RrMU1pSXNDaUFnSW1OeVpXUmxiblJwWVd4ZlptbHNaVjl3WVhSMFpYSnVJaUE2SUNJME1WOHhOams1TXpReU5UYzFJZ3A5IiwKICAiczNfcGF0aCI6ICIiLAogICJiNjRfaW5wdXRfanNvbiI6ICJld29pY0hKdlkyVnpjMGxrSWpveE56QXdNRFkyTkRNNE1USTJOREkwTVN3S0ltUmhkR0Z3YkdGalpVbGtJam8wTWl3S0luUmhZbXhsU1dRaU9qTTNNak0wTEFvaVpHRjBZVzF2ZG1WdFpXNTBTV1FpT2pJMk1Td0tJbXB2WWxOamFHVmtkV3hsWkZWelpYSkpaQ0k2SWsxaGJtRnpkMmx1YVNCRGFHbHVkR2hoYkdGd2RXUnBJaXdLSW1wdllsTmphR1ZrZFd4bFNXUWlPakUxTmpnc0NpSmlZWFJqYUVsa0lqb3hOekF3TURZMk5ETTRNREl6T1RrMU1pd0tJbXhoYzNSU2RXNVVhVzFsYzNSaGJYQWlPaUl5TURJekxURXhMVEEzSURFeU9qUXlPakF3TGpnMk16WTFJaXdLSW5KbGRISjVUblZ0SWpvZ0lqQWlDbjA9IiwKICAiZXh0cmFfY29uZmlnIjogImV3b2laWGgwY21GRGIyNW1hV2ROWVhBaU9pQjdJbk53WVhKckxtNWhZblV1Wm1WMFkyaGZjMmw2WlNJNklDSXhNREF3TUNJc0lDSnpjR0Z5YXk1dVlXSjFMbU52YlhCMWRHVmZaVzVuYVc1bElqb2dJbUY2ZFhKbFgyUmhkR0ZpY21samEzTWlMQ0FpYzNCaGNtc3VibUZpZFM1emIyeHlYMkpoZEdOb1gzTnBlbVVpT2lBaU1UQXdNREFpTENBaWMzQmhjbXN1Ym1GaWRTNWhjSEJzYVdOaGRHbHZibDl1WVcxbElqb2dJbTVoWW5VdGMzQmhjbXRpYjNRdGFXNW5aWE4wYVc5dUlpd2dJbk53WVhKckxtUnlhWFpsY2k1dVlXSjFYM0J5YVhaaGRHVkxaWGtpT2lBaUwyUmlabk12ZEcxd0wyUmxkaTEyTXkweExUSXRNQzl1WVdKMUx6RTNNREF3TmpZME16Z3hNalkwTWpReEx6QXZjSEpwZG1GMFpVdGxlU0lzSUNKemNHRnlheTVrY21sMlpYSXVjMjkxY21ObFgyRjNjMTlsYm1SUWIybHVkQ0k2SUNKek15NWhiV0Y2YjI1aGQzTXVZMjl0SWl3Z0luTndZWEpyTG1SeWFYWmxjaTUwWVhKblpYUmZZWGR6WDJWdVpGQnZhVzUwSWpvZ0luTXpMbUZ0WVhwdmJtRjNjeTVqYjIwaUxDQWljM0JoY21zdWJtRmlkUzVqYjIxd2RYUmxYMlZ1WjJsdVpWOXNhV0p6WDNCaGRHZ2lPaUFpTDJSaVpuTXZkRzF3TDJSbGRpMTJNeTB4TFRJdE1DOXVZV0oxTHpFM01EQXdOalkwTXpneE1qWTBNalF4THpBdllYQndiR2xqWVhScGIyNHVZMjl1WmlKOUNuMD0iLAogICJiYXRjaF9pZCI6IDE3MDAwNjY0MzgwMjM5OTUyLAogICJyZXRyeV9udW0iOiAiMCIsCiAgInNwYXJrX2NvbmZpZ3MiOiAiZXdvZ0lDQWdJbk52YkhKZlltRjBZMmhmYzJsNlpTSTZJakV3TURBd0lpd2ljR0Z5WVd4c1pXeGZkR2h5WldGa2N5STZJakV3SWl3aVptVjBZMmhmYzJsNlpTSTZJakV3TURBd0lnb2dJQ0FnZlE9PSIsCiAgImlzX2J1Y2tldF9lbmNyeXB0ZWQiOiAiIiwKICAiYjY0X2V4dGVybmFsX2phcnNfbWFwIiA6ICIiCn0=", "base64_rsa_compressed_encrypted_creds" : "rO0ABXVyAAJbQqzzF\/gGCFTgAgAAeHAAAAEAVy+9AQow7FXoD3z0ooJjPC+HrI5N52yIITSaL9yRvE3fFebDEBpUbP1qvJhLwLTo+6fqeYvorPcJGHVOzB+Iqo+4m\/AMDDiIgWaXz5hy8QfjV7PwWwarCUa5mj+NtOgTKwyw4WNnFcphnkE34tLJad1s2vF1qQHUgOCtysAB0fD2JA5BeEsUprhbts03GzeY8OCgy0kqiYHEoKRaS8cBWUQ81oeyo7fW8mdSsKVpY8wi3b2npBin83TSMAUXtFbeCjOOr7HC\/3DMYHQUM5xaZCNH7zeYWSMgAlTn1c+y42\/1lX0UE1c2qtplYC8Ky+yYikmWcrfsLOy5xJEB7L+KRHVxAH4AAAAAA5BHFNPNX+74skXzppe3RfD\/xrCll8g7yP06oIux1cYJaH6Z7Tz988miRj5z+4nzKfiAIw+MdVKnOwsvawBMOpAR\/WDGsqWEKC7EsNrjsBFm1HQ5tPFHcClV0HYlKZR5ejgDCOvBGBZ\/tQsIzKYl+dX92uH4Lgcbr9ns5Yi5CM3R0+q\/Z+5xzabCGcz54a7EjH1zT9y0wYp17VgEW9nccBtkkCmXJgDD1tijNxwK7I61N36cNTaMdQR71U1npaMyzuT0dQ6kgrputCx75rpIMsDwEkYi9ay\/LBgamfQiKPa7SDIzBjv5OgCrfU15BWr0OMRFAbu4rLF8s8PO9BrKQrA3JOsJwl8dQ47dhhJsDJgS8QAndbeJgjkT0Nsa18RE9pZ0HVVpSPhJR4aJvRlyFas6EOxbgVcPIrOgb9ahXBrFPblowqfD1iJ+z1brU00RxP\/cbjwyZOf6WJvFUzQqzqVEUJyJC4np9grL7zrPsMO8lseQ45QZQ7uhSsDztsV3OrzFK+mqSUtrVQzmkABaHyutr4dz3mPa9QtcZCX\/EshdwWwqf7+8WnuSwT40xMECKEL06BjuBZRtAPMhxX8Zo+eEA2mQmk2V2raRX0bluYFVsz2vnxcH1ntp9k\/YgPZeGNWpUI\/KQ\/CbUjbX7NX1FV+63fmJT2SRWj32vCOBu4K8405WNQ82YRJmP0k\/vMTeq\/XfF0tguDEBT31ra0tTYcKCUqIZ0+wTBakLiFVEM1xj7A\/u+7n7rsQkrKs31eNRo+2C8klBPjv6v\/Ju0F9JbNJtqUiFOxlUq\/wNRSm68xH6ZOFDG51BcZfxlkWvJOdvYoTVlylv67hH3pZgFK2GhXwl9Bhw6+eljQ+fP6eAncyFejNtvAuWGl5xf3ZgtPc\/15c8rj2+DPRqcd+rv6M7oftuvIqGbs\/gA1vDEbVVTT6J0TxEiEMpC0iYHmyAremaLDkBKWIns10eBeegTF1\/bZ7yNWcDS6tX\/0ensUmI5hLTA1tKsul7NuEjbU88KabhKtWknSmMnDix+feQ+D3yMuNIZroXqOeyDW+VkOpMNJNfrv5lPlVoiklns4VyGc\/XasVA63bVnUxRtgVNwO1ZyyfAIe7F46dIakC1HAHHTkmPwSJe965Ty+pACqPLVvEtrHJtETL5CKW2spRW3SnmhGLdr4R01j\/XFamcyFWvWmeSfwXG25kzHBrJN+5mGxFPFto=", "target_schemadrift_details" : [ { "schema_drifted" : false, "target_schemadrift_ignore_table" : false, "target_schemadrift_backup_table" : false, "target_schemadrift_new_table" : false, "destination_table_name" : "aaaa", "backup_table_name" : "aaaa" } ], "generate_file_content_json" : "ewogICJjcmVkZW50aWFsX2lkIjogIjQxIiwKICAiY3JlZGVudGlhbF90eXBlX2lkIjogIjE1IiwKICAiY3JlZGVudGlhbF90eXBlIjogIkZpbGUgQ29udGVudCIsCiAgInRva2VuIjogImM2OTUwNTgyYTEyYjU1OGFiNjQ4Y2RiNzIwMDgxNzNiMmU4NDI4ZmI1NWRhYWQ3NDAxNTIyNTY5MWVlYzc4ZWU3YjVjNGUzNDMxMmRlZDcwYWU1ZTdlZTQ4M2I3ZDdlYTBjMjNlMjRlNDU4ZWQxZjU0ZGEzY2NkN2RiY2ZlODcwYTYxZTVjOWM1MDg3ZTdmYjZkYzE2YjZmOGY1ZTRiZWRlNGMwZTAzYjNkYjZhZmE3YjcyOWNiOWJjYTgxMDNjYmU0YjFiY2QyYmM1YjMyYzI0ODI3ZmRmOTFjOGMxMWNmMzZiZjUxNzFhOTk2MmMxY2E1NGY4ZWM4NDIwNjdhODQ4YjkyM2M2OWQyOTljNmI3NTI0YzA5NTQyOTMwNDAzMDlhMWY4ZmQzOWY3ODJkMWJkODY0M2YzMmE2NWZhMzU3MDU2ZWJkZjBkNTQ5ZTIwZjBmMWEwNTZlODEyNjM4MjM0YTRmNTVlMDU5N2YwNmFlN2Y0NzAwNjQ1YzBmMmQ4NzlhMDJkNTUyNGVhMjM0YzIwZDllZWY0NmQxNWZlZGJhNWJmOTVlNmJiODMwZmFjZGNhYWUxNzA2ZmNhNjE4MGJkYjAwMzVhOTNlMjRkNTc1NGY3ZDJmOGMzMzU4YmJhYmNiNWM5ZjJkZGJhMGFhOTk4Y2Y5OWNkMThjYzllOTE4YzBjOTdjOTgxZWZlYzNlZmI3MmI1Y2I1NTcwMGNiMWU4Mjk5MzA3YjI4OGE3ODRiODA2Yjg0OTMzNjc1NDRkZTk5NzM5ZjI0YTk2NDU0ZWU3MTkyMTBlYmQyNzNlMzQzNmE0MjU4NDI4MGEyMzA2MDljM2E1NmI3ZGU2NmFhYWRkNGVlMDY1N2Q0NTc1YmI2OTIwMDEyZmJmZWRiNjZhZjI0NGQ1MTk5MjVmYzNlNDRhZjJmNGJhNjc0ZGMzM2JjMmVlNGRiMmY0YWZmM2U5ZWJkNGVhNjVhMTY3NmFkYWM4ZjRhMDY0NzllOGE0NTQ3ZWVlOGU0ZTJjMzliMDE1YmQ3ZjgxNGMzODhjMDU1MWQzZjIyYWZkMTIxYmRmY2VmOTY5Y2Q3MWQ2YjdiMzUwYmUxNzYxZDU5YjY1MDMyY2NkYmRhNzE4Njg2NjA1YWE4ZjQ3NTBmYzI3Mjg1OTNkOTJkOWFkZjVmODRlZDUzYTA3OWQ2MDlkMDc2MmQ1NGQ3MDI0NWZiMmVmMjI0OTM1Nzk3OGIzNDIyMGExYzhjNDUzMjJlZjRkZWRhYzExNGE4Yzk2YTU1OWQzYWVjMzJmM2U2MTNmYThlZWFmZjAyOGE4MzdiYjEyYWIwZWM2MjU0MDE4MTA2YzY1NGVjYjc4M2Q0ZWQzMzM5MGRjNjhhZDgzYmU4ZWI4OGUzYjcxNGM0MDUzMjIwOTk0MjM3NjY5MDkzMGY3ZDc0OGUxYTRiMTk3NDk0NjYzNTA5OTNiMmU1YjQyZGI0NTIyYmNhMTNhNmE5YzVkMjYzMzg0OGRmODEzZDMwNzdlN2JhNzgwNTI4OWZlMDQ2YjUwMDkxOTk1ZDQ2YzA3YTBjODEzNjY2NzFiNzQxNTJiNWIzZjcwYmM4IiwKICAiY3JlZGVudGlhbF9lbmRwb2ludF91cmwiOiAiaHR0cDovL2Rldi1kaGEuaHVtYW5hLmNvbTo4ODg5L2ZpcmVzaG90cy9jcmVkZW50aWFsc0ZldGNoV2ViU2VydmljZSIsCiAgImZpbGVfcGF0aCI6ICIxNTY4XzI2MV8xNzAwMDY2NDM4MDIzOTk1MiIsCiAgImNyZWRlbnRpYWxfZmlsZV9wYXR0ZXJuIiA6ICI0MV8xNjk5MzQyNTc1Igp9", "get_view_info" : [ { "id" : 1 } ], "get_already_ingested_condition" : [ { "already_ingested" : true } ], "sort_by_columns_data" : [], "fetching_credential_inputs" : [ { "spark_credential_id" : 41, "metastore_credential_id" : null, "credential_type_id" : 15, "credential_type" : "File Content", "credential_pattern" : "41_1699342575", "metastore_credential_type_id" : null } ], "get_varchar_columns" : [], "generate_spark_configs_json" : "ewogICAgInNvbHJfYmF0Y2hfc2l6ZSI6IjEwMDAwIiwicGFyYWxsZWxfdGhyZWFkcyI6IjEwIiwiZmV0Y2hfc2l6ZSI6IjEwMDAwIgogICAgfQ==" } }, "skipLogicPattern" : "doNothing", "output_message_templates": [ { "template_group": "templates/artifact_ingestion/ingestion_flow.stg", "template_name": "spark_buffer_msg", "useIncomingData":true }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "task_status_success_msg" } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "error_template_create_msg" } ] } ] }
""2023-11-15 16:41:16.786 [Thread-88] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_jdbc
""2023-11-15 16:41:16.807 [Thread-88] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_jdbc
""2023-11-15 16:41:16.807 [Thread-88] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-15 16:41:16.819 [Thread-88] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "8797764a-ebb0-4c4e-999b-58a15a340100", "parent_id": "4e8bcd3a-7fb0-4043-aba4-6d226c053fa0", "bot_id": "84c43ca6-2712-4cd9-b2d9-b0fe3f69b476", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":17000664381264241, "initial_ts":1700066438126, "batch_id":17000664380239952, "batch_name":"Ingestion_20231115", "job_schedule_id":1568, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "2023-11-07 12:42:00.86365", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot", "KoshBot", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"84c43ca6-2712-4cd9-b2d9-b0fe3f69b476", "bot_name":"DBOpsBot", "process_context":"get_metadata_and_generate_almaren", "task_name":"get_metadata_and_generate_almaren", "process_id":"17000664381264241", "task_ts":1700066476531, "batch_id":"17000664380239952", "status_code_id": 6 } } ] }
""2023-11-15 16:41:16.821 [Thread-88] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:41:16.824 [Thread-88] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:41:16.824 [Thread-88] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:41:16.825 [Thread-88] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot finished processing message with id 4e8bcd3a-7fb0-4043-aba4-6d226c053fa0
""2023-11-15 16:41:16.899 [Thread-520] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 7b28e22d-3ddf-4bc2-8582-71b466eff01f has started processing message with message_id 8797764a-ebb0-4c4e-999b-58a15a340100 and thread_id 667 
""2023-11-15 16:41:16.899 [Thread-520] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:41:16.899 [Thread-520] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=4e8bcd3a-7fb0-4043-aba4-6d226c053fa0, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=8797764a-ebb0-4c4e-999b-58a15a340100, task_retry_intervals_secs=[], bot_id=84c43ca6-2712-4cd9-b2d9-b0fe3f69b476, message_topic=nabu_2_taskmonitor, tags={process_id=17000664381264241, initial_ts=1700066438126, batch_name=Ingestion_20231115, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot, KoshBot, TaskMonitorBot]}}
""2023-11-15 16:41:16.927 [Thread-588] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 15b7f47d-8271-437b-8b5b-cc11873475de has started processing message with message_id 9ef48220-268b-40d5-8cd9-8f49fbd8f89c and thread_id 748 
""2023-11-15 16:41:16.927 [Thread-588] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:41:16.927 [Thread-588] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=4e8bcd3a-7fb0-4043-aba4-6d226c053fa0, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=ingestion_deciding, message_id=9ef48220-268b-40d5-8cd9-8f49fbd8f89c, task_retry_intervals_secs=[], bot_id=84c43ca6-2712-4cd9-b2d9-b0fe3f69b476, message_topic=nabu_2_jdbc, tags={process_id=17000664381264241, batch_id=17000664380239952, job_scheduled_user_id=Manaswini Chinthalapudi, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot, KoshBot, DBOpsBot], initial_ts=1700066438126, batch_name=Ingestion_20231115, environment=modak, job_schedule_id=1568, data_movement_id=261, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, task_dependency=true, ignore_job_termination=false}}
""2023-11-15 16:41:16.928 [Thread-520] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 17000664381264241, 'DBOpsBot', 'get_metadata_and_generate_almaren', 'get_metadata_and_generate_almaren', 6 , TO_TIMESTAMP(1700066476531::double precision / 1000) ,'84c43ca6-2712-4cd9-b2d9-b0fe3f69b476');
""2023-11-15 16:41:16.928 [Thread-520] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 7b28e22d-3ddf-4bc2-8582-71b466eff01f has started process logic with message_id 8797764a-ebb0-4c4e-999b-58a15a340100 and thread_id 667
""2023-11-15 16:41:16.951 [Thread-520] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 7b28e22d-3ddf-4bc2-8582-71b466eff01f has finished process logic with message_id 8797764a-ebb0-4c4e-999b-58a15a340100 and thread_id 667
""2023-11-15 16:41:16.951 [Thread-520] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:41:16.951 [Thread-520] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 8797764a-ebb0-4c4e-999b-58a15a340100
""2023-11-15 16:41:16.961 [Thread-588] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
doNothing
""2023-11-15 16:41:16.961 [Thread-588] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : true
""2023-11-15 16:41:17.235 [Thread-588] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "DBOpsBot", "bot_metadata": { "message_id": "e16c0da0-abcf-4b8d-a952-7d29310a9e06", "parent_id": "9ef48220-268b-40d5-8cd9-8f49fbd8f89c", "bot_id": "15b7f47d-8271-437b-8b5b-cc11873475de", "message_topic":"nabu_2_jdbc", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":17000664381264241, "initial_ts":1700066438126, "batch_id":17000664380239952, "batch_name":"Ingestion_20231115", "job_schedule_id":1568, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "2023-11-07 12:42:00.86365", "environment": "modak", "ignore_job_termination" : false, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot", "KoshBot", "DBOpsBot", "DBOpsBot" ],"task_dependency":true}, "task_retry_intervals_secs": [ ], "message_context": "spark_buffer_msg" }, "bot_tasks": [ { "task_name": "spark_buffer_msg", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "doNothingTemplate" }, "input_data": { "templateData": { "query_input" : { "target_schemadrift_flag" : [ { "nextrun_after_targetdrift" : false } ], "input_json_for_checkpoint_status" : "ewoicHJvY2Vzc0lkIjoxNzAwMDY2NDM4MTI2NDI0MSwKImRhdGFwbGFjZUlkIjo0MiwKInRhYmxlSWQiOjM3MjM0LAoiZGF0YW1vdmVtZW50SWQiOjI2MSwKImpvYlNjaGVkdWxlZFVzZXJJZCI6Ik1hbmFzd2luaSBDaGludGhhbGFwdWRpIiwKImpvYlNjaGVkdWxlSWQiOjE1NjgsCiJiYXRjaElkIjoxNzAwMDY2NDM4MDIzOTk1MiwKImxhc3RSdW5UaW1lc3RhbXAiOiIyMDIzLTExLTA3IDEyOjQyOjAwLjg2MzY1IiwKInJldHJ5TnVtIjogIjAiCn0=", "get_cdc_last_run_table" : [ { "prev_target_path" : null, "cdc_first" : true, "relative_path" : "\/261\/42\/development-db\/acuity-develop\/aaaa.parquet", "target_path" : "abfss:\/\/dataproc@idea15pisplznonprodsa2.dfs.core.windows.net\/261\/42\/development-db\/acuity-develop\/aaaa.parquet" } ], "get_cdc_type" : [ { "cdc_applied" : false, "is_primary" : false, "cdctype2" : false, "temp_path" : "17000664381264241_aaaa" } ], "generate_yeedu_metastore_credential" : "ewogICJjcmVkZW50aWFsX2lkIjogIiIsCiAgImNyZWRlbnRpYWxfdHlwZV9pZCI6ICIiLAogICJ0b2tlbiI6ICJjNjk1MDU4MmExMmI1NThhYjY0OGNkYjcyMDA4MTczYjJlODQyOGZiNTVkYWFkNzQwMTUyMjU2OTFlZWM3OGVlN2I1YzRlMzQzMTJkZWQ3MGFlNWU3ZWU0ODNiN2Q3ZWEwYzIzZTI0ZTQ1OGVkMWY1NGRhM2NjZDdkYmNmZTg3MGE2MWU1YzljNTA4N2U3ZmI2ZGMxNmI2ZjhmNWU0YmVkZTRjMGUwM2IzZGI2YWZhN2I3MjljYjliY2E4MTAzY2JlNGIxYmNkMmJjNWIzMmMyNDgyN2ZkZjkxYzhjMTFjZjM2YmY1MTcxYTk5NjJjMWNhNTRmOGVjODQyMDY3YTg0OGI5MjNjNjlkMjk5YzZiNzUyNGMwOTU0MjkzMDQwMzA5YTFmOGZkMzlmNzgyZDFiZDg2NDNmMzJhNjVmYTM1NzA1NmViZGYwZDU0OWUyMGYwZjFhMDU2ZTgxMjYzODIzNGE0ZjU1ZTA1OTdmMDZhZTdmNDcwMDY0NWMwZjJkODc5YTAyZDU1MjRlYTIzNGMyMGQ5ZWVmNDZkMTVmZWRiYTViZjk1ZTZiYjgzMGZhY2RjYWFlMTcwNmZjYTYxODBiZGIwMDM1YTkzZTI0ZDU3NTRmN2QyZjhjMzM1OGJiYWJjYjVjOWYyZGRiYTBhYTk5OGNmOTljZDE4Y2M5ZTkxOGMwYzk3Yzk4MWVmZWMzZWZiNzJiNWNiNTU3MDBjYjFlODI5OTMwN2IyODhhNzg0YjgwNmI4NDkzMzY3NTQ0ZGU5OTczOWYyNGE5NjQ1NGVlNzE5MjEwZWJkMjczZTM0MzZhNDI1ODQyODBhMjMwNjA5YzNhNTZiN2RlNjZhYWFkZDRlZTA2NTdkNDU3NWJiNjkyMDAxMmZiZmVkYjY2YWYyNDRkNTE5OTI1ZmMzZTQ0YWYyZjRiYTY3NGRjMzNiYzJlZTRkYjJmNGFmZjNlOWViZDRlYTY1YTE2NzZhZGFjOGY0YTA2NDc5ZThhNDU0N2VlZThlNGUyYzM5YjAxNWJkN2Y4MTRjMzg4YzA1NTFkM2YyMmFmZDEyMWJkZmNlZjk2OWNkNzFkNmI3YjM1MGJlMTc2MWQ1OWI2NTAzMmNjZGJkYTcxODY4NjYwNWFhOGY0NzUwZmMyNzI4NTkzZDkyZDlhZGY1Zjg0ZWQ1M2EwNzlkNjA5ZDA3NjJkNTRkNzAyNDVmYjJlZjIyNDkzNTc5NzhiMzQyMjBhMWM4YzQ1MzIyZWY0ZGVkYWMxMTRhOGM5NmE1NTlkM2FlYzMyZjNlNjEzZmE4ZWVhZmYwMjhhODM3YmIxMmFiMGVjNjI1NDAxODEwNmM2NTRlY2I3ODNkNGVkMzMzOTBkYzY4YWQ4M2JlOGViODhlM2I3MTRjNDA1MzIyMDk5NDIzNzY2OTA5MzBmN2Q3NDhlMWE0YjE5NzQ5NDY2MzUwOTkzYjJlNWI0MmRiNDUyMmJjYTEzYTZhOWM1ZDI2MzM4NDhkZjgxM2QzMDc3ZTdiYTc4MDUyODlmZTA0NmI1MDA5MTk5NWQ0NmMwN2EwYzgxMzY2NjcxYjc0MTUyYjViM2Y3MGJjOCIsCiAgImNyZWRlbnRpYWxfZW5kcG9pbnRfdXJsIjogImh0dHA6Ly9kZXYtZGhhLmh1bWFuYS5jb206ODg4OS9maXJlc2hvdHMvY3JlZGVudGlhbHNGZXRjaFdlYlNlcnZpY2UiCn0=", "table_metadata_output" : [ { "end_point" : "http:\/\/dev-dha.humana.com:8889\/fireshots\/credentialsFetchWebService", "is_filesystem_credential_type_aws" : true, "table_name" : "aaaa", "s3_bucket" : null, "path" : "", "is_lazy_mode" : false, "destination_type" : "adls_gen2", "archive_files_path" : "", "rename_table_condition" : false, "adls_gen2_directory_name" : null, "is_archive_data" : false, "destination_db" : null, "bucket_name" : null, "source_type" : "sql_server", "credential_pattern" : "2_1686574260", "is_destination_hive" : false, "estimated_rows" : 4914, "destination_file_format" : "parquet", "warehouse_name" : null, "filesystem_credential_type" : null, "is_aws_iam_attached_to_ec2_instance" : false, "is_bigquery" : false, "is_source_filetype" : false, "source_jdbc_url" : "jdbc:sqlserver:\/\/hyp-acu-development-5de0.database.windows.net:1433;database=development-db;sslProtocol=TLSv1.2;encrypt=true", "flow_number" : 1, "batch_id" : 17000664380239952, "destination_url" : null, "filesystem_credential_type_id" : null, "schema_drift_flag" : false, "is_mysql" : false, "filesystem_credential_id" : null, "destination_directory" : null, "source_credential_type_id" : 1, "destination_backup_table_name" : "aaaa", "destination_table_name" : "aaaa", "destination_dataplace_sub_component_id" : 18, "is_azure_oauth" : false, "gcs_bucket" : null, "source_directory" : null, "is_file_system_type_s3a" : false, "destination_schema_directory_id" : 3, "intermediate_type" : "parquet", "is_source_jdbc_url" : true, "is_source_spark_hive" : false, "batch_name" : "Ingestion_20231115", "source_endpoint" : "s3.amazonaws.com", "upper_case_destination_table_name" : "AAAA", "source_credential_id" : 37, "destination_credential_type_id" : 5, "adls_gen2_container" : "dataproc", "source_default_credential_exists" : false, "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDY2NDU3NzgzNDI0MCwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0OTI1OCwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2NjQ1N30.cgEzDcSlWhMY65PdNscgXY1oBYM75LZUbp00acf6_d1WRUOrXXGi5pcvwkRNDv0JIxun7nmcSCqy2CKZ38-eHnEqqAoxh2CIRwXTdBlsYYFyfkXHYapfaXinAi82pkDk0yJQOs-m-vAf1cbV4ue4Zk6bHKbJeu_j5_x8HU3PKeF0pz0lA-tpeoFRlq_tLUXqApH5t7QuTIzOSq7Aujo6yOSm_inHTBzTWxUyVaBCitbKs_j3Oq-P5c-Y5W3r9oAvDNbMASikxmdxfJBp_rI2QYHdxazW9UvVh_ZpRPwOIbi7EAe9-B6BBxAxItPBTo4M-GFi-zvZZXXYMX57edoRDA", "project" : null, "source_table_name" : "aaaa", "table_id" : 37234, "authentication_type" : "auth_token", "source_url" : null, "destination_endpoint" : "s3.amazonaws.com", "schema_id" : 453, "datamovement_engine_type" : "Spark", "relative_file_path" : "", "filesystem_credential_epoch" : null, "is_needed_partition_name_without_column_name" : false, "table_suffix" : "", "schema_name" : "acuity-develop", "is_record_process_enabled" : true, "is_default" : false, "is_jdbcmode" : false, "table_timestamp" : "", "verification_threshold" : 0.1, "pipeline_flow_timeout" : 23, "dest_default_credential_exists" : false, "process_id" : 17000664381264241, "is_destination_file" : true, "where_condition" : "37234", "source_dataplace_id" : 42, "file_system_type" : "abfss", "is_ingestion_root_path" : false, "is_source_hive" : false, "destination_oracle_jdbc_url" : null, "schema_drift_option" : "drop_create_table", "ingestion_table_format" : "", "already_ingested" : true, "destination_dataplace_id" : 5, "destination_credential_id" : 2, "file_format" : "", "create_backup_table" : null, "destination_dataplace_component_type_id" : 3, "source_jdbc_driver" : "com.microsoft.sqlserver.jdbc.SQLServerDriver", "destination_schema_name" : "dataproc", "source_db" : "development-db", "apply_transformation" : false, "target_type" : "adls_gen2", "oracle_jdbc_url" : null, "destination_schema_id" : 3, "dataplace_id" : 42, "filesystem_endpoint" : null, "is_spark_hive" : false, "destination_jdbc_driver" : null, "data_movement_id" : 261, "storage_account" : "idea15pisplznonprodsa2", "is_relative_file_path" : false, "is_create_table" : false, "is_apache_jdbc_driver" : false } ], "get_cdc_audit_cols" : [], "get_list_of_maps_of_partition_columns" : [ { "?column?" : "null" } ], "get_cdc_info" : [ { "job_id_column_name" : "process_id", "prev_job_id_column_name" : "prev_process_id", "is_sha2" : false, "add_audit_columns" : false, "end_date_column_name" : "valid_to_ts", "create_view" : false, "start_date_column_name" : "valid_from_ts", "hash_type" : "", "view_name" : "v_aaaa" } ], "get_spark_configs" : [ { "cluster_id" : null, "config_json" : { "extra_configs" : {}, "default_configs" : { "solr_batch_size" : "10000", "parallel_threads" : "10", "fetch_size" : "10000" } }, "spark_configuration_type_id" : 1, "spark_configs_json" : "{\n \"solr_batch_size\":\"10000\",\"parallel_threads\":\"10\",\"fetch_size\":\"10000\"\n }", "compute_engine_id" : 11, "extra_configs_json" : { "spark.nabu.fetch_size" : "10000", "spark.nabu.solr_batch_size" : "10000" } } ], "advanced_options_tables_flags_status" : [ { "columns_options" : false, "cdc" : null, "sort_by_columns" : false, "incremental_load" : false, "parallel_ingestion" : false, "remove_duplicates" : false, "virtual_column" : false, "reorder_columns" : false, "modified_columns" : false, "ingestion_mode" : true, "enable_cache" : false, "ingest_using_query" : false, "new_table_name" : false, "excluded_column_ids" : false, "table_partitions" : false } ], "yeedu_input_json" : "ewoiY2x1c3Rlcl9pZCI6ICIiLAoiYjY0X2lucHV0X2pzb24iOiAiZXdvaWNISnZZMlZ6YzBsa0lqb3hOekF3TURZMk5ETTRNVEkyTkRJME1Td0tJbVJoZEdGd2JHRmpaVWxrSWpvME1pd0tJblJoWW14bFNXUWlPak0zTWpNMExBb2laR0YwWVcxdmRtVnRaVzUwU1dRaU9qSTJNU3dLSW1wdllsTmphR1ZrZFd4bFpGVnpaWEpKWkNJNklrMWhibUZ6ZDJsdWFTQkRhR2x1ZEdoaGJHRndkV1JwSWl3S0ltcHZZbE5qYUdWa2RXeGxTV1FpT2pFMU5qZ3NDaUppWVhSamFFbGtJam94TnpBd01EWTJORE00TURJek9UazFNaXdLSW14aGMzUlNkVzVVYVcxbGMzUmhiWEFpT2lJeU1ESXpMVEV4TFRBM0lERXlPalF5T2pBd0xqZzJNelkxSWl3S0luSmxkSEo1VG5WdElqb2dJakFpQ24wPSIsCiJleHRyYV9jb25maWciOiAiZXdvaVpYaDBjbUZEYjI1bWFXZE5ZWEFpT2lCN0luTndZWEpyTG01aFluVXVabVYwWTJoZmMybDZaU0k2SUNJeE1EQXdNQ0lzSUNKemNHRnlheTV1WVdKMUxtTnZiWEIxZEdWZlpXNW5hVzVsSWpvZ0ltRjZkWEpsWDJSaGRHRmljbWxqYTNNaUxDQWljM0JoY21zdWJtRmlkUzV6YjJ4eVgySmhkR05vWDNOcGVtVWlPaUFpTVRBd01EQWlMQ0FpYzNCaGNtc3VibUZpZFM1aGNIQnNhV05oZEdsdmJsOXVZVzFsSWpvZ0ltNWhZblV0YzNCaGNtdGliM1F0YVc1blpYTjBhVzl1SWl3Z0luTndZWEpyTG1SeWFYWmxjaTV1WVdKMVgzQnlhWFpoZEdWTFpYa2lPaUFpTDJSaVpuTXZkRzF3TDJSbGRpMTJNeTB4TFRJdE1DOXVZV0oxTHpFM01EQXdOalkwTXpneE1qWTBNalF4THpBdmNISnBkbUYwWlV0bGVTSXNJQ0p6Y0dGeWF5NWtjbWwyWlhJdWMyOTFjbU5sWDJGM2MxOWxibVJRYjJsdWRDSTZJQ0p6TXk1aGJXRjZiMjVoZDNNdVkyOXRJaXdnSW5Od1lYSnJMbVJ5YVhabGNpNTBZWEpuWlhSZllYZHpYMlZ1WkZCdmFXNTBJam9nSW5NekxtRnRZWHB2Ym1GM2N5NWpiMjBpTENBaWMzQmhjbXN1Ym1GaWRTNWpiMjF3ZFhSbFgyVnVaMmx1WlY5c2FXSnpYM0JoZEdnaU9pQWlMMlJpWm5NdmRHMXdMMlJsZGkxMk15MHhMVEl0TUM5dVlXSjFMekUzTURBd05qWTBNemd4TWpZME1qUXhMekF2WVhCd2JHbGpZWFJwYjI0dVkyOXVaaUo5Q24wPSIsCiJjb21wdXRlX2VuZ19jcmVkc19qc29uIiA6ICJld29nSUNKamNtVmtaVzUwYVdGc1gybGtJam9nSWpReElpd0tJQ0FpWTNKbFpHVnVkR2xoYkY5MGVYQmxYMmxrSWpvZ0lqRTFJaXdLSUNBaVkzSmxaR1Z1ZEdsaGJGOTBlWEJsSWpvZ0lrWnBiR1VnUTI5dWRHVnVkQ0lzQ2lBZ0luUnZhMlZ1SWpvZ0ltTTJPVFV3TlRneVlURXlZalUxT0dGaU5qUTRZMlJpTnpJd01EZ3hOek5pTW1VNE5ESTRabUkxTldSaFlXUTNOREF4TlRJeU5UWTVNV1ZsWXpjNFpXVTNZalZqTkdVek5ETXhNbVJsWkRjd1lXVTFaVGRsWlRRNE0ySTNaRGRsWVRCak1qTmxNalJsTkRVNFpXUXhaalUwWkdFelkyTmtOMlJpWTJabE9EY3dZVFl4WlRWak9XTTFNRGczWlRkbVlqWmtZekUyWWpabU9HWTFaVFJpWldSbE5HTXdaVEF6WWpOa1lqWmhabUUzWWpjeU9XTmlPV0pqWVRneE1ETmpZbVUwWWpGaVkyUXlZbU0xWWpNeVl6STBPREkzWm1SbU9URmpPR014TVdObU16WmlaalV4TnpGaE9UazJNbU14WTJFMU5HWTRaV000TkRJd05qZGhPRFE0WWpreU0yTTJPV1F5T1Rsak5tSTNOVEkwWXpBNU5UUXlPVE13TkRBek1EbGhNV1k0Wm1Rek9XWTNPREprTVdKa09EWTBNMll6TW1FMk5XWmhNelUzTURVMlpXSmtaakJrTlRRNVpUSXdaakJtTVdFd05UWmxPREV5TmpNNE1qTTBZVFJtTlRWbE1EVTVOMll3Tm1GbE4yWTBOekF3TmpRMVl6Qm1NbVE0TnpsaE1ESmtOVFV5TkdWaE1qTTBZekl3WkRsbFpXWTBObVF4TldabFpHSmhOV0ptT1RWbE5tSmlPRE13Wm1GalpHTmhZV1V4TnpBMlptTmhOakU0TUdKa1lqQXdNelZoT1RObE1qUmtOVGMxTkdZM1pESm1PR016TXpVNFltSmhZbU5pTldNNVpqSmtaR0poTUdGaE9UazRZMlk1T1dOa01UaGpZemxsT1RFNFl6QmpPVGRqT1RneFpXWmxZek5sWm1JM01tSTFZMkkxTlRjd01HTmlNV1U0TWprNU16QTNZakk0T0dFM09EUmlPREEyWWpnME9UTXpOamMxTkRSa1pUazVOek01WmpJMFlUazJORFUwWldVM01Ua3lNVEJsWW1ReU56TmxNelF6Tm1FME1qVTROREk0TUdFeU16QTJNRGxqTTJFMU5tSTNaR1UyTm1GaFlXUmtOR1ZsTURZMU4yUTBOVGMxWW1JMk9USXdNREV5Wm1KbVpXUmlOalpoWmpJME5HUTFNVGs1TWpWbVl6TmxORFJoWmpKbU5HSmhOamMwWkdNek0ySmpNbVZsTkdSaU1tWTBZV1ptTTJVNVpXSmtOR1ZoTmpWaE1UWTNObUZrWVdNNFpqUmhNRFkwTnpsbE9HRTBOVFEzWldWbE9HVTBaVEpqTXpsaU1ERTFZbVEzWmpneE5HTXpPRGhqTURVMU1XUXpaakl5WVdaa01USXhZbVJtWTJWbU9UWTVZMlEzTVdRMllqZGlNelV3WW1VeE56WXhaRFU1WWpZMU1ETXlZMk5rWW1SaE56RTROamcyTmpBMVlXRTRaalEzTlRCbVl6STNNamcxT1ROa09USmtPV0ZrWmpWbU9EUmxaRFV6WVRBM09XUTJNRGxrTURjMk1tUTFOR1EzTURJME5XWmlNbVZtTWpJME9UTTFOemszT0dJek5ESXlNR0V4WXpoak5EVXpNakpsWmpSa1pXUmhZekV4TkdFNFl6azJZVFUxT1dRellXVmpNekptTTJVMk1UTm1ZVGhsWldGbVpqQXlPR0U0TXpkaVlqRXlZV0l3WldNMk1qVTBNREU0TVRBMll6WTFOR1ZqWWpjNE0yUTBaV1F6TXpNNU1HUmpOamhoWkRnelltVTRaV0k0T0dVellqY3hOR00wTURVek1qSXdPVGswTWpNM05qWTVNRGt6TUdZM1pEYzBPR1V4WVRSaU1UazNORGswTmpZek5UQTVPVE5pTW1VMVlqUXlaR0kwTlRJeVltTmhNVE5oTm1FNVl6VmtNall6TXpnME9HUm1PREV6WkRNd056ZGxOMkpoTnpnd05USTRPV1psTURRMllqVXdNRGt4T1RrMVpEUTJZekEzWVRCak9ERXpOalkyTnpGaU56UXhOVEppTldJelpqY3dZbU00SWl3S0lDQWlZM0psWkdWdWRHbGhiRjlsYm1Sd2IybHVkRjkxY213aU9pQWlhSFIwY0RvdkwyUmxkaTFrYUdFdWFIVnRZVzVoTG1OdmJUbzRPRGc1TDJacGNtVnphRzkwY3k5amNtVmtaVzUwYVdGc2MwWmxkR05vVjJWaVUyVnlkbWxqWlNJc0NpQWdJbVpwYkdWZmNHRjBhQ0k2SUNJeE5UWTRYekkyTVY4eE56QXdNRFkyTkRNNE1ESXpPVGsxTWlJc0NpQWdJbU55WldSbGJuUnBZV3hmWm1sc1pWOXdZWFIwWlhKdUlpQTZJQ0kwTVY4eE5qazVNelF5TlRjMUlncDkiLAoiY2x1c3Rlcl91aSI6ICIiLAoicmV0cnlfbnVtIjogIjAiLAoic3BhcmtfY29uZmlncyI6ICJld29nSUNBZ0luTnZiSEpmWW1GMFkyaGZjMmw2WlNJNklqRXdNREF3SWl3aWNHRnlZV3hzWld4ZmRHaHlaV0ZrY3lJNklqRXdJaXdpWm1WMFkyaGZjMmw2WlNJNklqRXdNREF3SWdvZ0lDQWdmUT09IiwKImI2NF9oaXZlX2NyZWRzX2pzb24iOiAiZXdvZ0lDSmpjbVZrWlc1MGFXRnNYMmxrSWpvZ0lpSXNDaUFnSW1OeVpXUmxiblJwWVd4ZmRIbHdaVjlwWkNJNklDSWlMQW9nSUNKMGIydGxiaUk2SUNKak5qazFNRFU0TW1FeE1tSTFOVGhoWWpZME9HTmtZamN5TURBNE1UY3pZakpsT0RReU9HWmlOVFZrWVdGa056UXdNVFV5TWpVMk9URmxaV00zT0dWbE4ySTFZelJsTXpRek1USmtaV1EzTUdGbE5XVTNaV1UwT0ROaU4yUTNaV0V3WXpJelpUSTBaVFExT0dWa01XWTFOR1JoTTJOalpEZGtZbU5tWlRnM01HRTJNV1UxWXpsak5UQTROMlUzWm1JMlpHTXhObUkyWmpobU5XVTBZbVZrWlRSak1HVXdNMkl6WkdJMllXWmhOMkkzTWpsallqbGlZMkU0TVRBelkySmxOR0l4WW1Oa01tSmpOV0l6TW1NeU5EZ3lOMlprWmpreFl6aGpNVEZqWmpNMlltWTFNVGN4WVRrNU5qSmpNV05oTlRSbU9HVmpPRFF5TURZM1lUZzBPR0k1TWpOak5qbGtNams1WXpaaU56VXlOR013T1RVME1qa3pNRFF3TXpBNVlURm1PR1prTXpsbU56Z3laREZpWkRnMk5ETm1NekpoTmpWbVlUTTFOekExTm1WaVpHWXdaRFUwT1dVeU1HWXdaakZoTURVMlpUZ3hNall6T0RJek5HRTBaalUxWlRBMU9UZG1NRFpoWlRkbU5EY3dNRFkwTldNd1pqSmtPRGM1WVRBeVpEVTFNalJsWVRJek5HTXlNR1E1WldWbU5EWmtNVFZtWldSaVlUVmlaamsxWlRaaVlqZ3pNR1poWTJSallXRmxNVGN3Tm1aallUWXhPREJpWkdJd01ETTFZVGt6WlRJMFpEVTNOVFJtTjJReVpqaGpNek0xT0dKaVlXSmpZalZqT1dZeVpHUmlZVEJoWVRrNU9HTm1PVGxqWkRFNFkyTTVaVGt4T0dNd1l6azNZems0TVdWbVpXTXpaV1ppTnpKaU5XTmlOVFUzTURCallqRmxPREk1T1RNd04ySXlPRGhoTnpnMFlqZ3dObUk0TkRrek16WTNOVFEwWkdVNU9UY3pPV1l5TkdFNU5qUTFOR1ZsTnpFNU1qRXdaV0prTWpjelpUTTBNelpoTkRJMU9EUXlPREJoTWpNd05qQTVZek5oTlRaaU4yUmxOalpoWVdGa1pEUmxaVEEyTlRka05EVTNOV0ppTmpreU1EQXhNbVppWm1Wa1lqWTJZV1l5TkRSa05URTVPVEkxWm1NelpUUTBZV1l5WmpSaVlUWTNOR1JqTXpOaVl6SmxaVFJrWWpKbU5HRm1aak5sT1dWaVpEUmxZVFkxWVRFMk56WmhaR0ZqT0dZMFlUQTJORGM1WlRoaE5EVTBOMlZsWlRobE5HVXlZek01WWpBeE5XSmtOMlk0TVRSak16ZzRZekExTlRGa00yWXlNbUZtWkRFeU1XSmtabU5sWmprMk9XTmtOekZrTm1JM1lqTTFNR0psTVRjMk1XUTFPV0kyTlRBek1tTmpaR0prWVRjeE9EWTROall3TldGaE9HWTBOelV3Wm1NeU56STROVGt6WkRreVpEbGhaR1kxWmpnMFpXUTFNMkV3Tnpsa05qQTVaREEzTmpKa05UUmtOekF5TkRWbVlqSmxaakl5TkRrek5UYzVOemhpTXpReU1qQmhNV000WXpRMU16SXlaV1kwWkdWa1lXTXhNVFJoT0dNNU5tRTFOVGxrTTJGbFl6TXlaak5sTmpFelptRTRaV1ZoWm1Zd01qaGhPRE0zWW1JeE1tRmlNR1ZqTmpJMU5EQXhPREV3Tm1NMk5UUmxZMkkzT0ROa05HVmtNek16T1RCa1l6WTRZV1E0TTJKbE9HVmlPRGhsTTJJM01UUmpOREExTXpJeU1EazVOREl6TnpZMk9UQTVNekJtTjJRM05EaGxNV0UwWWpFNU56UTVORFkyTXpVd09Ua3pZakpsTldJME1tUmlORFV5TW1KallURXpZVFpoT1dNMVpESTJNek00TkRoa1pqZ3hNMlF6TURjM1pUZGlZVGM0TURVeU9EbG1aVEEwTm1JMU1EQTVNVGs1TldRME5tTXdOMkV3WXpneE16WTJOamN4WWpjME1UVXlZalZpTTJZM01HSmpPQ0lzQ2lBZ0ltTnlaV1JsYm5ScFlXeGZaVzVrY0c5cGJuUmZkWEpzSWpvZ0ltaDBkSEE2THk5a1pYWXRaR2hoTG1oMWJXRnVZUzVqYjIwNk9EZzRPUzltYVhKbGMyaHZkSE12WTNKbFpHVnVkR2xoYkhOR1pYUmphRmRsWWxObGNuWnBZMlVpQ24wPSIsCiJiYXRjaF9pZCI6MTcwMDA2NjQzODAyMzk5NTIsCiJwcm9jZXNzX2lkIiA6MTcwMDA2NjQzODEyNjQyNDEsCiJyZXN0X3VybCI6ICIiLAoiYjY0X2V4dGVybmFsX2phcnNfbWFwIiA6ICIiCn0=", "ingestion_mode" : [ { "mode" : "overwrite", "save_mode" : "Overwrite", "data_movement_id" : 261, "ingestion_mode_key" : true, "drop_create_condition" : true } ], "generate_extra_configs_json" : "ewoiZXh0cmFDb25maWdNYXAiOiB7InNwYXJrLm5hYnUuZmV0Y2hfc2l6ZSI6ICIxMDAwMCIsICJzcGFyay5uYWJ1LmNvbXB1dGVfZW5naW5lIjogImF6dXJlX2RhdGFicmlja3MiLCAic3BhcmsubmFidS5zb2xyX2JhdGNoX3NpemUiOiAiMTAwMDAiLCAic3BhcmsubmFidS5hcHBsaWNhdGlvbl9uYW1lIjogIm5hYnUtc3Bhcmtib3QtaW5nZXN0aW9uIiwgInNwYXJrLmRyaXZlci5uYWJ1X3ByaXZhdGVLZXkiOiAiL2RiZnMvdG1wL2Rldi12My0xLTItMC9uYWJ1LzE3MDAwNjY0MzgxMjY0MjQxLzAvcHJpdmF0ZUtleSIsICJzcGFyay5kcml2ZXIuc291cmNlX2F3c19lbmRQb2ludCI6ICJzMy5hbWF6b25hd3MuY29tIiwgInNwYXJrLmRyaXZlci50YXJnZXRfYXdzX2VuZFBvaW50IjogInMzLmFtYXpvbmF3cy5jb20iLCAic3BhcmsubmFidS5jb21wdXRlX2VuZ2luZV9saWJzX3BhdGgiOiAiL2RiZnMvdG1wL2Rldi12My0xLTItMC9uYWJ1LzE3MDAwNjY0MzgxMjY0MjQxLzAvYXBwbGljYXRpb24uY29uZiJ9Cn0=", "incremental_load_details" : [ { "?column?" : 1 } ], "place_holders_with_default_and_max_values" : [ { "?column?" : 1 } ], "incremental_max_columns_with_column_ids" : [ { "?column?" : 1 } ], "remove_duplicates_data" : [], "cdc_first_time" : [ { "cdc_first_time" : true } ], "generate_base64_pipeline_timeout_json" : "ewoicGlwZWxpbmVfdGltZW91dCIgOiAyMwp9", "table_partition_output" : [], "fetch_source_type" : [ { "is_source_filetype" : false, "is_destination_redshift" : false, "data_movement_id" : 261, "source_metadata_category" : "relational", "destination" : "adls_gen2", "is_source_salesforce" : false, "is_destination_filetype" : true, "source" : "sql_server", "is_source_mongodb" : false, "is_ordinalpos_startwith_zero" : false, "destination_metadata_category" : "file" } ], "destination_transformation_query_details_output" : [ { "is_virtual" : false, "data_precision" : 0, "is_nullable" : false, "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "table_id" : 37234, "is_precision_scale" : true, "table_name" : "aaaa", "intermediate_datatype_name" : "string", "is_mysql" : false, "is_source_hive" : false, "is_partitioned_col" : false, "ingested_colorder" : 1, "user_text" : null, "field_name_replaced" : "entity_id", "is_long_col_name" : false, "is_oracle_destination" : false, "data_length" : 255, "destination_datatype_name" : "string", "column_name" : "entity_id", "source_type" : "sql_server", "schema_name" : "acuity-develop", "is_source_casting_enabled" : false, "is_varchar" : false, "field_name" : "entity_id", "column_id" : 956158, "source_cast_type" : "AsIs", "ordinal_position" : 1, "source_datatype_name" : "varchar", "is_cdc_col" : false, "data_scale" : 0, "replaced_column_name" : "entity_id", "data_type" : "varchar", "is_bigquery" : false, "is_precision" : true, "is_redshift_relational_destination" : false, "source_stg_function" : "AsIs", "istimezone" : false }, { "is_virtual" : false, "data_precision" : 0, "is_nullable" : false, "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "table_id" : 37234, "is_precision_scale" : true, "table_name" : "aaaa", "intermediate_datatype_name" : "string", "is_mysql" : false, "is_source_hive" : false, "is_partitioned_col" : false, "ingested_colorder" : 2, "user_text" : null, "field_name_replaced" : "entity_type", "is_long_col_name" : false, "is_oracle_destination" : false, "data_length" : 255, "destination_datatype_name" : "string", "column_name" : "entity_type", "source_type" : "sql_server", "schema_name" : "acuity-develop", "is_source_casting_enabled" : false, "is_varchar" : false, "field_name" : "entity_type", "column_id" : 956159, "source_cast_type" : "AsIs", "ordinal_position" : 2, "source_datatype_name" : "varchar", "is_cdc_col" : false, "data_scale" : 0, "replaced_column_name" : "entity_type", "data_type" : "varchar", "is_bigquery" : false, "is_precision" : true, "is_redshift_relational_destination" : false, "source_stg_function" : "AsIs", "istimezone" : false } ], "get_varchar_columns_destination" : [], "input_data" : { "flow_number" : 1, "process_id" : 17000664381264241, "source_database_name_lowercase" : "development-db", "batch_id" : 17000664380239952, "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDY2NDU3NzgzNDI0MCwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0OTI1OCwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2NjQ1N30.cgEzDcSlWhMY65PdNscgXY1oBYM75LZUbp00acf6_d1WRUOrXXGi5pcvwkRNDv0JIxun7nmcSCqy2CKZ38-eHnEqqAoxh2CIRwXTdBlsYYFyfkXHYapfaXinAi82pkDk0yJQOs-m-vAf1cbV4ue4Zk6bHKbJeu_j5_x8HU3PKeF0pz0lA-tpeoFRlq_tLUXqApH5t7QuTIzOSq7Aujo6yOSm_inHTBzTWxUyVaBCitbKs_j3Oq-P5c-Y5W3r9oAvDNbMASikxmdxfJBp_rI2QYHdxazW9UvVh_ZpRPwOIbi7EAe9-B6BBxAxItPBTo4M-GFi-zvZZXXYMX57edoRDA", "end_point" : "http:\/\/dev-dha.humana.com:8889\/fireshots\/credentialsFetchWebService", "where_condition" : "37234", "suffix" : "", "reorder_columns" : [], "job_type_id" : "1", "ingestion_table_format" : "", "job_schedule_id" : 1568, "relative_file_path" : "", "retry_attempt" : "0", "source_schema_name_lowercase" : "acuity-develop", "variables" : { "env_variables" : {}, "user_variables" : {}, "payload_variables" : {} }, "source_database_name_uppercase" : "DEVELOPMENT-DB", "job_scheduled_user_id" : "Manaswini Chinthalapudi", "virtual_column" : [], "new_table_for_rename" : "", "source_schema_name_uppercase" : "ACUITY-DEVELOP", "batch_name" : "Ingestion_20231115", "modified_columns" : [], "source_database_name" : "development-db", "data_movement_id" : 261, "last_run_timestamp" : "2023-11-07 12:42:00.86365", "is_relative_file_path" : false }, "table_adv_opt_details" : [ { "dataplace_id" : 42, "cru_ts" : "2023-11-15 09:31:16.466337", "data_movement_id" : 261, "valid_to_ts" : "9999-12-31 00:00:00.0", "advance_option_details" : { "advanced_table_options" : { "columns_options" : { "modified_columns" : [], "virtual_column" : [], "excluded_column_ids" : [] }, "CDC" : { "audit_columns" : { "prev_process_id_column_name" : "prev_process_id", "end_date_column_name" : "valid_to_ts", "process_id_column_name" : "process_id", "start_date_column_name" : "valid_from_ts" }, "CDC_process_type" : "", "add_audit_columns" : false, "columns_ids" : [], "CDC_type" : "", "create_view" : false, "hash_type" : "", "view_name" : "v_aaaa" }, "sort_by_columns" : [], "incremental_load" : { "condition_values" : [], "where_clause" : "" }, "parallel_ingestion" : { "max_connections" : 1, "enable" : false }, "remove_duplicates" : { "sort_columns" : [], "key_columns" : [] }, "table_id" : 37234, "reorder_columns" : [], "table_name" : "aaaa", "parallel_hash_ingestion" : { "max_connections" : 8, "enable" : false }, "dataplace_id" : 42, "ingestion_mode" : { "mode" : "Drop & Re-create", "enable" : true }, "enable_cache" : { "enable" : false }, "ingest_using_query" : { "enable" : false, "sql_query" : "" }, "schema_id" : 453, "new_table_name" : "", "table_partitions" : [] }, "advanced_option_flags" : { "columns_options" : false, "CDC" : false, "sort_by_columns" : false, "incremental_load" : false, "parallel_ingestion" : false, "remove_duplicates" : false, "virtual_column" : false, "table_id" : 37234, "reorder_columns" : false, "table_name" : "aaaa", "parallel_hash_ingestion" : false, "dataplace_id" : 42, "modified_columns" : false, "ingestion_mode" : true, "enable_cache" : false, "ingest_using_query" : false, "schema_id" : 453, "new_table_name" : false, "excluded_column_ids" : false, "table_partitions" : false } }, "valid_from_ts" : "2023-11-15 09:31:16.466337", "cru_by" : "Venkata Yeedi", "object_id" : 37234 } ], "check_compute_engine_validity" : [ { "is_valid_compute_engine" : true } ], "get_non_partition_cols" : [ { "is_virtual" : false, "data_precision" : "0", "destination_datatype_name" : "string", "is_auditcol" : false, "data_length" : "255", "column_name" : "entity_id", "source_field_name" : "entity_id", "field_name" : "entity_id", "column_id" : "956158", "source_datatype_name" : "varchar", "is_partitioned_col" : false, "data_scale" : "0", "ingested_colorder" : 1 }, { "is_virtual" : false, "data_precision" : "0", "destination_datatype_name" : "string", "is_auditcol" : false, "data_length" : "255", "column_name" : "entity_type", "source_field_name" : "entity_type", "field_name" : "entity_type", "column_id" : "956159", "source_datatype_name" : "varchar", "is_partitioned_col" : false, "data_scale" : "0", "ingested_colorder" : 2 } ], "get_partition_cols" : [], "list_of_maps_of_incremental_columns" : [ { "?column?" : 1 } ], "spark_script_inputs" : [ { "ssh_username" : "null", "ssh_host" : "null", "loggroupname" : null, "kerberos" : null, "cloud_watch" : null, "compute_engine_info" : "ewoiY2x1c3Rlcl9pZCI6IjA5MjItMDAzMTM4LW9ybjlyMHRlIiwic3BhcmtfdmVyc2lvbl92YWx1ZSI6IjNfMSIsInNjYWxhX3ZlcnNpb25fdmFsdWUiOiIyXzEyIiwiY3JlZGVudGlhbHNfZmlsZXBhdGgiOiIiLCJjbHVzdGVyX2xpYnJhcnlfcGF0aCI6Ii9kYmZzL3RtcCIsInNwYXJrX3ZlcnNpb24iOiIzLjEiLCJzY2FsYV92ZXJzaW9uIjoiMi4xMiIKfQ==", "private_key_path" : "\/dbfs\/tmp\/dev-v3-1-2-0\/nabu\/17000664381264241\/0\/privateKey", "b64_external_jars_map" : null, "cluster_id" : "0922-003138-orn9r0te", "engine_sub_type" : "azure databricks", "spark_location" : "null", "dataproc_cluster" : "null", "cluster_library_path" : "\/dbfs\/tmp", "data_movement_name" : "ss_compass_adb_validation", "dataproc_project" : "null", "engine_path" : "azure_databricks", "is_bucket_encrypted" : null, "execution_role" : null, "cluster_ui" : null, "s3_bucket_path" : null, "rest_url" : null, "s3logs" : null, "cloud_type" : "null", "release_label" : null, "spark_version" : "3.1", "scala_version" : "2.12", "region" : "null" } ], "column_metadata_output" : [ { "is_virtual" : false, "data_precision" : 0, "is_nullable" : false, "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "table_id" : 37234, "is_precision_scale" : true, "table_name" : "aaaa", "intermediate_datatype_name" : "string", "is_mysql" : false, "is_source_hive" : false, "is_partitioned_col" : false, "user_text" : null, "field_name_replaced" : "entity_id", "is_long_col_name" : false, "is_oracle_destination" : false, "data_length" : 255, "destination_datatype_name" : "string", "column_name" : "entity_id", "source_type" : "sql_server", "schema_name" : "acuity-develop", "is_source_casting_enabled" : false, "is_varchar" : false, "field_name" : "entity_id", "column_id" : 956158, "source_cast_type" : "AsIs", "ordinal_position" : 1, "source_datatype_name" : "varchar", "is_cdc_col" : false, "data_scale" : 0, "replaced_column_name" : "entity_id", "data_type" : "varchar", "is_bigquery" : false, "is_precision" : true, "is_redshift_relational_destination" : false, "source_stg_function" : "AsIs", "istimezone" : false }, { "is_virtual" : false, "data_precision" : 0, "is_nullable" : false, "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "table_id" : 37234, "is_precision_scale" : true, "table_name" : "aaaa", "intermediate_datatype_name" : "string", "is_mysql" : false, "is_source_hive" : false, "is_partitioned_col" : false, "user_text" : null, "field_name_replaced" : "entity_type", "is_long_col_name" : false, "is_oracle_destination" : false, "data_length" : 255, "destination_datatype_name" : "string", "column_name" : "entity_type", "source_type" : "sql_server", "schema_name" : "acuity-develop", "is_source_casting_enabled" : false, "is_varchar" : false, "field_name" : "entity_type", "column_id" : 956159, "source_cast_type" : "AsIs", "ordinal_position" : 2, "source_datatype_name" : "varchar", "is_cdc_col" : false, "data_scale" : 0, "replaced_column_name" : "entity_type", "data_type" : "varchar", "is_bigquery" : false, "is_precision" : true, "is_redshift_relational_destination" : false, "source_stg_function" : "AsIs", "istimezone" : false } ], "updated_wherecondition_replaced_with_default_and_max_values" : [ { "?column?" : 1 } ], "cdc_schema_drift_new_table" : [ { "drift_new_table" : false } ], "emr_input_json" : "ewogICJjbHVzdGVyX2lkIjogIjA5MjItMDAzMTM4LW9ybjlyMHRlIiwKICAiY2x1c3Rlcl9yZWdpb24iOiAibnVsbCIsCiAgImNvbXB1dGVfZW5nX2NyZWRzX2pzb24iOiAiZXdvZ0lDSmpjbVZrWlc1MGFXRnNYMmxrSWpvZ0lqUXhJaXdLSUNBaVkzSmxaR1Z1ZEdsaGJGOTBlWEJsWDJsa0lqb2dJakUxSWl3S0lDQWlZM0psWkdWdWRHbGhiRjkwZVhCbElqb2dJa1pwYkdVZ1EyOXVkR1Z1ZENJc0NpQWdJblJ2YTJWdUlqb2dJbU0yT1RVd05UZ3lZVEV5WWpVMU9HRmlOalE0WTJSaU56SXdNRGd4TnpOaU1tVTROREk0Wm1JMU5XUmhZV1EzTkRBeE5USXlOVFk1TVdWbFl6YzRaV1UzWWpWak5HVXpORE14TW1SbFpEY3dZV1UxWlRkbFpUUTRNMkkzWkRkbFlUQmpNak5sTWpSbE5EVTRaV1F4WmpVMFpHRXpZMk5rTjJSaVkyWmxPRGN3WVRZeFpUVmpPV00xTURnM1pUZG1ZalprWXpFMllqWm1PR1kxWlRSaVpXUmxOR013WlRBellqTmtZalpoWm1FM1lqY3lPV05pT1dKallUZ3hNRE5qWW1VMFlqRmlZMlF5WW1NMVlqTXlZekkwT0RJM1ptUm1PVEZqT0dNeE1XTm1NelppWmpVeE56RmhPVGsyTW1NeFkyRTFOR1k0WldNNE5ESXdOamRoT0RRNFlqa3lNMk0yT1dReU9UbGpObUkzTlRJMFl6QTVOVFF5T1RNd05EQXpNRGxoTVdZNFptUXpPV1kzT0RKa01XSmtPRFkwTTJZek1tRTJOV1poTXpVM01EVTJaV0prWmpCa05UUTVaVEl3WmpCbU1XRXdOVFpsT0RFeU5qTTRNak0wWVRSbU5UVmxNRFU1TjJZd05tRmxOMlkwTnpBd05qUTFZekJtTW1RNE56bGhNREprTlRVeU5HVmhNak0wWXpJd1pEbGxaV1kwTm1ReE5XWmxaR0poTldKbU9UVmxObUppT0RNd1ptRmpaR05oWVdVeE56QTJabU5oTmpFNE1HSmtZakF3TXpWaE9UTmxNalJrTlRjMU5HWTNaREptT0dNek16VTRZbUpoWW1OaU5XTTVaakprWkdKaE1HRmhPVGs0WTJZNU9XTmtNVGhqWXpsbE9URTRZekJqT1Rkak9UZ3haV1psWXpObFptSTNNbUkxWTJJMU5UY3dNR05pTVdVNE1qazVNekEzWWpJNE9HRTNPRFJpT0RBMllqZzBPVE16TmpjMU5EUmtaVGs1TnpNNVpqSTBZVGsyTkRVMFpXVTNNVGt5TVRCbFltUXlOek5sTXpRek5tRTBNalU0TkRJNE1HRXlNekEyTURsak0yRTFObUkzWkdVMk5tRmhZV1JrTkdWbE1EWTFOMlEwTlRjMVltSTJPVEl3TURFeVptSm1aV1JpTmpaaFpqSTBOR1ExTVRrNU1qVm1Zek5sTkRSaFpqSm1OR0poTmpjMFpHTXpNMkpqTW1WbE5HUmlNbVkwWVdabU0yVTVaV0prTkdWaE5qVmhNVFkzTm1Ga1lXTTRaalJoTURZME56bGxPR0UwTlRRM1pXVmxPR1UwWlRKak16bGlNREUxWW1RM1pqZ3hOR016T0Roak1EVTFNV1F6WmpJeVlXWmtNVEl4WW1SbVkyVm1PVFk1WTJRM01XUTJZamRpTXpVd1ltVXhOell4WkRVNVlqWTFNRE15WTJOa1ltUmhOekU0TmpnMk5qQTFZV0U0WmpRM05UQm1ZekkzTWpnMU9UTmtPVEprT1dGa1pqVm1PRFJsWkRVellUQTNPV1EyTURsa01EYzJNbVExTkdRM01ESTBOV1ppTW1WbU1qSTBPVE0xTnprM09HSXpOREl5TUdFeFl6aGpORFV6TWpKbFpqUmtaV1JoWXpFeE5HRTRZemsyWVRVMU9XUXpZV1ZqTXpKbU0yVTJNVE5tWVRobFpXRm1aakF5T0dFNE16ZGlZakV5WVdJd1pXTTJNalUwTURFNE1UQTJZelkxTkdWallqYzRNMlEwWldRek16TTVNR1JqTmpoaFpEZ3pZbVU0WldJNE9HVXpZamN4TkdNME1EVXpNakl3T1RrME1qTTNOalk1TURrek1HWTNaRGMwT0dVeFlUUmlNVGszTkRrME5qWXpOVEE1T1ROaU1tVTFZalF5WkdJME5USXlZbU5oTVROaE5tRTVZelZrTWpZek16ZzBPR1JtT0RFelpETXdOemRsTjJKaE56Z3dOVEk0T1dabE1EUTJZalV3TURreE9UazFaRFEyWXpBM1lUQmpPREV6TmpZMk56RmlOelF4TlRKaU5XSXpaamN3WW1NNElpd0tJQ0FpWTNKbFpHVnVkR2xoYkY5bGJtUndiMmx1ZEY5MWNtd2lPaUFpYUhSMGNEb3ZMMlJsZGkxa2FHRXVhSFZ0WVc1aExtTnZiVG80T0RnNUwyWnBjbVZ6YUc5MGN5OWpjbVZrWlc1MGFXRnNjMFpsZEdOb1YyVmlVMlZ5ZG1salpTSXNDaUFnSW1acGJHVmZjR0YwYUNJNklDSXhOVFk0WHpJMk1WOHhOekF3TURZMk5ETTRNREl6T1RrMU1pSXNDaUFnSW1OeVpXUmxiblJwWVd4ZlptbHNaVjl3WVhSMFpYSnVJaUE2SUNJME1WOHhOams1TXpReU5UYzFJZ3A5IiwKICAiczNfcGF0aCI6ICIiLAogICJiNjRfaW5wdXRfanNvbiI6ICJld29pY0hKdlkyVnpjMGxrSWpveE56QXdNRFkyTkRNNE1USTJOREkwTVN3S0ltUmhkR0Z3YkdGalpVbGtJam8wTWl3S0luUmhZbXhsU1dRaU9qTTNNak0wTEFvaVpHRjBZVzF2ZG1WdFpXNTBTV1FpT2pJMk1Td0tJbXB2WWxOamFHVmtkV3hsWkZWelpYSkpaQ0k2SWsxaGJtRnpkMmx1YVNCRGFHbHVkR2hoYkdGd2RXUnBJaXdLSW1wdllsTmphR1ZrZFd4bFNXUWlPakUxTmpnc0NpSmlZWFJqYUVsa0lqb3hOekF3TURZMk5ETTRNREl6T1RrMU1pd0tJbXhoYzNSU2RXNVVhVzFsYzNSaGJYQWlPaUl5TURJekxURXhMVEEzSURFeU9qUXlPakF3TGpnMk16WTFJaXdLSW5KbGRISjVUblZ0SWpvZ0lqQWlDbjA9IiwKICAiZXh0cmFfY29uZmlnIjogImV3b2laWGgwY21GRGIyNW1hV2ROWVhBaU9pQjdJbk53WVhKckxtNWhZblV1Wm1WMFkyaGZjMmw2WlNJNklDSXhNREF3TUNJc0lDSnpjR0Z5YXk1dVlXSjFMbU52YlhCMWRHVmZaVzVuYVc1bElqb2dJbUY2ZFhKbFgyUmhkR0ZpY21samEzTWlMQ0FpYzNCaGNtc3VibUZpZFM1emIyeHlYMkpoZEdOb1gzTnBlbVVpT2lBaU1UQXdNREFpTENBaWMzQmhjbXN1Ym1GaWRTNWhjSEJzYVdOaGRHbHZibDl1WVcxbElqb2dJbTVoWW5VdGMzQmhjbXRpYjNRdGFXNW5aWE4wYVc5dUlpd2dJbk53WVhKckxtUnlhWFpsY2k1dVlXSjFYM0J5YVhaaGRHVkxaWGtpT2lBaUwyUmlabk12ZEcxd0wyUmxkaTEyTXkweExUSXRNQzl1WVdKMUx6RTNNREF3TmpZME16Z3hNalkwTWpReEx6QXZjSEpwZG1GMFpVdGxlU0lzSUNKemNHRnlheTVrY21sMlpYSXVjMjkxY21ObFgyRjNjMTlsYm1SUWIybHVkQ0k2SUNKek15NWhiV0Y2YjI1aGQzTXVZMjl0SWl3Z0luTndZWEpyTG1SeWFYWmxjaTUwWVhKblpYUmZZWGR6WDJWdVpGQnZhVzUwSWpvZ0luTXpMbUZ0WVhwdmJtRjNjeTVqYjIwaUxDQWljM0JoY21zdWJtRmlkUzVqYjIxd2RYUmxYMlZ1WjJsdVpWOXNhV0p6WDNCaGRHZ2lPaUFpTDJSaVpuTXZkRzF3TDJSbGRpMTJNeTB4TFRJdE1DOXVZV0oxTHpFM01EQXdOalkwTXpneE1qWTBNalF4THpBdllYQndiR2xqWVhScGIyNHVZMjl1WmlKOUNuMD0iLAogICJiYXRjaF9pZCI6IDE3MDAwNjY0MzgwMjM5OTUyLAogICJyZXRyeV9udW0iOiAiMCIsCiAgInNwYXJrX2NvbmZpZ3MiOiAiZXdvZ0lDQWdJbk52YkhKZlltRjBZMmhmYzJsNlpTSTZJakV3TURBd0lpd2ljR0Z5WVd4c1pXeGZkR2h5WldGa2N5STZJakV3SWl3aVptVjBZMmhmYzJsNlpTSTZJakV3TURBd0lnb2dJQ0FnZlE9PSIsCiAgImlzX2J1Y2tldF9lbmNyeXB0ZWQiOiAiIiwKICAiYjY0X2V4dGVybmFsX2phcnNfbWFwIiA6ICIiCn0=", "base64_rsa_compressed_encrypted_creds" : "rO0ABXVyAAJbQqzzF\/gGCFTgAgAAeHAAAAEAVy+9AQow7FXoD3z0ooJjPC+HrI5N52yIITSaL9yRvE3fFebDEBpUbP1qvJhLwLTo+6fqeYvorPcJGHVOzB+Iqo+4m\/AMDDiIgWaXz5hy8QfjV7PwWwarCUa5mj+NtOgTKwyw4WNnFcphnkE34tLJad1s2vF1qQHUgOCtysAB0fD2JA5BeEsUprhbts03GzeY8OCgy0kqiYHEoKRaS8cBWUQ81oeyo7fW8mdSsKVpY8wi3b2npBin83TSMAUXtFbeCjOOr7HC\/3DMYHQUM5xaZCNH7zeYWSMgAlTn1c+y42\/1lX0UE1c2qtplYC8Ky+yYikmWcrfsLOy5xJEB7L+KRHVxAH4AAAAAA5BHFNPNX+74skXzppe3RfD\/xrCll8g7yP06oIux1cYJaH6Z7Tz988miRj5z+4nzKfiAIw+MdVKnOwsvawBMOpAR\/WDGsqWEKC7EsNrjsBFm1HQ5tPFHcClV0HYlKZR5ejgDCOvBGBZ\/tQsIzKYl+dX92uH4Lgcbr9ns5Yi5CM3R0+q\/Z+5xzabCGcz54a7EjH1zT9y0wYp17VgEW9nccBtkkCmXJgDD1tijNxwK7I61N36cNTaMdQR71U1npaMyzuT0dQ6kgrputCx75rpIMsDwEkYi9ay\/LBgamfQiKPa7SDIzBjv5OgCrfU15BWr0OMRFAbu4rLF8s8PO9BrKQrA3JOsJwl8dQ47dhhJsDJgS8QAndbeJgjkT0Nsa18RE9pZ0HVVpSPhJR4aJvRlyFas6EOxbgVcPIrOgb9ahXBrFPblowqfD1iJ+z1brU00RxP\/cbjwyZOf6WJvFUzQqzqVEUJyJC4np9grL7zrPsMO8lseQ45QZQ7uhSsDztsV3OrzFK+mqSUtrVQzmkABaHyutr4dz3mPa9QtcZCX\/EshdwWwqf7+8WnuSwT40xMECKEL06BjuBZRtAPMhxX8Zo+eEA2mQmk2V2raRX0bluYFVsz2vnxcH1ntp9k\/YgPZeGNWpUI\/KQ\/CbUjbX7NX1FV+63fmJT2SRWj32vCOBu4K8405WNQ82YRJmP0k\/vMTeq\/XfF0tguDEBT31ra0tTYcKCUqIZ0+wTBakLiFVEM1xj7A\/u+7n7rsQkrKs31eNRo+2C8klBPjv6v\/Ju0F9JbNJtqUiFOxlUq\/wNRSm68xH6ZOFDG51BcZfxlkWvJOdvYoTVlylv67hH3pZgFK2GhXwl9Bhw6+eljQ+fP6eAncyFejNtvAuWGl5xf3ZgtPc\/15c8rj2+DPRqcd+rv6M7oftuvIqGbs\/gA1vDEbVVTT6J0TxEiEMpC0iYHmyAremaLDkBKWIns10eBeegTF1\/bZ7yNWcDS6tX\/0ensUmI5hLTA1tKsul7NuEjbU88KabhKtWknSmMnDix+feQ+D3yMuNIZroXqOeyDW+VkOpMNJNfrv5lPlVoiklns4VyGc\/XasVA63bVnUxRtgVNwO1ZyyfAIe7F46dIakC1HAHHTkmPwSJe965Ty+pACqPLVvEtrHJtETL5CKW2spRW3SnmhGLdr4R01j\/XFamcyFWvWmeSfwXG25kzHBrJN+5mGxFPFto=", "target_schemadrift_details" : [ { "destination_table_name" : "aaaa", "target_schemadrift_backup_table" : false, "target_schemadrift_ignore_table" : false, "backup_table_name" : "aaaa", "target_schemadrift_new_table" : false, "schema_drifted" : false } ], "generate_file_content_json" : "ewogICJjcmVkZW50aWFsX2lkIjogIjQxIiwKICAiY3JlZGVudGlhbF90eXBlX2lkIjogIjE1IiwKICAiY3JlZGVudGlhbF90eXBlIjogIkZpbGUgQ29udGVudCIsCiAgInRva2VuIjogImM2OTUwNTgyYTEyYjU1OGFiNjQ4Y2RiNzIwMDgxNzNiMmU4NDI4ZmI1NWRhYWQ3NDAxNTIyNTY5MWVlYzc4ZWU3YjVjNGUzNDMxMmRlZDcwYWU1ZTdlZTQ4M2I3ZDdlYTBjMjNlMjRlNDU4ZWQxZjU0ZGEzY2NkN2RiY2ZlODcwYTYxZTVjOWM1MDg3ZTdmYjZkYzE2YjZmOGY1ZTRiZWRlNGMwZTAzYjNkYjZhZmE3YjcyOWNiOWJjYTgxMDNjYmU0YjFiY2QyYmM1YjMyYzI0ODI3ZmRmOTFjOGMxMWNmMzZiZjUxNzFhOTk2MmMxY2E1NGY4ZWM4NDIwNjdhODQ4YjkyM2M2OWQyOTljNmI3NTI0YzA5NTQyOTMwNDAzMDlhMWY4ZmQzOWY3ODJkMWJkODY0M2YzMmE2NWZhMzU3MDU2ZWJkZjBkNTQ5ZTIwZjBmMWEwNTZlODEyNjM4MjM0YTRmNTVlMDU5N2YwNmFlN2Y0NzAwNjQ1YzBmMmQ4NzlhMDJkNTUyNGVhMjM0YzIwZDllZWY0NmQxNWZlZGJhNWJmOTVlNmJiODMwZmFjZGNhYWUxNzA2ZmNhNjE4MGJkYjAwMzVhOTNlMjRkNTc1NGY3ZDJmOGMzMzU4YmJhYmNiNWM5ZjJkZGJhMGFhOTk4Y2Y5OWNkMThjYzllOTE4YzBjOTdjOTgxZWZlYzNlZmI3MmI1Y2I1NTcwMGNiMWU4Mjk5MzA3YjI4OGE3ODRiODA2Yjg0OTMzNjc1NDRkZTk5NzM5ZjI0YTk2NDU0ZWU3MTkyMTBlYmQyNzNlMzQzNmE0MjU4NDI4MGEyMzA2MDljM2E1NmI3ZGU2NmFhYWRkNGVlMDY1N2Q0NTc1YmI2OTIwMDEyZmJmZWRiNjZhZjI0NGQ1MTk5MjVmYzNlNDRhZjJmNGJhNjc0ZGMzM2JjMmVlNGRiMmY0YWZmM2U5ZWJkNGVhNjVhMTY3NmFkYWM4ZjRhMDY0NzllOGE0NTQ3ZWVlOGU0ZTJjMzliMDE1YmQ3ZjgxNGMzODhjMDU1MWQzZjIyYWZkMTIxYmRmY2VmOTY5Y2Q3MWQ2YjdiMzUwYmUxNzYxZDU5YjY1MDMyY2NkYmRhNzE4Njg2NjA1YWE4ZjQ3NTBmYzI3Mjg1OTNkOTJkOWFkZjVmODRlZDUzYTA3OWQ2MDlkMDc2MmQ1NGQ3MDI0NWZiMmVmMjI0OTM1Nzk3OGIzNDIyMGExYzhjNDUzMjJlZjRkZWRhYzExNGE4Yzk2YTU1OWQzYWVjMzJmM2U2MTNmYThlZWFmZjAyOGE4MzdiYjEyYWIwZWM2MjU0MDE4MTA2YzY1NGVjYjc4M2Q0ZWQzMzM5MGRjNjhhZDgzYmU4ZWI4OGUzYjcxNGM0MDUzMjIwOTk0MjM3NjY5MDkzMGY3ZDc0OGUxYTRiMTk3NDk0NjYzNTA5OTNiMmU1YjQyZGI0NTIyYmNhMTNhNmE5YzVkMjYzMzg0OGRmODEzZDMwNzdlN2JhNzgwNTI4OWZlMDQ2YjUwMDkxOTk1ZDQ2YzA3YTBjODEzNjY2NzFiNzQxNTJiNWIzZjcwYmM4IiwKICAiY3JlZGVudGlhbF9lbmRwb2ludF91cmwiOiAiaHR0cDovL2Rldi1kaGEuaHVtYW5hLmNvbTo4ODg5L2ZpcmVzaG90cy9jcmVkZW50aWFsc0ZldGNoV2ViU2VydmljZSIsCiAgImZpbGVfcGF0aCI6ICIxNTY4XzI2MV8xNzAwMDY2NDM4MDIzOTk1MiIsCiAgImNyZWRlbnRpYWxfZmlsZV9wYXR0ZXJuIiA6ICI0MV8xNjk5MzQyNTc1Igp9", "get_view_info" : [ { "id" : 1 } ], "get_already_ingested_condition" : [ { "already_ingested" : true } ], "sort_by_columns_data" : [], "fetching_credential_inputs" : [ { "credential_type" : "File Content", "metastore_credential_type_id" : null, "credential_type_id" : 15, "metastore_credential_id" : null, "credential_pattern" : "41_1699342575", "spark_credential_id" : 41 } ], "get_varchar_columns" : [], "generate_spark_configs_json" : "ewogICAgInNvbHJfYmF0Y2hfc2l6ZSI6IjEwMDAwIiwicGFyYWxsZWxfdGhyZWFkcyI6IjEwIiwiZmV0Y2hfc2l6ZSI6IjEwMDAwIgogICAgfQ==" }, "batch_id" : "17000664380239952", "template_execution_type" : "single", "query_type" : "json", "currentBotMessageMap" : { "parent_id" : "4e8bcd3a-7fb0-4043-aba4-6d226c053fa0", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "message_context" : "ingestion_deciding", "message_id" : "9ef48220-268b-40d5-8cd9-8f49fbd8f89c", "task_retry_intervals_secs" : [], "bot_id" : "84c43ca6-2712-4cd9-b2d9-b0fe3f69b476", "message_topic" : "nabu_2_jdbc", "tags" : { "process_id" : 17000664381264241, "batch_id" : 17000664380239952, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "tags" : [ "AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot", "KoshBot", "DBOpsBot" ], "initial_ts" : 1700066438126, "batch_name" : "Ingestion_20231115", "environment" : "modak", "job_schedule_id" : 1568, "data_movement_id" : 261, "last_run_timestamp" : "2023-11-07 12:42:00.86365", "retry_attempt" : 0, "task_dependency" : true, "ignore_job_termination" : false } } }, "template_execution_type": "single", "query_type":"json" }, "skipLogicPattern" : "doNothing", "output_message_templates": [ { "template_group": "templates/artifact_ingestion/ingestion_flow.stg", "template_name": "spark_ingestion_msg", "useIncomingData":true } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "error_template_create_msg" } ] } ] }
""2023-11-15 16:41:17.246 [Thread-588] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_jdbc
""2023-11-15 16:41:17.260 [Thread-588] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_jdbc
""2023-11-15 16:41:17.261 [Thread-588] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-15 16:41:17.261 [Thread-588] INFO  com.modak.bots.basebot.AbstractBaseBot - Skipping bot logic as skipBotLogic == true && useIncomingData == false templates/artifact_ingestion/common_templates.stg doNothingTemplate
""2023-11-15 16:41:17.261 [Thread-588] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:41:17.261 [Thread-588] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot finished processing message with id 9ef48220-268b-40d5-8cd9-8f49fbd8f89c
""2023-11-15 16:41:17.342 [Thread-1276] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 0376eeee-b9ad-4204-b839-cf0e957579a7 has started processing message with message_id e16c0da0-abcf-4b8d-a952-7d29310a9e06 and thread_id 1553 
""2023-11-15 16:41:17.342 [Thread-1276] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:41:17.342 [Thread-1276] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=9ef48220-268b-40d5-8cd9-8f49fbd8f89c, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=spark_buffer_msg, message_id=e16c0da0-abcf-4b8d-a952-7d29310a9e06, task_retry_intervals_secs=[], bot_id=15b7f47d-8271-437b-8b5b-cc11873475de, message_topic=nabu_2_jdbc, tags={process_id=17000664381264241, batch_id=17000664380239952, job_scheduled_user_id=Manaswini Chinthalapudi, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot, KoshBot, DBOpsBot, DBOpsBot], initial_ts=1700066438126, batch_name=Ingestion_20231115, environment=modak, job_schedule_id=1568, data_movement_id=261, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, task_dependency=true, ignore_job_termination=false}}
""2023-11-15 16:41:17.355 [Thread-1276] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
doNothing
""2023-11-15 16:41:17.355 [Thread-1276] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : true
""2023-11-15 16:41:17.890 [Thread-1276] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "SparkScriptBot", "bot_metadata": { "message_id": "3cc69581-bcec-4220-ade0-259dc4327992", "parent_id": "e16c0da0-abcf-4b8d-a952-7d29310a9e06", "bot_id": "0376eeee-b9ad-4204-b839-cf0e957579a7", "message_topic":"nabu_2_spark_script", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":17000664381264241, "initial_ts":1700066438126, "batch_id":17000664380239952, "batch_name":"Ingestion_20231115", "job_schedule_id":1568, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "2023-11-07 12:42:00.86365", "environment": "modak", "ignore_job_termination" : false, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot", "KoshBot", "DBOpsBot", "DBOpsBot", "KoshBot" ],"task_dependency":true}, "task_retry_intervals_secs": [ ], "message_context": "run_almaren_ingestion_job_using_spark" }, "bot_tasks": [ { "task_name": "create_credential_file_if_required", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "pre_task_logging_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "pre_log_template" }, "app_template_details": { "template_group": "templates/artifact_ingestion/ingestion_templates.stg", "template_name": "command_to_create_credentials" }, "input_data": { "is_valid_compute_engine":true, "data": { "batch_id" : "17000664380239952", "templateData" : { "query_input" : { "target_schemadrift_flag" : [ { "nextrun_after_targetdrift" : false } ], "input_json_for_checkpoint_status" : "ewoicHJvY2Vzc0lkIjoxNzAwMDY2NDM4MTI2NDI0MSwKImRhdGFwbGFjZUlkIjo0MiwKInRhYmxlSWQiOjM3MjM0LAoiZGF0YW1vdmVtZW50SWQiOjI2MSwKImpvYlNjaGVkdWxlZFVzZXJJZCI6Ik1hbmFzd2luaSBDaGludGhhbGFwdWRpIiwKImpvYlNjaGVkdWxlSWQiOjE1NjgsCiJiYXRjaElkIjoxNzAwMDY2NDM4MDIzOTk1MiwKImxhc3RSdW5UaW1lc3RhbXAiOiIyMDIzLTExLTA3IDEyOjQyOjAwLjg2MzY1IiwKInJldHJ5TnVtIjogIjAiCn0=", "get_cdc_last_run_table" : [ { "prev_target_path" : null, "cdc_first" : true, "relative_path" : "\/261\/42\/development-db\/acuity-develop\/aaaa.parquet", "target_path" : "abfss:\/\/dataproc@idea15pisplznonprodsa2.dfs.core.windows.net\/261\/42\/development-db\/acuity-develop\/aaaa.parquet" } ], "get_cdc_type" : [ { "cdc_applied" : false, "is_primary" : false, "cdctype2" : false, "temp_path" : "17000664381264241_aaaa" } ], "generate_yeedu_metastore_credential" : "ewogICJjcmVkZW50aWFsX2lkIjogIiIsCiAgImNyZWRlbnRpYWxfdHlwZV9pZCI6ICIiLAogICJ0b2tlbiI6ICJjNjk1MDU4MmExMmI1NThhYjY0OGNkYjcyMDA4MTczYjJlODQyOGZiNTVkYWFkNzQwMTUyMjU2OTFlZWM3OGVlN2I1YzRlMzQzMTJkZWQ3MGFlNWU3ZWU0ODNiN2Q3ZWEwYzIzZTI0ZTQ1OGVkMWY1NGRhM2NjZDdkYmNmZTg3MGE2MWU1YzljNTA4N2U3ZmI2ZGMxNmI2ZjhmNWU0YmVkZTRjMGUwM2IzZGI2YWZhN2I3MjljYjliY2E4MTAzY2JlNGIxYmNkMmJjNWIzMmMyNDgyN2ZkZjkxYzhjMTFjZjM2YmY1MTcxYTk5NjJjMWNhNTRmOGVjODQyMDY3YTg0OGI5MjNjNjlkMjk5YzZiNzUyNGMwOTU0MjkzMDQwMzA5YTFmOGZkMzlmNzgyZDFiZDg2NDNmMzJhNjVmYTM1NzA1NmViZGYwZDU0OWUyMGYwZjFhMDU2ZTgxMjYzODIzNGE0ZjU1ZTA1OTdmMDZhZTdmNDcwMDY0NWMwZjJkODc5YTAyZDU1MjRlYTIzNGMyMGQ5ZWVmNDZkMTVmZWRiYTViZjk1ZTZiYjgzMGZhY2RjYWFlMTcwNmZjYTYxODBiZGIwMDM1YTkzZTI0ZDU3NTRmN2QyZjhjMzM1OGJiYWJjYjVjOWYyZGRiYTBhYTk5OGNmOTljZDE4Y2M5ZTkxOGMwYzk3Yzk4MWVmZWMzZWZiNzJiNWNiNTU3MDBjYjFlODI5OTMwN2IyODhhNzg0YjgwNmI4NDkzMzY3NTQ0ZGU5OTczOWYyNGE5NjQ1NGVlNzE5MjEwZWJkMjczZTM0MzZhNDI1ODQyODBhMjMwNjA5YzNhNTZiN2RlNjZhYWFkZDRlZTA2NTdkNDU3NWJiNjkyMDAxMmZiZmVkYjY2YWYyNDRkNTE5OTI1ZmMzZTQ0YWYyZjRiYTY3NGRjMzNiYzJlZTRkYjJmNGFmZjNlOWViZDRlYTY1YTE2NzZhZGFjOGY0YTA2NDc5ZThhNDU0N2VlZThlNGUyYzM5YjAxNWJkN2Y4MTRjMzg4YzA1NTFkM2YyMmFmZDEyMWJkZmNlZjk2OWNkNzFkNmI3YjM1MGJlMTc2MWQ1OWI2NTAzMmNjZGJkYTcxODY4NjYwNWFhOGY0NzUwZmMyNzI4NTkzZDkyZDlhZGY1Zjg0ZWQ1M2EwNzlkNjA5ZDA3NjJkNTRkNzAyNDVmYjJlZjIyNDkzNTc5NzhiMzQyMjBhMWM4YzQ1MzIyZWY0ZGVkYWMxMTRhOGM5NmE1NTlkM2FlYzMyZjNlNjEzZmE4ZWVhZmYwMjhhODM3YmIxMmFiMGVjNjI1NDAxODEwNmM2NTRlY2I3ODNkNGVkMzMzOTBkYzY4YWQ4M2JlOGViODhlM2I3MTRjNDA1MzIyMDk5NDIzNzY2OTA5MzBmN2Q3NDhlMWE0YjE5NzQ5NDY2MzUwOTkzYjJlNWI0MmRiNDUyMmJjYTEzYTZhOWM1ZDI2MzM4NDhkZjgxM2QzMDc3ZTdiYTc4MDUyODlmZTA0NmI1MDA5MTk5NWQ0NmMwN2EwYzgxMzY2NjcxYjc0MTUyYjViM2Y3MGJjOCIsCiAgImNyZWRlbnRpYWxfZW5kcG9pbnRfdXJsIjogImh0dHA6Ly9kZXYtZGhhLmh1bWFuYS5jb206ODg4OS9maXJlc2hvdHMvY3JlZGVudGlhbHNGZXRjaFdlYlNlcnZpY2UiCn0=", "table_metadata_output" : [ { "end_point" : "http:\/\/dev-dha.humana.com:8889\/fireshots\/credentialsFetchWebService", "is_filesystem_credential_type_aws" : true, "table_name" : "aaaa", "s3_bucket" : null, "path" : "", "is_lazy_mode" : false, "destination_type" : "adls_gen2", "archive_files_path" : "", "rename_table_condition" : false, "adls_gen2_directory_name" : null, "is_archive_data" : false, "destination_db" : null, "bucket_name" : null, "source_type" : "sql_server", "credential_pattern" : "2_1686574260", "is_destination_hive" : false, "estimated_rows" : 4914, "destination_file_format" : "parquet", "warehouse_name" : null, "filesystem_credential_type" : null, "is_aws_iam_attached_to_ec2_instance" : false, "is_bigquery" : false, "is_source_filetype" : false, "source_jdbc_url" : "jdbc:sqlserver:\/\/hyp-acu-development-5de0.database.windows.net:1433;database=development-db;sslProtocol=TLSv1.2;encrypt=true", "flow_number" : 1, "batch_id" : 17000664380239952, "destination_url" : null, "filesystem_credential_type_id" : null, "schema_drift_flag" : false, "is_mysql" : false, "filesystem_credential_id" : null, "destination_directory" : null, "source_credential_type_id" : 1, "destination_backup_table_name" : "aaaa", "destination_table_name" : "aaaa", "destination_dataplace_sub_component_id" : 18, "is_azure_oauth" : false, "gcs_bucket" : null, "source_directory" : null, "is_file_system_type_s3a" : false, "destination_schema_directory_id" : 3, "intermediate_type" : "parquet", "is_source_jdbc_url" : true, "is_source_spark_hive" : false, "batch_name" : "Ingestion_20231115", "source_endpoint" : "s3.amazonaws.com", "upper_case_destination_table_name" : "AAAA", "source_credential_id" : 37, "destination_credential_type_id" : 5, "adls_gen2_container" : "dataproc", "source_default_credential_exists" : false, "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDY2NDU3NzgzNDI0MCwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0OTI1OCwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2NjQ1N30.cgEzDcSlWhMY65PdNscgXY1oBYM75LZUbp00acf6_d1WRUOrXXGi5pcvwkRNDv0JIxun7nmcSCqy2CKZ38-eHnEqqAoxh2CIRwXTdBlsYYFyfkXHYapfaXinAi82pkDk0yJQOs-m-vAf1cbV4ue4Zk6bHKbJeu_j5_x8HU3PKeF0pz0lA-tpeoFRlq_tLUXqApH5t7QuTIzOSq7Aujo6yOSm_inHTBzTWxUyVaBCitbKs_j3Oq-P5c-Y5W3r9oAvDNbMASikxmdxfJBp_rI2QYHdxazW9UvVh_ZpRPwOIbi7EAe9-B6BBxAxItPBTo4M-GFi-zvZZXXYMX57edoRDA", "project" : null, "source_table_name" : "aaaa", "table_id" : 37234, "authentication_type" : "auth_token", "source_url" : null, "destination_endpoint" : "s3.amazonaws.com", "schema_id" : 453, "datamovement_engine_type" : "Spark", "relative_file_path" : "", "filesystem_credential_epoch" : null, "is_needed_partition_name_without_column_name" : false, "table_suffix" : "", "schema_name" : "acuity-develop", "is_record_process_enabled" : true, "is_default" : false, "is_jdbcmode" : false, "table_timestamp" : "", "verification_threshold" : 0.1, "pipeline_flow_timeout" : 23, "dest_default_credential_exists" : false, "process_id" : 17000664381264241, "is_destination_file" : true, "where_condition" : "37234", "source_dataplace_id" : 42, "file_system_type" : "abfss", "is_ingestion_root_path" : false, "is_source_hive" : false, "destination_oracle_jdbc_url" : null, "schema_drift_option" : "drop_create_table", "ingestion_table_format" : "", "already_ingested" : true, "destination_dataplace_id" : 5, "destination_credential_id" : 2, "file_format" : "", "create_backup_table" : null, "destination_dataplace_component_type_id" : 3, "source_jdbc_driver" : "com.microsoft.sqlserver.jdbc.SQLServerDriver", "destination_schema_name" : "dataproc", "source_db" : "development-db", "apply_transformation" : false, "target_type" : "adls_gen2", "oracle_jdbc_url" : null, "destination_schema_id" : 3, "dataplace_id" : 42, "filesystem_endpoint" : null, "is_spark_hive" : false, "destination_jdbc_driver" : null, "data_movement_id" : 261, "storage_account" : "idea15pisplznonprodsa2", "is_relative_file_path" : false, "is_create_table" : false, "is_apache_jdbc_driver" : false } ], "get_cdc_audit_cols" : [], "get_list_of_maps_of_partition_columns" : [ { "?column?" : "null" } ], "get_cdc_info" : [ { "job_id_column_name" : "process_id", "prev_job_id_column_name" : "prev_process_id", "is_sha2" : false, "add_audit_columns" : false, "end_date_column_name" : "valid_to_ts", "create_view" : false, "start_date_column_name" : "valid_from_ts", "hash_type" : "", "view_name" : "v_aaaa" } ], "get_spark_configs" : [ { "cluster_id" : null, "config_json" : { "extra_configs" : {}, "default_configs" : { "solr_batch_size" : "10000", "parallel_threads" : "10", "fetch_size" : "10000" } }, "spark_configuration_type_id" : 1, "spark_configs_json" : "{\n \"solr_batch_size\":\"10000\",\"parallel_threads\":\"10\",\"fetch_size\":\"10000\"\n }", "compute_engine_id" : 11, "extra_configs_json" : { "spark.nabu.fetch_size" : "10000", "spark.nabu.solr_batch_size" : "10000" } } ], "advanced_options_tables_flags_status" : [ { "columns_options" : false, "cdc" : null, "sort_by_columns" : false, "incremental_load" : false, "parallel_ingestion" : false, "remove_duplicates" : false, "virtual_column" : false, "reorder_columns" : false, "modified_columns" : false, "ingestion_mode" : true, "enable_cache" : false, "ingest_using_query" : false, "new_table_name" : false, "excluded_column_ids" : false, "table_partitions" : false } ], "yeedu_input_json" : "ewoiY2x1c3Rlcl9pZCI6ICIiLAoiYjY0X2lucHV0X2pzb24iOiAiZXdvaWNISnZZMlZ6YzBsa0lqb3hOekF3TURZMk5ETTRNVEkyTkRJME1Td0tJbVJoZEdGd2JHRmpaVWxrSWpvME1pd0tJblJoWW14bFNXUWlPak0zTWpNMExBb2laR0YwWVcxdmRtVnRaVzUwU1dRaU9qSTJNU3dLSW1wdllsTmphR1ZrZFd4bFpGVnpaWEpKWkNJNklrMWhibUZ6ZDJsdWFTQkRhR2x1ZEdoaGJHRndkV1JwSWl3S0ltcHZZbE5qYUdWa2RXeGxTV1FpT2pFMU5qZ3NDaUppWVhSamFFbGtJam94TnpBd01EWTJORE00TURJek9UazFNaXdLSW14aGMzUlNkVzVVYVcxbGMzUmhiWEFpT2lJeU1ESXpMVEV4TFRBM0lERXlPalF5T2pBd0xqZzJNelkxSWl3S0luSmxkSEo1VG5WdElqb2dJakFpQ24wPSIsCiJleHRyYV9jb25maWciOiAiZXdvaVpYaDBjbUZEYjI1bWFXZE5ZWEFpT2lCN0luTndZWEpyTG01aFluVXVabVYwWTJoZmMybDZaU0k2SUNJeE1EQXdNQ0lzSUNKemNHRnlheTV1WVdKMUxtTnZiWEIxZEdWZlpXNW5hVzVsSWpvZ0ltRjZkWEpsWDJSaGRHRmljbWxqYTNNaUxDQWljM0JoY21zdWJtRmlkUzV6YjJ4eVgySmhkR05vWDNOcGVtVWlPaUFpTVRBd01EQWlMQ0FpYzNCaGNtc3VibUZpZFM1aGNIQnNhV05oZEdsdmJsOXVZVzFsSWpvZ0ltNWhZblV0YzNCaGNtdGliM1F0YVc1blpYTjBhVzl1SWl3Z0luTndZWEpyTG1SeWFYWmxjaTV1WVdKMVgzQnlhWFpoZEdWTFpYa2lPaUFpTDJSaVpuTXZkRzF3TDJSbGRpMTJNeTB4TFRJdE1DOXVZV0oxTHpFM01EQXdOalkwTXpneE1qWTBNalF4THpBdmNISnBkbUYwWlV0bGVTSXNJQ0p6Y0dGeWF5NWtjbWwyWlhJdWMyOTFjbU5sWDJGM2MxOWxibVJRYjJsdWRDSTZJQ0p6TXk1aGJXRjZiMjVoZDNNdVkyOXRJaXdnSW5Od1lYSnJMbVJ5YVhabGNpNTBZWEpuWlhSZllYZHpYMlZ1WkZCdmFXNTBJam9nSW5NekxtRnRZWHB2Ym1GM2N5NWpiMjBpTENBaWMzQmhjbXN1Ym1GaWRTNWpiMjF3ZFhSbFgyVnVaMmx1WlY5c2FXSnpYM0JoZEdnaU9pQWlMMlJpWm5NdmRHMXdMMlJsZGkxMk15MHhMVEl0TUM5dVlXSjFMekUzTURBd05qWTBNemd4TWpZME1qUXhMekF2WVhCd2JHbGpZWFJwYjI0dVkyOXVaaUo5Q24wPSIsCiJjb21wdXRlX2VuZ19jcmVkc19qc29uIiA6ICJld29nSUNKamNtVmtaVzUwYVdGc1gybGtJam9nSWpReElpd0tJQ0FpWTNKbFpHVnVkR2xoYkY5MGVYQmxYMmxrSWpvZ0lqRTFJaXdLSUNBaVkzSmxaR1Z1ZEdsaGJGOTBlWEJsSWpvZ0lrWnBiR1VnUTI5dWRHVnVkQ0lzQ2lBZ0luUnZhMlZ1SWpvZ0ltTTJPVFV3TlRneVlURXlZalUxT0dGaU5qUTRZMlJpTnpJd01EZ3hOek5pTW1VNE5ESTRabUkxTldSaFlXUTNOREF4TlRJeU5UWTVNV1ZsWXpjNFpXVTNZalZqTkdVek5ETXhNbVJsWkRjd1lXVTFaVGRsWlRRNE0ySTNaRGRsWVRCak1qTmxNalJsTkRVNFpXUXhaalUwWkdFelkyTmtOMlJpWTJabE9EY3dZVFl4WlRWak9XTTFNRGczWlRkbVlqWmtZekUyWWpabU9HWTFaVFJpWldSbE5HTXdaVEF6WWpOa1lqWmhabUUzWWpjeU9XTmlPV0pqWVRneE1ETmpZbVUwWWpGaVkyUXlZbU0xWWpNeVl6STBPREkzWm1SbU9URmpPR014TVdObU16WmlaalV4TnpGaE9UazJNbU14WTJFMU5HWTRaV000TkRJd05qZGhPRFE0WWpreU0yTTJPV1F5T1Rsak5tSTNOVEkwWXpBNU5UUXlPVE13TkRBek1EbGhNV1k0Wm1Rek9XWTNPREprTVdKa09EWTBNMll6TW1FMk5XWmhNelUzTURVMlpXSmtaakJrTlRRNVpUSXdaakJtTVdFd05UWmxPREV5TmpNNE1qTTBZVFJtTlRWbE1EVTVOMll3Tm1GbE4yWTBOekF3TmpRMVl6Qm1NbVE0TnpsaE1ESmtOVFV5TkdWaE1qTTBZekl3WkRsbFpXWTBObVF4TldabFpHSmhOV0ptT1RWbE5tSmlPRE13Wm1GalpHTmhZV1V4TnpBMlptTmhOakU0TUdKa1lqQXdNelZoT1RObE1qUmtOVGMxTkdZM1pESm1PR016TXpVNFltSmhZbU5pTldNNVpqSmtaR0poTUdGaE9UazRZMlk1T1dOa01UaGpZemxsT1RFNFl6QmpPVGRqT1RneFpXWmxZek5sWm1JM01tSTFZMkkxTlRjd01HTmlNV1U0TWprNU16QTNZakk0T0dFM09EUmlPREEyWWpnME9UTXpOamMxTkRSa1pUazVOek01WmpJMFlUazJORFUwWldVM01Ua3lNVEJsWW1ReU56TmxNelF6Tm1FME1qVTROREk0TUdFeU16QTJNRGxqTTJFMU5tSTNaR1UyTm1GaFlXUmtOR1ZsTURZMU4yUTBOVGMxWW1JMk9USXdNREV5Wm1KbVpXUmlOalpoWmpJME5HUTFNVGs1TWpWbVl6TmxORFJoWmpKbU5HSmhOamMwWkdNek0ySmpNbVZsTkdSaU1tWTBZV1ptTTJVNVpXSmtOR1ZoTmpWaE1UWTNObUZrWVdNNFpqUmhNRFkwTnpsbE9HRTBOVFEzWldWbE9HVTBaVEpqTXpsaU1ERTFZbVEzWmpneE5HTXpPRGhqTURVMU1XUXpaakl5WVdaa01USXhZbVJtWTJWbU9UWTVZMlEzTVdRMllqZGlNelV3WW1VeE56WXhaRFU1WWpZMU1ETXlZMk5rWW1SaE56RTROamcyTmpBMVlXRTRaalEzTlRCbVl6STNNamcxT1ROa09USmtPV0ZrWmpWbU9EUmxaRFV6WVRBM09XUTJNRGxrTURjMk1tUTFOR1EzTURJME5XWmlNbVZtTWpJME9UTTFOemszT0dJek5ESXlNR0V4WXpoak5EVXpNakpsWmpSa1pXUmhZekV4TkdFNFl6azJZVFUxT1dRellXVmpNekptTTJVMk1UTm1ZVGhsWldGbVpqQXlPR0U0TXpkaVlqRXlZV0l3WldNMk1qVTBNREU0TVRBMll6WTFOR1ZqWWpjNE0yUTBaV1F6TXpNNU1HUmpOamhoWkRnelltVTRaV0k0T0dVellqY3hOR00wTURVek1qSXdPVGswTWpNM05qWTVNRGt6TUdZM1pEYzBPR1V4WVRSaU1UazNORGswTmpZek5UQTVPVE5pTW1VMVlqUXlaR0kwTlRJeVltTmhNVE5oTm1FNVl6VmtNall6TXpnME9HUm1PREV6WkRNd056ZGxOMkpoTnpnd05USTRPV1psTURRMllqVXdNRGt4T1RrMVpEUTJZekEzWVRCak9ERXpOalkyTnpGaU56UXhOVEppTldJelpqY3dZbU00SWl3S0lDQWlZM0psWkdWdWRHbGhiRjlsYm1Sd2IybHVkRjkxY213aU9pQWlhSFIwY0RvdkwyUmxkaTFrYUdFdWFIVnRZVzVoTG1OdmJUbzRPRGc1TDJacGNtVnphRzkwY3k5amNtVmtaVzUwYVdGc2MwWmxkR05vVjJWaVUyVnlkbWxqWlNJc0NpQWdJbVpwYkdWZmNHRjBhQ0k2SUNJeE5UWTRYekkyTVY4eE56QXdNRFkyTkRNNE1ESXpPVGsxTWlJc0NpQWdJbU55WldSbGJuUnBZV3hmWm1sc1pWOXdZWFIwWlhKdUlpQTZJQ0kwTVY4eE5qazVNelF5TlRjMUlncDkiLAoiY2x1c3Rlcl91aSI6ICIiLAoicmV0cnlfbnVtIjogIjAiLAoic3BhcmtfY29uZmlncyI6ICJld29nSUNBZ0luTnZiSEpmWW1GMFkyaGZjMmw2WlNJNklqRXdNREF3SWl3aWNHRnlZV3hzWld4ZmRHaHlaV0ZrY3lJNklqRXdJaXdpWm1WMFkyaGZjMmw2WlNJNklqRXdNREF3SWdvZ0lDQWdmUT09IiwKImI2NF9oaXZlX2NyZWRzX2pzb24iOiAiZXdvZ0lDSmpjbVZrWlc1MGFXRnNYMmxrSWpvZ0lpSXNDaUFnSW1OeVpXUmxiblJwWVd4ZmRIbHdaVjlwWkNJNklDSWlMQW9nSUNKMGIydGxiaUk2SUNKak5qazFNRFU0TW1FeE1tSTFOVGhoWWpZME9HTmtZamN5TURBNE1UY3pZakpsT0RReU9HWmlOVFZrWVdGa056UXdNVFV5TWpVMk9URmxaV00zT0dWbE4ySTFZelJsTXpRek1USmtaV1EzTUdGbE5XVTNaV1UwT0ROaU4yUTNaV0V3WXpJelpUSTBaVFExT0dWa01XWTFOR1JoTTJOalpEZGtZbU5tWlRnM01HRTJNV1UxWXpsak5UQTROMlUzWm1JMlpHTXhObUkyWmpobU5XVTBZbVZrWlRSak1HVXdNMkl6WkdJMllXWmhOMkkzTWpsallqbGlZMkU0TVRBelkySmxOR0l4WW1Oa01tSmpOV0l6TW1NeU5EZ3lOMlprWmpreFl6aGpNVEZqWmpNMlltWTFNVGN4WVRrNU5qSmpNV05oTlRSbU9HVmpPRFF5TURZM1lUZzBPR0k1TWpOak5qbGtNams1WXpaaU56VXlOR013T1RVME1qa3pNRFF3TXpBNVlURm1PR1prTXpsbU56Z3laREZpWkRnMk5ETm1NekpoTmpWbVlUTTFOekExTm1WaVpHWXdaRFUwT1dVeU1HWXdaakZoTURVMlpUZ3hNall6T0RJek5HRTBaalUxWlRBMU9UZG1NRFpoWlRkbU5EY3dNRFkwTldNd1pqSmtPRGM1WVRBeVpEVTFNalJsWVRJek5HTXlNR1E1WldWbU5EWmtNVFZtWldSaVlUVmlaamsxWlRaaVlqZ3pNR1poWTJSallXRmxNVGN3Tm1aallUWXhPREJpWkdJd01ETTFZVGt6WlRJMFpEVTNOVFJtTjJReVpqaGpNek0xT0dKaVlXSmpZalZqT1dZeVpHUmlZVEJoWVRrNU9HTm1PVGxqWkRFNFkyTTVaVGt4T0dNd1l6azNZems0TVdWbVpXTXpaV1ppTnpKaU5XTmlOVFUzTURCallqRmxPREk1T1RNd04ySXlPRGhoTnpnMFlqZ3dObUk0TkRrek16WTNOVFEwWkdVNU9UY3pPV1l5TkdFNU5qUTFOR1ZsTnpFNU1qRXdaV0prTWpjelpUTTBNelpoTkRJMU9EUXlPREJoTWpNd05qQTVZek5oTlRaaU4yUmxOalpoWVdGa1pEUmxaVEEyTlRka05EVTNOV0ppTmpreU1EQXhNbVppWm1Wa1lqWTJZV1l5TkRSa05URTVPVEkxWm1NelpUUTBZV1l5WmpSaVlUWTNOR1JqTXpOaVl6SmxaVFJrWWpKbU5HRm1aak5sT1dWaVpEUmxZVFkxWVRFMk56WmhaR0ZqT0dZMFlUQTJORGM1WlRoaE5EVTBOMlZsWlRobE5HVXlZek01WWpBeE5XSmtOMlk0TVRSak16ZzRZekExTlRGa00yWXlNbUZtWkRFeU1XSmtabU5sWmprMk9XTmtOekZrTm1JM1lqTTFNR0psTVRjMk1XUTFPV0kyTlRBek1tTmpaR0prWVRjeE9EWTROall3TldGaE9HWTBOelV3Wm1NeU56STROVGt6WkRreVpEbGhaR1kxWmpnMFpXUTFNMkV3Tnpsa05qQTVaREEzTmpKa05UUmtOekF5TkRWbVlqSmxaakl5TkRrek5UYzVOemhpTXpReU1qQmhNV000WXpRMU16SXlaV1kwWkdWa1lXTXhNVFJoT0dNNU5tRTFOVGxrTTJGbFl6TXlaak5sTmpFelptRTRaV1ZoWm1Zd01qaGhPRE0zWW1JeE1tRmlNR1ZqTmpJMU5EQXhPREV3Tm1NMk5UUmxZMkkzT0ROa05HVmtNek16T1RCa1l6WTRZV1E0TTJKbE9HVmlPRGhsTTJJM01UUmpOREExTXpJeU1EazVOREl6TnpZMk9UQTVNekJtTjJRM05EaGxNV0UwWWpFNU56UTVORFkyTXpVd09Ua3pZakpsTldJME1tUmlORFV5TW1KallURXpZVFpoT1dNMVpESTJNek00TkRoa1pqZ3hNMlF6TURjM1pUZGlZVGM0TURVeU9EbG1aVEEwTm1JMU1EQTVNVGs1TldRME5tTXdOMkV3WXpneE16WTJOamN4WWpjME1UVXlZalZpTTJZM01HSmpPQ0lzQ2lBZ0ltTnlaV1JsYm5ScFlXeGZaVzVrY0c5cGJuUmZkWEpzSWpvZ0ltaDBkSEE2THk5a1pYWXRaR2hoTG1oMWJXRnVZUzVqYjIwNk9EZzRPUzltYVhKbGMyaHZkSE12WTNKbFpHVnVkR2xoYkhOR1pYUmphRmRsWWxObGNuWnBZMlVpQ24wPSIsCiJiYXRjaF9pZCI6MTcwMDA2NjQzODAyMzk5NTIsCiJwcm9jZXNzX2lkIiA6MTcwMDA2NjQzODEyNjQyNDEsCiJyZXN0X3VybCI6ICIiLAoiYjY0X2V4dGVybmFsX2phcnNfbWFwIiA6ICIiCn0=", "ingestion_mode" : [ { "mode" : "overwrite", "save_mode" : "Overwrite", "data_movement_id" : 261, "ingestion_mode_key" : true, "drop_create_condition" : true } ], "generate_extra_configs_json" : "ewoiZXh0cmFDb25maWdNYXAiOiB7InNwYXJrLm5hYnUuZmV0Y2hfc2l6ZSI6ICIxMDAwMCIsICJzcGFyay5uYWJ1LmNvbXB1dGVfZW5naW5lIjogImF6dXJlX2RhdGFicmlja3MiLCAic3BhcmsubmFidS5zb2xyX2JhdGNoX3NpemUiOiAiMTAwMDAiLCAic3BhcmsubmFidS5hcHBsaWNhdGlvbl9uYW1lIjogIm5hYnUtc3Bhcmtib3QtaW5nZXN0aW9uIiwgInNwYXJrLmRyaXZlci5uYWJ1X3ByaXZhdGVLZXkiOiAiL2RiZnMvdG1wL2Rldi12My0xLTItMC9uYWJ1LzE3MDAwNjY0MzgxMjY0MjQxLzAvcHJpdmF0ZUtleSIsICJzcGFyay5kcml2ZXIuc291cmNlX2F3c19lbmRQb2ludCI6ICJzMy5hbWF6b25hd3MuY29tIiwgInNwYXJrLmRyaXZlci50YXJnZXRfYXdzX2VuZFBvaW50IjogInMzLmFtYXpvbmF3cy5jb20iLCAic3BhcmsubmFidS5jb21wdXRlX2VuZ2luZV9saWJzX3BhdGgiOiAiL2RiZnMvdG1wL2Rldi12My0xLTItMC9uYWJ1LzE3MDAwNjY0MzgxMjY0MjQxLzAvYXBwbGljYXRpb24uY29uZiJ9Cn0=", "incremental_load_details" : [ { "?column?" : 1 } ], "place_holders_with_default_and_max_values" : [ { "?column?" : 1 } ], "incremental_max_columns_with_column_ids" : [ { "?column?" : 1 } ], "remove_duplicates_data" : [], "cdc_first_time" : [ { "cdc_first_time" : true } ], "generate_base64_pipeline_timeout_json" : "ewoicGlwZWxpbmVfdGltZW91dCIgOiAyMwp9", "table_partition_output" : [], "fetch_source_type" : [ { "is_source_filetype" : false, "is_destination_redshift" : false, "data_movement_id" : 261, "source_metadata_category" : "relational", "destination" : "adls_gen2", "is_source_salesforce" : false, "is_destination_filetype" : true, "source" : "sql_server", "is_source_mongodb" : false, "is_ordinalpos_startwith_zero" : false, "destination_metadata_category" : "file" } ], "destination_transformation_query_details_output" : [ { "is_virtual" : false, "data_precision" : 0, "is_nullable" : false, "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "table_id" : 37234, "is_precision_scale" : true, "table_name" : "aaaa", "intermediate_datatype_name" : "string", "is_mysql" : false, "is_source_hive" : false, "is_partitioned_col" : false, "ingested_colorder" : 1, "user_text" : null, "field_name_replaced" : "entity_id", "is_long_col_name" : false, "is_oracle_destination" : false, "data_length" : 255, "destination_datatype_name" : "string", "column_name" : "entity_id", "source_type" : "sql_server", "schema_name" : "acuity-develop", "is_source_casting_enabled" : false, "is_varchar" : false, "field_name" : "entity_id", "column_id" : 956158, "source_cast_type" : "AsIs", "ordinal_position" : 1, "source_datatype_name" : "varchar", "is_cdc_col" : false, "data_scale" : 0, "replaced_column_name" : "entity_id", "data_type" : "varchar", "is_bigquery" : false, "is_precision" : true, "is_redshift_relational_destination" : false, "source_stg_function" : "AsIs", "istimezone" : false }, { "is_virtual" : false, "data_precision" : 0, "is_nullable" : false, "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "table_id" : 37234, "is_precision_scale" : true, "table_name" : "aaaa", "intermediate_datatype_name" : "string", "is_mysql" : false, "is_source_hive" : false, "is_partitioned_col" : false, "ingested_colorder" : 2, "user_text" : null, "field_name_replaced" : "entity_type", "is_long_col_name" : false, "is_oracle_destination" : false, "data_length" : 255, "destination_datatype_name" : "string", "column_name" : "entity_type", "source_type" : "sql_server", "schema_name" : "acuity-develop", "is_source_casting_enabled" : false, "is_varchar" : false, "field_name" : "entity_type", "column_id" : 956159, "source_cast_type" : "AsIs", "ordinal_position" : 2, "source_datatype_name" : "varchar", "is_cdc_col" : false, "data_scale" : 0, "replaced_column_name" : "entity_type", "data_type" : "varchar", "is_bigquery" : false, "is_precision" : true, "is_redshift_relational_destination" : false, "source_stg_function" : "AsIs", "istimezone" : false } ], "get_varchar_columns_destination" : [], "input_data" : { "flow_number" : 1, "process_id" : 17000664381264241, "source_database_name_lowercase" : "development-db", "batch_id" : 17000664380239952, "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDY2NDU3NzgzNDI0MCwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0OTI1OCwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2NjQ1N30.cgEzDcSlWhMY65PdNscgXY1oBYM75LZUbp00acf6_d1WRUOrXXGi5pcvwkRNDv0JIxun7nmcSCqy2CKZ38-eHnEqqAoxh2CIRwXTdBlsYYFyfkXHYapfaXinAi82pkDk0yJQOs-m-vAf1cbV4ue4Zk6bHKbJeu_j5_x8HU3PKeF0pz0lA-tpeoFRlq_tLUXqApH5t7QuTIzOSq7Aujo6yOSm_inHTBzTWxUyVaBCitbKs_j3Oq-P5c-Y5W3r9oAvDNbMASikxmdxfJBp_rI2QYHdxazW9UvVh_ZpRPwOIbi7EAe9-B6BBxAxItPBTo4M-GFi-zvZZXXYMX57edoRDA", "end_point" : "http:\/\/dev-dha.humana.com:8889\/fireshots\/credentialsFetchWebService", "where_condition" : "37234", "suffix" : "", "reorder_columns" : [], "job_type_id" : "1", "ingestion_table_format" : "", "job_schedule_id" : 1568, "relative_file_path" : "", "retry_attempt" : "0", "source_schema_name_lowercase" : "acuity-develop", "variables" : { "env_variables" : {}, "user_variables" : {}, "payload_variables" : {} }, "source_database_name_uppercase" : "DEVELOPMENT-DB", "job_scheduled_user_id" : "Manaswini Chinthalapudi", "virtual_column" : [], "new_table_for_rename" : "", "source_schema_name_uppercase" : "ACUITY-DEVELOP", "batch_name" : "Ingestion_20231115", "modified_columns" : [], "source_database_name" : "development-db", "data_movement_id" : 261, "last_run_timestamp" : "2023-11-07 12:42:00.86365", "is_relative_file_path" : false }, "table_adv_opt_details" : [ { "dataplace_id" : 42, "cru_ts" : "2023-11-15 09:31:16.466337", "data_movement_id" : 261, "valid_to_ts" : "9999-12-31 00:00:00.0", "advance_option_details" : { "advanced_table_options" : { "columns_options" : { "modified_columns" : [], "virtual_column" : [], "excluded_column_ids" : [] }, "CDC" : { "audit_columns" : { "prev_process_id_column_name" : "prev_process_id", "end_date_column_name" : "valid_to_ts", "process_id_column_name" : "process_id", "start_date_column_name" : "valid_from_ts" }, "CDC_process_type" : "", "add_audit_columns" : false, "columns_ids" : [], "CDC_type" : "", "create_view" : false, "hash_type" : "", "view_name" : "v_aaaa" }, "sort_by_columns" : [], "incremental_load" : { "condition_values" : [], "where_clause" : "" }, "parallel_ingestion" : { "max_connections" : 1, "enable" : false }, "remove_duplicates" : { "sort_columns" : [], "key_columns" : [] }, "table_id" : 37234, "reorder_columns" : [], "table_name" : "aaaa", "parallel_hash_ingestion" : { "max_connections" : 8, "enable" : false }, "dataplace_id" : 42, "ingestion_mode" : { "mode" : "Drop & Re-create", "enable" : true }, "enable_cache" : { "enable" : false }, "ingest_using_query" : { "enable" : false, "sql_query" : "" }, "schema_id" : 453, "new_table_name" : "", "table_partitions" : [] }, "advanced_option_flags" : { "columns_options" : false, "CDC" : false, "sort_by_columns" : false, "incremental_load" : false, "parallel_ingestion" : false, "remove_duplicates" : false, "virtual_column" : false, "table_id" : 37234, "reorder_columns" : false, "table_name" : "aaaa", "parallel_hash_ingestion" : false, "dataplace_id" : 42, "modified_columns" : false, "ingestion_mode" : true, "enable_cache" : false, "ingest_using_query" : false, "schema_id" : 453, "new_table_name" : false, "excluded_column_ids" : false, "table_partitions" : false } }, "valid_from_ts" : "2023-11-15 09:31:16.466337", "cru_by" : "Venkata Yeedi", "object_id" : 37234 } ], "check_compute_engine_validity" : [ { "is_valid_compute_engine" : true } ], "get_non_partition_cols" : [ { "is_virtual" : false, "data_precision" : "0", "destination_datatype_name" : "string", "is_auditcol" : false, "data_length" : "255", "column_name" : "entity_id", "source_field_name" : "entity_id", "field_name" : "entity_id", "column_id" : "956158", "source_datatype_name" : "varchar", "is_partitioned_col" : false, "data_scale" : "0", "ingested_colorder" : 1 }, { "is_virtual" : false, "data_precision" : "0", "destination_datatype_name" : "string", "is_auditcol" : false, "data_length" : "255", "column_name" : "entity_type", "source_field_name" : "entity_type", "field_name" : "entity_type", "column_id" : "956159", "source_datatype_name" : "varchar", "is_partitioned_col" : false, "data_scale" : "0", "ingested_colorder" : 2 } ], "get_partition_cols" : [], "list_of_maps_of_incremental_columns" : [ { "?column?" : 1 } ], "spark_script_inputs" : [ { "ssh_username" : "null", "ssh_host" : "null", "loggroupname" : null, "kerberos" : null, "cloud_watch" : null, "compute_engine_info" : "ewoiY2x1c3Rlcl9pZCI6IjA5MjItMDAzMTM4LW9ybjlyMHRlIiwic3BhcmtfdmVyc2lvbl92YWx1ZSI6IjNfMSIsInNjYWxhX3ZlcnNpb25fdmFsdWUiOiIyXzEyIiwiY3JlZGVudGlhbHNfZmlsZXBhdGgiOiIiLCJjbHVzdGVyX2xpYnJhcnlfcGF0aCI6Ii9kYmZzL3RtcCIsInNwYXJrX3ZlcnNpb24iOiIzLjEiLCJzY2FsYV92ZXJzaW9uIjoiMi4xMiIKfQ==", "private_key_path" : "\/dbfs\/tmp\/dev-v3-1-2-0\/nabu\/17000664381264241\/0\/privateKey", "b64_external_jars_map" : null, "cluster_id" : "0922-003138-orn9r0te", "engine_sub_type" : "azure databricks", "spark_location" : "null", "dataproc_cluster" : "null", "cluster_library_path" : "\/dbfs\/tmp", "data_movement_name" : "ss_compass_adb_validation", "dataproc_project" : "null", "engine_path" : "azure_databricks", "is_bucket_encrypted" : null, "execution_role" : null, "cluster_ui" : null, "s3_bucket_path" : null, "rest_url" : null, "s3logs" : null, "cloud_type" : "null", "release_label" : null, "spark_version" : "3.1", "scala_version" : "2.12", "region" : "null" } ], "column_metadata_output" : [ { "is_virtual" : false, "data_precision" : 0, "is_nullable" : false, "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "table_id" : 37234, "is_precision_scale" : true, "table_name" : "aaaa", "intermediate_datatype_name" : "string", "is_mysql" : false, "is_source_hive" : false, "is_partitioned_col" : false, "user_text" : null, "field_name_replaced" : "entity_id", "is_long_col_name" : false, "is_oracle_destination" : false, "data_length" : 255, "destination_datatype_name" : "string", "column_name" : "entity_id", "source_type" : "sql_server", "schema_name" : "acuity-develop", "is_source_casting_enabled" : false, "is_varchar" : false, "field_name" : "entity_id", "column_id" : 956158, "source_cast_type" : "AsIs", "ordinal_position" : 1, "source_datatype_name" : "varchar", "is_cdc_col" : false, "data_scale" : 0, "replaced_column_name" : "entity_id", "data_type" : "varchar", "is_bigquery" : false, "is_precision" : true, "is_redshift_relational_destination" : false, "source_stg_function" : "AsIs", "istimezone" : false }, { "is_virtual" : false, "data_precision" : 0, "is_nullable" : false, "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "table_id" : 37234, "is_precision_scale" : true, "table_name" : "aaaa", "intermediate_datatype_name" : "string", "is_mysql" : false, "is_source_hive" : false, "is_partitioned_col" : false, "user_text" : null, "field_name_replaced" : "entity_type", "is_long_col_name" : false, "is_oracle_destination" : false, "data_length" : 255, "destination_datatype_name" : "string", "column_name" : "entity_type", "source_type" : "sql_server", "schema_name" : "acuity-develop", "is_source_casting_enabled" : false, "is_varchar" : false, "field_name" : "entity_type", "column_id" : 956159, "source_cast_type" : "AsIs", "ordinal_position" : 2, "source_datatype_name" : "varchar", "is_cdc_col" : false, "data_scale" : 0, "replaced_column_name" : "entity_type", "data_type" : "varchar", "is_bigquery" : false, "is_precision" : true, "is_redshift_relational_destination" : false, "source_stg_function" : "AsIs", "istimezone" : false } ], "updated_wherecondition_replaced_with_default_and_max_values" : [ { "?column?" : 1 } ], "cdc_schema_drift_new_table" : [ { "drift_new_table" : false } ], "emr_input_json" : "ewogICJjbHVzdGVyX2lkIjogIjA5MjItMDAzMTM4LW9ybjlyMHRlIiwKICAiY2x1c3Rlcl9yZWdpb24iOiAibnVsbCIsCiAgImNvbXB1dGVfZW5nX2NyZWRzX2pzb24iOiAiZXdvZ0lDSmpjbVZrWlc1MGFXRnNYMmxrSWpvZ0lqUXhJaXdLSUNBaVkzSmxaR1Z1ZEdsaGJGOTBlWEJsWDJsa0lqb2dJakUxSWl3S0lDQWlZM0psWkdWdWRHbGhiRjkwZVhCbElqb2dJa1pwYkdVZ1EyOXVkR1Z1ZENJc0NpQWdJblJ2YTJWdUlqb2dJbU0yT1RVd05UZ3lZVEV5WWpVMU9HRmlOalE0WTJSaU56SXdNRGd4TnpOaU1tVTROREk0Wm1JMU5XUmhZV1EzTkRBeE5USXlOVFk1TVdWbFl6YzRaV1UzWWpWak5HVXpORE14TW1SbFpEY3dZV1UxWlRkbFpUUTRNMkkzWkRkbFlUQmpNak5sTWpSbE5EVTRaV1F4WmpVMFpHRXpZMk5rTjJSaVkyWmxPRGN3WVRZeFpUVmpPV00xTURnM1pUZG1ZalprWXpFMllqWm1PR1kxWlRSaVpXUmxOR013WlRBellqTmtZalpoWm1FM1lqY3lPV05pT1dKallUZ3hNRE5qWW1VMFlqRmlZMlF5WW1NMVlqTXlZekkwT0RJM1ptUm1PVEZqT0dNeE1XTm1NelppWmpVeE56RmhPVGsyTW1NeFkyRTFOR1k0WldNNE5ESXdOamRoT0RRNFlqa3lNMk0yT1dReU9UbGpObUkzTlRJMFl6QTVOVFF5T1RNd05EQXpNRGxoTVdZNFptUXpPV1kzT0RKa01XSmtPRFkwTTJZek1tRTJOV1poTXpVM01EVTJaV0prWmpCa05UUTVaVEl3WmpCbU1XRXdOVFpsT0RFeU5qTTRNak0wWVRSbU5UVmxNRFU1TjJZd05tRmxOMlkwTnpBd05qUTFZekJtTW1RNE56bGhNREprTlRVeU5HVmhNak0wWXpJd1pEbGxaV1kwTm1ReE5XWmxaR0poTldKbU9UVmxObUppT0RNd1ptRmpaR05oWVdVeE56QTJabU5oTmpFNE1HSmtZakF3TXpWaE9UTmxNalJrTlRjMU5HWTNaREptT0dNek16VTRZbUpoWW1OaU5XTTVaakprWkdKaE1HRmhPVGs0WTJZNU9XTmtNVGhqWXpsbE9URTRZekJqT1Rkak9UZ3haV1psWXpObFptSTNNbUkxWTJJMU5UY3dNR05pTVdVNE1qazVNekEzWWpJNE9HRTNPRFJpT0RBMllqZzBPVE16TmpjMU5EUmtaVGs1TnpNNVpqSTBZVGsyTkRVMFpXVTNNVGt5TVRCbFltUXlOek5sTXpRek5tRTBNalU0TkRJNE1HRXlNekEyTURsak0yRTFObUkzWkdVMk5tRmhZV1JrTkdWbE1EWTFOMlEwTlRjMVltSTJPVEl3TURFeVptSm1aV1JpTmpaaFpqSTBOR1ExTVRrNU1qVm1Zek5sTkRSaFpqSm1OR0poTmpjMFpHTXpNMkpqTW1WbE5HUmlNbVkwWVdabU0yVTVaV0prTkdWaE5qVmhNVFkzTm1Ga1lXTTRaalJoTURZME56bGxPR0UwTlRRM1pXVmxPR1UwWlRKak16bGlNREUxWW1RM1pqZ3hOR016T0Roak1EVTFNV1F6WmpJeVlXWmtNVEl4WW1SbVkyVm1PVFk1WTJRM01XUTJZamRpTXpVd1ltVXhOell4WkRVNVlqWTFNRE15WTJOa1ltUmhOekU0TmpnMk5qQTFZV0U0WmpRM05UQm1ZekkzTWpnMU9UTmtPVEprT1dGa1pqVm1PRFJsWkRVellUQTNPV1EyTURsa01EYzJNbVExTkdRM01ESTBOV1ppTW1WbU1qSTBPVE0xTnprM09HSXpOREl5TUdFeFl6aGpORFV6TWpKbFpqUmtaV1JoWXpFeE5HRTRZemsyWVRVMU9XUXpZV1ZqTXpKbU0yVTJNVE5tWVRobFpXRm1aakF5T0dFNE16ZGlZakV5WVdJd1pXTTJNalUwTURFNE1UQTJZelkxTkdWallqYzRNMlEwWldRek16TTVNR1JqTmpoaFpEZ3pZbVU0WldJNE9HVXpZamN4TkdNME1EVXpNakl3T1RrME1qTTNOalk1TURrek1HWTNaRGMwT0dVeFlUUmlNVGszTkRrME5qWXpOVEE1T1ROaU1tVTFZalF5WkdJME5USXlZbU5oTVROaE5tRTVZelZrTWpZek16ZzBPR1JtT0RFelpETXdOemRsTjJKaE56Z3dOVEk0T1dabE1EUTJZalV3TURreE9UazFaRFEyWXpBM1lUQmpPREV6TmpZMk56RmlOelF4TlRKaU5XSXpaamN3WW1NNElpd0tJQ0FpWTNKbFpHVnVkR2xoYkY5bGJtUndiMmx1ZEY5MWNtd2lPaUFpYUhSMGNEb3ZMMlJsZGkxa2FHRXVhSFZ0WVc1aExtTnZiVG80T0RnNUwyWnBjbVZ6YUc5MGN5OWpjbVZrWlc1MGFXRnNjMFpsZEdOb1YyVmlVMlZ5ZG1salpTSXNDaUFnSW1acGJHVmZjR0YwYUNJNklDSXhOVFk0WHpJMk1WOHhOekF3TURZMk5ETTRNREl6T1RrMU1pSXNDaUFnSW1OeVpXUmxiblJwWVd4ZlptbHNaVjl3WVhSMFpYSnVJaUE2SUNJME1WOHhOams1TXpReU5UYzFJZ3A5IiwKICAiczNfcGF0aCI6ICIiLAogICJiNjRfaW5wdXRfanNvbiI6ICJld29pY0hKdlkyVnpjMGxrSWpveE56QXdNRFkyTkRNNE1USTJOREkwTVN3S0ltUmhkR0Z3YkdGalpVbGtJam8wTWl3S0luUmhZbXhsU1dRaU9qTTNNak0wTEFvaVpHRjBZVzF2ZG1WdFpXNTBTV1FpT2pJMk1Td0tJbXB2WWxOamFHVmtkV3hsWkZWelpYSkpaQ0k2SWsxaGJtRnpkMmx1YVNCRGFHbHVkR2hoYkdGd2RXUnBJaXdLSW1wdllsTmphR1ZrZFd4bFNXUWlPakUxTmpnc0NpSmlZWFJqYUVsa0lqb3hOekF3TURZMk5ETTRNREl6T1RrMU1pd0tJbXhoYzNSU2RXNVVhVzFsYzNSaGJYQWlPaUl5TURJekxURXhMVEEzSURFeU9qUXlPakF3TGpnMk16WTFJaXdLSW5KbGRISjVUblZ0SWpvZ0lqQWlDbjA9IiwKICAiZXh0cmFfY29uZmlnIjogImV3b2laWGgwY21GRGIyNW1hV2ROWVhBaU9pQjdJbk53WVhKckxtNWhZblV1Wm1WMFkyaGZjMmw2WlNJNklDSXhNREF3TUNJc0lDSnpjR0Z5YXk1dVlXSjFMbU52YlhCMWRHVmZaVzVuYVc1bElqb2dJbUY2ZFhKbFgyUmhkR0ZpY21samEzTWlMQ0FpYzNCaGNtc3VibUZpZFM1emIyeHlYMkpoZEdOb1gzTnBlbVVpT2lBaU1UQXdNREFpTENBaWMzQmhjbXN1Ym1GaWRTNWhjSEJzYVdOaGRHbHZibDl1WVcxbElqb2dJbTVoWW5VdGMzQmhjbXRpYjNRdGFXNW5aWE4wYVc5dUlpd2dJbk53WVhKckxtUnlhWFpsY2k1dVlXSjFYM0J5YVhaaGRHVkxaWGtpT2lBaUwyUmlabk12ZEcxd0wyUmxkaTEyTXkweExUSXRNQzl1WVdKMUx6RTNNREF3TmpZME16Z3hNalkwTWpReEx6QXZjSEpwZG1GMFpVdGxlU0lzSUNKemNHRnlheTVrY21sMlpYSXVjMjkxY21ObFgyRjNjMTlsYm1SUWIybHVkQ0k2SUNKek15NWhiV0Y2YjI1aGQzTXVZMjl0SWl3Z0luTndZWEpyTG1SeWFYWmxjaTUwWVhKblpYUmZZWGR6WDJWdVpGQnZhVzUwSWpvZ0luTXpMbUZ0WVhwdmJtRjNjeTVqYjIwaUxDQWljM0JoY21zdWJtRmlkUzVqYjIxd2RYUmxYMlZ1WjJsdVpWOXNhV0p6WDNCaGRHZ2lPaUFpTDJSaVpuTXZkRzF3TDJSbGRpMTJNeTB4TFRJdE1DOXVZV0oxTHpFM01EQXdOalkwTXpneE1qWTBNalF4THpBdllYQndiR2xqWVhScGIyNHVZMjl1WmlKOUNuMD0iLAogICJiYXRjaF9pZCI6IDE3MDAwNjY0MzgwMjM5OTUyLAogICJyZXRyeV9udW0iOiAiMCIsCiAgInNwYXJrX2NvbmZpZ3MiOiAiZXdvZ0lDQWdJbk52YkhKZlltRjBZMmhmYzJsNlpTSTZJakV3TURBd0lpd2ljR0Z5WVd4c1pXeGZkR2h5WldGa2N5STZJakV3SWl3aVptVjBZMmhmYzJsNlpTSTZJakV3TURBd0lnb2dJQ0FnZlE9PSIsCiAgImlzX2J1Y2tldF9lbmNyeXB0ZWQiOiAiIiwKICAiYjY0X2V4dGVybmFsX2phcnNfbWFwIiA6ICIiCn0=", "base64_rsa_compressed_encrypted_creds" : "rO0ABXVyAAJbQqzzF\/gGCFTgAgAAeHAAAAEAVy+9AQow7FXoD3z0ooJjPC+HrI5N52yIITSaL9yRvE3fFebDEBpUbP1qvJhLwLTo+6fqeYvorPcJGHVOzB+Iqo+4m\/AMDDiIgWaXz5hy8QfjV7PwWwarCUa5mj+NtOgTKwyw4WNnFcphnkE34tLJad1s2vF1qQHUgOCtysAB0fD2JA5BeEsUprhbts03GzeY8OCgy0kqiYHEoKRaS8cBWUQ81oeyo7fW8mdSsKVpY8wi3b2npBin83TSMAUXtFbeCjOOr7HC\/3DMYHQUM5xaZCNH7zeYWSMgAlTn1c+y42\/1lX0UE1c2qtplYC8Ky+yYikmWcrfsLOy5xJEB7L+KRHVxAH4AAAAAA5BHFNPNX+74skXzppe3RfD\/xrCll8g7yP06oIux1cYJaH6Z7Tz988miRj5z+4nzKfiAIw+MdVKnOwsvawBMOpAR\/WDGsqWEKC7EsNrjsBFm1HQ5tPFHcClV0HYlKZR5ejgDCOvBGBZ\/tQsIzKYl+dX92uH4Lgcbr9ns5Yi5CM3R0+q\/Z+5xzabCGcz54a7EjH1zT9y0wYp17VgEW9nccBtkkCmXJgDD1tijNxwK7I61N36cNTaMdQR71U1npaMyzuT0dQ6kgrputCx75rpIMsDwEkYi9ay\/LBgamfQiKPa7SDIzBjv5OgCrfU15BWr0OMRFAbu4rLF8s8PO9BrKQrA3JOsJwl8dQ47dhhJsDJgS8QAndbeJgjkT0Nsa18RE9pZ0HVVpSPhJR4aJvRlyFas6EOxbgVcPIrOgb9ahXBrFPblowqfD1iJ+z1brU00RxP\/cbjwyZOf6WJvFUzQqzqVEUJyJC4np9grL7zrPsMO8lseQ45QZQ7uhSsDztsV3OrzFK+mqSUtrVQzmkABaHyutr4dz3mPa9QtcZCX\/EshdwWwqf7+8WnuSwT40xMECKEL06BjuBZRtAPMhxX8Zo+eEA2mQmk2V2raRX0bluYFVsz2vnxcH1ntp9k\/YgPZeGNWpUI\/KQ\/CbUjbX7NX1FV+63fmJT2SRWj32vCOBu4K8405WNQ82YRJmP0k\/vMTeq\/XfF0tguDEBT31ra0tTYcKCUqIZ0+wTBakLiFVEM1xj7A\/u+7n7rsQkrKs31eNRo+2C8klBPjv6v\/Ju0F9JbNJtqUiFOxlUq\/wNRSm68xH6ZOFDG51BcZfxlkWvJOdvYoTVlylv67hH3pZgFK2GhXwl9Bhw6+eljQ+fP6eAncyFejNtvAuWGl5xf3ZgtPc\/15c8rj2+DPRqcd+rv6M7oftuvIqGbs\/gA1vDEbVVTT6J0TxEiEMpC0iYHmyAremaLDkBKWIns10eBeegTF1\/bZ7yNWcDS6tX\/0ensUmI5hLTA1tKsul7NuEjbU88KabhKtWknSmMnDix+feQ+D3yMuNIZroXqOeyDW+VkOpMNJNfrv5lPlVoiklns4VyGc\/XasVA63bVnUxRtgVNwO1ZyyfAIe7F46dIakC1HAHHTkmPwSJe965Ty+pACqPLVvEtrHJtETL5CKW2spRW3SnmhGLdr4R01j\/XFamcyFWvWmeSfwXG25kzHBrJN+5mGxFPFto=", "target_schemadrift_details" : [ { "destination_table_name" : "aaaa", "target_schemadrift_backup_table" : false, "target_schemadrift_ignore_table" : false, "backup_table_name" : "aaaa", "target_schemadrift_new_table" : false, "schema_drifted" : false } ], "generate_file_content_json" : "ewogICJjcmVkZW50aWFsX2lkIjogIjQxIiwKICAiY3JlZGVudGlhbF90eXBlX2lkIjogIjE1IiwKICAiY3JlZGVudGlhbF90eXBlIjogIkZpbGUgQ29udGVudCIsCiAgInRva2VuIjogImM2OTUwNTgyYTEyYjU1OGFiNjQ4Y2RiNzIwMDgxNzNiMmU4NDI4ZmI1NWRhYWQ3NDAxNTIyNTY5MWVlYzc4ZWU3YjVjNGUzNDMxMmRlZDcwYWU1ZTdlZTQ4M2I3ZDdlYTBjMjNlMjRlNDU4ZWQxZjU0ZGEzY2NkN2RiY2ZlODcwYTYxZTVjOWM1MDg3ZTdmYjZkYzE2YjZmOGY1ZTRiZWRlNGMwZTAzYjNkYjZhZmE3YjcyOWNiOWJjYTgxMDNjYmU0YjFiY2QyYmM1YjMyYzI0ODI3ZmRmOTFjOGMxMWNmMzZiZjUxNzFhOTk2MmMxY2E1NGY4ZWM4NDIwNjdhODQ4YjkyM2M2OWQyOTljNmI3NTI0YzA5NTQyOTMwNDAzMDlhMWY4ZmQzOWY3ODJkMWJkODY0M2YzMmE2NWZhMzU3MDU2ZWJkZjBkNTQ5ZTIwZjBmMWEwNTZlODEyNjM4MjM0YTRmNTVlMDU5N2YwNmFlN2Y0NzAwNjQ1YzBmMmQ4NzlhMDJkNTUyNGVhMjM0YzIwZDllZWY0NmQxNWZlZGJhNWJmOTVlNmJiODMwZmFjZGNhYWUxNzA2ZmNhNjE4MGJkYjAwMzVhOTNlMjRkNTc1NGY3ZDJmOGMzMzU4YmJhYmNiNWM5ZjJkZGJhMGFhOTk4Y2Y5OWNkMThjYzllOTE4YzBjOTdjOTgxZWZlYzNlZmI3MmI1Y2I1NTcwMGNiMWU4Mjk5MzA3YjI4OGE3ODRiODA2Yjg0OTMzNjc1NDRkZTk5NzM5ZjI0YTk2NDU0ZWU3MTkyMTBlYmQyNzNlMzQzNmE0MjU4NDI4MGEyMzA2MDljM2E1NmI3ZGU2NmFhYWRkNGVlMDY1N2Q0NTc1YmI2OTIwMDEyZmJmZWRiNjZhZjI0NGQ1MTk5MjVmYzNlNDRhZjJmNGJhNjc0ZGMzM2JjMmVlNGRiMmY0YWZmM2U5ZWJkNGVhNjVhMTY3NmFkYWM4ZjRhMDY0NzllOGE0NTQ3ZWVlOGU0ZTJjMzliMDE1YmQ3ZjgxNGMzODhjMDU1MWQzZjIyYWZkMTIxYmRmY2VmOTY5Y2Q3MWQ2YjdiMzUwYmUxNzYxZDU5YjY1MDMyY2NkYmRhNzE4Njg2NjA1YWE4ZjQ3NTBmYzI3Mjg1OTNkOTJkOWFkZjVmODRlZDUzYTA3OWQ2MDlkMDc2MmQ1NGQ3MDI0NWZiMmVmMjI0OTM1Nzk3OGIzNDIyMGExYzhjNDUzMjJlZjRkZWRhYzExNGE4Yzk2YTU1OWQzYWVjMzJmM2U2MTNmYThlZWFmZjAyOGE4MzdiYjEyYWIwZWM2MjU0MDE4MTA2YzY1NGVjYjc4M2Q0ZWQzMzM5MGRjNjhhZDgzYmU4ZWI4OGUzYjcxNGM0MDUzMjIwOTk0MjM3NjY5MDkzMGY3ZDc0OGUxYTRiMTk3NDk0NjYzNTA5OTNiMmU1YjQyZGI0NTIyYmNhMTNhNmE5YzVkMjYzMzg0OGRmODEzZDMwNzdlN2JhNzgwNTI4OWZlMDQ2YjUwMDkxOTk1ZDQ2YzA3YTBjODEzNjY2NzFiNzQxNTJiNWIzZjcwYmM4IiwKICAiY3JlZGVudGlhbF9lbmRwb2ludF91cmwiOiAiaHR0cDovL2Rldi1kaGEuaHVtYW5hLmNvbTo4ODg5L2ZpcmVzaG90cy9jcmVkZW50aWFsc0ZldGNoV2ViU2VydmljZSIsCiAgImZpbGVfcGF0aCI6ICIxNTY4XzI2MV8xNzAwMDY2NDM4MDIzOTk1MiIsCiAgImNyZWRlbnRpYWxfZmlsZV9wYXR0ZXJuIiA6ICI0MV8xNjk5MzQyNTc1Igp9", "get_view_info" : [ { "id" : 1 } ], "get_already_ingested_condition" : [ { "already_ingested" : true } ], "sort_by_columns_data" : [], "fetching_credential_inputs" : [ { "credential_type" : "File Content", "metastore_credential_type_id" : null, "credential_type_id" : 15, "metastore_credential_id" : null, "credential_pattern" : "41_1699342575", "spark_credential_id" : 41 } ], "get_varchar_columns" : [], "generate_spark_configs_json" : "ewogICAgInNvbHJfYmF0Y2hfc2l6ZSI6IjEwMDAwIiwicGFyYWxsZWxfdGhyZWFkcyI6IjEwIiwiZmV0Y2hfc2l6ZSI6IjEwMDAwIgogICAgfQ==" }, "batch_id" : "17000664380239952", "template_execution_type" : "single", "query_type" : "json", "currentBotMessageMap" : { "parent_id" : "4e8bcd3a-7fb0-4043-aba4-6d226c053fa0", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "message_context" : "ingestion_deciding", "message_id" : "9ef48220-268b-40d5-8cd9-8f49fbd8f89c", "task_retry_intervals_secs" : [], "bot_id" : "84c43ca6-2712-4cd9-b2d9-b0fe3f69b476", "message_topic" : "nabu_2_jdbc", "tags" : { "process_id" : 17000664381264241, "batch_id" : 17000664380239952, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "tags" : [ "AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot", "KoshBot", "DBOpsBot" ], "initial_ts" : 1700066438126, "batch_name" : "Ingestion_20231115", "environment" : "modak", "job_schedule_id" : 1568, "data_movement_id" : 261, "last_run_timestamp" : "2023-11-07 12:42:00.86365", "retry_attempt" : 0, "task_dependency" : true, "ignore_job_termination" : false } } }, "template_execution_type" : "single", "query_type" : "json", "currentBotMessageMap" : { "parent_id" : "9ef48220-268b-40d5-8cd9-8f49fbd8f89c", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "message_context" : "spark_buffer_msg", "message_id" : "e16c0da0-abcf-4b8d-a952-7d29310a9e06", "task_retry_intervals_secs" : [], "bot_id" : "15b7f47d-8271-437b-8b5b-cc11873475de", "message_topic" : "nabu_2_jdbc", "tags" : { "process_id" : 17000664381264241, "batch_id" : 17000664380239952, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "tags" : [ "AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot", "KoshBot", "DBOpsBot", "DBOpsBot" ], "initial_ts" : 1700066438126, "batch_name" : "Ingestion_20231115", "environment" : "modak", "job_schedule_id" : 1568, "data_movement_id" : 261, "last_run_timestamp" : "2023-11-07 12:42:00.86365", "retry_attempt" : 0, "task_dependency" : true, "ignore_job_termination" : false } } }, "retry_attempt": 0, "flow_number": 1, "data_movement_id": 261, "where_condition": "37234", "process_id": 17000664381264241, "job_scheduled_user_id": "Manaswini Chinthalapudi", "batch_id": 17000664380239952, "last_run_timestamp": "2023-11-07 12:42:00.86365", "schema_drift_flag": false, "ssh_host": "null", "ssh_username": "null", "engine_path": "azure_databricks", "compute_engine_info": "ewoiY2x1c3Rlcl9pZCI6IjA5MjItMDAzMTM4LW9ybjlyMHRlIiwic3BhcmtfdmVyc2lvbl92YWx1ZSI6IjNfMSIsInNjYWxhX3ZlcnNpb25fdmFsdWUiOiIyXzEyIiwiY3JlZGVudGlhbHNfZmlsZXBhdGgiOiIiLCJjbHVzdGVyX2xpYnJhcnlfcGF0aCI6Ii9kYmZzL3RtcCIsInNwYXJrX3ZlcnNpb24iOiIzLjEiLCJzY2FsYV92ZXJzaW9uIjoiMi4xMiIKfQ==", "spark_location": "null", "template_group": "templates/artifact_ingestion/ingestion_templates.stg", "destination": "adls_gen2", "spark_application_template": "insert_spark_application_details", "source_endpoint": "s3.amazonaws.com", "destination_endpoint": "s3.amazonaws.com", "is_create_table": false, "spark_credential_info": "ewogICJjcmVkZW50aWFsX2lkIjogIjQxIiwKICAiY3JlZGVudGlhbF90eXBlX2lkIjogIjE1IiwKICAiY3JlZGVudGlhbF90eXBlIjogIkZpbGUgQ29udGVudCIsCiAgInRva2VuIjogImM2OTUwNTgyYTEyYjU1OGFiNjQ4Y2RiNzIwMDgxNzNiMmU4NDI4ZmI1NWRhYWQ3NDAxNTIyNTY5MWVlYzc4ZWU3YjVjNGUzNDMxMmRlZDcwYWU1ZTdlZTQ4M2I3ZDdlYTBjMjNlMjRlNDU4ZWQxZjU0ZGEzY2NkN2RiY2ZlODcwYTYxZTVjOWM1MDg3ZTdmYjZkYzE2YjZmOGY1ZTRiZWRlNGMwZTAzYjNkYjZhZmE3YjcyOWNiOWJjYTgxMDNjYmU0YjFiY2QyYmM1YjMyYzI0ODI3ZmRmOTFjOGMxMWNmMzZiZjUxNzFhOTk2MmMxY2E1NGY4ZWM4NDIwNjdhODQ4YjkyM2M2OWQyOTljNmI3NTI0YzA5NTQyOTMwNDAzMDlhMWY4ZmQzOWY3ODJkMWJkODY0M2YzMmE2NWZhMzU3MDU2ZWJkZjBkNTQ5ZTIwZjBmMWEwNTZlODEyNjM4MjM0YTRmNTVlMDU5N2YwNmFlN2Y0NzAwNjQ1YzBmMmQ4NzlhMDJkNTUyNGVhMjM0YzIwZDllZWY0NmQxNWZlZGJhNWJmOTVlNmJiODMwZmFjZGNhYWUxNzA2ZmNhNjE4MGJkYjAwMzVhOTNlMjRkNTc1NGY3ZDJmOGMzMzU4YmJhYmNiNWM5ZjJkZGJhMGFhOTk4Y2Y5OWNkMThjYzllOTE4YzBjOTdjOTgxZWZlYzNlZmI3MmI1Y2I1NTcwMGNiMWU4Mjk5MzA3YjI4OGE3ODRiODA2Yjg0OTMzNjc1NDRkZTk5NzM5ZjI0YTk2NDU0ZWU3MTkyMTBlYmQyNzNlMzQzNmE0MjU4NDI4MGEyMzA2MDljM2E1NmI3ZGU2NmFhYWRkNGVlMDY1N2Q0NTc1YmI2OTIwMDEyZmJmZWRiNjZhZjI0NGQ1MTk5MjVmYzNlNDRhZjJmNGJhNjc0ZGMzM2JjMmVlNGRiMmY0YWZmM2U5ZWJkNGVhNjVhMTY3NmFkYWM4ZjRhMDY0NzllOGE0NTQ3ZWVlOGU0ZTJjMzliMDE1YmQ3ZjgxNGMzODhjMDU1MWQzZjIyYWZkMTIxYmRmY2VmOTY5Y2Q3MWQ2YjdiMzUwYmUxNzYxZDU5YjY1MDMyY2NkYmRhNzE4Njg2NjA1YWE4ZjQ3NTBmYzI3Mjg1OTNkOTJkOWFkZjVmODRlZDUzYTA3OWQ2MDlkMDc2MmQ1NGQ3MDI0NWZiMmVmMjI0OTM1Nzk3OGIzNDIyMGExYzhjNDUzMjJlZjRkZWRhYzExNGE4Yzk2YTU1OWQzYWVjMzJmM2U2MTNmYThlZWFmZjAyOGE4MzdiYjEyYWIwZWM2MjU0MDE4MTA2YzY1NGVjYjc4M2Q0ZWQzMzM5MGRjNjhhZDgzYmU4ZWI4OGUzYjcxNGM0MDUzMjIwOTk0MjM3NjY5MDkzMGY3ZDc0OGUxYTRiMTk3NDk0NjYzNTA5OTNiMmU1YjQyZGI0NTIyYmNhMTNhNmE5YzVkMjYzMzg0OGRmODEzZDMwNzdlN2JhNzgwNTI4OWZlMDQ2YjUwMDkxOTk1ZDQ2YzA3YTBjODEzNjY2NzFiNzQxNTJiNWIzZjcwYmM4IiwKICAiY3JlZGVudGlhbF9lbmRwb2ludF91cmwiOiAiaHR0cDovL2Rldi1kaGEuaHVtYW5hLmNvbTo4ODg5L2ZpcmVzaG90cy9jcmVkZW50aWFsc0ZldGNoV2ViU2VydmljZSIsCiAgImZpbGVfcGF0aCI6ICIxNTY4XzI2MV8xNzAwMDY2NDM4MDIzOTk1MiIsCiAgImNyZWRlbnRpYWxfZmlsZV9wYXR0ZXJuIiA6ICI0MV8xNjk5MzQyNTc1Igp9" }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "task_status_success_msg" } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "error_template_create_msg" } ] }, { "task_name": "run_almaren_ingestion_job_using_spark", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "pre_task_logging_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "pre_log_template" }, "app_template_details": { "template_group": "templates/artifact_ingestion/ingestion_templates.stg", "template_name": "command_to_run_almaren_ingestion" }, "input_data": { "is_valid_compute_engine":true, "data": { "batch_id" : "17000664380239952", "templateData" : { "query_input" : { "target_schemadrift_flag" : [ { "nextrun_after_targetdrift" : false } ], "input_json_for_checkpoint_status" : "ewoicHJvY2Vzc0lkIjoxNzAwMDY2NDM4MTI2NDI0MSwKImRhdGFwbGFjZUlkIjo0MiwKInRhYmxlSWQiOjM3MjM0LAoiZGF0YW1vdmVtZW50SWQiOjI2MSwKImpvYlNjaGVkdWxlZFVzZXJJZCI6Ik1hbmFzd2luaSBDaGludGhhbGFwdWRpIiwKImpvYlNjaGVkdWxlSWQiOjE1NjgsCiJiYXRjaElkIjoxNzAwMDY2NDM4MDIzOTk1MiwKImxhc3RSdW5UaW1lc3RhbXAiOiIyMDIzLTExLTA3IDEyOjQyOjAwLjg2MzY1IiwKInJldHJ5TnVtIjogIjAiCn0=", "get_cdc_last_run_table" : [ { "prev_target_path" : null, "cdc_first" : true, "relative_path" : "\/261\/42\/development-db\/acuity-develop\/aaaa.parquet", "target_path" : "abfss:\/\/dataproc@idea15pisplznonprodsa2.dfs.core.windows.net\/261\/42\/development-db\/acuity-develop\/aaaa.parquet" } ], "get_cdc_type" : [ { "cdc_applied" : false, "is_primary" : false, "cdctype2" : false, "temp_path" : "17000664381264241_aaaa" } ], "generate_yeedu_metastore_credential" : "ewogICJjcmVkZW50aWFsX2lkIjogIiIsCiAgImNyZWRlbnRpYWxfdHlwZV9pZCI6ICIiLAogICJ0b2tlbiI6ICJjNjk1MDU4MmExMmI1NThhYjY0OGNkYjcyMDA4MTczYjJlODQyOGZiNTVkYWFkNzQwMTUyMjU2OTFlZWM3OGVlN2I1YzRlMzQzMTJkZWQ3MGFlNWU3ZWU0ODNiN2Q3ZWEwYzIzZTI0ZTQ1OGVkMWY1NGRhM2NjZDdkYmNmZTg3MGE2MWU1YzljNTA4N2U3ZmI2ZGMxNmI2ZjhmNWU0YmVkZTRjMGUwM2IzZGI2YWZhN2I3MjljYjliY2E4MTAzY2JlNGIxYmNkMmJjNWIzMmMyNDgyN2ZkZjkxYzhjMTFjZjM2YmY1MTcxYTk5NjJjMWNhNTRmOGVjODQyMDY3YTg0OGI5MjNjNjlkMjk5YzZiNzUyNGMwOTU0MjkzMDQwMzA5YTFmOGZkMzlmNzgyZDFiZDg2NDNmMzJhNjVmYTM1NzA1NmViZGYwZDU0OWUyMGYwZjFhMDU2ZTgxMjYzODIzNGE0ZjU1ZTA1OTdmMDZhZTdmNDcwMDY0NWMwZjJkODc5YTAyZDU1MjRlYTIzNGMyMGQ5ZWVmNDZkMTVmZWRiYTViZjk1ZTZiYjgzMGZhY2RjYWFlMTcwNmZjYTYxODBiZGIwMDM1YTkzZTI0ZDU3NTRmN2QyZjhjMzM1OGJiYWJjYjVjOWYyZGRiYTBhYTk5OGNmOTljZDE4Y2M5ZTkxOGMwYzk3Yzk4MWVmZWMzZWZiNzJiNWNiNTU3MDBjYjFlODI5OTMwN2IyODhhNzg0YjgwNmI4NDkzMzY3NTQ0ZGU5OTczOWYyNGE5NjQ1NGVlNzE5MjEwZWJkMjczZTM0MzZhNDI1ODQyODBhMjMwNjA5YzNhNTZiN2RlNjZhYWFkZDRlZTA2NTdkNDU3NWJiNjkyMDAxMmZiZmVkYjY2YWYyNDRkNTE5OTI1ZmMzZTQ0YWYyZjRiYTY3NGRjMzNiYzJlZTRkYjJmNGFmZjNlOWViZDRlYTY1YTE2NzZhZGFjOGY0YTA2NDc5ZThhNDU0N2VlZThlNGUyYzM5YjAxNWJkN2Y4MTRjMzg4YzA1NTFkM2YyMmFmZDEyMWJkZmNlZjk2OWNkNzFkNmI3YjM1MGJlMTc2MWQ1OWI2NTAzMmNjZGJkYTcxODY4NjYwNWFhOGY0NzUwZmMyNzI4NTkzZDkyZDlhZGY1Zjg0ZWQ1M2EwNzlkNjA5ZDA3NjJkNTRkNzAyNDVmYjJlZjIyNDkzNTc5NzhiMzQyMjBhMWM4YzQ1MzIyZWY0ZGVkYWMxMTRhOGM5NmE1NTlkM2FlYzMyZjNlNjEzZmE4ZWVhZmYwMjhhODM3YmIxMmFiMGVjNjI1NDAxODEwNmM2NTRlY2I3ODNkNGVkMzMzOTBkYzY4YWQ4M2JlOGViODhlM2I3MTRjNDA1MzIyMDk5NDIzNzY2OTA5MzBmN2Q3NDhlMWE0YjE5NzQ5NDY2MzUwOTkzYjJlNWI0MmRiNDUyMmJjYTEzYTZhOWM1ZDI2MzM4NDhkZjgxM2QzMDc3ZTdiYTc4MDUyODlmZTA0NmI1MDA5MTk5NWQ0NmMwN2EwYzgxMzY2NjcxYjc0MTUyYjViM2Y3MGJjOCIsCiAgImNyZWRlbnRpYWxfZW5kcG9pbnRfdXJsIjogImh0dHA6Ly9kZXYtZGhhLmh1bWFuYS5jb206ODg4OS9maXJlc2hvdHMvY3JlZGVudGlhbHNGZXRjaFdlYlNlcnZpY2UiCn0=", "table_metadata_output" : [ { "end_point" : "http:\/\/dev-dha.humana.com:8889\/fireshots\/credentialsFetchWebService", "is_filesystem_credential_type_aws" : true, "table_name" : "aaaa", "s3_bucket" : null, "path" : "", "is_lazy_mode" : false, "destination_type" : "adls_gen2", "archive_files_path" : "", "rename_table_condition" : false, "adls_gen2_directory_name" : null, "is_archive_data" : false, "destination_db" : null, "bucket_name" : null, "source_type" : "sql_server", "credential_pattern" : "2_1686574260", "is_destination_hive" : false, "estimated_rows" : 4914, "destination_file_format" : "parquet", "warehouse_name" : null, "filesystem_credential_type" : null, "is_aws_iam_attached_to_ec2_instance" : false, "is_bigquery" : false, "is_source_filetype" : false, "source_jdbc_url" : "jdbc:sqlserver:\/\/hyp-acu-development-5de0.database.windows.net:1433;database=development-db;sslProtocol=TLSv1.2;encrypt=true", "flow_number" : 1, "batch_id" : 17000664380239952, "destination_url" : null, "filesystem_credential_type_id" : null, "schema_drift_flag" : false, "is_mysql" : false, "filesystem_credential_id" : null, "destination_directory" : null, "source_credential_type_id" : 1, "destination_backup_table_name" : "aaaa", "destination_table_name" : "aaaa", "destination_dataplace_sub_component_id" : 18, "is_azure_oauth" : false, "gcs_bucket" : null, "source_directory" : null, "is_file_system_type_s3a" : false, "destination_schema_directory_id" : 3, "intermediate_type" : "parquet", "is_source_jdbc_url" : true, "is_source_spark_hive" : false, "batch_name" : "Ingestion_20231115", "source_endpoint" : "s3.amazonaws.com", "upper_case_destination_table_name" : "AAAA", "source_credential_id" : 37, "destination_credential_type_id" : 5, "adls_gen2_container" : "dataproc", "source_default_credential_exists" : false, "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDY2NDU3NzgzNDI0MCwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0OTI1OCwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2NjQ1N30.cgEzDcSlWhMY65PdNscgXY1oBYM75LZUbp00acf6_d1WRUOrXXGi5pcvwkRNDv0JIxun7nmcSCqy2CKZ38-eHnEqqAoxh2CIRwXTdBlsYYFyfkXHYapfaXinAi82pkDk0yJQOs-m-vAf1cbV4ue4Zk6bHKbJeu_j5_x8HU3PKeF0pz0lA-tpeoFRlq_tLUXqApH5t7QuTIzOSq7Aujo6yOSm_inHTBzTWxUyVaBCitbKs_j3Oq-P5c-Y5W3r9oAvDNbMASikxmdxfJBp_rI2QYHdxazW9UvVh_ZpRPwOIbi7EAe9-B6BBxAxItPBTo4M-GFi-zvZZXXYMX57edoRDA", "project" : null, "source_table_name" : "aaaa", "table_id" : 37234, "authentication_type" : "auth_token", "source_url" : null, "destination_endpoint" : "s3.amazonaws.com", "schema_id" : 453, "datamovement_engine_type" : "Spark", "relative_file_path" : "", "filesystem_credential_epoch" : null, "is_needed_partition_name_without_column_name" : false, "table_suffix" : "", "schema_name" : "acuity-develop", "is_record_process_enabled" : true, "is_default" : false, "is_jdbcmode" : false, "table_timestamp" : "", "verification_threshold" : 0.1, "pipeline_flow_timeout" : 23, "dest_default_credential_exists" : false, "process_id" : 17000664381264241, "is_destination_file" : true, "where_condition" : "37234", "source_dataplace_id" : 42, "file_system_type" : "abfss", "is_ingestion_root_path" : false, "is_source_hive" : false, "destination_oracle_jdbc_url" : null, "schema_drift_option" : "drop_create_table", "ingestion_table_format" : "", "already_ingested" : true, "destination_dataplace_id" : 5, "destination_credential_id" : 2, "file_format" : "", "create_backup_table" : null, "destination_dataplace_component_type_id" : 3, "source_jdbc_driver" : "com.microsoft.sqlserver.jdbc.SQLServerDriver", "destination_schema_name" : "dataproc", "source_db" : "development-db", "apply_transformation" : false, "target_type" : "adls_gen2", "oracle_jdbc_url" : null, "destination_schema_id" : 3, "dataplace_id" : 42, "filesystem_endpoint" : null, "is_spark_hive" : false, "destination_jdbc_driver" : null, "data_movement_id" : 261, "storage_account" : "idea15pisplznonprodsa2", "is_relative_file_path" : false, "is_create_table" : false, "is_apache_jdbc_driver" : false } ], "get_cdc_audit_cols" : [], "get_list_of_maps_of_partition_columns" : [ { "?column?" : "null" } ], "get_cdc_info" : [ { "job_id_column_name" : "process_id", "prev_job_id_column_name" : "prev_process_id", "is_sha2" : false, "add_audit_columns" : false, "end_date_column_name" : "valid_to_ts", "create_view" : false, "start_date_column_name" : "valid_from_ts", "hash_type" : "", "view_name" : "v_aaaa" } ], "get_spark_configs" : [ { "cluster_id" : null, "config_json" : { "extra_configs" : {}, "default_configs" : { "solr_batch_size" : "10000", "parallel_threads" : "10", "fetch_size" : "10000" } }, "spark_configuration_type_id" : 1, "spark_configs_json" : "{\n \"solr_batch_size\":\"10000\",\"parallel_threads\":\"10\",\"fetch_size\":\"10000\"\n }", "compute_engine_id" : 11, "extra_configs_json" : { "spark.nabu.fetch_size" : "10000", "spark.nabu.solr_batch_size" : "10000" } } ], "advanced_options_tables_flags_status" : [ { "columns_options" : false, "cdc" : null, "sort_by_columns" : false, "incremental_load" : false, "parallel_ingestion" : false, "remove_duplicates" : false, "virtual_column" : false, "reorder_columns" : false, "modified_columns" : false, "ingestion_mode" : true, "enable_cache" : false, "ingest_using_query" : false, "new_table_name" : false, "excluded_column_ids" : false, "table_partitions" : false } ], "yeedu_input_json" : "ewoiY2x1c3Rlcl9pZCI6ICIiLAoiYjY0X2lucHV0X2pzb24iOiAiZXdvaWNISnZZMlZ6YzBsa0lqb3hOekF3TURZMk5ETTRNVEkyTkRJME1Td0tJbVJoZEdGd2JHRmpaVWxrSWpvME1pd0tJblJoWW14bFNXUWlPak0zTWpNMExBb2laR0YwWVcxdmRtVnRaVzUwU1dRaU9qSTJNU3dLSW1wdllsTmphR1ZrZFd4bFpGVnpaWEpKWkNJNklrMWhibUZ6ZDJsdWFTQkRhR2x1ZEdoaGJHRndkV1JwSWl3S0ltcHZZbE5qYUdWa2RXeGxTV1FpT2pFMU5qZ3NDaUppWVhSamFFbGtJam94TnpBd01EWTJORE00TURJek9UazFNaXdLSW14aGMzUlNkVzVVYVcxbGMzUmhiWEFpT2lJeU1ESXpMVEV4TFRBM0lERXlPalF5T2pBd0xqZzJNelkxSWl3S0luSmxkSEo1VG5WdElqb2dJakFpQ24wPSIsCiJleHRyYV9jb25maWciOiAiZXdvaVpYaDBjbUZEYjI1bWFXZE5ZWEFpT2lCN0luTndZWEpyTG01aFluVXVabVYwWTJoZmMybDZaU0k2SUNJeE1EQXdNQ0lzSUNKemNHRnlheTV1WVdKMUxtTnZiWEIxZEdWZlpXNW5hVzVsSWpvZ0ltRjZkWEpsWDJSaGRHRmljbWxqYTNNaUxDQWljM0JoY21zdWJtRmlkUzV6YjJ4eVgySmhkR05vWDNOcGVtVWlPaUFpTVRBd01EQWlMQ0FpYzNCaGNtc3VibUZpZFM1aGNIQnNhV05oZEdsdmJsOXVZVzFsSWpvZ0ltNWhZblV0YzNCaGNtdGliM1F0YVc1blpYTjBhVzl1SWl3Z0luTndZWEpyTG1SeWFYWmxjaTV1WVdKMVgzQnlhWFpoZEdWTFpYa2lPaUFpTDJSaVpuTXZkRzF3TDJSbGRpMTJNeTB4TFRJdE1DOXVZV0oxTHpFM01EQXdOalkwTXpneE1qWTBNalF4THpBdmNISnBkbUYwWlV0bGVTSXNJQ0p6Y0dGeWF5NWtjbWwyWlhJdWMyOTFjbU5sWDJGM2MxOWxibVJRYjJsdWRDSTZJQ0p6TXk1aGJXRjZiMjVoZDNNdVkyOXRJaXdnSW5Od1lYSnJMbVJ5YVhabGNpNTBZWEpuWlhSZllYZHpYMlZ1WkZCdmFXNTBJam9nSW5NekxtRnRZWHB2Ym1GM2N5NWpiMjBpTENBaWMzQmhjbXN1Ym1GaWRTNWpiMjF3ZFhSbFgyVnVaMmx1WlY5c2FXSnpYM0JoZEdnaU9pQWlMMlJpWm5NdmRHMXdMMlJsZGkxMk15MHhMVEl0TUM5dVlXSjFMekUzTURBd05qWTBNemd4TWpZME1qUXhMekF2WVhCd2JHbGpZWFJwYjI0dVkyOXVaaUo5Q24wPSIsCiJjb21wdXRlX2VuZ19jcmVkc19qc29uIiA6ICJld29nSUNKamNtVmtaVzUwYVdGc1gybGtJam9nSWpReElpd0tJQ0FpWTNKbFpHVnVkR2xoYkY5MGVYQmxYMmxrSWpvZ0lqRTFJaXdLSUNBaVkzSmxaR1Z1ZEdsaGJGOTBlWEJsSWpvZ0lrWnBiR1VnUTI5dWRHVnVkQ0lzQ2lBZ0luUnZhMlZ1SWpvZ0ltTTJPVFV3TlRneVlURXlZalUxT0dGaU5qUTRZMlJpTnpJd01EZ3hOek5pTW1VNE5ESTRabUkxTldSaFlXUTNOREF4TlRJeU5UWTVNV1ZsWXpjNFpXVTNZalZqTkdVek5ETXhNbVJsWkRjd1lXVTFaVGRsWlRRNE0ySTNaRGRsWVRCak1qTmxNalJsTkRVNFpXUXhaalUwWkdFelkyTmtOMlJpWTJabE9EY3dZVFl4WlRWak9XTTFNRGczWlRkbVlqWmtZekUyWWpabU9HWTFaVFJpWldSbE5HTXdaVEF6WWpOa1lqWmhabUUzWWpjeU9XTmlPV0pqWVRneE1ETmpZbVUwWWpGaVkyUXlZbU0xWWpNeVl6STBPREkzWm1SbU9URmpPR014TVdObU16WmlaalV4TnpGaE9UazJNbU14WTJFMU5HWTRaV000TkRJd05qZGhPRFE0WWpreU0yTTJPV1F5T1Rsak5tSTNOVEkwWXpBNU5UUXlPVE13TkRBek1EbGhNV1k0Wm1Rek9XWTNPREprTVdKa09EWTBNMll6TW1FMk5XWmhNelUzTURVMlpXSmtaakJrTlRRNVpUSXdaakJtTVdFd05UWmxPREV5TmpNNE1qTTBZVFJtTlRWbE1EVTVOMll3Tm1GbE4yWTBOekF3TmpRMVl6Qm1NbVE0TnpsaE1ESmtOVFV5TkdWaE1qTTBZekl3WkRsbFpXWTBObVF4TldabFpHSmhOV0ptT1RWbE5tSmlPRE13Wm1GalpHTmhZV1V4TnpBMlptTmhOakU0TUdKa1lqQXdNelZoT1RObE1qUmtOVGMxTkdZM1pESm1PR016TXpVNFltSmhZbU5pTldNNVpqSmtaR0poTUdGaE9UazRZMlk1T1dOa01UaGpZemxsT1RFNFl6QmpPVGRqT1RneFpXWmxZek5sWm1JM01tSTFZMkkxTlRjd01HTmlNV1U0TWprNU16QTNZakk0T0dFM09EUmlPREEyWWpnME9UTXpOamMxTkRSa1pUazVOek01WmpJMFlUazJORFUwWldVM01Ua3lNVEJsWW1ReU56TmxNelF6Tm1FME1qVTROREk0TUdFeU16QTJNRGxqTTJFMU5tSTNaR1UyTm1GaFlXUmtOR1ZsTURZMU4yUTBOVGMxWW1JMk9USXdNREV5Wm1KbVpXUmlOalpoWmpJME5HUTFNVGs1TWpWbVl6TmxORFJoWmpKbU5HSmhOamMwWkdNek0ySmpNbVZsTkdSaU1tWTBZV1ptTTJVNVpXSmtOR1ZoTmpWaE1UWTNObUZrWVdNNFpqUmhNRFkwTnpsbE9HRTBOVFEzWldWbE9HVTBaVEpqTXpsaU1ERTFZbVEzWmpneE5HTXpPRGhqTURVMU1XUXpaakl5WVdaa01USXhZbVJtWTJWbU9UWTVZMlEzTVdRMllqZGlNelV3WW1VeE56WXhaRFU1WWpZMU1ETXlZMk5rWW1SaE56RTROamcyTmpBMVlXRTRaalEzTlRCbVl6STNNamcxT1ROa09USmtPV0ZrWmpWbU9EUmxaRFV6WVRBM09XUTJNRGxrTURjMk1tUTFOR1EzTURJME5XWmlNbVZtTWpJME9UTTFOemszT0dJek5ESXlNR0V4WXpoak5EVXpNakpsWmpSa1pXUmhZekV4TkdFNFl6azJZVFUxT1dRellXVmpNekptTTJVMk1UTm1ZVGhsWldGbVpqQXlPR0U0TXpkaVlqRXlZV0l3WldNMk1qVTBNREU0TVRBMll6WTFOR1ZqWWpjNE0yUTBaV1F6TXpNNU1HUmpOamhoWkRnelltVTRaV0k0T0dVellqY3hOR00wTURVek1qSXdPVGswTWpNM05qWTVNRGt6TUdZM1pEYzBPR1V4WVRSaU1UazNORGswTmpZek5UQTVPVE5pTW1VMVlqUXlaR0kwTlRJeVltTmhNVE5oTm1FNVl6VmtNall6TXpnME9HUm1PREV6WkRNd056ZGxOMkpoTnpnd05USTRPV1psTURRMllqVXdNRGt4T1RrMVpEUTJZekEzWVRCak9ERXpOalkyTnpGaU56UXhOVEppTldJelpqY3dZbU00SWl3S0lDQWlZM0psWkdWdWRHbGhiRjlsYm1Sd2IybHVkRjkxY213aU9pQWlhSFIwY0RvdkwyUmxkaTFrYUdFdWFIVnRZVzVoTG1OdmJUbzRPRGc1TDJacGNtVnphRzkwY3k5amNtVmtaVzUwYVdGc2MwWmxkR05vVjJWaVUyVnlkbWxqWlNJc0NpQWdJbVpwYkdWZmNHRjBhQ0k2SUNJeE5UWTRYekkyTVY4eE56QXdNRFkyTkRNNE1ESXpPVGsxTWlJc0NpQWdJbU55WldSbGJuUnBZV3hmWm1sc1pWOXdZWFIwWlhKdUlpQTZJQ0kwTVY4eE5qazVNelF5TlRjMUlncDkiLAoiY2x1c3Rlcl91aSI6ICIiLAoicmV0cnlfbnVtIjogIjAiLAoic3BhcmtfY29uZmlncyI6ICJld29nSUNBZ0luTnZiSEpmWW1GMFkyaGZjMmw2WlNJNklqRXdNREF3SWl3aWNHRnlZV3hzWld4ZmRHaHlaV0ZrY3lJNklqRXdJaXdpWm1WMFkyaGZjMmw2WlNJNklqRXdNREF3SWdvZ0lDQWdmUT09IiwKImI2NF9oaXZlX2NyZWRzX2pzb24iOiAiZXdvZ0lDSmpjbVZrWlc1MGFXRnNYMmxrSWpvZ0lpSXNDaUFnSW1OeVpXUmxiblJwWVd4ZmRIbHdaVjlwWkNJNklDSWlMQW9nSUNKMGIydGxiaUk2SUNKak5qazFNRFU0TW1FeE1tSTFOVGhoWWpZME9HTmtZamN5TURBNE1UY3pZakpsT0RReU9HWmlOVFZrWVdGa056UXdNVFV5TWpVMk9URmxaV00zT0dWbE4ySTFZelJsTXpRek1USmtaV1EzTUdGbE5XVTNaV1UwT0ROaU4yUTNaV0V3WXpJelpUSTBaVFExT0dWa01XWTFOR1JoTTJOalpEZGtZbU5tWlRnM01HRTJNV1UxWXpsak5UQTROMlUzWm1JMlpHTXhObUkyWmpobU5XVTBZbVZrWlRSak1HVXdNMkl6WkdJMllXWmhOMkkzTWpsallqbGlZMkU0TVRBelkySmxOR0l4WW1Oa01tSmpOV0l6TW1NeU5EZ3lOMlprWmpreFl6aGpNVEZqWmpNMlltWTFNVGN4WVRrNU5qSmpNV05oTlRSbU9HVmpPRFF5TURZM1lUZzBPR0k1TWpOak5qbGtNams1WXpaaU56VXlOR013T1RVME1qa3pNRFF3TXpBNVlURm1PR1prTXpsbU56Z3laREZpWkRnMk5ETm1NekpoTmpWbVlUTTFOekExTm1WaVpHWXdaRFUwT1dVeU1HWXdaakZoTURVMlpUZ3hNall6T0RJek5HRTBaalUxWlRBMU9UZG1NRFpoWlRkbU5EY3dNRFkwTldNd1pqSmtPRGM1WVRBeVpEVTFNalJsWVRJek5HTXlNR1E1WldWbU5EWmtNVFZtWldSaVlUVmlaamsxWlRaaVlqZ3pNR1poWTJSallXRmxNVGN3Tm1aallUWXhPREJpWkdJd01ETTFZVGt6WlRJMFpEVTNOVFJtTjJReVpqaGpNek0xT0dKaVlXSmpZalZqT1dZeVpHUmlZVEJoWVRrNU9HTm1PVGxqWkRFNFkyTTVaVGt4T0dNd1l6azNZems0TVdWbVpXTXpaV1ppTnpKaU5XTmlOVFUzTURCallqRmxPREk1T1RNd04ySXlPRGhoTnpnMFlqZ3dObUk0TkRrek16WTNOVFEwWkdVNU9UY3pPV1l5TkdFNU5qUTFOR1ZsTnpFNU1qRXdaV0prTWpjelpUTTBNelpoTkRJMU9EUXlPREJoTWpNd05qQTVZek5oTlRaaU4yUmxOalpoWVdGa1pEUmxaVEEyTlRka05EVTNOV0ppTmpreU1EQXhNbVppWm1Wa1lqWTJZV1l5TkRSa05URTVPVEkxWm1NelpUUTBZV1l5WmpSaVlUWTNOR1JqTXpOaVl6SmxaVFJrWWpKbU5HRm1aak5sT1dWaVpEUmxZVFkxWVRFMk56WmhaR0ZqT0dZMFlUQTJORGM1WlRoaE5EVTBOMlZsWlRobE5HVXlZek01WWpBeE5XSmtOMlk0TVRSak16ZzRZekExTlRGa00yWXlNbUZtWkRFeU1XSmtabU5sWmprMk9XTmtOekZrTm1JM1lqTTFNR0psTVRjMk1XUTFPV0kyTlRBek1tTmpaR0prWVRjeE9EWTROall3TldGaE9HWTBOelV3Wm1NeU56STROVGt6WkRreVpEbGhaR1kxWmpnMFpXUTFNMkV3Tnpsa05qQTVaREEzTmpKa05UUmtOekF5TkRWbVlqSmxaakl5TkRrek5UYzVOemhpTXpReU1qQmhNV000WXpRMU16SXlaV1kwWkdWa1lXTXhNVFJoT0dNNU5tRTFOVGxrTTJGbFl6TXlaak5sTmpFelptRTRaV1ZoWm1Zd01qaGhPRE0zWW1JeE1tRmlNR1ZqTmpJMU5EQXhPREV3Tm1NMk5UUmxZMkkzT0ROa05HVmtNek16T1RCa1l6WTRZV1E0TTJKbE9HVmlPRGhsTTJJM01UUmpOREExTXpJeU1EazVOREl6TnpZMk9UQTVNekJtTjJRM05EaGxNV0UwWWpFNU56UTVORFkyTXpVd09Ua3pZakpsTldJME1tUmlORFV5TW1KallURXpZVFpoT1dNMVpESTJNek00TkRoa1pqZ3hNMlF6TURjM1pUZGlZVGM0TURVeU9EbG1aVEEwTm1JMU1EQTVNVGs1TldRME5tTXdOMkV3WXpneE16WTJOamN4WWpjME1UVXlZalZpTTJZM01HSmpPQ0lzQ2lBZ0ltTnlaV1JsYm5ScFlXeGZaVzVrY0c5cGJuUmZkWEpzSWpvZ0ltaDBkSEE2THk5a1pYWXRaR2hoTG1oMWJXRnVZUzVqYjIwNk9EZzRPUzltYVhKbGMyaHZkSE12WTNKbFpHVnVkR2xoYkhOR1pYUmphRmRsWWxObGNuWnBZMlVpQ24wPSIsCiJiYXRjaF9pZCI6MTcwMDA2NjQzODAyMzk5NTIsCiJwcm9jZXNzX2lkIiA6MTcwMDA2NjQzODEyNjQyNDEsCiJyZXN0X3VybCI6ICIiLAoiYjY0X2V4dGVybmFsX2phcnNfbWFwIiA6ICIiCn0=", "ingestion_mode" : [ { "mode" : "overwrite", "save_mode" : "Overwrite", "data_movement_id" : 261, "ingestion_mode_key" : true, "drop_create_condition" : true } ], "generate_extra_configs_json" : "ewoiZXh0cmFDb25maWdNYXAiOiB7InNwYXJrLm5hYnUuZmV0Y2hfc2l6ZSI6ICIxMDAwMCIsICJzcGFyay5uYWJ1LmNvbXB1dGVfZW5naW5lIjogImF6dXJlX2RhdGFicmlja3MiLCAic3BhcmsubmFidS5zb2xyX2JhdGNoX3NpemUiOiAiMTAwMDAiLCAic3BhcmsubmFidS5hcHBsaWNhdGlvbl9uYW1lIjogIm5hYnUtc3Bhcmtib3QtaW5nZXN0aW9uIiwgInNwYXJrLmRyaXZlci5uYWJ1X3ByaXZhdGVLZXkiOiAiL2RiZnMvdG1wL2Rldi12My0xLTItMC9uYWJ1LzE3MDAwNjY0MzgxMjY0MjQxLzAvcHJpdmF0ZUtleSIsICJzcGFyay5kcml2ZXIuc291cmNlX2F3c19lbmRQb2ludCI6ICJzMy5hbWF6b25hd3MuY29tIiwgInNwYXJrLmRyaXZlci50YXJnZXRfYXdzX2VuZFBvaW50IjogInMzLmFtYXpvbmF3cy5jb20iLCAic3BhcmsubmFidS5jb21wdXRlX2VuZ2luZV9saWJzX3BhdGgiOiAiL2RiZnMvdG1wL2Rldi12My0xLTItMC9uYWJ1LzE3MDAwNjY0MzgxMjY0MjQxLzAvYXBwbGljYXRpb24uY29uZiJ9Cn0=", "incremental_load_details" : [ { "?column?" : 1 } ], "place_holders_with_default_and_max_values" : [ { "?column?" : 1 } ], "incremental_max_columns_with_column_ids" : [ { "?column?" : 1 } ], "remove_duplicates_data" : [], "cdc_first_time" : [ { "cdc_first_time" : true } ], "generate_base64_pipeline_timeout_json" : "ewoicGlwZWxpbmVfdGltZW91dCIgOiAyMwp9", "table_partition_output" : [], "fetch_source_type" : [ { "is_source_filetype" : false, "is_destination_redshift" : false, "data_movement_id" : 261, "source_metadata_category" : "relational", "destination" : "adls_gen2", "is_source_salesforce" : false, "is_destination_filetype" : true, "source" : "sql_server", "is_source_mongodb" : false, "is_ordinalpos_startwith_zero" : false, "destination_metadata_category" : "file" } ], "destination_transformation_query_details_output" : [ { "is_virtual" : false, "data_precision" : 0, "is_nullable" : false, "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "table_id" : 37234, "is_precision_scale" : true, "table_name" : "aaaa", "intermediate_datatype_name" : "string", "is_mysql" : false, "is_source_hive" : false, "is_partitioned_col" : false, "ingested_colorder" : 1, "user_text" : null, "field_name_replaced" : "entity_id", "is_long_col_name" : false, "is_oracle_destination" : false, "data_length" : 255, "destination_datatype_name" : "string", "column_name" : "entity_id", "source_type" : "sql_server", "schema_name" : "acuity-develop", "is_source_casting_enabled" : false, "is_varchar" : false, "field_name" : "entity_id", "column_id" : 956158, "source_cast_type" : "AsIs", "ordinal_position" : 1, "source_datatype_name" : "varchar", "is_cdc_col" : false, "data_scale" : 0, "replaced_column_name" : "entity_id", "data_type" : "varchar", "is_bigquery" : false, "is_precision" : true, "is_redshift_relational_destination" : false, "source_stg_function" : "AsIs", "istimezone" : false }, { "is_virtual" : false, "data_precision" : 0, "is_nullable" : false, "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "table_id" : 37234, "is_precision_scale" : true, "table_name" : "aaaa", "intermediate_datatype_name" : "string", "is_mysql" : false, "is_source_hive" : false, "is_partitioned_col" : false, "ingested_colorder" : 2, "user_text" : null, "field_name_replaced" : "entity_type", "is_long_col_name" : false, "is_oracle_destination" : false, "data_length" : 255, "destination_datatype_name" : "string", "column_name" : "entity_type", "source_type" : "sql_server", "schema_name" : "acuity-develop", "is_source_casting_enabled" : false, "is_varchar" : false, "field_name" : "entity_type", "column_id" : 956159, "source_cast_type" : "AsIs", "ordinal_position" : 2, "source_datatype_name" : "varchar", "is_cdc_col" : false, "data_scale" : 0, "replaced_column_name" : "entity_type", "data_type" : "varchar", "is_bigquery" : false, "is_precision" : true, "is_redshift_relational_destination" : false, "source_stg_function" : "AsIs", "istimezone" : false } ], "get_varchar_columns_destination" : [], "input_data" : { "flow_number" : 1, "process_id" : 17000664381264241, "source_database_name_lowercase" : "development-db", "batch_id" : 17000664380239952, "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMDY2NDU3NzgzNDI0MCwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDE0OTI1OCwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDA2NjQ1N30.cgEzDcSlWhMY65PdNscgXY1oBYM75LZUbp00acf6_d1WRUOrXXGi5pcvwkRNDv0JIxun7nmcSCqy2CKZ38-eHnEqqAoxh2CIRwXTdBlsYYFyfkXHYapfaXinAi82pkDk0yJQOs-m-vAf1cbV4ue4Zk6bHKbJeu_j5_x8HU3PKeF0pz0lA-tpeoFRlq_tLUXqApH5t7QuTIzOSq7Aujo6yOSm_inHTBzTWxUyVaBCitbKs_j3Oq-P5c-Y5W3r9oAvDNbMASikxmdxfJBp_rI2QYHdxazW9UvVh_ZpRPwOIbi7EAe9-B6BBxAxItPBTo4M-GFi-zvZZXXYMX57edoRDA", "end_point" : "http:\/\/dev-dha.humana.com:8889\/fireshots\/credentialsFetchWebService", "where_condition" : "37234", "suffix" : "", "reorder_columns" : [], "job_type_id" : "1", "ingestion_table_format" : "", "job_schedule_id" : 1568, "relative_file_path" : "", "retry_attempt" : "0", "source_schema_name_lowercase" : "acuity-develop", "variables" : { "env_variables" : {}, "user_variables" : {}, "payload_variables" : {} }, "source_database_name_uppercase" : "DEVELOPMENT-DB", "job_scheduled_user_id" : "Manaswini Chinthalapudi", "virtual_column" : [], "new_table_for_rename" : "", "source_schema_name_uppercase" : "ACUITY-DEVELOP", "batch_name" : "Ingestion_20231115", "modified_columns" : [], "source_database_name" : "development-db", "data_movement_id" : 261, "last_run_timestamp" : "2023-11-07 12:42:00.86365", "is_relative_file_path" : false }, "table_adv_opt_details" : [ { "dataplace_id" : 42, "cru_ts" : "2023-11-15 09:31:16.466337", "data_movement_id" : 261, "valid_to_ts" : "9999-12-31 00:00:00.0", "advance_option_details" : { "advanced_table_options" : { "columns_options" : { "modified_columns" : [], "virtual_column" : [], "excluded_column_ids" : [] }, "CDC" : { "audit_columns" : { "prev_process_id_column_name" : "prev_process_id", "end_date_column_name" : "valid_to_ts", "process_id_column_name" : "process_id", "start_date_column_name" : "valid_from_ts" }, "CDC_process_type" : "", "add_audit_columns" : false, "columns_ids" : [], "CDC_type" : "", "create_view" : false, "hash_type" : "", "view_name" : "v_aaaa" }, "sort_by_columns" : [], "incremental_load" : { "condition_values" : [], "where_clause" : "" }, "parallel_ingestion" : { "max_connections" : 1, "enable" : false }, "remove_duplicates" : { "sort_columns" : [], "key_columns" : [] }, "table_id" : 37234, "reorder_columns" : [], "table_name" : "aaaa", "parallel_hash_ingestion" : { "max_connections" : 8, "enable" : false }, "dataplace_id" : 42, "ingestion_mode" : { "mode" : "Drop & Re-create", "enable" : true }, "enable_cache" : { "enable" : false }, "ingest_using_query" : { "enable" : false, "sql_query" : "" }, "schema_id" : 453, "new_table_name" : "", "table_partitions" : [] }, "advanced_option_flags" : { "columns_options" : false, "CDC" : false, "sort_by_columns" : false, "incremental_load" : false, "parallel_ingestion" : false, "remove_duplicates" : false, "virtual_column" : false, "table_id" : 37234, "reorder_columns" : false, "table_name" : "aaaa", "parallel_hash_ingestion" : false, "dataplace_id" : 42, "modified_columns" : false, "ingestion_mode" : true, "enable_cache" : false, "ingest_using_query" : false, "schema_id" : 453, "new_table_name" : false, "excluded_column_ids" : false, "table_partitions" : false } }, "valid_from_ts" : "2023-11-15 09:31:16.466337", "cru_by" : "Venkata Yeedi", "object_id" : 37234 } ], "check_compute_engine_validity" : [ { "is_valid_compute_engine" : true } ], "get_non_partition_cols" : [ { "is_virtual" : false, "data_precision" : "0", "destination_datatype_name" : "string", "is_auditcol" : false, "data_length" : "255", "column_name" : "entity_id", "source_field_name" : "entity_id", "field_name" : "entity_id", "column_id" : "956158", "source_datatype_name" : "varchar", "is_partitioned_col" : false, "data_scale" : "0", "ingested_colorder" : 1 }, { "is_virtual" : false, "data_precision" : "0", "destination_datatype_name" : "string", "is_auditcol" : false, "data_length" : "255", "column_name" : "entity_type", "source_field_name" : "entity_type", "field_name" : "entity_type", "column_id" : "956159", "source_datatype_name" : "varchar", "is_partitioned_col" : false, "data_scale" : "0", "ingested_colorder" : 2 } ], "get_partition_cols" : [], "list_of_maps_of_incremental_columns" : [ { "?column?" : 1 } ], "spark_script_inputs" : [ { "ssh_username" : "null", "ssh_host" : "null", "loggroupname" : null, "kerberos" : null, "cloud_watch" : null, "compute_engine_info" : "ewoiY2x1c3Rlcl9pZCI6IjA5MjItMDAzMTM4LW9ybjlyMHRlIiwic3BhcmtfdmVyc2lvbl92YWx1ZSI6IjNfMSIsInNjYWxhX3ZlcnNpb25fdmFsdWUiOiIyXzEyIiwiY3JlZGVudGlhbHNfZmlsZXBhdGgiOiIiLCJjbHVzdGVyX2xpYnJhcnlfcGF0aCI6Ii9kYmZzL3RtcCIsInNwYXJrX3ZlcnNpb24iOiIzLjEiLCJzY2FsYV92ZXJzaW9uIjoiMi4xMiIKfQ==", "private_key_path" : "\/dbfs\/tmp\/dev-v3-1-2-0\/nabu\/17000664381264241\/0\/privateKey", "b64_external_jars_map" : null, "cluster_id" : "0922-003138-orn9r0te", "engine_sub_type" : "azure databricks", "spark_location" : "null", "dataproc_cluster" : "null", "cluster_library_path" : "\/dbfs\/tmp", "data_movement_name" : "ss_compass_adb_validation", "dataproc_project" : "null", "engine_path" : "azure_databricks", "is_bucket_encrypted" : null, "execution_role" : null, "cluster_ui" : null, "s3_bucket_path" : null, "rest_url" : null, "s3logs" : null, "cloud_type" : "null", "release_label" : null, "spark_version" : "3.1", "scala_version" : "2.12", "region" : "null" } ], "column_metadata_output" : [ { "is_virtual" : false, "data_precision" : 0, "is_nullable" : false, "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "table_id" : 37234, "is_precision_scale" : true, "table_name" : "aaaa", "intermediate_datatype_name" : "string", "is_mysql" : false, "is_source_hive" : false, "is_partitioned_col" : false, "user_text" : null, "field_name_replaced" : "entity_id", "is_long_col_name" : false, "is_oracle_destination" : false, "data_length" : 255, "destination_datatype_name" : "string", "column_name" : "entity_id", "source_type" : "sql_server", "schema_name" : "acuity-develop", "is_source_casting_enabled" : false, "is_varchar" : false, "field_name" : "entity_id", "column_id" : 956158, "source_cast_type" : "AsIs", "ordinal_position" : 1, "source_datatype_name" : "varchar", "is_cdc_col" : false, "data_scale" : 0, "replaced_column_name" : "entity_id", "data_type" : "varchar", "is_bigquery" : false, "is_precision" : true, "is_redshift_relational_destination" : false, "source_stg_function" : "AsIs", "istimezone" : false }, { "is_virtual" : false, "data_precision" : 0, "is_nullable" : false, "intermediate_stg_function" : "parquet_AsIs", "inconsistent_datatype" : null, "table_id" : 37234, "is_precision_scale" : true, "table_name" : "aaaa", "intermediate_datatype_name" : "string", "is_mysql" : false, "is_source_hive" : false, "is_partitioned_col" : false, "user_text" : null, "field_name_replaced" : "entity_type", "is_long_col_name" : false, "is_oracle_destination" : false, "data_length" : 255, "destination_datatype_name" : "string", "column_name" : "entity_type", "source_type" : "sql_server", "schema_name" : "acuity-develop", "is_source_casting_enabled" : false, "is_varchar" : false, "field_name" : "entity_type", "column_id" : 956159, "source_cast_type" : "AsIs", "ordinal_position" : 2, "source_datatype_name" : "varchar", "is_cdc_col" : false, "data_scale" : 0, "replaced_column_name" : "entity_type", "data_type" : "varchar", "is_bigquery" : false, "is_precision" : true, "is_redshift_relational_destination" : false, "source_stg_function" : "AsIs", "istimezone" : false } ], "updated_wherecondition_replaced_with_default_and_max_values" : [ { "?column?" : 1 } ], "cdc_schema_drift_new_table" : [ { "drift_new_table" : false } ], "emr_input_json" : "ewogICJjbHVzdGVyX2lkIjogIjA5MjItMDAzMTM4LW9ybjlyMHRlIiwKICAiY2x1c3Rlcl9yZWdpb24iOiAibnVsbCIsCiAgImNvbXB1dGVfZW5nX2NyZWRzX2pzb24iOiAiZXdvZ0lDSmpjbVZrWlc1MGFXRnNYMmxrSWpvZ0lqUXhJaXdLSUNBaVkzSmxaR1Z1ZEdsaGJGOTBlWEJsWDJsa0lqb2dJakUxSWl3S0lDQWlZM0psWkdWdWRHbGhiRjkwZVhCbElqb2dJa1pwYkdVZ1EyOXVkR1Z1ZENJc0NpQWdJblJ2YTJWdUlqb2dJbU0yT1RVd05UZ3lZVEV5WWpVMU9HRmlOalE0WTJSaU56SXdNRGd4TnpOaU1tVTROREk0Wm1JMU5XUmhZV1EzTkRBeE5USXlOVFk1TVdWbFl6YzRaV1UzWWpWak5HVXpORE14TW1SbFpEY3dZV1UxWlRkbFpUUTRNMkkzWkRkbFlUQmpNak5sTWpSbE5EVTRaV1F4WmpVMFpHRXpZMk5rTjJSaVkyWmxPRGN3WVRZeFpUVmpPV00xTURnM1pUZG1ZalprWXpFMllqWm1PR1kxWlRSaVpXUmxOR013WlRBellqTmtZalpoWm1FM1lqY3lPV05pT1dKallUZ3hNRE5qWW1VMFlqRmlZMlF5WW1NMVlqTXlZekkwT0RJM1ptUm1PVEZqT0dNeE1XTm1NelppWmpVeE56RmhPVGsyTW1NeFkyRTFOR1k0WldNNE5ESXdOamRoT0RRNFlqa3lNMk0yT1dReU9UbGpObUkzTlRJMFl6QTVOVFF5T1RNd05EQXpNRGxoTVdZNFptUXpPV1kzT0RKa01XSmtPRFkwTTJZek1tRTJOV1poTXpVM01EVTJaV0prWmpCa05UUTVaVEl3WmpCbU1XRXdOVFpsT0RFeU5qTTRNak0wWVRSbU5UVmxNRFU1TjJZd05tRmxOMlkwTnpBd05qUTFZekJtTW1RNE56bGhNREprTlRVeU5HVmhNak0wWXpJd1pEbGxaV1kwTm1ReE5XWmxaR0poTldKbU9UVmxObUppT0RNd1ptRmpaR05oWVdVeE56QTJabU5oTmpFNE1HSmtZakF3TXpWaE9UTmxNalJrTlRjMU5HWTNaREptT0dNek16VTRZbUpoWW1OaU5XTTVaakprWkdKaE1HRmhPVGs0WTJZNU9XTmtNVGhqWXpsbE9URTRZekJqT1Rkak9UZ3haV1psWXpObFptSTNNbUkxWTJJMU5UY3dNR05pTVdVNE1qazVNekEzWWpJNE9HRTNPRFJpT0RBMllqZzBPVE16TmpjMU5EUmtaVGs1TnpNNVpqSTBZVGsyTkRVMFpXVTNNVGt5TVRCbFltUXlOek5sTXpRek5tRTBNalU0TkRJNE1HRXlNekEyTURsak0yRTFObUkzWkdVMk5tRmhZV1JrTkdWbE1EWTFOMlEwTlRjMVltSTJPVEl3TURFeVptSm1aV1JpTmpaaFpqSTBOR1ExTVRrNU1qVm1Zek5sTkRSaFpqSm1OR0poTmpjMFpHTXpNMkpqTW1WbE5HUmlNbVkwWVdabU0yVTVaV0prTkdWaE5qVmhNVFkzTm1Ga1lXTTRaalJoTURZME56bGxPR0UwTlRRM1pXVmxPR1UwWlRKak16bGlNREUxWW1RM1pqZ3hOR016T0Roak1EVTFNV1F6WmpJeVlXWmtNVEl4WW1SbVkyVm1PVFk1WTJRM01XUTJZamRpTXpVd1ltVXhOell4WkRVNVlqWTFNRE15WTJOa1ltUmhOekU0TmpnMk5qQTFZV0U0WmpRM05UQm1ZekkzTWpnMU9UTmtPVEprT1dGa1pqVm1PRFJsWkRVellUQTNPV1EyTURsa01EYzJNbVExTkdRM01ESTBOV1ppTW1WbU1qSTBPVE0xTnprM09HSXpOREl5TUdFeFl6aGpORFV6TWpKbFpqUmtaV1JoWXpFeE5HRTRZemsyWVRVMU9XUXpZV1ZqTXpKbU0yVTJNVE5tWVRobFpXRm1aakF5T0dFNE16ZGlZakV5WVdJd1pXTTJNalUwTURFNE1UQTJZelkxTkdWallqYzRNMlEwWldRek16TTVNR1JqTmpoaFpEZ3pZbVU0WldJNE9HVXpZamN4TkdNME1EVXpNakl3T1RrME1qTTNOalk1TURrek1HWTNaRGMwT0dVeFlUUmlNVGszTkRrME5qWXpOVEE1T1ROaU1tVTFZalF5WkdJME5USXlZbU5oTVROaE5tRTVZelZrTWpZek16ZzBPR1JtT0RFelpETXdOemRsTjJKaE56Z3dOVEk0T1dabE1EUTJZalV3TURreE9UazFaRFEyWXpBM1lUQmpPREV6TmpZMk56RmlOelF4TlRKaU5XSXpaamN3WW1NNElpd0tJQ0FpWTNKbFpHVnVkR2xoYkY5bGJtUndiMmx1ZEY5MWNtd2lPaUFpYUhSMGNEb3ZMMlJsZGkxa2FHRXVhSFZ0WVc1aExtTnZiVG80T0RnNUwyWnBjbVZ6YUc5MGN5OWpjbVZrWlc1MGFXRnNjMFpsZEdOb1YyVmlVMlZ5ZG1salpTSXNDaUFnSW1acGJHVmZjR0YwYUNJNklDSXhOVFk0WHpJMk1WOHhOekF3TURZMk5ETTRNREl6T1RrMU1pSXNDaUFnSW1OeVpXUmxiblJwWVd4ZlptbHNaVjl3WVhSMFpYSnVJaUE2SUNJME1WOHhOams1TXpReU5UYzFJZ3A5IiwKICAiczNfcGF0aCI6ICIiLAogICJiNjRfaW5wdXRfanNvbiI6ICJld29pY0hKdlkyVnpjMGxrSWpveE56QXdNRFkyTkRNNE1USTJOREkwTVN3S0ltUmhkR0Z3YkdGalpVbGtJam8wTWl3S0luUmhZbXhsU1dRaU9qTTNNak0wTEFvaVpHRjBZVzF2ZG1WdFpXNTBTV1FpT2pJMk1Td0tJbXB2WWxOamFHVmtkV3hsWkZWelpYSkpaQ0k2SWsxaGJtRnpkMmx1YVNCRGFHbHVkR2hoYkdGd2RXUnBJaXdLSW1wdllsTmphR1ZrZFd4bFNXUWlPakUxTmpnc0NpSmlZWFJqYUVsa0lqb3hOekF3TURZMk5ETTRNREl6T1RrMU1pd0tJbXhoYzNSU2RXNVVhVzFsYzNSaGJYQWlPaUl5TURJekxURXhMVEEzSURFeU9qUXlPakF3TGpnMk16WTFJaXdLSW5KbGRISjVUblZ0SWpvZ0lqQWlDbjA9IiwKICAiZXh0cmFfY29uZmlnIjogImV3b2laWGgwY21GRGIyNW1hV2ROWVhBaU9pQjdJbk53WVhKckxtNWhZblV1Wm1WMFkyaGZjMmw2WlNJNklDSXhNREF3TUNJc0lDSnpjR0Z5YXk1dVlXSjFMbU52YlhCMWRHVmZaVzVuYVc1bElqb2dJbUY2ZFhKbFgyUmhkR0ZpY21samEzTWlMQ0FpYzNCaGNtc3VibUZpZFM1emIyeHlYMkpoZEdOb1gzTnBlbVVpT2lBaU1UQXdNREFpTENBaWMzQmhjbXN1Ym1GaWRTNWhjSEJzYVdOaGRHbHZibDl1WVcxbElqb2dJbTVoWW5VdGMzQmhjbXRpYjNRdGFXNW5aWE4wYVc5dUlpd2dJbk53WVhKckxtUnlhWFpsY2k1dVlXSjFYM0J5YVhaaGRHVkxaWGtpT2lBaUwyUmlabk12ZEcxd0wyUmxkaTEyTXkweExUSXRNQzl1WVdKMUx6RTNNREF3TmpZME16Z3hNalkwTWpReEx6QXZjSEpwZG1GMFpVdGxlU0lzSUNKemNHRnlheTVrY21sMlpYSXVjMjkxY21ObFgyRjNjMTlsYm1SUWIybHVkQ0k2SUNKek15NWhiV0Y2YjI1aGQzTXVZMjl0SWl3Z0luTndZWEpyTG1SeWFYWmxjaTUwWVhKblpYUmZZWGR6WDJWdVpGQnZhVzUwSWpvZ0luTXpMbUZ0WVhwdmJtRjNjeTVqYjIwaUxDQWljM0JoY21zdWJtRmlkUzVqYjIxd2RYUmxYMlZ1WjJsdVpWOXNhV0p6WDNCaGRHZ2lPaUFpTDJSaVpuTXZkRzF3TDJSbGRpMTJNeTB4TFRJdE1DOXVZV0oxTHpFM01EQXdOalkwTXpneE1qWTBNalF4THpBdllYQndiR2xqWVhScGIyNHVZMjl1WmlKOUNuMD0iLAogICJiYXRjaF9pZCI6IDE3MDAwNjY0MzgwMjM5OTUyLAogICJyZXRyeV9udW0iOiAiMCIsCiAgInNwYXJrX2NvbmZpZ3MiOiAiZXdvZ0lDQWdJbk52YkhKZlltRjBZMmhmYzJsNlpTSTZJakV3TURBd0lpd2ljR0Z5WVd4c1pXeGZkR2h5WldGa2N5STZJakV3SWl3aVptVjBZMmhmYzJsNlpTSTZJakV3TURBd0lnb2dJQ0FnZlE9PSIsCiAgImlzX2J1Y2tldF9lbmNyeXB0ZWQiOiAiIiwKICAiYjY0X2V4dGVybmFsX2phcnNfbWFwIiA6ICIiCn0=", "base64_rsa_compressed_encrypted_creds" : "rO0ABXVyAAJbQqzzF\/gGCFTgAgAAeHAAAAEAVy+9AQow7FXoD3z0ooJjPC+HrI5N52yIITSaL9yRvE3fFebDEBpUbP1qvJhLwLTo+6fqeYvorPcJGHVOzB+Iqo+4m\/AMDDiIgWaXz5hy8QfjV7PwWwarCUa5mj+NtOgTKwyw4WNnFcphnkE34tLJad1s2vF1qQHUgOCtysAB0fD2JA5BeEsUprhbts03GzeY8OCgy0kqiYHEoKRaS8cBWUQ81oeyo7fW8mdSsKVpY8wi3b2npBin83TSMAUXtFbeCjOOr7HC\/3DMYHQUM5xaZCNH7zeYWSMgAlTn1c+y42\/1lX0UE1c2qtplYC8Ky+yYikmWcrfsLOy5xJEB7L+KRHVxAH4AAAAAA5BHFNPNX+74skXzppe3RfD\/xrCll8g7yP06oIux1cYJaH6Z7Tz988miRj5z+4nzKfiAIw+MdVKnOwsvawBMOpAR\/WDGsqWEKC7EsNrjsBFm1HQ5tPFHcClV0HYlKZR5ejgDCOvBGBZ\/tQsIzKYl+dX92uH4Lgcbr9ns5Yi5CM3R0+q\/Z+5xzabCGcz54a7EjH1zT9y0wYp17VgEW9nccBtkkCmXJgDD1tijNxwK7I61N36cNTaMdQR71U1npaMyzuT0dQ6kgrputCx75rpIMsDwEkYi9ay\/LBgamfQiKPa7SDIzBjv5OgCrfU15BWr0OMRFAbu4rLF8s8PO9BrKQrA3JOsJwl8dQ47dhhJsDJgS8QAndbeJgjkT0Nsa18RE9pZ0HVVpSPhJR4aJvRlyFas6EOxbgVcPIrOgb9ahXBrFPblowqfD1iJ+z1brU00RxP\/cbjwyZOf6WJvFUzQqzqVEUJyJC4np9grL7zrPsMO8lseQ45QZQ7uhSsDztsV3OrzFK+mqSUtrVQzmkABaHyutr4dz3mPa9QtcZCX\/EshdwWwqf7+8WnuSwT40xMECKEL06BjuBZRtAPMhxX8Zo+eEA2mQmk2V2raRX0bluYFVsz2vnxcH1ntp9k\/YgPZeGNWpUI\/KQ\/CbUjbX7NX1FV+63fmJT2SRWj32vCOBu4K8405WNQ82YRJmP0k\/vMTeq\/XfF0tguDEBT31ra0tTYcKCUqIZ0+wTBakLiFVEM1xj7A\/u+7n7rsQkrKs31eNRo+2C8klBPjv6v\/Ju0F9JbNJtqUiFOxlUq\/wNRSm68xH6ZOFDG51BcZfxlkWvJOdvYoTVlylv67hH3pZgFK2GhXwl9Bhw6+eljQ+fP6eAncyFejNtvAuWGl5xf3ZgtPc\/15c8rj2+DPRqcd+rv6M7oftuvIqGbs\/gA1vDEbVVTT6J0TxEiEMpC0iYHmyAremaLDkBKWIns10eBeegTF1\/bZ7yNWcDS6tX\/0ensUmI5hLTA1tKsul7NuEjbU88KabhKtWknSmMnDix+feQ+D3yMuNIZroXqOeyDW+VkOpMNJNfrv5lPlVoiklns4VyGc\/XasVA63bVnUxRtgVNwO1ZyyfAIe7F46dIakC1HAHHTkmPwSJe965Ty+pACqPLVvEtrHJtETL5CKW2spRW3SnmhGLdr4R01j\/XFamcyFWvWmeSfwXG25kzHBrJN+5mGxFPFto=", "target_schemadrift_details" : [ { "destination_table_name" : "aaaa", "target_schemadrift_backup_table" : false, "target_schemadrift_ignore_table" : false, "backup_table_name" : "aaaa", "target_schemadrift_new_table" : false, "schema_drifted" : false } ], "generate_file_content_json" : "ewogICJjcmVkZW50aWFsX2lkIjogIjQxIiwKICAiY3JlZGVudGlhbF90eXBlX2lkIjogIjE1IiwKICAiY3JlZGVudGlhbF90eXBlIjogIkZpbGUgQ29udGVudCIsCiAgInRva2VuIjogImM2OTUwNTgyYTEyYjU1OGFiNjQ4Y2RiNzIwMDgxNzNiMmU4NDI4ZmI1NWRhYWQ3NDAxNTIyNTY5MWVlYzc4ZWU3YjVjNGUzNDMxMmRlZDcwYWU1ZTdlZTQ4M2I3ZDdlYTBjMjNlMjRlNDU4ZWQxZjU0ZGEzY2NkN2RiY2ZlODcwYTYxZTVjOWM1MDg3ZTdmYjZkYzE2YjZmOGY1ZTRiZWRlNGMwZTAzYjNkYjZhZmE3YjcyOWNiOWJjYTgxMDNjYmU0YjFiY2QyYmM1YjMyYzI0ODI3ZmRmOTFjOGMxMWNmMzZiZjUxNzFhOTk2MmMxY2E1NGY4ZWM4NDIwNjdhODQ4YjkyM2M2OWQyOTljNmI3NTI0YzA5NTQyOTMwNDAzMDlhMWY4ZmQzOWY3ODJkMWJkODY0M2YzMmE2NWZhMzU3MDU2ZWJkZjBkNTQ5ZTIwZjBmMWEwNTZlODEyNjM4MjM0YTRmNTVlMDU5N2YwNmFlN2Y0NzAwNjQ1YzBmMmQ4NzlhMDJkNTUyNGVhMjM0YzIwZDllZWY0NmQxNWZlZGJhNWJmOTVlNmJiODMwZmFjZGNhYWUxNzA2ZmNhNjE4MGJkYjAwMzVhOTNlMjRkNTc1NGY3ZDJmOGMzMzU4YmJhYmNiNWM5ZjJkZGJhMGFhOTk4Y2Y5OWNkMThjYzllOTE4YzBjOTdjOTgxZWZlYzNlZmI3MmI1Y2I1NTcwMGNiMWU4Mjk5MzA3YjI4OGE3ODRiODA2Yjg0OTMzNjc1NDRkZTk5NzM5ZjI0YTk2NDU0ZWU3MTkyMTBlYmQyNzNlMzQzNmE0MjU4NDI4MGEyMzA2MDljM2E1NmI3ZGU2NmFhYWRkNGVlMDY1N2Q0NTc1YmI2OTIwMDEyZmJmZWRiNjZhZjI0NGQ1MTk5MjVmYzNlNDRhZjJmNGJhNjc0ZGMzM2JjMmVlNGRiMmY0YWZmM2U5ZWJkNGVhNjVhMTY3NmFkYWM4ZjRhMDY0NzllOGE0NTQ3ZWVlOGU0ZTJjMzliMDE1YmQ3ZjgxNGMzODhjMDU1MWQzZjIyYWZkMTIxYmRmY2VmOTY5Y2Q3MWQ2YjdiMzUwYmUxNzYxZDU5YjY1MDMyY2NkYmRhNzE4Njg2NjA1YWE4ZjQ3NTBmYzI3Mjg1OTNkOTJkOWFkZjVmODRlZDUzYTA3OWQ2MDlkMDc2MmQ1NGQ3MDI0NWZiMmVmMjI0OTM1Nzk3OGIzNDIyMGExYzhjNDUzMjJlZjRkZWRhYzExNGE4Yzk2YTU1OWQzYWVjMzJmM2U2MTNmYThlZWFmZjAyOGE4MzdiYjEyYWIwZWM2MjU0MDE4MTA2YzY1NGVjYjc4M2Q0ZWQzMzM5MGRjNjhhZDgzYmU4ZWI4OGUzYjcxNGM0MDUzMjIwOTk0MjM3NjY5MDkzMGY3ZDc0OGUxYTRiMTk3NDk0NjYzNTA5OTNiMmU1YjQyZGI0NTIyYmNhMTNhNmE5YzVkMjYzMzg0OGRmODEzZDMwNzdlN2JhNzgwNTI4OWZlMDQ2YjUwMDkxOTk1ZDQ2YzA3YTBjODEzNjY2NzFiNzQxNTJiNWIzZjcwYmM4IiwKICAiY3JlZGVudGlhbF9lbmRwb2ludF91cmwiOiAiaHR0cDovL2Rldi1kaGEuaHVtYW5hLmNvbTo4ODg5L2ZpcmVzaG90cy9jcmVkZW50aWFsc0ZldGNoV2ViU2VydmljZSIsCiAgImZpbGVfcGF0aCI6ICIxNTY4XzI2MV8xNzAwMDY2NDM4MDIzOTk1MiIsCiAgImNyZWRlbnRpYWxfZmlsZV9wYXR0ZXJuIiA6ICI0MV8xNjk5MzQyNTc1Igp9", "get_view_info" : [ { "id" : 1 } ], "get_already_ingested_condition" : [ { "already_ingested" : true } ], "sort_by_columns_data" : [], "fetching_credential_inputs" : [ { "credential_type" : "File Content", "metastore_credential_type_id" : null, "credential_type_id" : 15, "metastore_credential_id" : null, "credential_pattern" : "41_1699342575", "spark_credential_id" : 41 } ], "get_varchar_columns" : [], "generate_spark_configs_json" : "ewogICAgInNvbHJfYmF0Y2hfc2l6ZSI6IjEwMDAwIiwicGFyYWxsZWxfdGhyZWFkcyI6IjEwIiwiZmV0Y2hfc2l6ZSI6IjEwMDAwIgogICAgfQ==" }, "batch_id" : "17000664380239952", "template_execution_type" : "single", "query_type" : "json", "currentBotMessageMap" : { "parent_id" : "4e8bcd3a-7fb0-4043-aba4-6d226c053fa0", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "message_context" : "ingestion_deciding", "message_id" : "9ef48220-268b-40d5-8cd9-8f49fbd8f89c", "task_retry_intervals_secs" : [], "bot_id" : "84c43ca6-2712-4cd9-b2d9-b0fe3f69b476", "message_topic" : "nabu_2_jdbc", "tags" : { "process_id" : 17000664381264241, "batch_id" : 17000664380239952, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "tags" : [ "AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot", "KoshBot", "DBOpsBot" ], "initial_ts" : 1700066438126, "batch_name" : "Ingestion_20231115", "environment" : "modak", "job_schedule_id" : 1568, "data_movement_id" : 261, "last_run_timestamp" : "2023-11-07 12:42:00.86365", "retry_attempt" : 0, "task_dependency" : true, "ignore_job_termination" : false } } }, "template_execution_type" : "single", "query_type" : "json", "currentBotMessageMap" : { "parent_id" : "9ef48220-268b-40d5-8cd9-8f49fbd8f89c", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "message_context" : "spark_buffer_msg", "message_id" : "e16c0da0-abcf-4b8d-a952-7d29310a9e06", "task_retry_intervals_secs" : [], "bot_id" : "15b7f47d-8271-437b-8b5b-cc11873475de", "message_topic" : "nabu_2_jdbc", "tags" : { "process_id" : 17000664381264241, "batch_id" : 17000664380239952, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "tags" : [ "AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot", "KoshBot", "DBOpsBot", "DBOpsBot" ], "initial_ts" : 1700066438126, "batch_name" : "Ingestion_20231115", "environment" : "modak", "job_schedule_id" : 1568, "data_movement_id" : 261, "last_run_timestamp" : "2023-11-07 12:42:00.86365", "retry_attempt" : 0, "task_dependency" : true, "ignore_job_termination" : false } } }, "retry_attempt": 0, "flow_number": 1, "data_movement_id": 261, "where_condition": "37234", "process_id": 17000664381264241, "job_scheduled_user_id": "Manaswini Chinthalapudi", "batch_id": 17000664380239952, "last_run_timestamp": "2023-11-07 12:42:00.86365", "schema_drift_flag": false, "ssh_host": "null", "ssh_username": "null", "cloud_type": "null", "cluster_library_path": "/dbfs/tmp", "engine_path": "azure_databricks", "compute_engine_info": "ewoiY2x1c3Rlcl9pZCI6IjA5MjItMDAzMTM4LW9ybjlyMHRlIiwic3BhcmtfdmVyc2lvbl92YWx1ZSI6IjNfMSIsInNjYWxhX3ZlcnNpb25fdmFsdWUiOiIyXzEyIiwiY3JlZGVudGlhbHNfZmlsZXBhdGgiOiIiLCJjbHVzdGVyX2xpYnJhcnlfcGF0aCI6Ii9kYmZzL3RtcCIsInNwYXJrX3ZlcnNpb24iOiIzLjEiLCJzY2FsYV92ZXJzaW9uIjoiMi4xMiIKfQ==", "spark_location": "null", "template_group": "templates/artifact_ingestion/ingestion_templates.stg", "destination": "adls_gen2", "spark_application_template": "insert_spark_application_details", "source_endpoint": "s3.amazonaws.com", "destination_endpoint": "s3.amazonaws.com", "is_create_table": false, "spark_credential_info": "ewogICJjcmVkZW50aWFsX2lkIjogIjQxIiwKICAiY3JlZGVudGlhbF90eXBlX2lkIjogIjE1IiwKICAiY3JlZGVudGlhbF90eXBlIjogIkZpbGUgQ29udGVudCIsCiAgInRva2VuIjogImM2OTUwNTgyYTEyYjU1OGFiNjQ4Y2RiNzIwMDgxNzNiMmU4NDI4ZmI1NWRhYWQ3NDAxNTIyNTY5MWVlYzc4ZWU3YjVjNGUzNDMxMmRlZDcwYWU1ZTdlZTQ4M2I3ZDdlYTBjMjNlMjRlNDU4ZWQxZjU0ZGEzY2NkN2RiY2ZlODcwYTYxZTVjOWM1MDg3ZTdmYjZkYzE2YjZmOGY1ZTRiZWRlNGMwZTAzYjNkYjZhZmE3YjcyOWNiOWJjYTgxMDNjYmU0YjFiY2QyYmM1YjMyYzI0ODI3ZmRmOTFjOGMxMWNmMzZiZjUxNzFhOTk2MmMxY2E1NGY4ZWM4NDIwNjdhODQ4YjkyM2M2OWQyOTljNmI3NTI0YzA5NTQyOTMwNDAzMDlhMWY4ZmQzOWY3ODJkMWJkODY0M2YzMmE2NWZhMzU3MDU2ZWJkZjBkNTQ5ZTIwZjBmMWEwNTZlODEyNjM4MjM0YTRmNTVlMDU5N2YwNmFlN2Y0NzAwNjQ1YzBmMmQ4NzlhMDJkNTUyNGVhMjM0YzIwZDllZWY0NmQxNWZlZGJhNWJmOTVlNmJiODMwZmFjZGNhYWUxNzA2ZmNhNjE4MGJkYjAwMzVhOTNlMjRkNTc1NGY3ZDJmOGMzMzU4YmJhYmNiNWM5ZjJkZGJhMGFhOTk4Y2Y5OWNkMThjYzllOTE4YzBjOTdjOTgxZWZlYzNlZmI3MmI1Y2I1NTcwMGNiMWU4Mjk5MzA3YjI4OGE3ODRiODA2Yjg0OTMzNjc1NDRkZTk5NzM5ZjI0YTk2NDU0ZWU3MTkyMTBlYmQyNzNlMzQzNmE0MjU4NDI4MGEyMzA2MDljM2E1NmI3ZGU2NmFhYWRkNGVlMDY1N2Q0NTc1YmI2OTIwMDEyZmJmZWRiNjZhZjI0NGQ1MTk5MjVmYzNlNDRhZjJmNGJhNjc0ZGMzM2JjMmVlNGRiMmY0YWZmM2U5ZWJkNGVhNjVhMTY3NmFkYWM4ZjRhMDY0NzllOGE0NTQ3ZWVlOGU0ZTJjMzliMDE1YmQ3ZjgxNGMzODhjMDU1MWQzZjIyYWZkMTIxYmRmY2VmOTY5Y2Q3MWQ2YjdiMzUwYmUxNzYxZDU5YjY1MDMyY2NkYmRhNzE4Njg2NjA1YWE4ZjQ3NTBmYzI3Mjg1OTNkOTJkOWFkZjVmODRlZDUzYTA3OWQ2MDlkMDc2MmQ1NGQ3MDI0NWZiMmVmMjI0OTM1Nzk3OGIzNDIyMGExYzhjNDUzMjJlZjRkZWRhYzExNGE4Yzk2YTU1OWQzYWVjMzJmM2U2MTNmYThlZWFmZjAyOGE4MzdiYjEyYWIwZWM2MjU0MDE4MTA2YzY1NGVjYjc4M2Q0ZWQzMzM5MGRjNjhhZDgzYmU4ZWI4OGUzYjcxNGM0MDUzMjIwOTk0MjM3NjY5MDkzMGY3ZDc0OGUxYTRiMTk3NDk0NjYzNTA5OTNiMmU1YjQyZGI0NTIyYmNhMTNhNmE5YzVkMjYzMzg0OGRmODEzZDMwNzdlN2JhNzgwNTI4OWZlMDQ2YjUwMDkxOTk1ZDQ2YzA3YTBjODEzNjY2NzFiNzQxNTJiNWIzZjcwYmM4IiwKICAiY3JlZGVudGlhbF9lbmRwb2ludF91cmwiOiAiaHR0cDovL2Rldi1kaGEuaHVtYW5hLmNvbTo4ODg5L2ZpcmVzaG90cy9jcmVkZW50aWFsc0ZldGNoV2ViU2VydmljZSIsCiAgImZpbGVfcGF0aCI6ICIxNTY4XzI2MV8xNzAwMDY2NDM4MDIzOTk1MiIsCiAgImNyZWRlbnRpYWxfZmlsZV9wYXR0ZXJuIiA6ICI0MV8xNjk5MzQyNTc1Igp9", "base64_pipeline_timeout_json": "ewoicGlwZWxpbmVfdGltZW91dCIgOiAyMwp9", "emr_input_json":"ewogICJjbHVzdGVyX2lkIjogIjA5MjItMDAzMTM4LW9ybjlyMHRlIiwKICAiY2x1c3Rlcl9yZWdpb24iOiAibnVsbCIsCiAgImNvbXB1dGVfZW5nX2NyZWRzX2pzb24iOiAiZXdvZ0lDSmpjbVZrWlc1MGFXRnNYMmxrSWpvZ0lqUXhJaXdLSUNBaVkzSmxaR1Z1ZEdsaGJGOTBlWEJsWDJsa0lqb2dJakUxSWl3S0lDQWlZM0psWkdWdWRHbGhiRjkwZVhCbElqb2dJa1pwYkdVZ1EyOXVkR1Z1ZENJc0NpQWdJblJ2YTJWdUlqb2dJbU0yT1RVd05UZ3lZVEV5WWpVMU9HRmlOalE0WTJSaU56SXdNRGd4TnpOaU1tVTROREk0Wm1JMU5XUmhZV1EzTkRBeE5USXlOVFk1TVdWbFl6YzRaV1UzWWpWak5HVXpORE14TW1SbFpEY3dZV1UxWlRkbFpUUTRNMkkzWkRkbFlUQmpNak5sTWpSbE5EVTRaV1F4WmpVMFpHRXpZMk5rTjJSaVkyWmxPRGN3WVRZeFpUVmpPV00xTURnM1pUZG1ZalprWXpFMllqWm1PR1kxWlRSaVpXUmxOR013WlRBellqTmtZalpoWm1FM1lqY3lPV05pT1dKallUZ3hNRE5qWW1VMFlqRmlZMlF5WW1NMVlqTXlZekkwT0RJM1ptUm1PVEZqT0dNeE1XTm1NelppWmpVeE56RmhPVGsyTW1NeFkyRTFOR1k0WldNNE5ESXdOamRoT0RRNFlqa3lNMk0yT1dReU9UbGpObUkzTlRJMFl6QTVOVFF5T1RNd05EQXpNRGxoTVdZNFptUXpPV1kzT0RKa01XSmtPRFkwTTJZek1tRTJOV1poTXpVM01EVTJaV0prWmpCa05UUTVaVEl3WmpCbU1XRXdOVFpsT0RFeU5qTTRNak0wWVRSbU5UVmxNRFU1TjJZd05tRmxOMlkwTnpBd05qUTFZekJtTW1RNE56bGhNREprTlRVeU5HVmhNak0wWXpJd1pEbGxaV1kwTm1ReE5XWmxaR0poTldKbU9UVmxObUppT0RNd1ptRmpaR05oWVdVeE56QTJabU5oTmpFNE1HSmtZakF3TXpWaE9UTmxNalJrTlRjMU5HWTNaREptT0dNek16VTRZbUpoWW1OaU5XTTVaakprWkdKaE1HRmhPVGs0WTJZNU9XTmtNVGhqWXpsbE9URTRZekJqT1Rkak9UZ3haV1psWXpObFptSTNNbUkxWTJJMU5UY3dNR05pTVdVNE1qazVNekEzWWpJNE9HRTNPRFJpT0RBMllqZzBPVE16TmpjMU5EUmtaVGs1TnpNNVpqSTBZVGsyTkRVMFpXVTNNVGt5TVRCbFltUXlOek5sTXpRek5tRTBNalU0TkRJNE1HRXlNekEyTURsak0yRTFObUkzWkdVMk5tRmhZV1JrTkdWbE1EWTFOMlEwTlRjMVltSTJPVEl3TURFeVptSm1aV1JpTmpaaFpqSTBOR1ExTVRrNU1qVm1Zek5sTkRSaFpqSm1OR0poTmpjMFpHTXpNMkpqTW1WbE5HUmlNbVkwWVdabU0yVTVaV0prTkdWaE5qVmhNVFkzTm1Ga1lXTTRaalJoTURZME56bGxPR0UwTlRRM1pXVmxPR1UwWlRKak16bGlNREUxWW1RM1pqZ3hOR016T0Roak1EVTFNV1F6WmpJeVlXWmtNVEl4WW1SbVkyVm1PVFk1WTJRM01XUTJZamRpTXpVd1ltVXhOell4WkRVNVlqWTFNRE15WTJOa1ltUmhOekU0TmpnMk5qQTFZV0U0WmpRM05UQm1ZekkzTWpnMU9UTmtPVEprT1dGa1pqVm1PRFJsWkRVellUQTNPV1EyTURsa01EYzJNbVExTkdRM01ESTBOV1ppTW1WbU1qSTBPVE0xTnprM09HSXpOREl5TUdFeFl6aGpORFV6TWpKbFpqUmtaV1JoWXpFeE5HRTRZemsyWVRVMU9XUXpZV1ZqTXpKbU0yVTJNVE5tWVRobFpXRm1aakF5T0dFNE16ZGlZakV5WVdJd1pXTTJNalUwTURFNE1UQTJZelkxTkdWallqYzRNMlEwWldRek16TTVNR1JqTmpoaFpEZ3pZbVU0WldJNE9HVXpZamN4TkdNME1EVXpNakl3T1RrME1qTTNOalk1TURrek1HWTNaRGMwT0dVeFlUUmlNVGszTkRrME5qWXpOVEE1T1ROaU1tVTFZalF5WkdJME5USXlZbU5oTVROaE5tRTVZelZrTWpZek16ZzBPR1JtT0RFelpETXdOemRsTjJKaE56Z3dOVEk0T1dabE1EUTJZalV3TURreE9UazFaRFEyWXpBM1lUQmpPREV6TmpZMk56RmlOelF4TlRKaU5XSXpaamN3WW1NNElpd0tJQ0FpWTNKbFpHVnVkR2xoYkY5bGJtUndiMmx1ZEY5MWNtd2lPaUFpYUhSMGNEb3ZMMlJsZGkxa2FHRXVhSFZ0WVc1aExtTnZiVG80T0RnNUwyWnBjbVZ6YUc5MGN5OWpjbVZrWlc1MGFXRnNjMFpsZEdOb1YyVmlVMlZ5ZG1salpTSXNDaUFnSW1acGJHVmZjR0YwYUNJNklDSXhOVFk0WHpJMk1WOHhOekF3TURZMk5ETTRNREl6T1RrMU1pSXNDaUFnSW1OeVpXUmxiblJwWVd4ZlptbHNaVjl3WVhSMFpYSnVJaUE2SUNJME1WOHhOams1TXpReU5UYzFJZ3A5IiwKICAiczNfcGF0aCI6ICIiLAogICJiNjRfaW5wdXRfanNvbiI6ICJld29pY0hKdlkyVnpjMGxrSWpveE56QXdNRFkyTkRNNE1USTJOREkwTVN3S0ltUmhkR0Z3YkdGalpVbGtJam8wTWl3S0luUmhZbXhsU1dRaU9qTTNNak0wTEFvaVpHRjBZVzF2ZG1WdFpXNTBTV1FpT2pJMk1Td0tJbXB2WWxOamFHVmtkV3hsWkZWelpYSkpaQ0k2SWsxaGJtRnpkMmx1YVNCRGFHbHVkR2hoYkdGd2RXUnBJaXdLSW1wdllsTmphR1ZrZFd4bFNXUWlPakUxTmpnc0NpSmlZWFJqYUVsa0lqb3hOekF3TURZMk5ETTRNREl6T1RrMU1pd0tJbXhoYzNSU2RXNVVhVzFsYzNSaGJYQWlPaUl5TURJekxURXhMVEEzSURFeU9qUXlPakF3TGpnMk16WTFJaXdLSW5KbGRISjVUblZ0SWpvZ0lqQWlDbjA9IiwKICAiZXh0cmFfY29uZmlnIjogImV3b2laWGgwY21GRGIyNW1hV2ROWVhBaU9pQjdJbk53WVhKckxtNWhZblV1Wm1WMFkyaGZjMmw2WlNJNklDSXhNREF3TUNJc0lDSnpjR0Z5YXk1dVlXSjFMbU52YlhCMWRHVmZaVzVuYVc1bElqb2dJbUY2ZFhKbFgyUmhkR0ZpY21samEzTWlMQ0FpYzNCaGNtc3VibUZpZFM1emIyeHlYMkpoZEdOb1gzTnBlbVVpT2lBaU1UQXdNREFpTENBaWMzQmhjbXN1Ym1GaWRTNWhjSEJzYVdOaGRHbHZibDl1WVcxbElqb2dJbTVoWW5VdGMzQmhjbXRpYjNRdGFXNW5aWE4wYVc5dUlpd2dJbk53WVhKckxtUnlhWFpsY2k1dVlXSjFYM0J5YVhaaGRHVkxaWGtpT2lBaUwyUmlabk12ZEcxd0wyUmxkaTEyTXkweExUSXRNQzl1WVdKMUx6RTNNREF3TmpZME16Z3hNalkwTWpReEx6QXZjSEpwZG1GMFpVdGxlU0lzSUNKemNHRnlheTVrY21sMlpYSXVjMjkxY21ObFgyRjNjMTlsYm1SUWIybHVkQ0k2SUNKek15NWhiV0Y2YjI1aGQzTXVZMjl0SWl3Z0luTndZWEpyTG1SeWFYWmxjaTUwWVhKblpYUmZZWGR6WDJWdVpGQnZhVzUwSWpvZ0luTXpMbUZ0WVhwdmJtRjNjeTVqYjIwaUxDQWljM0JoY21zdWJtRmlkUzVqYjIxd2RYUmxYMlZ1WjJsdVpWOXNhV0p6WDNCaGRHZ2lPaUFpTDJSaVpuTXZkRzF3TDJSbGRpMTJNeTB4TFRJdE1DOXVZV0oxTHpFM01EQXdOalkwTXpneE1qWTBNalF4THpBdllYQndiR2xqWVhScGIyNHVZMjl1WmlKOUNuMD0iLAogICJiYXRjaF9pZCI6IDE3MDAwNjY0MzgwMjM5OTUyLAogICJyZXRyeV9udW0iOiAiMCIsCiAgInNwYXJrX2NvbmZpZ3MiOiAiZXdvZ0lDQWdJbk52YkhKZlltRjBZMmhmYzJsNlpTSTZJakV3TURBd0lpd2ljR0Z5WVd4c1pXeGZkR2h5WldGa2N5STZJakV3SWl3aVptVjBZMmhmYzJsNlpTSTZJakV3TURBd0lnb2dJQ0FnZlE9PSIsCiAgImlzX2J1Y2tldF9lbmNyeXB0ZWQiOiAiIiwKICAiYjY0X2V4dGVybmFsX2phcnNfbWFwIiA6ICIiCn0=", "yeedu_input_json":"ewoiY2x1c3Rlcl9pZCI6ICIiLAoiYjY0X2lucHV0X2pzb24iOiAiZXdvaWNISnZZMlZ6YzBsa0lqb3hOekF3TURZMk5ETTRNVEkyTkRJME1Td0tJbVJoZEdGd2JHRmpaVWxrSWpvME1pd0tJblJoWW14bFNXUWlPak0zTWpNMExBb2laR0YwWVcxdmRtVnRaVzUwU1dRaU9qSTJNU3dLSW1wdllsTmphR1ZrZFd4bFpGVnpaWEpKWkNJNklrMWhibUZ6ZDJsdWFTQkRhR2x1ZEdoaGJHRndkV1JwSWl3S0ltcHZZbE5qYUdWa2RXeGxTV1FpT2pFMU5qZ3NDaUppWVhSamFFbGtJam94TnpBd01EWTJORE00TURJek9UazFNaXdLSW14aGMzUlNkVzVVYVcxbGMzUmhiWEFpT2lJeU1ESXpMVEV4TFRBM0lERXlPalF5T2pBd0xqZzJNelkxSWl3S0luSmxkSEo1VG5WdElqb2dJakFpQ24wPSIsCiJleHRyYV9jb25maWciOiAiZXdvaVpYaDBjbUZEYjI1bWFXZE5ZWEFpT2lCN0luTndZWEpyTG01aFluVXVabVYwWTJoZmMybDZaU0k2SUNJeE1EQXdNQ0lzSUNKemNHRnlheTV1WVdKMUxtTnZiWEIxZEdWZlpXNW5hVzVsSWpvZ0ltRjZkWEpsWDJSaGRHRmljbWxqYTNNaUxDQWljM0JoY21zdWJtRmlkUzV6YjJ4eVgySmhkR05vWDNOcGVtVWlPaUFpTVRBd01EQWlMQ0FpYzNCaGNtc3VibUZpZFM1aGNIQnNhV05oZEdsdmJsOXVZVzFsSWpvZ0ltNWhZblV0YzNCaGNtdGliM1F0YVc1blpYTjBhVzl1SWl3Z0luTndZWEpyTG1SeWFYWmxjaTV1WVdKMVgzQnlhWFpoZEdWTFpYa2lPaUFpTDJSaVpuTXZkRzF3TDJSbGRpMTJNeTB4TFRJdE1DOXVZV0oxTHpFM01EQXdOalkwTXpneE1qWTBNalF4THpBdmNISnBkbUYwWlV0bGVTSXNJQ0p6Y0dGeWF5NWtjbWwyWlhJdWMyOTFjbU5sWDJGM2MxOWxibVJRYjJsdWRDSTZJQ0p6TXk1aGJXRjZiMjVoZDNNdVkyOXRJaXdnSW5Od1lYSnJMbVJ5YVhabGNpNTBZWEpuWlhSZllYZHpYMlZ1WkZCdmFXNTBJam9nSW5NekxtRnRZWHB2Ym1GM2N5NWpiMjBpTENBaWMzQmhjbXN1Ym1GaWRTNWpiMjF3ZFhSbFgyVnVaMmx1WlY5c2FXSnpYM0JoZEdnaU9pQWlMMlJpWm5NdmRHMXdMMlJsZGkxMk15MHhMVEl0TUM5dVlXSjFMekUzTURBd05qWTBNemd4TWpZME1qUXhMekF2WVhCd2JHbGpZWFJwYjI0dVkyOXVaaUo5Q24wPSIsCiJjb21wdXRlX2VuZ19jcmVkc19qc29uIiA6ICJld29nSUNKamNtVmtaVzUwYVdGc1gybGtJam9nSWpReElpd0tJQ0FpWTNKbFpHVnVkR2xoYkY5MGVYQmxYMmxrSWpvZ0lqRTFJaXdLSUNBaVkzSmxaR1Z1ZEdsaGJGOTBlWEJsSWpvZ0lrWnBiR1VnUTI5dWRHVnVkQ0lzQ2lBZ0luUnZhMlZ1SWpvZ0ltTTJPVFV3TlRneVlURXlZalUxT0dGaU5qUTRZMlJpTnpJd01EZ3hOek5pTW1VNE5ESTRabUkxTldSaFlXUTNOREF4TlRJeU5UWTVNV1ZsWXpjNFpXVTNZalZqTkdVek5ETXhNbVJsWkRjd1lXVTFaVGRsWlRRNE0ySTNaRGRsWVRCak1qTmxNalJsTkRVNFpXUXhaalUwWkdFelkyTmtOMlJpWTJabE9EY3dZVFl4WlRWak9XTTFNRGczWlRkbVlqWmtZekUyWWpabU9HWTFaVFJpWldSbE5HTXdaVEF6WWpOa1lqWmhabUUzWWpjeU9XTmlPV0pqWVRneE1ETmpZbVUwWWpGaVkyUXlZbU0xWWpNeVl6STBPREkzWm1SbU9URmpPR014TVdObU16WmlaalV4TnpGaE9UazJNbU14WTJFMU5HWTRaV000TkRJd05qZGhPRFE0WWpreU0yTTJPV1F5T1Rsak5tSTNOVEkwWXpBNU5UUXlPVE13TkRBek1EbGhNV1k0Wm1Rek9XWTNPREprTVdKa09EWTBNMll6TW1FMk5XWmhNelUzTURVMlpXSmtaakJrTlRRNVpUSXdaakJtTVdFd05UWmxPREV5TmpNNE1qTTBZVFJtTlRWbE1EVTVOMll3Tm1GbE4yWTBOekF3TmpRMVl6Qm1NbVE0TnpsaE1ESmtOVFV5TkdWaE1qTTBZekl3WkRsbFpXWTBObVF4TldabFpHSmhOV0ptT1RWbE5tSmlPRE13Wm1GalpHTmhZV1V4TnpBMlptTmhOakU0TUdKa1lqQXdNelZoT1RObE1qUmtOVGMxTkdZM1pESm1PR016TXpVNFltSmhZbU5pTldNNVpqSmtaR0poTUdGaE9UazRZMlk1T1dOa01UaGpZemxsT1RFNFl6QmpPVGRqT1RneFpXWmxZek5sWm1JM01tSTFZMkkxTlRjd01HTmlNV1U0TWprNU16QTNZakk0T0dFM09EUmlPREEyWWpnME9UTXpOamMxTkRSa1pUazVOek01WmpJMFlUazJORFUwWldVM01Ua3lNVEJsWW1ReU56TmxNelF6Tm1FME1qVTROREk0TUdFeU16QTJNRGxqTTJFMU5tSTNaR1UyTm1GaFlXUmtOR1ZsTURZMU4yUTBOVGMxWW1JMk9USXdNREV5Wm1KbVpXUmlOalpoWmpJME5HUTFNVGs1TWpWbVl6TmxORFJoWmpKbU5HSmhOamMwWkdNek0ySmpNbVZsTkdSaU1tWTBZV1ptTTJVNVpXSmtOR1ZoTmpWaE1UWTNObUZrWVdNNFpqUmhNRFkwTnpsbE9HRTBOVFEzWldWbE9HVTBaVEpqTXpsaU1ERTFZbVEzWmpneE5HTXpPRGhqTURVMU1XUXpaakl5WVdaa01USXhZbVJtWTJWbU9UWTVZMlEzTVdRMllqZGlNelV3WW1VeE56WXhaRFU1WWpZMU1ETXlZMk5rWW1SaE56RTROamcyTmpBMVlXRTRaalEzTlRCbVl6STNNamcxT1ROa09USmtPV0ZrWmpWbU9EUmxaRFV6WVRBM09XUTJNRGxrTURjMk1tUTFOR1EzTURJME5XWmlNbVZtTWpJME9UTTFOemszT0dJek5ESXlNR0V4WXpoak5EVXpNakpsWmpSa1pXUmhZekV4TkdFNFl6azJZVFUxT1dRellXVmpNekptTTJVMk1UTm1ZVGhsWldGbVpqQXlPR0U0TXpkaVlqRXlZV0l3WldNMk1qVTBNREU0TVRBMll6WTFOR1ZqWWpjNE0yUTBaV1F6TXpNNU1HUmpOamhoWkRnelltVTRaV0k0T0dVellqY3hOR00wTURVek1qSXdPVGswTWpNM05qWTVNRGt6TUdZM1pEYzBPR1V4WVRSaU1UazNORGswTmpZek5UQTVPVE5pTW1VMVlqUXlaR0kwTlRJeVltTmhNVE5oTm1FNVl6VmtNall6TXpnME9HUm1PREV6WkRNd056ZGxOMkpoTnpnd05USTRPV1psTURRMllqVXdNRGt4T1RrMVpEUTJZekEzWVRCak9ERXpOalkyTnpGaU56UXhOVEppTldJelpqY3dZbU00SWl3S0lDQWlZM0psWkdWdWRHbGhiRjlsYm1Sd2IybHVkRjkxY213aU9pQWlhSFIwY0RvdkwyUmxkaTFrYUdFdWFIVnRZVzVoTG1OdmJUbzRPRGc1TDJacGNtVnphRzkwY3k5amNtVmtaVzUwYVdGc2MwWmxkR05vVjJWaVUyVnlkbWxqWlNJc0NpQWdJbVpwYkdWZmNHRjBhQ0k2SUNJeE5UWTRYekkyTVY4eE56QXdNRFkyTkRNNE1ESXpPVGsxTWlJc0NpQWdJbU55WldSbGJuUnBZV3hmWm1sc1pWOXdZWFIwWlhKdUlpQTZJQ0kwTVY4eE5qazVNelF5TlRjMUlncDkiLAoiY2x1c3Rlcl91aSI6ICIiLAoicmV0cnlfbnVtIjogIjAiLAoic3BhcmtfY29uZmlncyI6ICJld29nSUNBZ0luTnZiSEpmWW1GMFkyaGZjMmw2WlNJNklqRXdNREF3SWl3aWNHRnlZV3hzWld4ZmRHaHlaV0ZrY3lJNklqRXdJaXdpWm1WMFkyaGZjMmw2WlNJNklqRXdNREF3SWdvZ0lDQWdmUT09IiwKImI2NF9oaXZlX2NyZWRzX2pzb24iOiAiZXdvZ0lDSmpjbVZrWlc1MGFXRnNYMmxrSWpvZ0lpSXNDaUFnSW1OeVpXUmxiblJwWVd4ZmRIbHdaVjlwWkNJNklDSWlMQW9nSUNKMGIydGxiaUk2SUNKak5qazFNRFU0TW1FeE1tSTFOVGhoWWpZME9HTmtZamN5TURBNE1UY3pZakpsT0RReU9HWmlOVFZrWVdGa056UXdNVFV5TWpVMk9URmxaV00zT0dWbE4ySTFZelJsTXpRek1USmtaV1EzTUdGbE5XVTNaV1UwT0ROaU4yUTNaV0V3WXpJelpUSTBaVFExT0dWa01XWTFOR1JoTTJOalpEZGtZbU5tWlRnM01HRTJNV1UxWXpsak5UQTROMlUzWm1JMlpHTXhObUkyWmpobU5XVTBZbVZrWlRSak1HVXdNMkl6WkdJMllXWmhOMkkzTWpsallqbGlZMkU0TVRBelkySmxOR0l4WW1Oa01tSmpOV0l6TW1NeU5EZ3lOMlprWmpreFl6aGpNVEZqWmpNMlltWTFNVGN4WVRrNU5qSmpNV05oTlRSbU9HVmpPRFF5TURZM1lUZzBPR0k1TWpOak5qbGtNams1WXpaaU56VXlOR013T1RVME1qa3pNRFF3TXpBNVlURm1PR1prTXpsbU56Z3laREZpWkRnMk5ETm1NekpoTmpWbVlUTTFOekExTm1WaVpHWXdaRFUwT1dVeU1HWXdaakZoTURVMlpUZ3hNall6T0RJek5HRTBaalUxWlRBMU9UZG1NRFpoWlRkbU5EY3dNRFkwTldNd1pqSmtPRGM1WVRBeVpEVTFNalJsWVRJek5HTXlNR1E1WldWbU5EWmtNVFZtWldSaVlUVmlaamsxWlRaaVlqZ3pNR1poWTJSallXRmxNVGN3Tm1aallUWXhPREJpWkdJd01ETTFZVGt6WlRJMFpEVTNOVFJtTjJReVpqaGpNek0xT0dKaVlXSmpZalZqT1dZeVpHUmlZVEJoWVRrNU9HTm1PVGxqWkRFNFkyTTVaVGt4T0dNd1l6azNZems0TVdWbVpXTXpaV1ppTnpKaU5XTmlOVFUzTURCallqRmxPREk1T1RNd04ySXlPRGhoTnpnMFlqZ3dObUk0TkRrek16WTNOVFEwWkdVNU9UY3pPV1l5TkdFNU5qUTFOR1ZsTnpFNU1qRXdaV0prTWpjelpUTTBNelpoTkRJMU9EUXlPREJoTWpNd05qQTVZek5oTlRaaU4yUmxOalpoWVdGa1pEUmxaVEEyTlRka05EVTNOV0ppTmpreU1EQXhNbVppWm1Wa1lqWTJZV1l5TkRSa05URTVPVEkxWm1NelpUUTBZV1l5WmpSaVlUWTNOR1JqTXpOaVl6SmxaVFJrWWpKbU5HRm1aak5sT1dWaVpEUmxZVFkxWVRFMk56WmhaR0ZqT0dZMFlUQTJORGM1WlRoaE5EVTBOMlZsWlRobE5HVXlZek01WWpBeE5XSmtOMlk0TVRSak16ZzRZekExTlRGa00yWXlNbUZtWkRFeU1XSmtabU5sWmprMk9XTmtOekZrTm1JM1lqTTFNR0psTVRjMk1XUTFPV0kyTlRBek1tTmpaR0prWVRjeE9EWTROall3TldGaE9HWTBOelV3Wm1NeU56STROVGt6WkRreVpEbGhaR1kxWmpnMFpXUTFNMkV3Tnpsa05qQTVaREEzTmpKa05UUmtOekF5TkRWbVlqSmxaakl5TkRrek5UYzVOemhpTXpReU1qQmhNV000WXpRMU16SXlaV1kwWkdWa1lXTXhNVFJoT0dNNU5tRTFOVGxrTTJGbFl6TXlaak5sTmpFelptRTRaV1ZoWm1Zd01qaGhPRE0zWW1JeE1tRmlNR1ZqTmpJMU5EQXhPREV3Tm1NMk5UUmxZMkkzT0ROa05HVmtNek16T1RCa1l6WTRZV1E0TTJKbE9HVmlPRGhsTTJJM01UUmpOREExTXpJeU1EazVOREl6TnpZMk9UQTVNekJtTjJRM05EaGxNV0UwWWpFNU56UTVORFkyTXpVd09Ua3pZakpsTldJME1tUmlORFV5TW1KallURXpZVFpoT1dNMVpESTJNek00TkRoa1pqZ3hNMlF6TURjM1pUZGlZVGM0TURVeU9EbG1aVEEwTm1JMU1EQTVNVGs1TldRME5tTXdOMkV3WXpneE16WTJOamN4WWpjME1UVXlZalZpTTJZM01HSmpPQ0lzQ2lBZ0ltTnlaV1JsYm5ScFlXeGZaVzVrY0c5cGJuUmZkWEpzSWpvZ0ltaDBkSEE2THk5a1pYWXRaR2hoTG1oMWJXRnVZUzVqYjIwNk9EZzRPUzltYVhKbGMyaHZkSE12WTNKbFpHVnVkR2xoYkhOR1pYUmphRmRsWWxObGNuWnBZMlVpQ24wPSIsCiJiYXRjaF9pZCI6MTcwMDA2NjQzODAyMzk5NTIsCiJwcm9jZXNzX2lkIiA6MTcwMDA2NjQzODEyNjQyNDEsCiJyZXN0X3VybCI6ICIiLAoiYjY0X2V4dGVybmFsX2phcnNfbWFwIiA6ICIiCn0=", "yeedu_restapi_url":"null" }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/ingestion_flow.stg", "template_name": "advanced_table_options_utility", "useIncomingData": true }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "task_status_success_msg", "useIncomingData": true } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "error_template_create_msg" } ] } ] }
""2023-11-15 16:41:17.931 [Thread-1276] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_spark_script
""2023-11-15 16:41:18.052 [Thread-1952] INFO  com.modak.bots.basebot.AbstractBaseBot - SparkScriptBot with bot_id a59f4834-1892-4126-b8f2-fa70013de55d has started processing message with message_id 3cc69581-bcec-4220-ade0-259dc4327992 and thread_id 2398 
""2023-11-15 16:41:18.052 [Thread-1952] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:41:18.052 [Thread-1952] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=e16c0da0-abcf-4b8d-a952-7d29310a9e06, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=run_almaren_ingestion_job_using_spark, message_id=3cc69581-bcec-4220-ade0-259dc4327992, task_retry_intervals_secs=[], bot_id=0376eeee-b9ad-4204-b839-cf0e957579a7, message_topic=nabu_2_spark_script, tags={process_id=17000664381264241, batch_id=17000664380239952, job_scheduled_user_id=Manaswini Chinthalapudi, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot, KoshBot, DBOpsBot, DBOpsBot, KoshBot], initial_ts=1700066438126, batch_name=Ingestion_20231115, environment=modak, job_schedule_id=1568, data_movement_id=261, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, task_dependency=true, ignore_job_termination=false}}
""2023-11-15 16:41:18.066 [Thread-1276] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_spark_script
""2023-11-15 16:41:18.066 [Thread-1276] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:41:18.066 [Thread-1276] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot finished processing message with id e16c0da0-abcf-4b8d-a952-7d29310a9e06
""2023-11-15 16:41:18.272 [Thread-1952] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
["sh","-l","-c","$NABU_ROOT_INSTALLATION/botworks/scripts/createCredentials.sh null null azure_databricks null ewogICJjcmVkZW50aWFsX2lkIjogIjQxIiwKICAiY3JlZGVudGlhbF90eXBlX2lkIjogIjE1IiwKICAiY3JlZGVudGlhbF90eXBlIjogIkZpbGUgQ29udGVudCIsCiAgInRva2VuIjogImM2OTUwNTgyYTEyYjU1OGFiNjQ4Y2RiNzIwMDgxNzNiMmU4NDI4ZmI1NWRhYWQ3NDAxNTIyNTY5MWVlYzc4ZWU3YjVjNGUzNDMxMmRlZDcwYWU1ZTdlZTQ4M2I3ZDdlYTBjMjNlMjRlNDU4ZWQxZjU0ZGEzY2NkN2RiY2ZlODcwYTYxZTVjOWM1MDg3ZTdmYjZkYzE2YjZmOGY1ZTRiZWRlNGMwZTAzYjNkYjZhZmE3YjcyOWNiOWJjYTgxMDNjYmU0YjFiY2QyYmM1YjMyYzI0ODI3ZmRmOTFjOGMxMWNmMzZiZjUxNzFhOTk2MmMxY2E1NGY4ZWM4NDIwNjdhODQ4YjkyM2M2OWQyOTljNmI3NTI0YzA5NTQyOTMwNDAzMDlhMWY4ZmQzOWY3ODJkMWJkODY0M2YzMmE2NWZhMzU3MDU2ZWJkZjBkNTQ5ZTIwZjBmMWEwNTZlODEyNjM4MjM0YTRmNTVlMDU5N2YwNmFlN2Y0NzAwNjQ1YzBmMmQ4NzlhMDJkNTUyNGVhMjM0YzIwZDllZWY0NmQxNWZlZGJhNWJmOTVlNmJiODMwZmFjZGNhYWUxNzA2ZmNhNjE4MGJkYjAwMzVhOTNlMjRkNTc1NGY3ZDJmOGMzMzU4YmJhYmNiNWM5ZjJkZGJhMGFhOTk4Y2Y5OWNkMThjYzllOTE4YzBjOTdjOTgxZWZlYzNlZmI3MmI1Y2I1NTcwMGNiMWU4Mjk5MzA3YjI4OGE3ODRiODA2Yjg0OTMzNjc1NDRkZTk5NzM5ZjI0YTk2NDU0ZWU3MTkyMTBlYmQyNzNlMzQzNmE0MjU4NDI4MGEyMzA2MDljM2E1NmI3ZGU2NmFhYWRkNGVlMDY1N2Q0NTc1YmI2OTIwMDEyZmJmZWRiNjZhZjI0NGQ1MTk5MjVmYzNlNDRhZjJmNGJhNjc0ZGMzM2JjMmVlNGRiMmY0YWZmM2U5ZWJkNGVhNjVhMTY3NmFkYWM4ZjRhMDY0NzllOGE0NTQ3ZWVlOGU0ZTJjMzliMDE1YmQ3ZjgxNGMzODhjMDU1MWQzZjIyYWZkMTIxYmRmY2VmOTY5Y2Q3MWQ2YjdiMzUwYmUxNzYxZDU5YjY1MDMyY2NkYmRhNzE4Njg2NjA1YWE4ZjQ3NTBmYzI3Mjg1OTNkOTJkOWFkZjVmODRlZDUzYTA3OWQ2MDlkMDc2MmQ1NGQ3MDI0NWZiMmVmMjI0OTM1Nzk3OGIzNDIyMGExYzhjNDUzMjJlZjRkZWRhYzExNGE4Yzk2YTU1OWQzYWVjMzJmM2U2MTNmYThlZWFmZjAyOGE4MzdiYjEyYWIwZWM2MjU0MDE4MTA2YzY1NGVjYjc4M2Q0ZWQzMzM5MGRjNjhhZDgzYmU4ZWI4OGUzYjcxNGM0MDUzMjIwOTk0MjM3NjY5MDkzMGY3ZDc0OGUxYTRiMTk3NDk0NjYzNTA5OTNiMmU1YjQyZGI0NTIyYmNhMTNhNmE5YzVkMjYzMzg0OGRmODEzZDMwNzdlN2JhNzgwNTI4OWZlMDQ2YjUwMDkxOTk1ZDQ2YzA3YTBjODEzNjY2NzFiNzQxNTJiNWIzZjcwYmM4IiwKICAiY3JlZGVudGlhbF9lbmRwb2ludF91cmwiOiAiaHR0cDovL2Rldi1kaGEuaHVtYW5hLmNvbTo4ODg5L2ZpcmVzaG90cy9jcmVkZW50aWFsc0ZldGNoV2ViU2VydmljZSIsCiAgImZpbGVfcGF0aCI6ICIxNTY4XzI2MV8xNzAwMDY2NDM4MDIzOTk1MiIsCiAgImNyZWRlbnRpYWxfZmlsZV9wYXR0ZXJuIiA6ICI0MV8xNjk5MzQyNTc1Igp9"]
""2023-11-15 16:41:18.289 [Thread-1952] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 16:41:18.291 [Thread-1952] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:41:18.296 [Thread-1952] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:41:18.296 [Thread-1952] INFO  com.modak.bots.basebot.AbstractBaseBot - SparkScriptBot with bot_id a59f4834-1892-4126-b8f2-fa70013de55d has started process logic with message_id 3cc69581-bcec-4220-ade0-259dc4327992 and thread_id 2398
""2023-11-15 16:41:18.319 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - command to be executed  [sh, -l, -c, $NABU_ROOT_INSTALLATION/botworks/scripts/createCredentials.sh null null azure_databricks null ewogICJjcmVkZW50aWFsX2lkIjogIjQxIiwKICAiY3JlZGVudGlhbF90eXBlX2lkIjogIjE1IiwKICAiY3JlZGVudGlhbF90eXBlIjogIkZpbGUgQ29udGVudCIsCiAgInRva2VuIjogImM2OTUwNTgyYTEyYjU1OGFiNjQ4Y2RiNzIwMDgxNzNiMmU4NDI4ZmI1NWRhYWQ3NDAxNTIyNTY5MWVlYzc4ZWU3YjVjNGUzNDMxMmRlZDcwYWU1ZTdlZTQ4M2I3ZDdlYTBjMjNlMjRlNDU4ZWQxZjU0ZGEzY2NkN2RiY2ZlODcwYTYxZTVjOWM1MDg3ZTdmYjZkYzE2YjZmOGY1ZTRiZWRlNGMwZTAzYjNkYjZhZmE3YjcyOWNiOWJjYTgxMDNjYmU0YjFiY2QyYmM1YjMyYzI0ODI3ZmRmOTFjOGMxMWNmMzZiZjUxNzFhOTk2MmMxY2E1NGY4ZWM4NDIwNjdhODQ4YjkyM2M2OWQyOTljNmI3NTI0YzA5NTQyOTMwNDAzMDlhMWY4ZmQzOWY3ODJkMWJkODY0M2YzMmE2NWZhMzU3MDU2ZWJkZjBkNTQ5ZTIwZjBmMWEwNTZlODEyNjM4MjM0YTRmNTVlMDU5N2YwNmFlN2Y0NzAwNjQ1YzBmMmQ4NzlhMDJkNTUyNGVhMjM0YzIwZDllZWY0NmQxNWZlZGJhNWJmOTVlNmJiODMwZmFjZGNhYWUxNzA2ZmNhNjE4MGJkYjAwMzVhOTNlMjRkNTc1NGY3ZDJmOGMzMzU4YmJhYmNiNWM5ZjJkZGJhMGFhOTk4Y2Y5OWNkMThjYzllOTE4YzBjOTdjOTgxZWZlYzNlZmI3MmI1Y2I1NTcwMGNiMWU4Mjk5MzA3YjI4OGE3ODRiODA2Yjg0OTMzNjc1NDRkZTk5NzM5ZjI0YTk2NDU0ZWU3MTkyMTBlYmQyNzNlMzQzNmE0MjU4NDI4MGEyMzA2MDljM2E1NmI3ZGU2NmFhYWRkNGVlMDY1N2Q0NTc1YmI2OTIwMDEyZmJmZWRiNjZhZjI0NGQ1MTk5MjVmYzNlNDRhZjJmNGJhNjc0ZGMzM2JjMmVlNGRiMmY0YWZmM2U5ZWJkNGVhNjVhMTY3NmFkYWM4ZjRhMDY0NzllOGE0NTQ3ZWVlOGU0ZTJjMzliMDE1YmQ3ZjgxNGMzODhjMDU1MWQzZjIyYWZkMTIxYmRmY2VmOTY5Y2Q3MWQ2YjdiMzUwYmUxNzYxZDU5YjY1MDMyY2NkYmRhNzE4Njg2NjA1YWE4ZjQ3NTBmYzI3Mjg1OTNkOTJkOWFkZjVmODRlZDUzYTA3OWQ2MDlkMDc2MmQ1NGQ3MDI0NWZiMmVmMjI0OTM1Nzk3OGIzNDIyMGExYzhjNDUzMjJlZjRkZWRhYzExNGE4Yzk2YTU1OWQzYWVjMzJmM2U2MTNmYThlZWFmZjAyOGE4MzdiYjEyYWIwZWM2MjU0MDE4MTA2YzY1NGVjYjc4M2Q0ZWQzMzM5MGRjNjhhZDgzYmU4ZWI4OGUzYjcxNGM0MDUzMjIwOTk0MjM3NjY5MDkzMGY3ZDc0OGUxYTRiMTk3NDk0NjYzNTA5OTNiMmU1YjQyZGI0NTIyYmNhMTNhNmE5YzVkMjYzMzg0OGRmODEzZDMwNzdlN2JhNzgwNTI4OWZlMDQ2YjUwMDkxOTk1ZDQ2YzA3YTBjODEzNjY2NzFiNzQxNTJiNWIzZjcwYmM4IiwKICAiY3JlZGVudGlhbF9lbmRwb2ludF91cmwiOiAiaHR0cDovL2Rldi1kaGEuaHVtYW5hLmNvbTo4ODg5L2ZpcmVzaG90cy9jcmVkZW50aWFsc0ZldGNoV2ViU2VydmljZSIsCiAgImZpbGVfcGF0aCI6ICIxNTY4XzI2MV8xNzAwMDY2NDM4MDIzOTk1MiIsCiAgImNyZWRlbnRpYWxfZmlsZV9wYXR0ZXJuIiA6ICI0MV8xNjk5MzQyNTc1Igp9]
""2023-11-15 16:41:18.433 [Thread-836] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 8139d6f2-9a65-43f2-b465-28a78f070e95 has started processing message with message_id 825861ec-ca50-4736-a904-1a80ecfd82c9 and thread_id 1039 
""2023-11-15 16:41:18.433 [Thread-836] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:41:18.433 [Thread-836] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=3cc69581-bcec-4220-ade0-259dc4327992, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=825861ec-ca50-4736-a904-1a80ecfd82c9, task_retry_intervals_secs=[], bot_id=a59f4834-1892-4126-b8f2-fa70013de55d, message_topic=nabu_2_taskmonitor, tags={process_id=17000664381264241, initial_ts=1700066438126, batch_name=Ingestion_20231115, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot, KoshBot, DBOpsBot, DBOpsBot, KoshBot, TaskMonitorBot]}}
""2023-11-15 16:41:18.452 [Thread-836] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 17000664381264241, 'SparkScriptBot', 'run_almaren_ingestion_job_using_spark', 'create_credential_file_if_required', 10 , TO_TIMESTAMP(1700066478052::double precision / 1000) ,'a59f4834-1892-4126-b8f2-fa70013de55d');
""2023-11-15 16:41:18.452 [Thread-836] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 8139d6f2-9a65-43f2-b465-28a78f070e95 has started process logic with message_id 825861ec-ca50-4736-a904-1a80ecfd82c9 and thread_id 1039
""2023-11-15 16:41:18.551 [Thread-836] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 8139d6f2-9a65-43f2-b465-28a78f070e95 has finished process logic with message_id 825861ec-ca50-4736-a904-1a80ecfd82c9 and thread_id 1039
""2023-11-15 16:41:18.552 [Thread-836] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:41:18.552 [Thread-836] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 825861ec-ca50-4736-a904-1a80ecfd82c9
""2023-11-15 16:41:18.897 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - spark engine is azure_databricks
""2023-11-15 16:41:19.368 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:19,368] 	 DEBUG:Starting new HTTP connection (1): dev-dha.humana.com:8889
""2023-11-15 16:41:19.508 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:19,508] 	 DEBUG:http://dev-dha.humana.com:8889 "POST /fireshots/credentialsFetchWebService HTTP/1.1" 200 332
""2023-11-15 16:41:19.513 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:19,510] 	 INFO:file created at:/opt/nabu/nabu-spark-bots/azure_databricks/creds/1568_261_17000664380239952/ with filename 41_1699342575
""2023-11-15 16:41:19.591 [Thread-1952] INFO  com.modak.bots.SparkScriptBot -  exit status : 0
""2023-11-15 16:41:19.592 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - application_id null
""2023-11-15 16:41:19.592 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - job_id null
""2023-11-15 16:41:19.592 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - run_id null
""2023-11-15 16:41:19.592 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - job_name null
""2023-11-15 16:41:19.592 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - RunPageURL null
""2023-11-15 16:41:19.592 [Thread-1952] INFO  com.modak.bots.SparkScriptBot - Script executed successfully
""2023-11-15 16:41:19.592 [Thread-1952] INFO  com.modak.bots.SparkScriptBot - connection closed!
""2023-11-15 16:41:19.592 [Thread-1952] INFO  com.modak.bots.basebot.AbstractBaseBot - SparkScriptBot with bot_id a59f4834-1892-4126-b8f2-fa70013de55d has finished process logic with message_id 3cc69581-bcec-4220-ade0-259dc4327992 and thread_id 2398
""2023-11-15 16:41:19.592 [Thread-1952] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-15 16:41:19.605 [Thread-1952] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "869def21-f507-4b47-b3d0-c3c50a0c09b5", "parent_id": "3cc69581-bcec-4220-ade0-259dc4327992", "bot_id": "a59f4834-1892-4126-b8f2-fa70013de55d", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":17000664381264241, "initial_ts":1700066438126, "batch_id":17000664380239952, "batch_name":"Ingestion_20231115", "job_schedule_id":1568, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "2023-11-07 12:42:00.86365", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot", "KoshBot", "DBOpsBot", "DBOpsBot", "KoshBot", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"a59f4834-1892-4126-b8f2-fa70013de55d", "bot_name":"SparkScriptBot", "process_context":"run_almaren_ingestion_job_using_spark", "task_name":"create_credential_file_if_required", "process_id":"17000664381264241", "task_ts":1700066479592, "batch_id":"17000664380239952", "status_code_id": 6 } } ] }
""2023-11-15 16:41:19.608 [Thread-1952] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:41:19.618 [Thread-1952] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:41:19.618 [Thread-1952] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:41:19.618 [Thread-1952] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:41:19.619 [Thread-1952] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=e16c0da0-abcf-4b8d-a952-7d29310a9e06, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=run_almaren_ingestion_job_using_spark, message_id=3cc69581-bcec-4220-ade0-259dc4327992, task_retry_intervals_secs=[], bot_id=0376eeee-b9ad-4204-b839-cf0e957579a7, message_topic=nabu_2_spark_script, tags={process_id=17000664381264241, batch_id=17000664380239952, job_scheduled_user_id=Manaswini Chinthalapudi, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot, KoshBot, DBOpsBot, DBOpsBot, KoshBot], initial_ts=1700066438126, batch_name=Ingestion_20231115, environment=modak, job_schedule_id=1568, data_movement_id=261, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, task_dependency=true, ignore_job_termination=false}}
""2023-11-15 16:41:19.650 [Thread-680] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id b1b82409-9b47-41cf-be41-09ddeb2d8af9 has started processing message with message_id 869def21-f507-4b47-b3d0-c3c50a0c09b5 and thread_id 856 
""2023-11-15 16:41:19.650 [Thread-680] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:41:19.650 [Thread-680] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=3cc69581-bcec-4220-ade0-259dc4327992, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=869def21-f507-4b47-b3d0-c3c50a0c09b5, task_retry_intervals_secs=[], bot_id=a59f4834-1892-4126-b8f2-fa70013de55d, message_topic=nabu_2_taskmonitor, tags={process_id=17000664381264241, initial_ts=1700066438126, batch_name=Ingestion_20231115, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot, KoshBot, DBOpsBot, DBOpsBot, KoshBot, TaskMonitorBot]}}
""2023-11-15 16:41:19.661 [Thread-680] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 17000664381264241, 'SparkScriptBot', 'run_almaren_ingestion_job_using_spark', 'create_credential_file_if_required', 6 , TO_TIMESTAMP(1700066479592::double precision / 1000) ,'a59f4834-1892-4126-b8f2-fa70013de55d');
""2023-11-15 16:41:19.661 [Thread-680] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id b1b82409-9b47-41cf-be41-09ddeb2d8af9 has started process logic with message_id 869def21-f507-4b47-b3d0-c3c50a0c09b5 and thread_id 856
""2023-11-15 16:41:19.744 [Thread-680] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id b1b82409-9b47-41cf-be41-09ddeb2d8af9 has finished process logic with message_id 869def21-f507-4b47-b3d0-c3c50a0c09b5 and thread_id 856
""2023-11-15 16:41:19.744 [Thread-680] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:41:19.745 [Thread-680] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 869def21-f507-4b47-b3d0-c3c50a0c09b5
""2023-11-15 16:41:19.908 [Thread-1952] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
["sh","-l","-c","$NABU_ROOT_INSTALLATION/botworks/scripts/ingestion/run_almaren_job.sh rO0ABXVyAAJbQqzzF/gGCFTgAgAAeHAAAAEAVy+9AQow7FXoD3z0ooJjPC+HrI5N52yIITSaL9yRvE3fFebDEBpUbP1qvJhLwLTo+6fqeYvorPcJGHVOzB+Iqo+4m/AMDDiIgWaXz5hy8QfjV7PwWwarCUa5mj+NtOgTKwyw4WNnFcphnkE34tLJad1s2vF1qQHUgOCtysAB0fD2JA5BeEsUprhbts03GzeY8OCgy0kqiYHEoKRaS8cBWUQ81oeyo7fW8mdSsKVpY8wi3b2npBin83TSMAUXtFbeCjOOr7HC/3DMYHQUM5xaZCNH7zeYWSMgAlTn1c+y42/1lX0UE1c2qtplYC8Ky+yYikmWcrfsLOy5xJEB7L+KRHVxAH4AAAAAA5BHFNPNX+74skXzppe3RfD/xrCll8g7yP06oIux1cYJaH6Z7Tz988miRj5z+4nzKfiAIw+MdVKnOwsvawBMOpAR/WDGsqWEKC7EsNrjsBFm1HQ5tPFHcClV0HYlKZR5ejgDCOvBGBZ/tQsIzKYl+dX92uH4Lgcbr9ns5Yi5CM3R0+q/Z+5xzabCGcz54a7EjH1zT9y0wYp17VgEW9nccBtkkCmXJgDD1tijNxwK7I61N36cNTaMdQR71U1npaMyzuT0dQ6kgrputCx75rpIMsDwEkYi9ay/LBgamfQiKPa7SDIzBjv5OgCrfU15BWr0OMRFAbu4rLF8s8PO9BrKQrA3JOsJwl8dQ47dhhJsDJgS8QAndbeJgjkT0Nsa18RE9pZ0HVVpSPhJR4aJvRlyFas6EOxbgVcPIrOgb9ahXBrFPblowqfD1iJ+z1brU00RxP/cbjwyZOf6WJvFUzQqzqVEUJyJC4np9grL7zrPsMO8lseQ45QZQ7uhSsDztsV3OrzFK+mqSUtrVQzmkABaHyutr4dz3mPa9QtcZCX/EshdwWwqf7+8WnuSwT40xMECKEL06BjuBZRtAPMhxX8Zo+eEA2mQmk2V2raRX0bluYFVsz2vnxcH1ntp9k/YgPZeGNWpUI/KQ/CbUjbX7NX1FV+63fmJT2SRWj32vCOBu4K8405WNQ82YRJmP0k/vMTeq/XfF0tguDEBT31ra0tTYcKCUqIZ0+wTBakLiFVEM1xj7A/u+7n7rsQkrKs31eNRo+2C8klBPjv6v/Ju0F9JbNJtqUiFOxlUq/wNRSm68xH6ZOFDG51BcZfxlkWvJOdvYoTVlylv67hH3pZgFK2GhXwl9Bhw6+eljQ+fP6eAncyFejNtvAuWGl5xf3ZgtPc/15c8rj2+DPRqcd+rv6M7oftuvIqGbs/gA1vDEbVVTT6J0TxEiEMpC0iYHmyAremaLDkBKWIns10eBeegTF1/bZ7yNWcDS6tX/0ensUmI5hLTA1tKsul7NuEjbU88KabhKtWknSmMnDix+feQ+D3yMuNIZroXqOeyDW+VkOpMNJNfrv5lPlVoiklns4VyGc/XasVA63bVnUxRtgVNwO1ZyyfAIe7F46dIakC1HAHHTkmPwSJe965Ty+pACqPLVvEtrHJtETL5CKW2spRW3SnmhGLdr4R01j/XFamcyFWvWmeSfwXG25kzHBrJN+5mGxFPFto= ewoicHJvY2Vzc0lkIjoxNzAwMDY2NDM4MTI2NDI0MSwKImRhdGFwbGFjZUlkIjo0MiwKInRhYmxlSWQiOjM3MjM0LAoiZGF0YW1vdmVtZW50SWQiOjI2MSwKImpvYlNjaGVkdWxlZFVzZXJJZCI6Ik1hbmFzd2luaSBDaGludGhhbGFwdWRpIiwKImpvYlNjaGVkdWxlSWQiOjE1NjgsCiJiYXRjaElkIjoxNzAwMDY2NDM4MDIzOTk1MiwKImxhc3RSdW5UaW1lc3RhbXAiOiIyMDIzLTExLTA3IDEyOjQyOjAwLjg2MzY1IiwKInJldHJ5TnVtIjogIjAiCn0= 0 null null azure_databricks null ewoiY2x1c3Rlcl9pZCI6IjA5MjItMDAzMTM4LW9ybjlyMHRlIiwic3BhcmtfdmVyc2lvbl92YWx1ZSI6IjNfMSIsInNjYWxhX3ZlcnNpb25fdmFsdWUiOiIyXzEyIiwiY3JlZGVudGlhbHNfZmlsZXBhdGgiOiIiLCJjbHVzdGVyX2xpYnJhcnlfcGF0aCI6Ii9kYmZzL3RtcCIsInNwYXJrX3ZlcnNpb24iOiIzLjEiLCJzY2FsYV92ZXJzaW9uIjoiMi4xMiIKfQ== s3.amazonaws.com s3.amazonaws.com 1 ewogICAgInNvbHJfYmF0Y2hfc2l6ZSI6IjEwMDAwIiwicGFyYWxsZWxfdGhyZWFkcyI6IjEwIiwiZmV0Y2hfc2l6ZSI6IjEwMDAwIgogICAgfQ== ewoiZXh0cmFDb25maWdNYXAiOiB7InNwYXJrLm5hYnUuZmV0Y2hfc2l6ZSI6ICIxMDAwMCIsICJzcGFyay5uYWJ1LmNvbXB1dGVfZW5naW5lIjogImF6dXJlX2RhdGFicmlja3MiLCAic3BhcmsubmFidS5zb2xyX2JhdGNoX3NpemUiOiAiMTAwMDAiLCAic3BhcmsubmFidS5hcHBsaWNhdGlvbl9uYW1lIjogIm5hYnUtc3Bhcmtib3QtaW5nZXN0aW9uIiwgInNwYXJrLmRyaXZlci5uYWJ1X3ByaXZhdGVLZXkiOiAiL2RiZnMvdG1wL2Rldi12My0xLTItMC9uYWJ1LzE3MDAwNjY0MzgxMjY0MjQxLzAvcHJpdmF0ZUtleSIsICJzcGFyay5kcml2ZXIuc291cmNlX2F3c19lbmRQb2ludCI6ICJzMy5hbWF6b25hd3MuY29tIiwgInNwYXJrLmRyaXZlci50YXJnZXRfYXdzX2VuZFBvaW50IjogInMzLmFtYXpvbmF3cy5jb20iLCAic3BhcmsubmFidS5jb21wdXRlX2VuZ2luZV9saWJzX3BhdGgiOiAiL2RiZnMvdG1wL2Rldi12My0xLTItMC9uYWJ1LzE3MDAwNjY0MzgxMjY0MjQxLzAvYXBwbGljYXRpb24uY29uZiJ9Cn0= ewogICJjcmVkZW50aWFsX2lkIjogIjQxIiwKICAiY3JlZGVudGlhbF90eXBlX2lkIjogIjE1IiwKICAiY3JlZGVudGlhbF90eXBlIjogIkZpbGUgQ29udGVudCIsCiAgInRva2VuIjogImM2OTUwNTgyYTEyYjU1OGFiNjQ4Y2RiNzIwMDgxNzNiMmU4NDI4ZmI1NWRhYWQ3NDAxNTIyNTY5MWVlYzc4ZWU3YjVjNGUzNDMxMmRlZDcwYWU1ZTdlZTQ4M2I3ZDdlYTBjMjNlMjRlNDU4ZWQxZjU0ZGEzY2NkN2RiY2ZlODcwYTYxZTVjOWM1MDg3ZTdmYjZkYzE2YjZmOGY1ZTRiZWRlNGMwZTAzYjNkYjZhZmE3YjcyOWNiOWJjYTgxMDNjYmU0YjFiY2QyYmM1YjMyYzI0ODI3ZmRmOTFjOGMxMWNmMzZiZjUxNzFhOTk2MmMxY2E1NGY4ZWM4NDIwNjdhODQ4YjkyM2M2OWQyOTljNmI3NTI0YzA5NTQyOTMwNDAzMDlhMWY4ZmQzOWY3ODJkMWJkODY0M2YzMmE2NWZhMzU3MDU2ZWJkZjBkNTQ5ZTIwZjBmMWEwNTZlODEyNjM4MjM0YTRmNTVlMDU5N2YwNmFlN2Y0NzAwNjQ1YzBmMmQ4NzlhMDJkNTUyNGVhMjM0YzIwZDllZWY0NmQxNWZlZGJhNWJmOTVlNmJiODMwZmFjZGNhYWUxNzA2ZmNhNjE4MGJkYjAwMzVhOTNlMjRkNTc1NGY3ZDJmOGMzMzU4YmJhYmNiNWM5ZjJkZGJhMGFhOTk4Y2Y5OWNkMThjYzllOTE4YzBjOTdjOTgxZWZlYzNlZmI3MmI1Y2I1NTcwMGNiMWU4Mjk5MzA3YjI4OGE3ODRiODA2Yjg0OTMzNjc1NDRkZTk5NzM5ZjI0YTk2NDU0ZWU3MTkyMTBlYmQyNzNlMzQzNmE0MjU4NDI4MGEyMzA2MDljM2E1NmI3ZGU2NmFhYWRkNGVlMDY1N2Q0NTc1YmI2OTIwMDEyZmJmZWRiNjZhZjI0NGQ1MTk5MjVmYzNlNDRhZjJmNGJhNjc0ZGMzM2JjMmVlNGRiMmY0YWZmM2U5ZWJkNGVhNjVhMTY3NmFkYWM4ZjRhMDY0NzllOGE0NTQ3ZWVlOGU0ZTJjMzliMDE1YmQ3ZjgxNGMzODhjMDU1MWQzZjIyYWZkMTIxYmRmY2VmOTY5Y2Q3MWQ2YjdiMzUwYmUxNzYxZDU5YjY1MDMyY2NkYmRhNzE4Njg2NjA1YWE4ZjQ3NTBmYzI3Mjg1OTNkOTJkOWFkZjVmODRlZDUzYTA3OWQ2MDlkMDc2MmQ1NGQ3MDI0NWZiMmVmMjI0OTM1Nzk3OGIzNDIyMGExYzhjNDUzMjJlZjRkZWRhYzExNGE4Yzk2YTU1OWQzYWVjMzJmM2U2MTNmYThlZWFmZjAyOGE4MzdiYjEyYWIwZWM2MjU0MDE4MTA2YzY1NGVjYjc4M2Q0ZWQzMzM5MGRjNjhhZDgzYmU4ZWI4OGUzYjcxNGM0MDUzMjIwOTk0MjM3NjY5MDkzMGY3ZDc0OGUxYTRiMTk3NDk0NjYzNTA5OTNiMmU1YjQyZGI0NTIyYmNhMTNhNmE5YzVkMjYzMzg0OGRmODEzZDMwNzdlN2JhNzgwNTI4OWZlMDQ2YjUwMDkxOTk1ZDQ2YzA3YTBjODEzNjY2NzFiNzQxNTJiNWIzZjcwYmM4IiwKICAiY3JlZGVudGlhbF9lbmRwb2ludF91cmwiOiAiaHR0cDovL2Rldi1kaGEuaHVtYW5hLmNvbTo4ODg5L2ZpcmVzaG90cy9jcmVkZW50aWFsc0ZldGNoV2ViU2VydmljZSIsCiAgImZpbGVfcGF0aCI6ICIxNTY4XzI2MV8xNzAwMDY2NDM4MDIzOTk1MiIsCiAgImNyZWRlbnRpYWxfZmlsZV9wYXR0ZXJuIiA6ICI0MV8xNjk5MzQyNTc1Igp9 ewogICJjbHVzdGVyX2lkIjogIjA5MjItMDAzMTM4LW9ybjlyMHRlIiwKICAiY2x1c3Rlcl9yZWdpb24iOiAibnVsbCIsCiAgImNvbXB1dGVfZW5nX2NyZWRzX2pzb24iOiAiZXdvZ0lDSmpjbVZrWlc1MGFXRnNYMmxrSWpvZ0lqUXhJaXdLSUNBaVkzSmxaR1Z1ZEdsaGJGOTBlWEJsWDJsa0lqb2dJakUxSWl3S0lDQWlZM0psWkdWdWRHbGhiRjkwZVhCbElqb2dJa1pwYkdVZ1EyOXVkR1Z1ZENJc0NpQWdJblJ2YTJWdUlqb2dJbU0yT1RVd05UZ3lZVEV5WWpVMU9HRmlOalE0WTJSaU56SXdNRGd4TnpOaU1tVTROREk0Wm1JMU5XUmhZV1EzTkRBeE5USXlOVFk1TVdWbFl6YzRaV1UzWWpWak5HVXpORE14TW1SbFpEY3dZV1UxWlRkbFpUUTRNMkkzWkRkbFlUQmpNak5sTWpSbE5EVTRaV1F4WmpVMFpHRXpZMk5rTjJSaVkyWmxPRGN3WVRZeFpUVmpPV00xTURnM1pUZG1ZalprWXpFMllqWm1PR1kxWlRSaVpXUmxOR013WlRBellqTmtZalpoWm1FM1lqY3lPV05pT1dKallUZ3hNRE5qWW1VMFlqRmlZMlF5WW1NMVlqTXlZekkwT0RJM1ptUm1PVEZqT0dNeE1XTm1NelppWmpVeE56RmhPVGsyTW1NeFkyRTFOR1k0WldNNE5ESXdOamRoT0RRNFlqa3lNMk0yT1dReU9UbGpObUkzTlRJMFl6QTVOVFF5T1RNd05EQXpNRGxoTVdZNFptUXpPV1kzT0RKa01XSmtPRFkwTTJZek1tRTJOV1poTXpVM01EVTJaV0prWmpCa05UUTVaVEl3WmpCbU1XRXdOVFpsT0RFeU5qTTRNak0wWVRSbU5UVmxNRFU1TjJZd05tRmxOMlkwTnpBd05qUTFZekJtTW1RNE56bGhNREprTlRVeU5HVmhNak0wWXpJd1pEbGxaV1kwTm1ReE5XWmxaR0poTldKbU9UVmxObUppT0RNd1ptRmpaR05oWVdVeE56QTJabU5oTmpFNE1HSmtZakF3TXpWaE9UTmxNalJrTlRjMU5HWTNaREptT0dNek16VTRZbUpoWW1OaU5XTTVaakprWkdKaE1HRmhPVGs0WTJZNU9XTmtNVGhqWXpsbE9URTRZekJqT1Rkak9UZ3haV1psWXpObFptSTNNbUkxWTJJMU5UY3dNR05pTVdVNE1qazVNekEzWWpJNE9HRTNPRFJpT0RBMllqZzBPVE16TmpjMU5EUmtaVGs1TnpNNVpqSTBZVGsyTkRVMFpXVTNNVGt5TVRCbFltUXlOek5sTXpRek5tRTBNalU0TkRJNE1HRXlNekEyTURsak0yRTFObUkzWkdVMk5tRmhZV1JrTkdWbE1EWTFOMlEwTlRjMVltSTJPVEl3TURFeVptSm1aV1JpTmpaaFpqSTBOR1ExTVRrNU1qVm1Zek5sTkRSaFpqSm1OR0poTmpjMFpHTXpNMkpqTW1WbE5HUmlNbVkwWVdabU0yVTVaV0prTkdWaE5qVmhNVFkzTm1Ga1lXTTRaalJoTURZME56bGxPR0UwTlRRM1pXVmxPR1UwWlRKak16bGlNREUxWW1RM1pqZ3hOR016T0Roak1EVTFNV1F6WmpJeVlXWmtNVEl4WW1SbVkyVm1PVFk1WTJRM01XUTJZamRpTXpVd1ltVXhOell4WkRVNVlqWTFNRE15WTJOa1ltUmhOekU0TmpnMk5qQTFZV0U0WmpRM05UQm1ZekkzTWpnMU9UTmtPVEprT1dGa1pqVm1PRFJsWkRVellUQTNPV1EyTURsa01EYzJNbVExTkdRM01ESTBOV1ppTW1WbU1qSTBPVE0xTnprM09HSXpOREl5TUdFeFl6aGpORFV6TWpKbFpqUmtaV1JoWXpFeE5HRTRZemsyWVRVMU9XUXpZV1ZqTXpKbU0yVTJNVE5tWVRobFpXRm1aakF5T0dFNE16ZGlZakV5WVdJd1pXTTJNalUwTURFNE1UQTJZelkxTkdWallqYzRNMlEwWldRek16TTVNR1JqTmpoaFpEZ3pZbVU0WldJNE9HVXpZamN4TkdNME1EVXpNakl3T1RrME1qTTNOalk1TURrek1HWTNaRGMwT0dVeFlUUmlNVGszTkRrME5qWXpOVEE1T1ROaU1tVTFZalF5WkdJME5USXlZbU5oTVROaE5tRTVZelZrTWpZek16ZzBPR1JtT0RFelpETXdOemRsTjJKaE56Z3dOVEk0T1dabE1EUTJZalV3TURreE9UazFaRFEyWXpBM1lUQmpPREV6TmpZMk56RmlOelF4TlRKaU5XSXpaamN3WW1NNElpd0tJQ0FpWTNKbFpHVnVkR2xoYkY5bGJtUndiMmx1ZEY5MWNtd2lPaUFpYUhSMGNEb3ZMMlJsZGkxa2FHRXVhSFZ0WVc1aExtTnZiVG80T0RnNUwyWnBjbVZ6YUc5MGN5OWpjbVZrWlc1MGFXRnNjMFpsZEdOb1YyVmlVMlZ5ZG1salpTSXNDaUFnSW1acGJHVmZjR0YwYUNJNklDSXhOVFk0WHpJMk1WOHhOekF3TURZMk5ETTRNREl6T1RrMU1pSXNDaUFnSW1OeVpXUmxiblJwWVd4ZlptbHNaVjl3WVhSMFpYSnVJaUE2SUNJME1WOHhOams1TXpReU5UYzFJZ3A5IiwKICAiczNfcGF0aCI6ICIiLAogICJiNjRfaW5wdXRfanNvbiI6ICJld29pY0hKdlkyVnpjMGxrSWpveE56QXdNRFkyTkRNNE1USTJOREkwTVN3S0ltUmhkR0Z3YkdGalpVbGtJam8wTWl3S0luUmhZbXhsU1dRaU9qTTNNak0wTEFvaVpHRjBZVzF2ZG1WdFpXNTBTV1FpT2pJMk1Td0tJbXB2WWxOamFHVmtkV3hsWkZWelpYSkpaQ0k2SWsxaGJtRnpkMmx1YVNCRGFHbHVkR2hoYkdGd2RXUnBJaXdLSW1wdllsTmphR1ZrZFd4bFNXUWlPakUxTmpnc0NpSmlZWFJqYUVsa0lqb3hOekF3TURZMk5ETTRNREl6T1RrMU1pd0tJbXhoYzNSU2RXNVVhVzFsYzNSaGJYQWlPaUl5TURJekxURXhMVEEzSURFeU9qUXlPakF3TGpnMk16WTFJaXdLSW5KbGRISjVUblZ0SWpvZ0lqQWlDbjA9IiwKICAiZXh0cmFfY29uZmlnIjogImV3b2laWGgwY21GRGIyNW1hV2ROWVhBaU9pQjdJbk53WVhKckxtNWhZblV1Wm1WMFkyaGZjMmw2WlNJNklDSXhNREF3TUNJc0lDSnpjR0Z5YXk1dVlXSjFMbU52YlhCMWRHVmZaVzVuYVc1bElqb2dJbUY2ZFhKbFgyUmhkR0ZpY21samEzTWlMQ0FpYzNCaGNtc3VibUZpZFM1emIyeHlYMkpoZEdOb1gzTnBlbVVpT2lBaU1UQXdNREFpTENBaWMzQmhjbXN1Ym1GaWRTNWhjSEJzYVdOaGRHbHZibDl1WVcxbElqb2dJbTVoWW5VdGMzQmhjbXRpYjNRdGFXNW5aWE4wYVc5dUlpd2dJbk53WVhKckxtUnlhWFpsY2k1dVlXSjFYM0J5YVhaaGRHVkxaWGtpT2lBaUwyUmlabk12ZEcxd0wyUmxkaTEyTXkweExUSXRNQzl1WVdKMUx6RTNNREF3TmpZME16Z3hNalkwTWpReEx6QXZjSEpwZG1GMFpVdGxlU0lzSUNKemNHRnlheTVrY21sMlpYSXVjMjkxY21ObFgyRjNjMTlsYm1SUWIybHVkQ0k2SUNKek15NWhiV0Y2YjI1aGQzTXVZMjl0SWl3Z0luTndZWEpyTG1SeWFYWmxjaTUwWVhKblpYUmZZWGR6WDJWdVpGQnZhVzUwSWpvZ0luTXpMbUZ0WVhwdmJtRjNjeTVqYjIwaUxDQWljM0JoY21zdWJtRmlkUzVqYjIxd2RYUmxYMlZ1WjJsdVpWOXNhV0p6WDNCaGRHZ2lPaUFpTDJSaVpuTXZkRzF3TDJSbGRpMTJNeTB4TFRJdE1DOXVZV0oxTHpFM01EQXdOalkwTXpneE1qWTBNalF4THpBdllYQndiR2xqWVhScGIyNHVZMjl1WmlKOUNuMD0iLAogICJiYXRjaF9pZCI6IDE3MDAwNjY0MzgwMjM5OTUyLAogICJyZXRyeV9udW0iOiAiMCIsCiAgInNwYXJrX2NvbmZpZ3MiOiAiZXdvZ0lDQWdJbk52YkhKZlltRjBZMmhmYzJsNlpTSTZJakV3TURBd0lpd2ljR0Z5WVd4c1pXeGZkR2h5WldGa2N5STZJakV3SWl3aVptVjBZMmhmYzJsNlpTSTZJakV3TURBd0lnb2dJQ0FnZlE9PSIsCiAgImlzX2J1Y2tldF9lbmNyeXB0ZWQiOiAiIiwKICAiYjY0X2V4dGVybmFsX2phcnNfbWFwIiA6ICIiCn0= null /dbfs/tmp ewoiY2x1c3Rlcl9pZCI6ICIiLAoiYjY0X2lucHV0X2pzb24iOiAiZXdvaWNISnZZMlZ6YzBsa0lqb3hOekF3TURZMk5ETTRNVEkyTkRJME1Td0tJbVJoZEdGd2JHRmpaVWxrSWpvME1pd0tJblJoWW14bFNXUWlPak0zTWpNMExBb2laR0YwWVcxdmRtVnRaVzUwU1dRaU9qSTJNU3dLSW1wdllsTmphR1ZrZFd4bFpGVnpaWEpKWkNJNklrMWhibUZ6ZDJsdWFTQkRhR2x1ZEdoaGJHRndkV1JwSWl3S0ltcHZZbE5qYUdWa2RXeGxTV1FpT2pFMU5qZ3NDaUppWVhSamFFbGtJam94TnpBd01EWTJORE00TURJek9UazFNaXdLSW14aGMzUlNkVzVVYVcxbGMzUmhiWEFpT2lJeU1ESXpMVEV4TFRBM0lERXlPalF5T2pBd0xqZzJNelkxSWl3S0luSmxkSEo1VG5WdElqb2dJakFpQ24wPSIsCiJleHRyYV9jb25maWciOiAiZXdvaVpYaDBjbUZEYjI1bWFXZE5ZWEFpT2lCN0luTndZWEpyTG01aFluVXVabVYwWTJoZmMybDZaU0k2SUNJeE1EQXdNQ0lzSUNKemNHRnlheTV1WVdKMUxtTnZiWEIxZEdWZlpXNW5hVzVsSWpvZ0ltRjZkWEpsWDJSaGRHRmljbWxqYTNNaUxDQWljM0JoY21zdWJtRmlkUzV6YjJ4eVgySmhkR05vWDNOcGVtVWlPaUFpTVRBd01EQWlMQ0FpYzNCaGNtc3VibUZpZFM1aGNIQnNhV05oZEdsdmJsOXVZVzFsSWpvZ0ltNWhZblV0YzNCaGNtdGliM1F0YVc1blpYTjBhVzl1SWl3Z0luTndZWEpyTG1SeWFYWmxjaTV1WVdKMVgzQnlhWFpoZEdWTFpYa2lPaUFpTDJSaVpuTXZkRzF3TDJSbGRpMTJNeTB4TFRJdE1DOXVZV0oxTHpFM01EQXdOalkwTXpneE1qWTBNalF4THpBdmNISnBkbUYwWlV0bGVTSXNJQ0p6Y0dGeWF5NWtjbWwyWlhJdWMyOTFjbU5sWDJGM2MxOWxibVJRYjJsdWRDSTZJQ0p6TXk1aGJXRjZiMjVoZDNNdVkyOXRJaXdnSW5Od1lYSnJMbVJ5YVhabGNpNTBZWEpuWlhSZllYZHpYMlZ1WkZCdmFXNTBJam9nSW5NekxtRnRZWHB2Ym1GM2N5NWpiMjBpTENBaWMzQmhjbXN1Ym1GaWRTNWpiMjF3ZFhSbFgyVnVaMmx1WlY5c2FXSnpYM0JoZEdnaU9pQWlMMlJpWm5NdmRHMXdMMlJsZGkxMk15MHhMVEl0TUM5dVlXSjFMekUzTURBd05qWTBNemd4TWpZME1qUXhMekF2WVhCd2JHbGpZWFJwYjI0dVkyOXVaaUo5Q24wPSIsCiJjb21wdXRlX2VuZ19jcmVkc19qc29uIiA6ICJld29nSUNKamNtVmtaVzUwYVdGc1gybGtJam9nSWpReElpd0tJQ0FpWTNKbFpHVnVkR2xoYkY5MGVYQmxYMmxrSWpvZ0lqRTFJaXdLSUNBaVkzSmxaR1Z1ZEdsaGJGOTBlWEJsSWpvZ0lrWnBiR1VnUTI5dWRHVnVkQ0lzQ2lBZ0luUnZhMlZ1SWpvZ0ltTTJPVFV3TlRneVlURXlZalUxT0dGaU5qUTRZMlJpTnpJd01EZ3hOek5pTW1VNE5ESTRabUkxTldSaFlXUTNOREF4TlRJeU5UWTVNV1ZsWXpjNFpXVTNZalZqTkdVek5ETXhNbVJsWkRjd1lXVTFaVGRsWlRRNE0ySTNaRGRsWVRCak1qTmxNalJsTkRVNFpXUXhaalUwWkdFelkyTmtOMlJpWTJabE9EY3dZVFl4WlRWak9XTTFNRGczWlRkbVlqWmtZekUyWWpabU9HWTFaVFJpWldSbE5HTXdaVEF6WWpOa1lqWmhabUUzWWpjeU9XTmlPV0pqWVRneE1ETmpZbVUwWWpGaVkyUXlZbU0xWWpNeVl6STBPREkzWm1SbU9URmpPR014TVdObU16WmlaalV4TnpGaE9UazJNbU14WTJFMU5HWTRaV000TkRJd05qZGhPRFE0WWpreU0yTTJPV1F5T1Rsak5tSTNOVEkwWXpBNU5UUXlPVE13TkRBek1EbGhNV1k0Wm1Rek9XWTNPREprTVdKa09EWTBNMll6TW1FMk5XWmhNelUzTURVMlpXSmtaakJrTlRRNVpUSXdaakJtTVdFd05UWmxPREV5TmpNNE1qTTBZVFJtTlRWbE1EVTVOMll3Tm1GbE4yWTBOekF3TmpRMVl6Qm1NbVE0TnpsaE1ESmtOVFV5TkdWaE1qTTBZekl3WkRsbFpXWTBObVF4TldabFpHSmhOV0ptT1RWbE5tSmlPRE13Wm1GalpHTmhZV1V4TnpBMlptTmhOakU0TUdKa1lqQXdNelZoT1RObE1qUmtOVGMxTkdZM1pESm1PR016TXpVNFltSmhZbU5pTldNNVpqSmtaR0poTUdGaE9UazRZMlk1T1dOa01UaGpZemxsT1RFNFl6QmpPVGRqT1RneFpXWmxZek5sWm1JM01tSTFZMkkxTlRjd01HTmlNV1U0TWprNU16QTNZakk0T0dFM09EUmlPREEyWWpnME9UTXpOamMxTkRSa1pUazVOek01WmpJMFlUazJORFUwWldVM01Ua3lNVEJsWW1ReU56TmxNelF6Tm1FME1qVTROREk0TUdFeU16QTJNRGxqTTJFMU5tSTNaR1UyTm1GaFlXUmtOR1ZsTURZMU4yUTBOVGMxWW1JMk9USXdNREV5Wm1KbVpXUmlOalpoWmpJME5HUTFNVGs1TWpWbVl6TmxORFJoWmpKbU5HSmhOamMwWkdNek0ySmpNbVZsTkdSaU1tWTBZV1ptTTJVNVpXSmtOR1ZoTmpWaE1UWTNObUZrWVdNNFpqUmhNRFkwTnpsbE9HRTBOVFEzWldWbE9HVTBaVEpqTXpsaU1ERTFZbVEzWmpneE5HTXpPRGhqTURVMU1XUXpaakl5WVdaa01USXhZbVJtWTJWbU9UWTVZMlEzTVdRMllqZGlNelV3WW1VeE56WXhaRFU1WWpZMU1ETXlZMk5rWW1SaE56RTROamcyTmpBMVlXRTRaalEzTlRCbVl6STNNamcxT1ROa09USmtPV0ZrWmpWbU9EUmxaRFV6WVRBM09XUTJNRGxrTURjMk1tUTFOR1EzTURJME5XWmlNbVZtTWpJME9UTTFOemszT0dJek5ESXlNR0V4WXpoak5EVXpNakpsWmpSa1pXUmhZekV4TkdFNFl6azJZVFUxT1dRellXVmpNekptTTJVMk1UTm1ZVGhsWldGbVpqQXlPR0U0TXpkaVlqRXlZV0l3WldNMk1qVTBNREU0TVRBMll6WTFOR1ZqWWpjNE0yUTBaV1F6TXpNNU1HUmpOamhoWkRnelltVTRaV0k0T0dVellqY3hOR00wTURVek1qSXdPVGswTWpNM05qWTVNRGt6TUdZM1pEYzBPR1V4WVRSaU1UazNORGswTmpZek5UQTVPVE5pTW1VMVlqUXlaR0kwTlRJeVltTmhNVE5oTm1FNVl6VmtNall6TXpnME9HUm1PREV6WkRNd056ZGxOMkpoTnpnd05USTRPV1psTURRMllqVXdNRGt4T1RrMVpEUTJZekEzWVRCak9ERXpOalkyTnpGaU56UXhOVEppTldJelpqY3dZbU00SWl3S0lDQWlZM0psWkdWdWRHbGhiRjlsYm1Sd2IybHVkRjkxY213aU9pQWlhSFIwY0RvdkwyUmxkaTFrYUdFdWFIVnRZVzVoTG1OdmJUbzRPRGc1TDJacGNtVnphRzkwY3k5amNtVmtaVzUwYVdGc2MwWmxkR05vVjJWaVUyVnlkbWxqWlNJc0NpQWdJbVpwYkdWZmNHRjBhQ0k2SUNJeE5UWTRYekkyTVY4eE56QXdNRFkyTkRNNE1ESXpPVGsxTWlJc0NpQWdJbU55WldSbGJuUnBZV3hmWm1sc1pWOXdZWFIwWlhKdUlpQTZJQ0kwTVY4eE5qazVNelF5TlRjMUlncDkiLAoiY2x1c3Rlcl91aSI6ICIiLAoicmV0cnlfbnVtIjogIjAiLAoic3BhcmtfY29uZmlncyI6ICJld29nSUNBZ0luTnZiSEpmWW1GMFkyaGZjMmw2WlNJNklqRXdNREF3SWl3aWNHRnlZV3hzWld4ZmRHaHlaV0ZrY3lJNklqRXdJaXdpWm1WMFkyaGZjMmw2WlNJNklqRXdNREF3SWdvZ0lDQWdmUT09IiwKImI2NF9oaXZlX2NyZWRzX2pzb24iOiAiZXdvZ0lDSmpjbVZrWlc1MGFXRnNYMmxrSWpvZ0lpSXNDaUFnSW1OeVpXUmxiblJwWVd4ZmRIbHdaVjlwWkNJNklDSWlMQW9nSUNKMGIydGxiaUk2SUNKak5qazFNRFU0TW1FeE1tSTFOVGhoWWpZME9HTmtZamN5TURBNE1UY3pZakpsT0RReU9HWmlOVFZrWVdGa056UXdNVFV5TWpVMk9URmxaV00zT0dWbE4ySTFZelJsTXpRek1USmtaV1EzTUdGbE5XVTNaV1UwT0ROaU4yUTNaV0V3WXpJelpUSTBaVFExT0dWa01XWTFOR1JoTTJOalpEZGtZbU5tWlRnM01HRTJNV1UxWXpsak5UQTROMlUzWm1JMlpHTXhObUkyWmpobU5XVTBZbVZrWlRSak1HVXdNMkl6WkdJMllXWmhOMkkzTWpsallqbGlZMkU0TVRBelkySmxOR0l4WW1Oa01tSmpOV0l6TW1NeU5EZ3lOMlprWmpreFl6aGpNVEZqWmpNMlltWTFNVGN4WVRrNU5qSmpNV05oTlRSbU9HVmpPRFF5TURZM1lUZzBPR0k1TWpOak5qbGtNams1WXpaaU56VXlOR013T1RVME1qa3pNRFF3TXpBNVlURm1PR1prTXpsbU56Z3laREZpWkRnMk5ETm1NekpoTmpWbVlUTTFOekExTm1WaVpHWXdaRFUwT1dVeU1HWXdaakZoTURVMlpUZ3hNall6T0RJek5HRTBaalUxWlRBMU9UZG1NRFpoWlRkbU5EY3dNRFkwTldNd1pqSmtPRGM1WVRBeVpEVTFNalJsWVRJek5HTXlNR1E1WldWbU5EWmtNVFZtWldSaVlUVmlaamsxWlRaaVlqZ3pNR1poWTJSallXRmxNVGN3Tm1aallUWXhPREJpWkdJd01ETTFZVGt6WlRJMFpEVTNOVFJtTjJReVpqaGpNek0xT0dKaVlXSmpZalZqT1dZeVpHUmlZVEJoWVRrNU9HTm1PVGxqWkRFNFkyTTVaVGt4T0dNd1l6azNZems0TVdWbVpXTXpaV1ppTnpKaU5XTmlOVFUzTURCallqRmxPREk1T1RNd04ySXlPRGhoTnpnMFlqZ3dObUk0TkRrek16WTNOVFEwWkdVNU9UY3pPV1l5TkdFNU5qUTFOR1ZsTnpFNU1qRXdaV0prTWpjelpUTTBNelpoTkRJMU9EUXlPREJoTWpNd05qQTVZek5oTlRaaU4yUmxOalpoWVdGa1pEUmxaVEEyTlRka05EVTNOV0ppTmpreU1EQXhNbVppWm1Wa1lqWTJZV1l5TkRSa05URTVPVEkxWm1NelpUUTBZV1l5WmpSaVlUWTNOR1JqTXpOaVl6SmxaVFJrWWpKbU5HRm1aak5sT1dWaVpEUmxZVFkxWVRFMk56WmhaR0ZqT0dZMFlUQTJORGM1WlRoaE5EVTBOMlZsWlRobE5HVXlZek01WWpBeE5XSmtOMlk0TVRSak16ZzRZekExTlRGa00yWXlNbUZtWkRFeU1XSmtabU5sWmprMk9XTmtOekZrTm1JM1lqTTFNR0psTVRjMk1XUTFPV0kyTlRBek1tTmpaR0prWVRjeE9EWTROall3TldGaE9HWTBOelV3Wm1NeU56STROVGt6WkRreVpEbGhaR1kxWmpnMFpXUTFNMkV3Tnpsa05qQTVaREEzTmpKa05UUmtOekF5TkRWbVlqSmxaakl5TkRrek5UYzVOemhpTXpReU1qQmhNV000WXpRMU16SXlaV1kwWkdWa1lXTXhNVFJoT0dNNU5tRTFOVGxrTTJGbFl6TXlaak5sTmpFelptRTRaV1ZoWm1Zd01qaGhPRE0zWW1JeE1tRmlNR1ZqTmpJMU5EQXhPREV3Tm1NMk5UUmxZMkkzT0ROa05HVmtNek16T1RCa1l6WTRZV1E0TTJKbE9HVmlPRGhsTTJJM01UUmpOREExTXpJeU1EazVOREl6TnpZMk9UQTVNekJtTjJRM05EaGxNV0UwWWpFNU56UTVORFkyTXpVd09Ua3pZakpsTldJME1tUmlORFV5TW1KallURXpZVFpoT1dNMVpESTJNek00TkRoa1pqZ3hNMlF6TURjM1pUZGlZVGM0TURVeU9EbG1aVEEwTm1JMU1EQTVNVGs1TldRME5tTXdOMkV3WXpneE16WTJOamN4WWpjME1UVXlZalZpTTJZM01HSmpPQ0lzQ2lBZ0ltTnlaV1JsYm5ScFlXeGZaVzVrY0c5cGJuUmZkWEpzSWpvZ0ltaDBkSEE2THk5a1pYWXRaR2hoTG1oMWJXRnVZUzVqYjIwNk9EZzRPUzltYVhKbGMyaHZkSE12WTNKbFpHVnVkR2xoYkhOR1pYUmphRmRsWWxObGNuWnBZMlVpQ24wPSIsCiJiYXRjaF9pZCI6MTcwMDA2NjQzODAyMzk5NTIsCiJwcm9jZXNzX2lkIiA6MTcwMDA2NjQzODEyNjQyNDEsCiJyZXN0X3VybCI6ICIiLAoiYjY0X2V4dGVybmFsX2phcnNfbWFwIiA6ICIiCn0= null ewoicGlwZWxpbmVfdGltZW91dCIgOiAyMwp9"]
""2023-11-15 16:41:19.922 [Thread-1952] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 16:41:19.924 [Thread-1952] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:41:19.928 [Thread-1952] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:41:19.928 [Thread-1952] INFO  com.modak.bots.basebot.AbstractBaseBot - SparkScriptBot with bot_id a59f4834-1892-4126-b8f2-fa70013de55d has started process logic with message_id 3cc69581-bcec-4220-ade0-259dc4327992 and thread_id 2398
""2023-11-15 16:41:19.986 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - command to be executed  [sh, -l, -c, $NABU_ROOT_INSTALLATION/botworks/scripts/ingestion/run_almaren_job.sh rO0ABXVyAAJbQqzzF/gGCFTgAgAAeHAAAAEAVy+9AQow7FXoD3z0ooJjPC+HrI5N52yIITSaL9yRvE3fFebDEBpUbP1qvJhLwLTo+6fqeYvorPcJGHVOzB+Iqo+4m/AMDDiIgWaXz5hy8QfjV7PwWwarCUa5mj+NtOgTKwyw4WNnFcphnkE34tLJad1s2vF1qQHUgOCtysAB0fD2JA5BeEsUprhbts03GzeY8OCgy0kqiYHEoKRaS8cBWUQ81oeyo7fW8mdSsKVpY8wi3b2npBin83TSMAUXtFbeCjOOr7HC/3DMYHQUM5xaZCNH7zeYWSMgAlTn1c+y42/1lX0UE1c2qtplYC8Ky+yYikmWcrfsLOy5xJEB7L+KRHVxAH4AAAAAA5BHFNPNX+74skXzppe3RfD/xrCll8g7yP06oIux1cYJaH6Z7Tz988miRj5z+4nzKfiAIw+MdVKnOwsvawBMOpAR/WDGsqWEKC7EsNrjsBFm1HQ5tPFHcClV0HYlKZR5ejgDCOvBGBZ/tQsIzKYl+dX92uH4Lgcbr9ns5Yi5CM3R0+q/Z+5xzabCGcz54a7EjH1zT9y0wYp17VgEW9nccBtkkCmXJgDD1tijNxwK7I61N36cNTaMdQR71U1npaMyzuT0dQ6kgrputCx75rpIMsDwEkYi9ay/LBgamfQiKPa7SDIzBjv5OgCrfU15BWr0OMRFAbu4rLF8s8PO9BrKQrA3JOsJwl8dQ47dhhJsDJgS8QAndbeJgjkT0Nsa18RE9pZ0HVVpSPhJR4aJvRlyFas6EOxbgVcPIrOgb9ahXBrFPblowqfD1iJ+z1brU00RxP/cbjwyZOf6WJvFUzQqzqVEUJyJC4np9grL7zrPsMO8lseQ45QZQ7uhSsDztsV3OrzFK+mqSUtrVQzmkABaHyutr4dz3mPa9QtcZCX/EshdwWwqf7+8WnuSwT40xMECKEL06BjuBZRtAPMhxX8Zo+eEA2mQmk2V2raRX0bluYFVsz2vnxcH1ntp9k/YgPZeGNWpUI/KQ/CbUjbX7NX1FV+63fmJT2SRWj32vCOBu4K8405WNQ82YRJmP0k/vMTeq/XfF0tguDEBT31ra0tTYcKCUqIZ0+wTBakLiFVEM1xj7A/u+7n7rsQkrKs31eNRo+2C8klBPjv6v/Ju0F9JbNJtqUiFOxlUq/wNRSm68xH6ZOFDG51BcZfxlkWvJOdvYoTVlylv67hH3pZgFK2GhXwl9Bhw6+eljQ+fP6eAncyFejNtvAuWGl5xf3ZgtPc/15c8rj2+DPRqcd+rv6M7oftuvIqGbs/gA1vDEbVVTT6J0TxEiEMpC0iYHmyAremaLDkBKWIns10eBeegTF1/bZ7yNWcDS6tX/0ensUmI5hLTA1tKsul7NuEjbU88KabhKtWknSmMnDix+feQ+D3yMuNIZroXqOeyDW+VkOpMNJNfrv5lPlVoiklns4VyGc/XasVA63bVnUxRtgVNwO1ZyyfAIe7F46dIakC1HAHHTkmPwSJe965Ty+pACqPLVvEtrHJtETL5CKW2spRW3SnmhGLdr4R01j/XFamcyFWvWmeSfwXG25kzHBrJN+5mGxFPFto= ewoicHJvY2Vzc0lkIjoxNzAwMDY2NDM4MTI2NDI0MSwKImRhdGFwbGFjZUlkIjo0MiwKInRhYmxlSWQiOjM3MjM0LAoiZGF0YW1vdmVtZW50SWQiOjI2MSwKImpvYlNjaGVkdWxlZFVzZXJJZCI6Ik1hbmFzd2luaSBDaGludGhhbGFwdWRpIiwKImpvYlNjaGVkdWxlSWQiOjE1NjgsCiJiYXRjaElkIjoxNzAwMDY2NDM4MDIzOTk1MiwKImxhc3RSdW5UaW1lc3RhbXAiOiIyMDIzLTExLTA3IDEyOjQyOjAwLjg2MzY1IiwKInJldHJ5TnVtIjogIjAiCn0= 0 null null azure_databricks null ewoiY2x1c3Rlcl9pZCI6IjA5MjItMDAzMTM4LW9ybjlyMHRlIiwic3BhcmtfdmVyc2lvbl92YWx1ZSI6IjNfMSIsInNjYWxhX3ZlcnNpb25fdmFsdWUiOiIyXzEyIiwiY3JlZGVudGlhbHNfZmlsZXBhdGgiOiIiLCJjbHVzdGVyX2xpYnJhcnlfcGF0aCI6Ii9kYmZzL3RtcCIsInNwYXJrX3ZlcnNpb24iOiIzLjEiLCJzY2FsYV92ZXJzaW9uIjoiMi4xMiIKfQ== s3.amazonaws.com s3.amazonaws.com 1 ewogICAgInNvbHJfYmF0Y2hfc2l6ZSI6IjEwMDAwIiwicGFyYWxsZWxfdGhyZWFkcyI6IjEwIiwiZmV0Y2hfc2l6ZSI6IjEwMDAwIgogICAgfQ== ewoiZXh0cmFDb25maWdNYXAiOiB7InNwYXJrLm5hYnUuZmV0Y2hfc2l6ZSI6ICIxMDAwMCIsICJzcGFyay5uYWJ1LmNvbXB1dGVfZW5naW5lIjogImF6dXJlX2RhdGFicmlja3MiLCAic3BhcmsubmFidS5zb2xyX2JhdGNoX3NpemUiOiAiMTAwMDAiLCAic3BhcmsubmFidS5hcHBsaWNhdGlvbl9uYW1lIjogIm5hYnUtc3Bhcmtib3QtaW5nZXN0aW9uIiwgInNwYXJrLmRyaXZlci5uYWJ1X3ByaXZhdGVLZXkiOiAiL2RiZnMvdG1wL2Rldi12My0xLTItMC9uYWJ1LzE3MDAwNjY0MzgxMjY0MjQxLzAvcHJpdmF0ZUtleSIsICJzcGFyay5kcml2ZXIuc291cmNlX2F3c19lbmRQb2ludCI6ICJzMy5hbWF6b25hd3MuY29tIiwgInNwYXJrLmRyaXZlci50YXJnZXRfYXdzX2VuZFBvaW50IjogInMzLmFtYXpvbmF3cy5jb20iLCAic3BhcmsubmFidS5jb21wdXRlX2VuZ2luZV9saWJzX3BhdGgiOiAiL2RiZnMvdG1wL2Rldi12My0xLTItMC9uYWJ1LzE3MDAwNjY0MzgxMjY0MjQxLzAvYXBwbGljYXRpb24uY29uZiJ9Cn0= ewogICJjcmVkZW50aWFsX2lkIjogIjQxIiwKICAiY3JlZGVudGlhbF90eXBlX2lkIjogIjE1IiwKICAiY3JlZGVudGlhbF90eXBlIjogIkZpbGUgQ29udGVudCIsCiAgInRva2VuIjogImM2OTUwNTgyYTEyYjU1OGFiNjQ4Y2RiNzIwMDgxNzNiMmU4NDI4ZmI1NWRhYWQ3NDAxNTIyNTY5MWVlYzc4ZWU3YjVjNGUzNDMxMmRlZDcwYWU1ZTdlZTQ4M2I3ZDdlYTBjMjNlMjRlNDU4ZWQxZjU0ZGEzY2NkN2RiY2ZlODcwYTYxZTVjOWM1MDg3ZTdmYjZkYzE2YjZmOGY1ZTRiZWRlNGMwZTAzYjNkYjZhZmE3YjcyOWNiOWJjYTgxMDNjYmU0YjFiY2QyYmM1YjMyYzI0ODI3ZmRmOTFjOGMxMWNmMzZiZjUxNzFhOTk2MmMxY2E1NGY4ZWM4NDIwNjdhODQ4YjkyM2M2OWQyOTljNmI3NTI0YzA5NTQyOTMwNDAzMDlhMWY4ZmQzOWY3ODJkMWJkODY0M2YzMmE2NWZhMzU3MDU2ZWJkZjBkNTQ5ZTIwZjBmMWEwNTZlODEyNjM4MjM0YTRmNTVlMDU5N2YwNmFlN2Y0NzAwNjQ1YzBmMmQ4NzlhMDJkNTUyNGVhMjM0YzIwZDllZWY0NmQxNWZlZGJhNWJmOTVlNmJiODMwZmFjZGNhYWUxNzA2ZmNhNjE4MGJkYjAwMzVhOTNlMjRkNTc1NGY3ZDJmOGMzMzU4YmJhYmNiNWM5ZjJkZGJhMGFhOTk4Y2Y5OWNkMThjYzllOTE4YzBjOTdjOTgxZWZlYzNlZmI3MmI1Y2I1NTcwMGNiMWU4Mjk5MzA3YjI4OGE3ODRiODA2Yjg0OTMzNjc1NDRkZTk5NzM5ZjI0YTk2NDU0ZWU3MTkyMTBlYmQyNzNlMzQzNmE0MjU4NDI4MGEyMzA2MDljM2E1NmI3ZGU2NmFhYWRkNGVlMDY1N2Q0NTc1YmI2OTIwMDEyZmJmZWRiNjZhZjI0NGQ1MTk5MjVmYzNlNDRhZjJmNGJhNjc0ZGMzM2JjMmVlNGRiMmY0YWZmM2U5ZWJkNGVhNjVhMTY3NmFkYWM4ZjRhMDY0NzllOGE0NTQ3ZWVlOGU0ZTJjMzliMDE1YmQ3ZjgxNGMzODhjMDU1MWQzZjIyYWZkMTIxYmRmY2VmOTY5Y2Q3MWQ2YjdiMzUwYmUxNzYxZDU5YjY1MDMyY2NkYmRhNzE4Njg2NjA1YWE4ZjQ3NTBmYzI3Mjg1OTNkOTJkOWFkZjVmODRlZDUzYTA3OWQ2MDlkMDc2MmQ1NGQ3MDI0NWZiMmVmMjI0OTM1Nzk3OGIzNDIyMGExYzhjNDUzMjJlZjRkZWRhYzExNGE4Yzk2YTU1OWQzYWVjMzJmM2U2MTNmYThlZWFmZjAyOGE4MzdiYjEyYWIwZWM2MjU0MDE4MTA2YzY1NGVjYjc4M2Q0ZWQzMzM5MGRjNjhhZDgzYmU4ZWI4OGUzYjcxNGM0MDUzMjIwOTk0MjM3NjY5MDkzMGY3ZDc0OGUxYTRiMTk3NDk0NjYzNTA5OTNiMmU1YjQyZGI0NTIyYmNhMTNhNmE5YzVkMjYzMzg0OGRmODEzZDMwNzdlN2JhNzgwNTI4OWZlMDQ2YjUwMDkxOTk1ZDQ2YzA3YTBjODEzNjY2NzFiNzQxNTJiNWIzZjcwYmM4IiwKICAiY3JlZGVudGlhbF9lbmRwb2ludF91cmwiOiAiaHR0cDovL2Rldi1kaGEuaHVtYW5hLmNvbTo4ODg5L2ZpcmVzaG90cy9jcmVkZW50aWFsc0ZldGNoV2ViU2VydmljZSIsCiAgImZpbGVfcGF0aCI6ICIxNTY4XzI2MV8xNzAwMDY2NDM4MDIzOTk1MiIsCiAgImNyZWRlbnRpYWxfZmlsZV9wYXR0ZXJuIiA6ICI0MV8xNjk5MzQyNTc1Igp9 ewogICJjbHVzdGVyX2lkIjogIjA5MjItMDAzMTM4LW9ybjlyMHRlIiwKICAiY2x1c3Rlcl9yZWdpb24iOiAibnVsbCIsCiAgImNvbXB1dGVfZW5nX2NyZWRzX2pzb24iOiAiZXdvZ0lDSmpjbVZrWlc1MGFXRnNYMmxrSWpvZ0lqUXhJaXdLSUNBaVkzSmxaR1Z1ZEdsaGJGOTBlWEJsWDJsa0lqb2dJakUxSWl3S0lDQWlZM0psWkdWdWRHbGhiRjkwZVhCbElqb2dJa1pwYkdVZ1EyOXVkR1Z1ZENJc0NpQWdJblJ2YTJWdUlqb2dJbU0yT1RVd05UZ3lZVEV5WWpVMU9HRmlOalE0WTJSaU56SXdNRGd4TnpOaU1tVTROREk0Wm1JMU5XUmhZV1EzTkRBeE5USXlOVFk1TVdWbFl6YzRaV1UzWWpWak5HVXpORE14TW1SbFpEY3dZV1UxWlRkbFpUUTRNMkkzWkRkbFlUQmpNak5sTWpSbE5EVTRaV1F4WmpVMFpHRXpZMk5rTjJSaVkyWmxPRGN3WVRZeFpUVmpPV00xTURnM1pUZG1ZalprWXpFMllqWm1PR1kxWlRSaVpXUmxOR013WlRBellqTmtZalpoWm1FM1lqY3lPV05pT1dKallUZ3hNRE5qWW1VMFlqRmlZMlF5WW1NMVlqTXlZekkwT0RJM1ptUm1PVEZqT0dNeE1XTm1NelppWmpVeE56RmhPVGsyTW1NeFkyRTFOR1k0WldNNE5ESXdOamRoT0RRNFlqa3lNMk0yT1dReU9UbGpObUkzTlRJMFl6QTVOVFF5T1RNd05EQXpNRGxoTVdZNFptUXpPV1kzT0RKa01XSmtPRFkwTTJZek1tRTJOV1poTXpVM01EVTJaV0prWmpCa05UUTVaVEl3WmpCbU1XRXdOVFpsT0RFeU5qTTRNak0wWVRSbU5UVmxNRFU1TjJZd05tRmxOMlkwTnpBd05qUTFZekJtTW1RNE56bGhNREprTlRVeU5HVmhNak0wWXpJd1pEbGxaV1kwTm1ReE5XWmxaR0poTldKbU9UVmxObUppT0RNd1ptRmpaR05oWVdVeE56QTJabU5oTmpFNE1HSmtZakF3TXpWaE9UTmxNalJrTlRjMU5HWTNaREptT0dNek16VTRZbUpoWW1OaU5XTTVaakprWkdKaE1HRmhPVGs0WTJZNU9XTmtNVGhqWXpsbE9URTRZekJqT1Rkak9UZ3haV1psWXpObFptSTNNbUkxWTJJMU5UY3dNR05pTVdVNE1qazVNekEzWWpJNE9HRTNPRFJpT0RBMllqZzBPVE16TmpjMU5EUmtaVGs1TnpNNVpqSTBZVGsyTkRVMFpXVTNNVGt5TVRCbFltUXlOek5sTXpRek5tRTBNalU0TkRJNE1HRXlNekEyTURsak0yRTFObUkzWkdVMk5tRmhZV1JrTkdWbE1EWTFOMlEwTlRjMVltSTJPVEl3TURFeVptSm1aV1JpTmpaaFpqSTBOR1ExTVRrNU1qVm1Zek5sTkRSaFpqSm1OR0poTmpjMFpHTXpNMkpqTW1WbE5HUmlNbVkwWVdabU0yVTVaV0prTkdWaE5qVmhNVFkzTm1Ga1lXTTRaalJoTURZME56bGxPR0UwTlRRM1pXVmxPR1UwWlRKak16bGlNREUxWW1RM1pqZ3hOR016T0Roak1EVTFNV1F6WmpJeVlXWmtNVEl4WW1SbVkyVm1PVFk1WTJRM01XUTJZamRpTXpVd1ltVXhOell4WkRVNVlqWTFNRE15WTJOa1ltUmhOekU0TmpnMk5qQTFZV0U0WmpRM05UQm1ZekkzTWpnMU9UTmtPVEprT1dGa1pqVm1PRFJsWkRVellUQTNPV1EyTURsa01EYzJNbVExTkdRM01ESTBOV1ppTW1WbU1qSTBPVE0xTnprM09HSXpOREl5TUdFeFl6aGpORFV6TWpKbFpqUmtaV1JoWXpFeE5HRTRZemsyWVRVMU9XUXpZV1ZqTXpKbU0yVTJNVE5tWVRobFpXRm1aakF5T0dFNE16ZGlZakV5WVdJd1pXTTJNalUwTURFNE1UQTJZelkxTkdWallqYzRNMlEwWldRek16TTVNR1JqTmpoaFpEZ3pZbVU0WldJNE9HVXpZamN4TkdNME1EVXpNakl3T1RrME1qTTNOalk1TURrek1HWTNaRGMwT0dVeFlUUmlNVGszTkRrME5qWXpOVEE1T1ROaU1tVTFZalF5WkdJME5USXlZbU5oTVROaE5tRTVZelZrTWpZek16ZzBPR1JtT0RFelpETXdOemRsTjJKaE56Z3dOVEk0T1dabE1EUTJZalV3TURreE9UazFaRFEyWXpBM1lUQmpPREV6TmpZMk56RmlOelF4TlRKaU5XSXpaamN3WW1NNElpd0tJQ0FpWTNKbFpHVnVkR2xoYkY5bGJtUndiMmx1ZEY5MWNtd2lPaUFpYUhSMGNEb3ZMMlJsZGkxa2FHRXVhSFZ0WVc1aExtTnZiVG80T0RnNUwyWnBjbVZ6YUc5MGN5OWpjbVZrWlc1MGFXRnNjMFpsZEdOb1YyVmlVMlZ5ZG1salpTSXNDaUFnSW1acGJHVmZjR0YwYUNJNklDSXhOVFk0WHpJMk1WOHhOekF3TURZMk5ETTRNREl6T1RrMU1pSXNDaUFnSW1OeVpXUmxiblJwWVd4ZlptbHNaVjl3WVhSMFpYSnVJaUE2SUNJME1WOHhOams1TXpReU5UYzFJZ3A5IiwKICAiczNfcGF0aCI6ICIiLAogICJiNjRfaW5wdXRfanNvbiI6ICJld29pY0hKdlkyVnpjMGxrSWpveE56QXdNRFkyTkRNNE1USTJOREkwTVN3S0ltUmhkR0Z3YkdGalpVbGtJam8wTWl3S0luUmhZbXhsU1dRaU9qTTNNak0wTEFvaVpHRjBZVzF2ZG1WdFpXNTBTV1FpT2pJMk1Td0tJbXB2WWxOamFHVmtkV3hsWkZWelpYSkpaQ0k2SWsxaGJtRnpkMmx1YVNCRGFHbHVkR2hoYkdGd2RXUnBJaXdLSW1wdllsTmphR1ZrZFd4bFNXUWlPakUxTmpnc0NpSmlZWFJqYUVsa0lqb3hOekF3TURZMk5ETTRNREl6T1RrMU1pd0tJbXhoYzNSU2RXNVVhVzFsYzNSaGJYQWlPaUl5TURJekxURXhMVEEzSURFeU9qUXlPakF3TGpnMk16WTFJaXdLSW5KbGRISjVUblZ0SWpvZ0lqQWlDbjA9IiwKICAiZXh0cmFfY29uZmlnIjogImV3b2laWGgwY21GRGIyNW1hV2ROWVhBaU9pQjdJbk53WVhKckxtNWhZblV1Wm1WMFkyaGZjMmw2WlNJNklDSXhNREF3TUNJc0lDSnpjR0Z5YXk1dVlXSjFMbU52YlhCMWRHVmZaVzVuYVc1bElqb2dJbUY2ZFhKbFgyUmhkR0ZpY21samEzTWlMQ0FpYzNCaGNtc3VibUZpZFM1emIyeHlYMkpoZEdOb1gzTnBlbVVpT2lBaU1UQXdNREFpTENBaWMzQmhjbXN1Ym1GaWRTNWhjSEJzYVdOaGRHbHZibDl1WVcxbElqb2dJbTVoWW5VdGMzQmhjbXRpYjNRdGFXNW5aWE4wYVc5dUlpd2dJbk53WVhKckxtUnlhWFpsY2k1dVlXSjFYM0J5YVhaaGRHVkxaWGtpT2lBaUwyUmlabk12ZEcxd0wyUmxkaTEyTXkweExUSXRNQzl1WVdKMUx6RTNNREF3TmpZME16Z3hNalkwTWpReEx6QXZjSEpwZG1GMFpVdGxlU0lzSUNKemNHRnlheTVrY21sMlpYSXVjMjkxY21ObFgyRjNjMTlsYm1SUWIybHVkQ0k2SUNKek15NWhiV0Y2YjI1aGQzTXVZMjl0SWl3Z0luTndZWEpyTG1SeWFYWmxjaTUwWVhKblpYUmZZWGR6WDJWdVpGQnZhVzUwSWpvZ0luTXpMbUZ0WVhwdmJtRjNjeTVqYjIwaUxDQWljM0JoY21zdWJtRmlkUzVqYjIxd2RYUmxYMlZ1WjJsdVpWOXNhV0p6WDNCaGRHZ2lPaUFpTDJSaVpuTXZkRzF3TDJSbGRpMTJNeTB4TFRJdE1DOXVZV0oxTHpFM01EQXdOalkwTXpneE1qWTBNalF4THpBdllYQndiR2xqWVhScGIyNHVZMjl1WmlKOUNuMD0iLAogICJiYXRjaF9pZCI6IDE3MDAwNjY0MzgwMjM5OTUyLAogICJyZXRyeV9udW0iOiAiMCIsCiAgInNwYXJrX2NvbmZpZ3MiOiAiZXdvZ0lDQWdJbk52YkhKZlltRjBZMmhmYzJsNlpTSTZJakV3TURBd0lpd2ljR0Z5WVd4c1pXeGZkR2h5WldGa2N5STZJakV3SWl3aVptVjBZMmhmYzJsNlpTSTZJakV3TURBd0lnb2dJQ0FnZlE9PSIsCiAgImlzX2J1Y2tldF9lbmNyeXB0ZWQiOiAiIiwKICAiYjY0X2V4dGVybmFsX2phcnNfbWFwIiA6ICIiCn0= null /dbfs/tmp ewoiY2x1c3Rlcl9pZCI6ICIiLAoiYjY0X2lucHV0X2pzb24iOiAiZXdvaWNISnZZMlZ6YzBsa0lqb3hOekF3TURZMk5ETTRNVEkyTkRJME1Td0tJbVJoZEdGd2JHRmpaVWxrSWpvME1pd0tJblJoWW14bFNXUWlPak0zTWpNMExBb2laR0YwWVcxdmRtVnRaVzUwU1dRaU9qSTJNU3dLSW1wdllsTmphR1ZrZFd4bFpGVnpaWEpKWkNJNklrMWhibUZ6ZDJsdWFTQkRhR2x1ZEdoaGJHRndkV1JwSWl3S0ltcHZZbE5qYUdWa2RXeGxTV1FpT2pFMU5qZ3NDaUppWVhSamFFbGtJam94TnpBd01EWTJORE00TURJek9UazFNaXdLSW14aGMzUlNkVzVVYVcxbGMzUmhiWEFpT2lJeU1ESXpMVEV4TFRBM0lERXlPalF5T2pBd0xqZzJNelkxSWl3S0luSmxkSEo1VG5WdElqb2dJakFpQ24wPSIsCiJleHRyYV9jb25maWciOiAiZXdvaVpYaDBjbUZEYjI1bWFXZE5ZWEFpT2lCN0luTndZWEpyTG01aFluVXVabVYwWTJoZmMybDZaU0k2SUNJeE1EQXdNQ0lzSUNKemNHRnlheTV1WVdKMUxtTnZiWEIxZEdWZlpXNW5hVzVsSWpvZ0ltRjZkWEpsWDJSaGRHRmljbWxqYTNNaUxDQWljM0JoY21zdWJtRmlkUzV6YjJ4eVgySmhkR05vWDNOcGVtVWlPaUFpTVRBd01EQWlMQ0FpYzNCaGNtc3VibUZpZFM1aGNIQnNhV05oZEdsdmJsOXVZVzFsSWpvZ0ltNWhZblV0YzNCaGNtdGliM1F0YVc1blpYTjBhVzl1SWl3Z0luTndZWEpyTG1SeWFYWmxjaTV1WVdKMVgzQnlhWFpoZEdWTFpYa2lPaUFpTDJSaVpuTXZkRzF3TDJSbGRpMTJNeTB4TFRJdE1DOXVZV0oxTHpFM01EQXdOalkwTXpneE1qWTBNalF4THpBdmNISnBkbUYwWlV0bGVTSXNJQ0p6Y0dGeWF5NWtjbWwyWlhJdWMyOTFjbU5sWDJGM2MxOWxibVJRYjJsdWRDSTZJQ0p6TXk1aGJXRjZiMjVoZDNNdVkyOXRJaXdnSW5Od1lYSnJMbVJ5YVhabGNpNTBZWEpuWlhSZllYZHpYMlZ1WkZCdmFXNTBJam9nSW5NekxtRnRZWHB2Ym1GM2N5NWpiMjBpTENBaWMzQmhjbXN1Ym1GaWRTNWpiMjF3ZFhSbFgyVnVaMmx1WlY5c2FXSnpYM0JoZEdnaU9pQWlMMlJpWm5NdmRHMXdMMlJsZGkxMk15MHhMVEl0TUM5dVlXSjFMekUzTURBd05qWTBNemd4TWpZME1qUXhMekF2WVhCd2JHbGpZWFJwYjI0dVkyOXVaaUo5Q24wPSIsCiJjb21wdXRlX2VuZ19jcmVkc19qc29uIiA6ICJld29nSUNKamNtVmtaVzUwYVdGc1gybGtJam9nSWpReElpd0tJQ0FpWTNKbFpHVnVkR2xoYkY5MGVYQmxYMmxrSWpvZ0lqRTFJaXdLSUNBaVkzSmxaR1Z1ZEdsaGJGOTBlWEJsSWpvZ0lrWnBiR1VnUTI5dWRHVnVkQ0lzQ2lBZ0luUnZhMlZ1SWpvZ0ltTTJPVFV3TlRneVlURXlZalUxT0dGaU5qUTRZMlJpTnpJd01EZ3hOek5pTW1VNE5ESTRabUkxTldSaFlXUTNOREF4TlRJeU5UWTVNV1ZsWXpjNFpXVTNZalZqTkdVek5ETXhNbVJsWkRjd1lXVTFaVGRsWlRRNE0ySTNaRGRsWVRCak1qTmxNalJsTkRVNFpXUXhaalUwWkdFelkyTmtOMlJpWTJabE9EY3dZVFl4WlRWak9XTTFNRGczWlRkbVlqWmtZekUyWWpabU9HWTFaVFJpWldSbE5HTXdaVEF6WWpOa1lqWmhabUUzWWpjeU9XTmlPV0pqWVRneE1ETmpZbVUwWWpGaVkyUXlZbU0xWWpNeVl6STBPREkzWm1SbU9URmpPR014TVdObU16WmlaalV4TnpGaE9UazJNbU14WTJFMU5HWTRaV000TkRJd05qZGhPRFE0WWpreU0yTTJPV1F5T1Rsak5tSTNOVEkwWXpBNU5UUXlPVE13TkRBek1EbGhNV1k0Wm1Rek9XWTNPREprTVdKa09EWTBNMll6TW1FMk5XWmhNelUzTURVMlpXSmtaakJrTlRRNVpUSXdaakJtTVdFd05UWmxPREV5TmpNNE1qTTBZVFJtTlRWbE1EVTVOMll3Tm1GbE4yWTBOekF3TmpRMVl6Qm1NbVE0TnpsaE1ESmtOVFV5TkdWaE1qTTBZekl3WkRsbFpXWTBObVF4TldabFpHSmhOV0ptT1RWbE5tSmlPRE13Wm1GalpHTmhZV1V4TnpBMlptTmhOakU0TUdKa1lqQXdNelZoT1RObE1qUmtOVGMxTkdZM1pESm1PR016TXpVNFltSmhZbU5pTldNNVpqSmtaR0poTUdGaE9UazRZMlk1T1dOa01UaGpZemxsT1RFNFl6QmpPVGRqT1RneFpXWmxZek5sWm1JM01tSTFZMkkxTlRjd01HTmlNV1U0TWprNU16QTNZakk0T0dFM09EUmlPREEyWWpnME9UTXpOamMxTkRSa1pUazVOek01WmpJMFlUazJORFUwWldVM01Ua3lNVEJsWW1ReU56TmxNelF6Tm1FME1qVTROREk0TUdFeU16QTJNRGxqTTJFMU5tSTNaR1UyTm1GaFlXUmtOR1ZsTURZMU4yUTBOVGMxWW1JMk9USXdNREV5Wm1KbVpXUmlOalpoWmpJME5HUTFNVGs1TWpWbVl6TmxORFJoWmpKbU5HSmhOamMwWkdNek0ySmpNbVZsTkdSaU1tWTBZV1ptTTJVNVpXSmtOR1ZoTmpWaE1UWTNObUZrWVdNNFpqUmhNRFkwTnpsbE9HRTBOVFEzWldWbE9HVTBaVEpqTXpsaU1ERTFZbVEzWmpneE5HTXpPRGhqTURVMU1XUXpaakl5WVdaa01USXhZbVJtWTJWbU9UWTVZMlEzTVdRMllqZGlNelV3WW1VeE56WXhaRFU1WWpZMU1ETXlZMk5rWW1SaE56RTROamcyTmpBMVlXRTRaalEzTlRCbVl6STNNamcxT1ROa09USmtPV0ZrWmpWbU9EUmxaRFV6WVRBM09XUTJNRGxrTURjMk1tUTFOR1EzTURJME5XWmlNbVZtTWpJME9UTTFOemszT0dJek5ESXlNR0V4WXpoak5EVXpNakpsWmpSa1pXUmhZekV4TkdFNFl6azJZVFUxT1dRellXVmpNekptTTJVMk1UTm1ZVGhsWldGbVpqQXlPR0U0TXpkaVlqRXlZV0l3WldNMk1qVTBNREU0TVRBMll6WTFOR1ZqWWpjNE0yUTBaV1F6TXpNNU1HUmpOamhoWkRnelltVTRaV0k0T0dVellqY3hOR00wTURVek1qSXdPVGswTWpNM05qWTVNRGt6TUdZM1pEYzBPR1V4WVRSaU1UazNORGswTmpZek5UQTVPVE5pTW1VMVlqUXlaR0kwTlRJeVltTmhNVE5oTm1FNVl6VmtNall6TXpnME9HUm1PREV6WkRNd056ZGxOMkpoTnpnd05USTRPV1psTURRMllqVXdNRGt4T1RrMVpEUTJZekEzWVRCak9ERXpOalkyTnpGaU56UXhOVEppTldJelpqY3dZbU00SWl3S0lDQWlZM0psWkdWdWRHbGhiRjlsYm1Sd2IybHVkRjkxY213aU9pQWlhSFIwY0RvdkwyUmxkaTFrYUdFdWFIVnRZVzVoTG1OdmJUbzRPRGc1TDJacGNtVnphRzkwY3k5amNtVmtaVzUwYVdGc2MwWmxkR05vVjJWaVUyVnlkbWxqWlNJc0NpQWdJbVpwYkdWZmNHRjBhQ0k2SUNJeE5UWTRYekkyTVY4eE56QXdNRFkyTkRNNE1ESXpPVGsxTWlJc0NpQWdJbU55WldSbGJuUnBZV3hmWm1sc1pWOXdZWFIwWlhKdUlpQTZJQ0kwTVY4eE5qazVNelF5TlRjMUlncDkiLAoiY2x1c3Rlcl91aSI6ICIiLAoicmV0cnlfbnVtIjogIjAiLAoic3BhcmtfY29uZmlncyI6ICJld29nSUNBZ0luTnZiSEpmWW1GMFkyaGZjMmw2WlNJNklqRXdNREF3SWl3aWNHRnlZV3hzWld4ZmRHaHlaV0ZrY3lJNklqRXdJaXdpWm1WMFkyaGZjMmw2WlNJNklqRXdNREF3SWdvZ0lDQWdmUT09IiwKImI2NF9oaXZlX2NyZWRzX2pzb24iOiAiZXdvZ0lDSmpjbVZrWlc1MGFXRnNYMmxrSWpvZ0lpSXNDaUFnSW1OeVpXUmxiblJwWVd4ZmRIbHdaVjlwWkNJNklDSWlMQW9nSUNKMGIydGxiaUk2SUNKak5qazFNRFU0TW1FeE1tSTFOVGhoWWpZME9HTmtZamN5TURBNE1UY3pZakpsT0RReU9HWmlOVFZrWVdGa056UXdNVFV5TWpVMk9URmxaV00zT0dWbE4ySTFZelJsTXpRek1USmtaV1EzTUdGbE5XVTNaV1UwT0ROaU4yUTNaV0V3WXpJelpUSTBaVFExT0dWa01XWTFOR1JoTTJOalpEZGtZbU5tWlRnM01HRTJNV1UxWXpsak5UQTROMlUzWm1JMlpHTXhObUkyWmpobU5XVTBZbVZrWlRSak1HVXdNMkl6WkdJMllXWmhOMkkzTWpsallqbGlZMkU0TVRBelkySmxOR0l4WW1Oa01tSmpOV0l6TW1NeU5EZ3lOMlprWmpreFl6aGpNVEZqWmpNMlltWTFNVGN4WVRrNU5qSmpNV05oTlRSbU9HVmpPRFF5TURZM1lUZzBPR0k1TWpOak5qbGtNams1WXpaaU56VXlOR013T1RVME1qa3pNRFF3TXpBNVlURm1PR1prTXpsbU56Z3laREZpWkRnMk5ETm1NekpoTmpWbVlUTTFOekExTm1WaVpHWXdaRFUwT1dVeU1HWXdaakZoTURVMlpUZ3hNall6T0RJek5HRTBaalUxWlRBMU9UZG1NRFpoWlRkbU5EY3dNRFkwTldNd1pqSmtPRGM1WVRBeVpEVTFNalJsWVRJek5HTXlNR1E1WldWbU5EWmtNVFZtWldSaVlUVmlaamsxWlRaaVlqZ3pNR1poWTJSallXRmxNVGN3Tm1aallUWXhPREJpWkdJd01ETTFZVGt6WlRJMFpEVTNOVFJtTjJReVpqaGpNek0xT0dKaVlXSmpZalZqT1dZeVpHUmlZVEJoWVRrNU9HTm1PVGxqWkRFNFkyTTVaVGt4T0dNd1l6azNZems0TVdWbVpXTXpaV1ppTnpKaU5XTmlOVFUzTURCallqRmxPREk1T1RNd04ySXlPRGhoTnpnMFlqZ3dObUk0TkRrek16WTNOVFEwWkdVNU9UY3pPV1l5TkdFNU5qUTFOR1ZsTnpFNU1qRXdaV0prTWpjelpUTTBNelpoTkRJMU9EUXlPREJoTWpNd05qQTVZek5oTlRaaU4yUmxOalpoWVdGa1pEUmxaVEEyTlRka05EVTNOV0ppTmpreU1EQXhNbVppWm1Wa1lqWTJZV1l5TkRSa05URTVPVEkxWm1NelpUUTBZV1l5WmpSaVlUWTNOR1JqTXpOaVl6SmxaVFJrWWpKbU5HRm1aak5sT1dWaVpEUmxZVFkxWVRFMk56WmhaR0ZqT0dZMFlUQTJORGM1WlRoaE5EVTBOMlZsWlRobE5HVXlZek01WWpBeE5XSmtOMlk0TVRSak16ZzRZekExTlRGa00yWXlNbUZtWkRFeU1XSmtabU5sWmprMk9XTmtOekZrTm1JM1lqTTFNR0psTVRjMk1XUTFPV0kyTlRBek1tTmpaR0prWVRjeE9EWTROall3TldGaE9HWTBOelV3Wm1NeU56STROVGt6WkRreVpEbGhaR1kxWmpnMFpXUTFNMkV3Tnpsa05qQTVaREEzTmpKa05UUmtOekF5TkRWbVlqSmxaakl5TkRrek5UYzVOemhpTXpReU1qQmhNV000WXpRMU16SXlaV1kwWkdWa1lXTXhNVFJoT0dNNU5tRTFOVGxrTTJGbFl6TXlaak5sTmpFelptRTRaV1ZoWm1Zd01qaGhPRE0zWW1JeE1tRmlNR1ZqTmpJMU5EQXhPREV3Tm1NMk5UUmxZMkkzT0ROa05HVmtNek16T1RCa1l6WTRZV1E0TTJKbE9HVmlPRGhsTTJJM01UUmpOREExTXpJeU1EazVOREl6TnpZMk9UQTVNekJtTjJRM05EaGxNV0UwWWpFNU56UTVORFkyTXpVd09Ua3pZakpsTldJME1tUmlORFV5TW1KallURXpZVFpoT1dNMVpESTJNek00TkRoa1pqZ3hNMlF6TURjM1pUZGlZVGM0TURVeU9EbG1aVEEwTm1JMU1EQTVNVGs1TldRME5tTXdOMkV3WXpneE16WTJOamN4WWpjME1UVXlZalZpTTJZM01HSmpPQ0lzQ2lBZ0ltTnlaV1JsYm5ScFlXeGZaVzVrY0c5cGJuUmZkWEpzSWpvZ0ltaDBkSEE2THk5a1pYWXRaR2hoTG1oMWJXRnVZUzVqYjIwNk9EZzRPUzltYVhKbGMyaHZkSE12WTNKbFpHVnVkR2xoYkhOR1pYUmphRmRsWWxObGNuWnBZMlVpQ24wPSIsCiJiYXRjaF9pZCI6MTcwMDA2NjQzODAyMzk5NTIsCiJwcm9jZXNzX2lkIiA6MTcwMDA2NjQzODEyNjQyNDEsCiJyZXN0X3VybCI6ICIiLAoiYjY0X2V4dGVybmFsX2phcnNfbWFwIiA6ICIiCn0= null ewoicGlwZWxpbmVfdGltZW91dCIgOiAyMwp9]
""2023-11-15 16:41:19.995 [Thread-68] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id d12340fe-aac8-403b-9f0e-dee87d62ef3e has started processing message with message_id 6a3e3126-b3d8-47fd-906e-37832245e778 and thread_id 140 
""2023-11-15 16:41:19.995 [Thread-68] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:41:19.995 [Thread-68] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=3cc69581-bcec-4220-ade0-259dc4327992, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=6a3e3126-b3d8-47fd-906e-37832245e778, task_retry_intervals_secs=[], bot_id=a59f4834-1892-4126-b8f2-fa70013de55d, message_topic=nabu_2_taskmonitor, tags={process_id=17000664381264241, initial_ts=1700066438126, batch_name=Ingestion_20231115, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot, KoshBot, DBOpsBot, DBOpsBot, KoshBot, TaskMonitorBot]}}
""2023-11-15 16:41:20.008 [Thread-68] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 17000664381264241, 'SparkScriptBot', 'run_almaren_ingestion_job_using_spark', 'run_almaren_ingestion_job_using_spark', 10 , TO_TIMESTAMP(1700066479618::double precision / 1000) ,'a59f4834-1892-4126-b8f2-fa70013de55d');
""2023-11-15 16:41:20.008 [Thread-68] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id d12340fe-aac8-403b-9f0e-dee87d62ef3e has started process logic with message_id 6a3e3126-b3d8-47fd-906e-37832245e778 and thread_id 140
""2023-11-15 16:41:20.097 [Thread-68] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id d12340fe-aac8-403b-9f0e-dee87d62ef3e has finished process logic with message_id 6a3e3126-b3d8-47fd-906e-37832245e778 and thread_id 140
""2023-11-15 16:41:20.097 [Thread-68] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:41:20.098 [Thread-68] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 6a3e3126-b3d8-47fd-906e-37832245e778
""2023-11-15 16:41:21.504 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - spark engine is azure_databricks
""2023-11-15 16:41:21.600 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:21,600] 	 INFO:[+] Logging nabu-sparkbot-ingestion Job 
""2023-11-15 16:41:23.354 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:23,352] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-profiler-assembly-jar-3-1-2-12/nabu-sparkbot-profiler-v0.6.1-3.1.jar from libraries
""2023-11-15 16:41:24.495 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:24,495] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-profiler-assembly-jar-3-1-2-12/postgresql-42.2.8.jar from libraries
""2023-11-15 16:41:25.649 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:25,648] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-profiler-assembly-jar-3-1-2-12/carolina-jdbc-2.4.4.jar from libraries
""2023-11-15 16:41:26.764 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:26,763] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-profiler-assembly-jar-3-1-2-12/spark-bigquery-with-dependencies_2.12-0.24.2.jar from libraries
""2023-11-15 16:41:27.921 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:27,919] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-profiler-assembly-jar-3-1-2-12/snowflake-jdbc-3.13.10.jar from libraries
""2023-11-15 16:41:29.103 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:29,102] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-profiler-assembly-jar-3-1-2-12/ngdbc-2.11.17.jar from libraries
""2023-11-15 16:41:30.183 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:30,183] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-profiler-assembly-jar-3-1-2-12/mongo-spark-connector-10.0.5.jar from libraries
""2023-11-15 16:41:31.350 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:31,348] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-profiler-assembly-jar-3-1-2-12/terajdbc-20.00.00.10.jar from libraries
""2023-11-15 16:41:32.452 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:32,451] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-profiler-assembly-jar-3-1-2-12/jcc-11.5.8.0.jar from libraries
""2023-11-15 16:41:33.688 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:33,688] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-profiler-assembly-jar-3-1-2-12/vertica-jdbc-12.0.2-0.jar from libraries
""2023-11-15 16:41:34.808 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:34,808] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-sparkbot-fuzzy-matching-jar-3-1-2-12/nabu-sparkbot-fuzzy-matching-v0.4.1-3.1.jar from libraries
""2023-11-15 16:41:35.880 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:35,879] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-sparkbot-fuzzy-matching-jar-3-1-2-12/postgresql-42.2.8.jar from libraries
""2023-11-15 16:41:36.967 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:36,967] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-index-bot-assembly-jar-3-1-2-12/nabu-sparkbot-index-v0.4.15-3.1.jar from libraries
""2023-11-15 16:41:38.089 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:38,087] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-index-bot-assembly-jar-3-1-2-12/carolina-jdbc-2.4.4.jar from libraries
""2023-11-15 16:41:39.200 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:39,198] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-index-bot-assembly-jar-3-1-2-12/spark-bigquery-with-dependencies_2.12-0.24.2.jar from libraries
""2023-11-15 16:41:40.326 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:40,326] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-index-bot-assembly-jar-3-1-2-12/snowflake-jdbc-3.13.10.jar from libraries
""2023-11-15 16:41:41.452 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:41,451] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-index-bot-assembly-jar-3-1-2-12/ngdbc-2.11.17.jar from libraries
""2023-11-15 16:41:42.604 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:42,603] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-index-bot-assembly-jar-3-1-2-12/mongo-spark-connector-10.0.5.jar from libraries
""2023-11-15 16:41:43.750 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:43,750] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-index-bot-assembly-jar-3-1-2-12/terajdbc-20.00.00.10.jar from libraries
""2023-11-15 16:41:44.846 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:44,846] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-index-bot-assembly-jar-3-1-2-12/jcc-11.5.8.0.jar from libraries
""2023-11-15 16:41:45.933 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:45,931] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-index-bot-assembly-jar-3-1-2-12/vertica-jdbc-12.0.2-0.jar from libraries
""2023-11-15 16:41:47.067 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:47,066] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-curation-dependency-jars-3-1/nabu-sparkbot-reflection-code-execution-v0.5.9-3.1.jar from libraries
""2023-11-15 16:41:48.194 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:48,192] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-curation-dependency-jars-3-1/hive-jdbc-1.0.jar from libraries
""2023-11-15 16:41:49.347 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:49,345] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-curation-dependency-jars-3-1/carolina-jdbc-2.4.4.jar from libraries
""2023-11-15 16:41:50.476 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:50,475] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-curation-dependency-jars-3-1/ojdbc6-11.2.0.4.jar from libraries
""2023-11-15 16:41:51.592 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:51,592] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-curation-dependency-jars-3-1/mssql-jdbc-8.2.0.jre8.jar from libraries
""2023-11-15 16:41:52.728 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:52,727] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-curation-dependency-jars-3-1/aws-java-sdk-1.11.163.jar from libraries
""2023-11-15 16:41:54.308 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:54,304] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-curation-dependency-jars-3-1/almaren-framework_2.12-0.9.9-3.1.jar from libraries
""2023-11-15 16:41:57.136 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:41:57,134] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-curation-dependency-jars-3-1/jdbcparallel-almaren_2.12-0.0.4-3.1.jar from libraries
""2023-11-15 16:42:00.782 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:00,778] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-curation-dependency-jars-3-1/postgresql-42.2.8.jar from libraries
""2023-11-15 16:42:03.505 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:03,503] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-curation-dependency-jars-3-1/mysql-connector-java-8.0.29.jar from libraries
""2023-11-15 16:42:04.623 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:04,622] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-curation-dependency-jars-3-1/jtds-1.3.1.jar from libraries
""2023-11-15 16:42:05.767 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:05,766] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-curation-dependency-jars-3-1/spark-bigquery-with-dependencies_2.12-0.24.2.jar from libraries
""2023-11-15 16:42:06.891 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:06,890] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-curation-dependency-jars-3-1/redshift-jdbc42-2.1.0.1.jar from libraries
""2023-11-15 16:42:08.012 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:08,011] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-curation-dependency-jars-3-1/snowflake-jdbc-3.13.10.jar from libraries
""2023-11-15 16:42:09.165 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:09,165] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-curation-dependency-jars-3-1/ngdbc-2.11.17.jar from libraries
""2023-11-15 16:42:10.319 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:10,318] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-curation-dependency-jars-3-1/terajdbc-20.00.00.10.jar from libraries
""2023-11-15 16:42:11.549 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:11,548] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-curation-dependency-jars-3-1/jcc-11.5.8.0.jar from libraries
""2023-11-15 16:42:12.716 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:12,715] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-curation-dependency-jars-3-1/mongo-spark-connector-10.0.5.jar from libraries
""2023-11-15 16:42:13.872 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:13,871] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-curation-dependency-jars-3-1/vertica-jdbc-12.0.2-0.jar from libraries
""2023-11-15 16:42:15.023 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:15,022] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-curation-dependency-jars-3-1/hive-jdbc-3.1.3.jar from libraries
""2023-11-15 16:42:16.125 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:16,124] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-curation-dependency-jars-3-1/hive-service-3.1.3.jar from libraries
""2023-11-15 16:42:17.253 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:17,252] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-curation-dependency-jars-3-1/hive-common-3.1.3.jar from libraries
""2023-11-15 16:42:18.372 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:18,370] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-curation-dependency-jars-3-1/hive-serde-3.1.3.jar from libraries
""2023-11-15 16:42:19.505 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:19,503] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-curation-dependency-jars-3-1/hive-service-rpc-3.1.3.jar from libraries
""2023-11-15 16:42:20.667 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:20,666] 	 INFO:[+] Removed dbfs:/tmp/dev-v3-1-2-0/nabu-spark-bot-curation-dependency-jars-3-1/libthrift-0.18.1.jar from libraries
""2023-11-15 16:42:21.905 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:21,904] 	 INFO:[+] Restarting cluster...
""2023-11-15 16:42:21.906 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:21,905] 	 INFO:[+] Checking resources
""2023-11-15 16:42:24.321 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:24,320] 	 INFO:[+] Resources are not available
""2023-11-15 16:42:24.321 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:24,320] 	 INFO:[+] Uploading the resources ....
""2023-11-15 16:42:25.540 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:25,539] 	 INFO:[+] Created Directory nabu-spark-bot-ingestion-dependency-jars-3-1 
""2023-11-15 16:42:38.949 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:38,948] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/2.12/nabu-sparkbot-reflection-code-execution-v0.5.9-3.1.jar
""2023-11-15 16:42:41.007 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:41,005] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/hive-jdbc-1.0.jar
""2023-11-15 16:42:42.663 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:42,661] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/carolina-jdbc-2.4.4.jar
""2023-11-15 16:42:44.485 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:44,483] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/com/oracle/database/jdbc/ojdbc6/11.2.0.4/ojdbc6-11.2.0.4.jar
""2023-11-15 16:42:46.083 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:46,082] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/com/microsoft/sqlserver/mssql-jdbc/8.2.0.jre8/mssql-jdbc-8.2.0.jre8.jar
""2023-11-15 16:42:47.425 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:47,424] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/com/amazonaws/aws-java-sdk/1.11.163/aws-java-sdk-1.11.163.jar
""2023-11-15 16:42:48.979 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:48,978] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/com/github/music-of-the-ainur/almaren-framework_2.12/0.9.9-3.1/almaren-framework_2.12-0.9.9-3.1.jar
""2023-11-15 16:42:50.742 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:50,740] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/jdbcparallel-almaren_2.12-0.0.4-3.1.jar
""2023-11-15 16:42:52.280 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:52,278] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/org/postgresql/postgresql/42.2.8/postgresql-42.2.8.jar
""2023-11-15 16:42:53.920 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:53,919] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/mysql/mysql-connector-java/8.0.29/mysql-connector-java-8.0.29.jar
""2023-11-15 16:42:55.348 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:55,347] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/net/sourceforge/jtds/jtds/1.3.1/jtds-1.3.1.jar
""2023-11-15 16:42:57.699 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:57,698] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/com/google/cloud/spark/spark-bigquery-with-dependencies_2.12/0.24.2/spark-bigquery-with-dependencies_2.12-0.24.2.jar
""2023-11-15 16:42:59.210 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:42:59,209] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/com/amazon/redshift/redshift-jdbc42/2.1.0.1/redshift-jdbc42-2.1.0.1.jar
""2023-11-15 16:43:01.354 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:43:01,353] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/net/snowflake/snowflake-jdbc/3.13.10/snowflake-jdbc-3.13.10.jar
""2023-11-15 16:43:03.027 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:43:03,025] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/com/sap/cloud/db/jdbc/ngdbc/2.11.17/ngdbc-2.11.17.jar
""2023-11-15 16:43:04.498 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:43:04,497] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/org/mongodb/spark/mongo-spark-connector/10.0.5/mongo-spark-connector-10.0.5.jar
""2023-11-15 16:43:06.073 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:43:06,072] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/com/teradata/jdbc/terajdbc/20.00.00.10/terajdbc-20.00.00.10.jar
""2023-11-15 16:43:07.694 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:43:07,693] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/com/ibm/db2/jcc/11.5.8.0/jcc-11.5.8.0.jar
""2023-11-15 16:43:09.242 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:43:09,241] 	 INFO:[+] Jar Uploaded successfully /opt/nabu/nabu-spark-bots/jars/https/repo1.maven.org/maven2/com/vertica/jdbc/vertica-jdbc/12.0.2-0/vertica-jdbc-12.0.2-0.jar
""2023-11-15 16:43:09.243 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:43:09,242] 	 INFO:[+] Uploaded the resources
""2023-11-15 16:43:09.243 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:43:09,242] 	 INFO:[+] Uploading temporary resources
""2023-11-15 16:43:11.912 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:43:11,911] 	 INFO:[+] Uploaded temporary resources /opt/nabu/nabu-spark-bots/azure_databricks/conf/small/application.conf
""2023-11-15 16:43:13.226 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:43:13,225] 	 INFO:[+] Uploaded temporary resources /opt/nabu/nabu-spark-bots/keys/privateKey
""2023-11-15 16:43:14.641 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:43:14,640] 	 INFO:[+] Uploaded temporary resources /opt/nabu/nabu-spark-bots/azure_databricks/conf/log4j.properties
""2023-11-15 16:43:14.641 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:43:14,640] 	 INFO:[+] Creating the Job_json for 17000664381264240
""2023-11-15 16:43:14.642 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:43:14,640] 	 INFO:[+] Creating reflection_job.json file
""2023-11-15 16:43:14.642 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:43:14,641] 	 INFO:[+] Creating the folder 17000664381264240/0
""2023-11-15 16:43:14.662 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:43:14,642] 	 INFO:[+] Job json file 17000664381264240/0/reflection_job.json successfully created
""2023-11-15 16:43:14.663 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:43:14,642] 	 INFO:[+] Creating the job for the file job_json
""2023-11-15 16:43:15.442 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - WARN: Your CLI is configured to use Jobs API 2.0. In order to use the latest Jobs features please upgrade to 2.1: 'databricks jobs configure --version=2.1'. Future versions of this CLI will default to the new Jobs API. Learn more at https://docs.databricks.com/dev-tools/cli/jobs-cli.html
""2023-11-15 16:43:15.932 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:43:15,931] 	 INFO:[+] Job id is 552259741091268
""2023-11-15 16:43:15.932 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:43:15,931] 	 INFO:[+] Running the job 552259741091268
""2023-11-15 16:43:16.797 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - WARN: Your CLI is configured to use Jobs API 2.0. In order to use the latest Jobs features please upgrade to 2.1: 'databricks jobs configure --version=2.1'. Future versions of this CLI will default to the new Jobs API. Learn more at https://docs.databricks.com/dev-tools/cli/jobs-cli.html
""2023-11-15 16:43:17.146 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:43:17,145] 	 INFO:[+] Run id is 1070407263625275
""2023-11-15 16:43:18.017 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - WARN: Your CLI is configured to use Jobs API 2.0. In order to use the latest Jobs features please upgrade to 2.1: 'databricks jobs configure --version=2.1'. Future versions of this CLI will default to the new Jobs API. Learn more at https://docs.databricks.com/dev-tools/cli/jobs-cli.html
""2023-11-15 16:43:18.314 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:43:18,312] 	 INFO:[+] Run page URL is https://adb-5839172005328472.12.azuredatabricks.net/?o=5839172005328472#job/552259741091268/run/1070407263625275
""2023-11-15 16:43:18.315 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:43:18,312] 	 INFO:[+] Inserting JOB details into kosh
""2023-11-15 16:43:18.573 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:43:18,572] 	 INFO:[+] Inserted job details into Kosh
""2023-11-15 16:43:19.457 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - WARN: Your CLI is configured to use Jobs API 2.0. In order to use the latest Jobs features please upgrade to 2.1: 'databricks jobs configure --version=2.1'. Future versions of this CLI will default to the new Jobs API. Learn more at https://docs.databricks.com/dev-tools/cli/jobs-cli.html
""2023-11-15 16:43:49.783 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:43:49,782] 	 INFO:[+] Job id 552259741091268 and run id 1070407263625275 is in PENDING Status
""2023-11-15 16:43:50.672 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - WARN: Your CLI is configured to use Jobs API 2.0. In order to use the latest Jobs features please upgrade to 2.1: 'databricks jobs configure --version=2.1'. Future versions of this CLI will default to the new Jobs API. Learn more at https://docs.databricks.com/dev-tools/cli/jobs-cli.html
""2023-11-15 16:44:21.051 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:44:21,049] 	 INFO:[+] Job id 552259741091268 and run id 1070407263625275 is in PENDING Status
""2023-11-15 16:44:21.900 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - WARN: Your CLI is configured to use Jobs API 2.0. In order to use the latest Jobs features please upgrade to 2.1: 'databricks jobs configure --version=2.1'. Future versions of this CLI will default to the new Jobs API. Learn more at https://docs.databricks.com/dev-tools/cli/jobs-cli.html
""2023-11-15 16:44:52.182 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:44:52,181] 	 INFO:[+] Job id 552259741091268 and run id 1070407263625275 is in RUNNING Status
""2023-11-15 16:44:53.029 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - WARN: Your CLI is configured to use Jobs API 2.0. In order to use the latest Jobs features please upgrade to 2.1: 'databricks jobs configure --version=2.1'. Future versions of this CLI will default to the new Jobs API. Learn more at https://docs.databricks.com/dev-tools/cli/jobs-cli.html
""2023-11-15 16:44:54.170 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - WARN: Your CLI is configured to use Jobs API 2.0. In order to use the latest Jobs features please upgrade to 2.1: 'databricks jobs configure --version=2.1'. Future versions of this CLI will default to the new Jobs API. Learn more at https://docs.databricks.com/dev-tools/cli/jobs-cli.html
""2023-11-15 16:44:55.317 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - WARN: Your CLI is configured to use Jobs API 2.0. In order to use the latest Jobs features please upgrade to 2.1: 'databricks jobs configure --version=2.1'. Future versions of this CLI will default to the new Jobs API. Learn more at https://docs.databricks.com/dev-tools/cli/jobs-cli.html
""2023-11-15 16:44:55.755 [Thread-1952] INFO  com.modak.bots.SparkScriptBot - runId match is: RUN ID is : 1070407263625275
""2023-11-15 16:44:55.755 [Thread-1952] INFO  com.modak.bots.SparkScriptBot - runId  is: 1070407263625275
""2023-11-15 16:44:55.756 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:44:55,754] 	 ERROR:[+] JOB ID is : 552259741091268 and RUN ID is : 1070407263625275 state is FAILED
""2023-11-15 16:44:55.757 [Thread-1952] INFO  com.modak.bots.SparkScriptBot - jobId match is:  JOB ID is : 552259741091268
""2023-11-15 16:44:55.960 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - Executing query to insert the spark application details into kosh: update nabu.spark_application_details set application_id = 'application_552259741091268_1070407263625275', mod_ts=now()
where process_id = 17000664381264241 and batch_id = 17000664380239952 and retry_num = 0;
insert into nabu.spark_application_details
(application_id, process_id, additional_info, cru_ts, batch_id, retry_num, mod_ts)
select
'application_552259741091268_1070407263625275',17000664381264241,'{"job_id":"552259741091268" ,"job_name": null  ,"run_id":"1070407263625275","RunPageURL": null }',now(), 17000664380239952, 0 , now()
where not exists(select * from nabu.spark_application_details where process_id = 17000664381264241 and batch_id = 17000664380239952 and retry_num = 0)
""2023-11-15 16:44:55.966 [Thread-1952] INFO  com.modak.bots.SparkScriptBot - Spark application details are inserted into kosh
""2023-11-15 16:44:55.966 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:44:55,754] 	 INFO:[+] Application id is application_552259741091268_1070407263625275
""2023-11-15 16:44:55.966 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:44:55,756] 	 INFO:[+] Removing temporary resources
""2023-11-15 16:44:57.055 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:44:57,055] 	 INFO:[+] Removed temporary resources of 17000664381264240
""2023-11-15 16:44:57.055 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - [2023-11-15 16:44:57,055] 	 INFO:[+] Deleting JSON file
""2023-11-15 16:44:57.094 [Thread-1952] INFO  com.modak.bots.SparkScriptBot -  exit status : 1
""2023-11-15 16:44:57.094 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - application_id application_552259741091268_1070407263625275
""2023-11-15 16:44:57.094 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - job_id 552259741091268
""2023-11-15 16:44:57.094 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - run_id 1070407263625275
""2023-11-15 16:44:57.094 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - job_name null
""2023-11-15 16:44:57.094 [Thread-1952] DEBUG com.modak.bots.SparkScriptBot - RunPageURL null
""2023-11-15 16:44:57.094 [Thread-1952] ERROR com.modak.bots.SparkScriptBot - 
application_id : application_552259741091268_1070407263625275 
error : 
[2023-11-15 16:44:55,754] 	 ERROR:[+] JOB ID is : 552259741091268 and RUN ID is : 1070407263625275 state is FAILED
""2023-11-15 16:44:57.099 [Thread-1952] ERROR com.modak.bots.SparkScriptBot - java.lang.Exception: 
application_id : application_552259741091268_1070407263625275
error :
[2023-11-15 16:44:55,754] 	 ERROR:[+] JOB ID is : 552259741091268 and RUN ID is : 1070407263625275 state is FAILED
	at com.modak.bots.SparkScriptBot.executeCommand(SparkScriptBot.java:222)
	at com.modak.bots.SparkScriptBot.processLogic(SparkScriptBot.java:94)
	at com.modak.bots.basebot.AbstractBaseBot.processMessage(AbstractBaseBot.java:387)
	at com.modak.bots.basebot.AbstractPullBot.lambda$startBot$0(AbstractPullBot.java:56)
	at java.lang.Thread.run(Thread.java:750)

""2023-11-15 16:44:57.100 [Thread-1952] INFO  com.modak.bots.SparkScriptBot - connection closed!
""2023-11-15 16:44:57.100 [Thread-1952] ERROR com.modak.bots.SparkScriptBot - Exception message : 
application_id : application_552259741091268_1070407263625275
error :
[2023-11-15 16:44:55,754] 	 ERROR:[+] JOB ID is : 552259741091268 and RUN ID is : 1070407263625275 state is FAILED


""2023-11-15 16:44:57.100 [Thread-1952] ERROR com.modak.bots.basebot.AbstractBaseBot - java.lang.Exception: Exception while executing script :
application_id : application_552259741091268_1070407263625275
error :
[2023-11-15 16:44:55,754] 	 ERROR:[+] JOB ID is : 552259741091268 and RUN ID is : 1070407263625275 state is FAILED
	at com.modak.bots.SparkScriptBot.processLogic(SparkScriptBot.java:102)
	at com.modak.bots.basebot.AbstractBaseBot.processMessage(AbstractBaseBot.java:387)
	at com.modak.bots.basebot.AbstractPullBot.lambda$startBot$0(AbstractPullBot.java:56)
	at java.lang.Thread.run(Thread.java:750)

""2023-11-15 16:44:57.125 [Thread-1952] INFO  com.modak.bots.basebot.AbstractBaseBot - publish_msg_topic nabu_2_errorbot
""2023-11-15 16:44:57.134 [Thread-1952] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_errorbot
""2023-11-15 16:44:57.141 [Thread-1952] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_errorbot
""2023-11-15 16:44:57.185 [Thread-1952] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:57.185 [Thread-1952] ERROR com.modak.bots.basebot.AbstractBaseBot - com.modak.utils.exception.BotException: BotException : java.lang.Exception: Exception while executing script :
application_id : application_552259741091268_1070407263625275
error :
[2023-11-15 16:44:55,754] 	 ERROR:[+] JOB ID is : 552259741091268 and RUN ID is : 1070407263625275 state is FAILED
	at com.modak.bots.basebot.AbstractBaseBot.processMessage(AbstractBaseBot.java:417)
	at com.modak.bots.basebot.AbstractPullBot.lambda$startBot$0(AbstractPullBot.java:56)
	at java.lang.Thread.run(Thread.java:750)

""2023-11-15 16:44:57.185 [Thread-1952] INFO  com.modak.bots.basebot.AbstractBaseBot - SparkScriptBot finished processing message with id 3cc69581-bcec-4220-ade0-259dc4327992
""2023-11-15 16:44:57.271 [Thread-1033] INFO  com.modak.bots.basebot.AbstractBaseBot - ErrorBot with bot_id aff16991-ea33-45f5-a31b-0a37ae1c9ec4 has started processing message with message_id 26932c59-4e96-4083-9e87-da610fd5dd6a and thread_id 1269 
""2023-11-15 16:44:57.271 [Thread-1033] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:57.271 [Thread-1033] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=3cc69581-bcec-4220-ade0-259dc4327992, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_error_msg, message_id=26932c59-4e96-4083-9e87-da610fd5dd6a, task_retry_intervals_secs=[], bot_id=a59f4834-1892-4126-b8f2-fa70013de55d, message_topic=nabu_2_errorbot, tags={process_id=17000664381264241, initial_ts=1700066438126, batch_name=Ingestion_20231115, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot, KoshBot, DBOpsBot, DBOpsBot, KoshBot, ErrorBot]}}
""2023-11-15 16:44:57.282 [Thread-1033] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
 INSERT INTO nabu.data_movement_errors (process_id, bot_uuid, process_context, error_json, created_ts, task_map, retry_attempt, bot_type) VALUES(?, ?::uuid, ?, ?, current_timestamp, ?, ?, ?); 
""2023-11-15 16:44:57.282 [Thread-1033] INFO  com.modak.bots.basebot.AbstractBaseBot - ErrorBot with bot_id aff16991-ea33-45f5-a31b-0a37ae1c9ec4 has started process logic with message_id 26932c59-4e96-4083-9e87-da610fd5dd6a and thread_id 1269
""2023-11-15 16:44:57.325 [Thread-1033] DEBUG com.modak.utils.jdbc.JDBCUtility - query : 
INSERT INTO nabu.data_movement_errors
(process_id, bot_uuid, process_context, error_json, created_ts, task_map, retry_attempt, bot_type)
VALUES(?, ?::uuid, ?, ?, current_timestamp, ?, ?, ?);

""2023-11-15 16:44:57.432 [Thread-1033] INFO  com.modak.bots.basebot.AbstractBaseBot - ErrorBot with bot_id aff16991-ea33-45f5-a31b-0a37ae1c9ec4 has finished process logic with message_id 26932c59-4e96-4083-9e87-da610fd5dd6a and thread_id 1269
""2023-11-15 16:44:57.432 [Thread-1033] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:57.432 [Thread-1033] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:57.432 [Thread-1033] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=3cc69581-bcec-4220-ade0-259dc4327992, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_error_msg, message_id=26932c59-4e96-4083-9e87-da610fd5dd6a, task_retry_intervals_secs=[], bot_id=a59f4834-1892-4126-b8f2-fa70013de55d, message_topic=nabu_2_errorbot, tags={process_id=17000664381264241, initial_ts=1700066438126, batch_name=Ingestion_20231115, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=2023-11-07 12:42:00.86365, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, KoshBot, KoshBot, DBOpsBot, DBOpsBot, KoshBot, ErrorBot]}}
""2023-11-15 16:44:57.446 [Thread-1033] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 17000664381264241, 'SparkScriptBot', 'run_almaren_ingestion_job_using_spark', 'run_almaren_ingestion_job_using_spark', 7 , TO_TIMESTAMP(1700066697112::double precision / 1000) ,'a59f4834-1892-4126-b8f2-fa70013de55d');
""2023-11-15 16:44:57.446 [Thread-1033] INFO  com.modak.bots.basebot.AbstractBaseBot - ErrorBot with bot_id aff16991-ea33-45f5-a31b-0a37ae1c9ec4 has started process logic with message_id 26932c59-4e96-4083-9e87-da610fd5dd6a and thread_id 1269
""2023-11-15 16:44:57.452 [Thread-1033] INFO  com.modak.bots.basebot.AbstractBaseBot - ErrorBot with bot_id aff16991-ea33-45f5-a31b-0a37ae1c9ec4 has finished process logic with message_id 26932c59-4e96-4083-9e87-da610fd5dd6a and thread_id 1269
""2023-11-15 16:44:57.453 [Thread-1033] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:57.453 [Thread-1033] INFO  com.modak.bots.basebot.AbstractBaseBot - ErrorBot finished processing message with id 26932c59-4e96-4083-9e87-da610fd5dd6a
""2023-11-15 16:44:58.309 [Thread-1180] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 9e78a1ce-b5de-4908-809f-2fd73caf270d has started processing message with message_id 41a68c7b-4066-473e-8b20-97e5033e7b76 and thread_id 1441 
""2023-11-15 16:44:58.309 [Thread-1180] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:58.309 [Thread-1180] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=41a68c7b-4066-473e-8b20-97e5033e7b76, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=delete_almaren_code_from_kosh, message_id=41a68c7b-4066-473e-8b20-97e5033e7b76, task_retry_intervals_secs=[], bot_id=9a243656-a8f6-45a1-bf1a-431a00d18e91, message_topic=nabu_2_jdbc, tags={process_id=1700066438126424, initial_ts=1700066438126, batch_name=, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, DBOpsBot]}}
""2023-11-15 16:44:58.322 [Thread-1180] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
delete from nabu.pipeline_spark_job_details where batch_id = 17000664380239952 and pipeline_id = 261 and job_type_id = 1
""2023-11-15 16:44:58.333 [Thread-1180] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 16:44:58.335 [Thread-1180] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:44:58.357 [Thread-1180] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:44:58.357 [Thread-1180] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 9e78a1ce-b5de-4908-809f-2fd73caf270d has started process logic with message_id 41a68c7b-4066-473e-8b20-97e5033e7b76 and thread_id 1441
""2023-11-15 16:44:58.439 [Thread-1180] DEBUG com.modak.bots.DBOpsBot - to execute query timeTakenInMillis : 82
""2023-11-15 16:44:58.439 [Thread-1180] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 9e78a1ce-b5de-4908-809f-2fd73caf270d has finished process logic with message_id 41a68c7b-4066-473e-8b20-97e5033e7b76 and thread_id 1441
""2023-11-15 16:44:58.439 [Thread-1180] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-15 16:44:58.442 [Thread-980] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ea7e160-7f7b-468f-9046-a99a4ec663a6 has started processing message with message_id a29fcc5b-6a9f-4f35-953c-a29982127b4a and thread_id 1207 
""2023-11-15 16:44:58.442 [Thread-980] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:58.442 [Thread-980] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=41a68c7b-4066-473e-8b20-97e5033e7b76, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=a29fcc5b-6a9f-4f35-953c-a29982127b4a, task_retry_intervals_secs=[], bot_id=9e78a1ce-b5de-4908-809f-2fd73caf270d, message_topic=nabu_2_taskmonitor, tags={process_id=1700066438126424, initial_ts=1700066438126, batch_name=, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, DBOpsBot, TaskMonitorBot]}}
""2023-11-15 16:44:58.450 [Thread-892] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 88f8e05b-fa7f-43f1-a36e-71e7922935a9 has started processing message with message_id b3b6ac55-71c9-458c-a4a0-06742c566dc3 and thread_id 1105 
""2023-11-15 16:44:58.451 [Thread-892] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:58.451 [Thread-892] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=b3b6ac55-71c9-458c-a4a0-06742c566dc3, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=get_created_credentials_details_if_exists, message_id=b3b6ac55-71c9-458c-a4a0-06742c566dc3, task_retry_intervals_secs=[], bot_id=9a243656-a8f6-45a1-bf1a-431a00d18e91, message_topic=nabu_2_jdbc, tags={process_id=1700066438126424, initial_ts=1700066438126, batch_name=, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, DBOpsBot]}}
""2023-11-15 16:44:58.451 [Thread-536] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 595ce3db-e0fb-4e57-b238-a2f959af2c69 has started processing message with message_id aa107a2f-155c-440c-9cc7-2ab900b08cab and thread_id 686 
""2023-11-15 16:44:58.451 [Thread-536] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:58.451 [Thread-536] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=aa107a2f-155c-440c-9cc7-2ab900b08cab, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=inserting_pre_aggregate_stats, message_id=aa107a2f-155c-440c-9cc7-2ab900b08cab, task_retry_intervals_secs=[], bot_id=9a243656-a8f6-45a1-bf1a-431a00d18e91, message_topic=nabu_2_jdbc, tags={process_id=1700066438126424, initial_ts=1700066438126, batch_name=, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, DBOpsBot]}}
""2023-11-15 16:44:58.453 [Thread-1180] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "adb2c173-bc54-4afd-863a-6bc75f573cd5", "parent_id": "41a68c7b-4066-473e-8b20-97e5033e7b76", "bot_id": "9e78a1ce-b5de-4908-809f-2fd73caf270d", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":1700066438126424, "initial_ts":1700066438126, "batch_id":17000664380239952, "batch_name":"", "job_schedule_id":1568, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "DBOpsBot", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"9e78a1ce-b5de-4908-809f-2fd73caf270d", "bot_name":"DBOpsBot", "process_context":"delete_almaren_code_from_kosh", "task_name":"delete_almaren_code_from_kosh", "process_id":"1700066438126424", "task_ts":1700066698439, "batch_id":"17000664380239952", "status_code_id": 6 } } ] }
""2023-11-15 16:44:58.456 [Thread-1180] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:44:58.458 [Thread-980] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 1700066438126424, 'DBOpsBot', 'delete_almaren_code_from_kosh', 'delete_almaren_code_from_kosh', 10 , TO_TIMESTAMP(1700066698309::double precision / 1000) ,'9e78a1ce-b5de-4908-809f-2fd73caf270d');
""2023-11-15 16:44:58.458 [Thread-980] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ea7e160-7f7b-468f-9046-a99a4ec663a6 has started process logic with message_id a29fcc5b-6a9f-4f35-953c-a29982127b4a and thread_id 1207
""2023-11-15 16:44:58.467 [Thread-892] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
{ "input_data": { "batch_id": "17000664380239952", "data_movement_id": "261", "job_schedule_id": "1568", "job_type_id" : "1" }, "sequential_templates":[ { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "check_compute_engine_validity_data_movement", "query_output_key": "check_compute_engine_validity", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/common_templates.stg", "query_template_name": "fetching_creds_script_inputs", "query_output_key": "fetching_script_inputs", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/common_templates.stg", "query_template_name": "fetching_credential_inputs", "query_output_key": "fetching_credential_inputs", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/common_templates.stg", "query_template_name": "get_worlflow_type", "query_output_key": "get_worlflow_type", "query_type":"select" } ], "output_keys":["check_compute_engine_validity","fetching_script_inputs","fetching_credential_inputs","get_worlflow_type"] }
""2023-11-15 16:44:58.468 [Thread-536] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
{ "input_data": { "batch_id": 17000664380239952, "data_movement_id": 261, "job_type_id": "1", "start_time" : "1700066442527", "end_time" : "1700066698240", "job_schedule_id": 1568 }, "sequential_templates":[ { "query_template_group": "templates/artifact_ingestion/common_templates.stg", "query_template_name": "insert_into_data_movement_pre_aggregate_stats", "query_output_key": "data_movement_pre_aggregate_stats", "query_type":"insert" }, { "query_template_group": "templates/artifact_ingestion/common_templates.stg", "query_template_name": "insert_into_data_movement_pre_aggregate_stats_archive_log", "query_output_key": "data_movement_pre_aggregate_stats_archive_log", "query_type":"insert" }, { "query_template_group": "templates/artifact_ingestion/common_templates.stg", "query_template_name": "delete_from_data_movement_pre_aggregate_stats", "query_output_key": "delete_from_data_movement_pre_aggregate_stats", "query_type":"delete" } ], "output_keys":["data_movement_pre_aggregate_stats","data_movement_pre_aggregate_stats_archive_log"] }
""2023-11-15 16:44:58.549 [Thread-980] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ea7e160-7f7b-468f-9046-a99a4ec663a6 has finished process logic with message_id a29fcc5b-6a9f-4f35-953c-a29982127b4a and thread_id 1207
""2023-11-15 16:44:58.549 [Thread-980] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:58.549 [Thread-980] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id a29fcc5b-6a9f-4f35-953c-a29982127b4a
""2023-11-15 16:44:58.552 [Thread-536] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 16:44:58.552 [Thread-1180] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:44:58.552 [Thread-1180] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:58.552 [Thread-1180] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot finished processing message with id 41a68c7b-4066-473e-8b20-97e5033e7b76
""2023-11-15 16:44:58.553 [Thread-536] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:44:58.553 [Thread-892] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 16:44:58.555 [Thread-892] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:44:58.557 [Thread-1076] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id aec66b87-c359-43a6-adee-0e9c6b3f0e45 has started processing message with message_id adb2c173-bc54-4afd-863a-6bc75f573cd5 and thread_id 1319 
""2023-11-15 16:44:58.557 [Thread-1076] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:58.557 [Thread-1076] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=41a68c7b-4066-473e-8b20-97e5033e7b76, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=adb2c173-bc54-4afd-863a-6bc75f573cd5, task_retry_intervals_secs=[], bot_id=9e78a1ce-b5de-4908-809f-2fd73caf270d, message_topic=nabu_2_taskmonitor, tags={process_id=1700066438126424, initial_ts=1700066438126, batch_name=, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, DBOpsBot, TaskMonitorBot]}}
""2023-11-15 16:44:58.558 [Thread-536] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:44:58.558 [Thread-536] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 595ce3db-e0fb-4e57-b238-a2f959af2c69 has started process logic with message_id aa107a2f-155c-440c-9cc7-2ab900b08cab and thread_id 686
""2023-11-15 16:44:58.561 [Thread-892] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:44:58.561 [Thread-892] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 88f8e05b-fa7f-43f1-a36e-71e7922935a9 has started process logic with message_id b3b6ac55-71c9-458c-a4a0-06742c566dc3 and thread_id 1105
""2023-11-15 16:44:58.569 [Thread-1076] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 1700066438126424, 'DBOpsBot', 'delete_almaren_code_from_kosh', 'delete_almaren_code_from_kosh', 6 , TO_TIMESTAMP(1700066698439::double precision / 1000) ,'9e78a1ce-b5de-4908-809f-2fd73caf270d');
""2023-11-15 16:44:58.570 [Thread-1076] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id aec66b87-c359-43a6-adee-0e9c6b3f0e45 has started process logic with message_id adb2c173-bc54-4afd-863a-6bc75f573cd5 and thread_id 1319
""2023-11-15 16:44:58.578 [Thread-1076] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id aec66b87-c359-43a6-adee-0e9c6b3f0e45 has finished process logic with message_id adb2c173-bc54-4afd-863a-6bc75f573cd5 and thread_id 1319
""2023-11-15 16:44:58.578 [Thread-1076] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:58.578 [Thread-1076] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id adb2c173-bc54-4afd-863a-6bc75f573cd5
""2023-11-15 16:44:58.593 [Thread-536] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with dm_batchid_object_map as (
select a.data_movement_id, batch_id, object_id,process_id,  e.metadata_category, status_code_id, source_dataplace_count , start_ts,end_ts
from (
select data_movement_id, batch_id, object_id,process_id,status_code_id, start_ts,end_ts
from (
select data_movement_id, batch_id, object_id,process_id,status_code_id, row_number () over (partition by data_movement_id ,batch_id, object_id order by flow_task_ts desc) as rownum, TO_TIMESTAMP(1700066442527::double precision / 1000) as start_ts, TO_TIMESTAMP(1700066698240::double precision / 1000) as end_ts
from nabu.flow_task_status
 where batch_id = 17000664380239952 and data_movement_id = 261
) x
where rownum = 1 and status_code_id not in(30,31,38,39)) a
inner join  (select  data_movement_id, count(distinct d.source_dataplace_id) as source_dataplace_count , max(e.metadata_category) as metadata_category
from nabu.data_movement_details_physical d
			inner join nabu.dataplace_physical c on d.source_dataplace_id = c.dataplace_id and c.valid_to_ts = '9999-12-31' and d.valid_to_ts = '9999-12-31'
and data_movement_id = 261
			   inner join nabu.dataplace_component_mapping_lookup e on c.dataplace_component_type_id = e.dataplace_component_type_id
and e.dataplace_sub_component_id =  c.dataplace_sub_component_id
group by 1) e on a.data_movement_id = e.data_movement_id
),

flow_status_agg as (
select *,1 as job_type_id, case when a.failed_count = 0 and a.running_count = 0 and a.queued_count = 0  then 'Succeeded'
	        when a.failed_count > 0 and a.running_count = 0 and a.queued_count= 0 then 'Failed'
		when a.running_count > 0 or a.queued_count > 0 then 'Running' end as dm_status_code
from (
select data_movement_id,batch_id,
		count(status_code_id) as total_count,
		count(case when status_code_id in (20) then 1 end) as queued_count,
		count(case when status_code_id= 15 then 1 end)  as success_count,
		count(case when status_code_id in(16,17,18) then 1 end) as failed_count,
		count(case when status_code_id in(19) then 1 end)  as running_count,
		count(case when status_code_id in(18) then 1 end) as flow_timeout_count,
        max (source_dataplace_count) as source_dataplace_count,
	    min(start_ts) as start_ts,
        max(end_ts) as end_ts
from dm_batchid_object_map
group by data_movement_id,batch_id ) a
),

get_status_code_id as (
select a.*,
case when a.job_type_id=6 then (
case when (a.failed_count > 0 and a.running_count = 0 and a.queued_count= 0) then 13
 when a.failed_count = 0 and a.running_count = 0 and a.queued_count = 0  then 12
 when a.running_count > 0 or a.queued_count > 0 then 11 end )
 when job_type_id in (1,3,14) then(
case when ((a.failed_count > 0 and a.running_count = 0 and a.queued_count= 0) and (a.flow_timeout_count>0)) then 29
 when (a.failed_count > 0 and a.running_count = 0 and a.queued_count= 0) then 13
 when a.failed_count = 0 and a.running_count = 0 and a.queued_count = 0  then 12
 when a.running_count > 0 or a.queued_count > 0 then 11 end
)
end as status_code_id from flow_status_agg a
),
get_spark_metrics as (
select data_movement_id,process_id,object_id,inputmetrics_bytesread,inputmetrics_recordsread,outputmetrics_byteswritten,outputmetrics_recordswritten from nabu.spark_metrics sm where
data_movement_id =261 and valid_to_ts = '99991231'  and process_id in (select process_id from dm_batchid_object_map)
)
--select * from get_spark_metrics
,
table_details as (
select data_movement_id, batch_id,count(table_id) as tables_count,
coalesce(sum( case when outputmetrics_byteswritten <= 0 then table_size else outputmetrics_byteswritten end),0) as table_size_in_bytes from
(
    select a.data_movement_id, batch_id,b.table_id,outputmetrics_byteswritten,b.table_size
    from get_spark_metrics c
    left outer join dm_batchid_object_map a on a.data_movement_id =c.data_movement_id and a.object_id = c.object_id and a.process_id=c.process_id
    left outer join nabu.dataplace_table_metadata_physical b on a.object_id = b.table_id
    where  b.valid_to_ts = '9999-12-31' and b.table_type = 'T' and a.metadata_category = 'relational'
)bb
group by 1,2
)
--select * from table_details
,

view_details as (
select data_movement_id, batch_id,count(table_id) as views_count,
coalesce(sum( case when outputmetrics_byteswritten <= 0 then table_size else outputmetrics_byteswritten end),0) as view_size_in_bytes from
(
select a.data_movement_id, batch_id,b.table_id,outputmetrics_byteswritten,b.table_size
    from get_spark_metrics c
    left outer join dm_batchid_object_map a on a.data_movement_id =c.data_movement_id and a.object_id = c.object_id and a.process_id=c.process_id
    left outer join nabu.dataplace_table_metadata_physical b on a.object_id = b.table_id
    where  b.valid_to_ts = '9999-12-31' and b.table_type in ('V', 'M' )and a.metadata_category = 'relational'
)bb
group by 1, 2
),


column_details as ( select a.data_movement_id, batch_id, count(b.column_id) as columns_count
from dm_batchid_object_map a, nabu.dataplace_column_metadata_physical b
where  a.object_id = b.table_id  and b.valid_to_ts = '9999-12-31'
and a.metadata_category = 'relational'
group by 1, 2

union all

select a.data_movement_id, batch_id, count(b.column_id) as columns_count
from dm_batchid_object_map a, nabu.dataplace_semi_structured_column_metadata b
where  a.object_id = b.file_id  and b.valid_to_ts = '9999-12-31'
and a.metadata_category = 'file'
group by 1, 2
),

file_details as(
select data_movement_id, batch_id, coalesce(sum(file_objects),0) as files_count, coalesce(sum(size_in_bytes),0) as file_size_in_bytes
from (

select data_movement_id, batch_id ,coalesce(count(object_id),0) as file_objects,
coalesce(sum( case when outputmetrics_byteswritten <= 0 then size else outputmetrics_byteswritten end),0) as size_in_bytes
from
(
        select a.data_movement_id, batch_id,c.object_id,outputmetrics_byteswritten,b.size as size
        from get_spark_metrics c
        left outer join dm_batchid_object_map a on a.data_movement_id =c.data_movement_id and a.object_id = c.object_id and a.process_id=c.process_id
        left outer join nabu.dataplace_file_metadata b on a.object_id = b.file_id
        where  b.dataplace_component_type_id in (2,3) and a.metadata_category in ( 'file' ) and b.valid_to_ts = '9999-12-31'
)bb
group by data_movement_id, batch_id
union all

select data_movement_id, batch_id ,coalesce(count(object_id),0) as file_objects,
coalesce(sum( case when outputmetrics_byteswritten <= 0 then size else outputmetrics_byteswritten end),0) as size_in_bytes
from
(
        select a.data_movement_id, batch_id,c.object_id,outputmetrics_byteswritten,b.file_size as size
        from get_spark_metrics c
        left outer join dm_batchid_object_map a on a.data_movement_id =c.data_movement_id and a.object_id = c.object_id and a.process_id=c.process_id
        left outer join nabu.dataplace_file_sharepoint_metadata b on a.object_id = b.file_id
        where  b.dataplace_component_type_id in (2,3) and a.metadata_category in ( 'sharepoint' ) and b.valid_to_ts = '9999-12-31'
)bb
group by data_movement_id, batch_id
union all

select data_movement_id, batch_id ,coalesce(count(object_id),0) as file_objects,
coalesce(sum( case when outputmetrics_byteswritten <= 0 then size else outputmetrics_byteswritten end),0) as size_in_bytes
from
(
        select a.data_movement_id, batch_id,c.object_id,outputmetrics_byteswritten,b.file_size as size
        from get_spark_metrics c
        left outer join dm_batchid_object_map a on a.data_movement_id =c.data_movement_id and a.object_id = c.object_id and a.process_id=c.process_id
        left outer join nabu.dataplace_file_documentum_metadata b on a.object_id = b.file_id
        where  b.dataplace_component_type_id in (2,3) and a.metadata_category in ( 'documentum' ) and b.valid_to_ts = '9999-12-31'
)bb
group by data_movement_id, batch_id
union all

select data_movement_id, batch_id ,coalesce(count(object_id),0) as file_objects,
coalesce(sum( case when outputmetrics_byteswritten <= 0 then size else outputmetrics_byteswritten end),0) as size_in_bytes
from
(
        select a.data_movement_id, batch_id,c.object_id,outputmetrics_byteswritten,b.file_size as size
        from get_spark_metrics c
        left outer join dm_batchid_object_map a on a.data_movement_id =c.data_movement_id and a.object_id = c.object_id and a.process_id=c.process_id
        left outer join nabu.dataplace_file_drive_metadata b on a.object_id = b.file_id
        where  b.dataplace_component_type_id in (2,3) and a.metadata_category in ( 'file' ) and b.valid_to_ts = '9999-12-31'
)bb
group by data_movement_id, batch_id


) x

group by data_movement_id, batch_id
)
,collection_details as(
select a.data_movement_id , batch_id, coalesce(sum(cm.collection_size),0) as estimated_size_collections,
count( cm.collection_id) as collections_count
from dm_batchid_object_map a
inner join nabu.dataplace_collection_metadata cm on a.object_id = cm.collection_id and cm.valid_to_ts = '9999-12-31'
and a.metadata_category in ( 'collection' )
group by a.data_movement_id , batch_id
)

,field_details as(
select a.data_movement_id , batch_id, coalesce (count(c.field_id),0) as fields_count
from dm_batchid_object_map a
inner join nabu.dataplace_collection_field_metadata c on a.object_id = c.collection_id and c.valid_to_ts = '9999-12-31'
and a.metadata_category in ( 'collection' )
group by a.data_movement_id , batch_id
)

INSERT INTO nabu_ui.data_movement_pre_aggregate_stats
(data_movement_id, batch_id, job_type_id, total_count, success_count, failed_count, source_dataplace_count, tables_count, views_count, collections_count, files_count, columns_count, fields_count, objects_size, dm_status_code, start_ts, end_ts, crt_ts,status_code_id,job_schedule_id)

select  a.data_movement_id, a.batch_id,1 as job_type_id, coalesce(a.total_count,0) as total_count, coalesce(a.success_count,0) as success_count, coalesce(a.failed_count,0) as failed_count, coalesce(a.source_dataplace_count,0) as source_dataplace_count, coalesce(b.tables_count,0) as tables_count, coalesce(c.views_count,0) as views_count, coalesce(d.collections_count,0) as collections_count, coalesce(e.files_count,0) as files_count, coalesce(f.columns_count,0) as columns_count, coalesce(g.fields_count,0) as fields_count,
 coalesce(estimated_size_collections,0) + coalesce(file_size_in_bytes,0) + coalesce(table_size_in_bytes,0) + coalesce(view_size_in_bytes,0) as objects_size,
a.dm_status_code, a.start_ts, a.end_ts, current_timestamp as crt_ts, i.status_code_id,1568 as job_schedule_id
from flow_status_agg a left outer join table_details b on a.data_movement_id = b.data_movement_id and a.batch_id = b.batch_id
left outer join view_details c on a.data_movement_id = c.data_movement_id and a.batch_id = c.batch_id
left outer join collection_details d on a.data_movement_id = d.data_movement_id and a.batch_id = d.batch_id
left outer join file_details e on a.data_movement_id = e.data_movement_id and a.batch_id = e.batch_id
left outer join column_details f on a.data_movement_id = f.data_movement_id and a.batch_id = f.batch_id
left outer join get_status_code_id i on i.data_movement_id=a.data_movement_id  and i.batch_id = a.batch_id
left outer join field_details g on a.data_movement_id = g.data_movement_id and a.batch_id = g.batch_id

""2023-11-15 16:44:58.661 [Thread-836] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 8139d6f2-9a65-43f2-b465-28a78f070e95 has started processing message with message_id 9449844e-fb0b-4324-81c4-1065b0a67b05 and thread_id 1039 
""2023-11-15 16:44:58.662 [Thread-836] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:58.662 [Thread-836] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=b3b6ac55-71c9-458c-a4a0-06742c566dc3, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=9449844e-fb0b-4324-81c4-1065b0a67b05, task_retry_intervals_secs=[], bot_id=88f8e05b-fa7f-43f1-a36e-71e7922935a9, message_topic=nabu_2_taskmonitor, tags={process_id=1700066438126424, initial_ts=1700066438126, batch_name=, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, DBOpsBot, TaskMonitorBot]}}
""2023-11-15 16:44:58.662 [Thread-184] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 8950f9f1-2dc3-43f6-9301-48688d3f0707 has started processing message with message_id 7f40c4d6-9a7e-4453-bd77-ef2e3f89bf46 and thread_id 275 
""2023-11-15 16:44:58.662 [Thread-184] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:58.662 [Thread-184] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=aa107a2f-155c-440c-9cc7-2ab900b08cab, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=7f40c4d6-9a7e-4453-bd77-ef2e3f89bf46, task_retry_intervals_secs=[], bot_id=595ce3db-e0fb-4e57-b238-a2f959af2c69, message_topic=nabu_2_taskmonitor, tags={process_id=1700066438126424, initial_ts=1700066438126, batch_name=, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, DBOpsBot, TaskMonitorBot]}}
""2023-11-15 16:44:58.680 [Thread-836] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 1700066438126424, 'DBOpsBot', 'get_created_credentials_details_if_exists', 'get_created_credentials_details_if_exists', 10 , TO_TIMESTAMP(1700066698451::double precision / 1000) ,'88f8e05b-fa7f-43f1-a36e-71e7922935a9');
""2023-11-15 16:44:58.680 [Thread-836] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 8139d6f2-9a65-43f2-b465-28a78f070e95 has started process logic with message_id 9449844e-fb0b-4324-81c4-1065b0a67b05 and thread_id 1039
""2023-11-15 16:44:58.706 [Thread-184] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 1700066438126424, 'DBOpsBot', 'inserting_pre_aggregate_stats', 'inserting_pre_aggregate_stats', 10 , TO_TIMESTAMP(1700066698451::double precision / 1000) ,'595ce3db-e0fb-4e57-b238-a2f959af2c69');
""2023-11-15 16:44:58.706 [Thread-184] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 8950f9f1-2dc3-43f6-9301-48688d3f0707 has started process logic with message_id 7f40c4d6-9a7e-4453-bd77-ef2e3f89bf46 and thread_id 275
""2023-11-15 16:44:58.707 [Thread-836] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 8139d6f2-9a65-43f2-b465-28a78f070e95 has finished process logic with message_id 9449844e-fb0b-4324-81c4-1065b0a67b05 and thread_id 1039
""2023-11-15 16:44:58.707 [Thread-836] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:58.707 [Thread-836] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 9449844e-fb0b-4324-81c4-1065b0a67b05
""2023-11-15 16:44:58.715 [Thread-536] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : 
with dm_batchid_object_map as (
select a.data_movement_id, batch_id, object_id,process_id,  e.metadata_category, status_code_id, source_dataplace_count , start_ts,end_ts
from (
select data_movement_id, batch_id, object_id,process_id,status_code_id, start_ts,end_ts
from (
select data_movement_id, batch_id, object_id,process_id,status_code_id, row_number () over (partition by data_movement_id ,batch_id, object_id order by flow_task_ts desc) as rownum, TO_TIMESTAMP(1700066442527::double precision / 1000) as start_ts, TO_TIMESTAMP(1700066698240::double precision / 1000) as end_ts
from nabu.flow_task_status
where batch_id = 17000664380239952 and data_movement_id = 261
) x
where rownum = 1 and status_code_id not in(30,31,38,39) ) a
inner join  (select  data_movement_id, count(distinct d.source_dataplace_id) as source_dataplace_count , max(e.metadata_category) as metadata_category
from nabu.data_movement_details_physical d
			inner join nabu.dataplace_physical c on d.source_dataplace_id = c.dataplace_id and c.valid_to_ts = '9999-12-31' and d.valid_to_ts = '9999-12-31'
and data_movement_id = 261
			   inner join nabu.dataplace_component_mapping_lookup e on c.dataplace_component_type_id = e.dataplace_component_type_id
and e.dataplace_sub_component_id =  c.dataplace_sub_component_id
group by 1) e on a.data_movement_id = e.data_movement_id
),

flow_status_agg as (
select *,1 as job_type_id, case when a.failed_count = 0 and a.running_count = 0 and a.queued_count = 0  then 'Succeeded'
	        when a.failed_count > 0 and a.running_count = 0 and a.queued_count= 0 then 'Failed'
		when a.running_count > 0 or a.queued_count > 0 then 'Running' end as dm_status_code
from (
select data_movement_id,batch_id,
		count(status_code_id) as total_count,
		count(case when status_code_id in (20) then 1 end) as queued_count,
		count(case when status_code_id= 15 then 1 end)  as success_count,
		count(case when status_code_id in(16,17,18) then 1 end) as failed_count,
		count(case when status_code_id in(19) then 1 end)  as running_count,
		count(case when status_code_id in(18) then 1 end) as flow_timeout_count,
        max (source_dataplace_count) as source_dataplace_count,
	    min(start_ts) as start_ts,
        max(end_ts) as end_ts
from dm_batchid_object_map
group by data_movement_id,batch_id ) a
),

get_status_code_id as (
select a.*,
case when a.job_type_id=6 then (
case when (a.failed_count > 0 and a.running_count = 0 and a.queued_count= 0) then 13
 when a.failed_count = 0 and a.running_count = 0 and a.queued_count = 0  then 12
 when a.running_count > 0 or a.queued_count > 0 then 11 end )
 when job_type_id in (1,3,14) then(
case when ((a.failed_count > 0 and a.running_count = 0 and a.queued_count= 0) and (a.flow_timeout_count>0)) then 29
 when (a.failed_count > 0 and a.running_count = 0 and a.queued_count= 0) then 13
 when a.failed_count = 0 and a.running_count = 0 and a.queued_count = 0  then 12
 when a.running_count > 0 or a.queued_count > 0 then 11 end
)
end as status_code_id from flow_status_agg a
),
get_spark_metrics as (
select data_movement_id,process_id,object_id,inputmetrics_bytesread,inputmetrics_recordsread,outputmetrics_byteswritten,outputmetrics_recordswritten from nabu.spark_metrics sm where
data_movement_id =261 and valid_to_ts = '99991231'  and process_id in (select process_id from dm_batchid_object_map)
)
--select * from get_spark_metrics
,
table_details as (
select data_movement_id, batch_id,count(table_id) as tables_count,
coalesce(sum( case when outputmetrics_byteswritten <= 0 then table_size else outputmetrics_byteswritten end),0) as table_size_in_bytes from
(
    select a.data_movement_id, batch_id,b.table_id,outputmetrics_byteswritten,b.table_size
    from get_spark_metrics c
    left outer join dm_batchid_object_map a on a.data_movement_id =c.data_movement_id and a.object_id = c.object_id and a.process_id=c.process_id
    left outer join nabu.dataplace_table_metadata_physical b on a.object_id = b.table_id
    where  b.valid_to_ts = '9999-12-31' and b.table_type = 'T' and a.metadata_category = 'relational'
)bb
group by 1,2
)
--select * from table_details
,

view_details as (
select data_movement_id, batch_id,count(table_id) as views_count,
coalesce(sum( case when outputmetrics_byteswritten <= 0 then table_size else outputmetrics_byteswritten end),0) as view_size_in_bytes from
(
select a.data_movement_id, batch_id,b.table_id,outputmetrics_byteswritten,b.table_size
    from get_spark_metrics c
    left outer join dm_batchid_object_map a on a.data_movement_id =c.data_movement_id and a.object_id = c.object_id and a.process_id=c.process_id
    left outer join nabu.dataplace_table_metadata_physical b on a.object_id = b.table_id
    where  b.valid_to_ts = '9999-12-31' and b.table_type in ('V', 'M' )and a.metadata_category = 'relational'
)bb
group by 1, 2 ),


column_details as ( select a.data_movement_id, batch_id, count(b.column_id) as columns_count
from dm_batchid_object_map a, nabu.dataplace_column_metadata_physical b
where  a.object_id = b.table_id  and b.valid_to_ts = '9999-12-31'
and a.metadata_category = 'relational'
group by 1, 2

union all

select a.data_movement_id, batch_id, count(b.column_id) as columns_count
from dm_batchid_object_map a, nabu.dataplace_semi_structured_column_metadata b
where  a.object_id = b.file_id  and b.valid_to_ts = '9999-12-31'
and a.metadata_category = 'file'
group by 1, 2
),

file_details as(
select data_movement_id, batch_id, coalesce(sum(file_objects),0) as files_count, coalesce(sum(size_in_bytes),0) as file_size_in_bytes
from (

select data_movement_id, batch_id ,coalesce(count(object_id),0) as file_objects,
coalesce(sum( case when outputmetrics_byteswritten <= 0 then size else outputmetrics_byteswritten end),0) as size_in_bytes
from
(
        select a.data_movement_id, batch_id,c.object_id,outputmetrics_byteswritten,b.size as size
        from get_spark_metrics c
        left outer join dm_batchid_object_map a on a.data_movement_id =c.data_movement_id and a.object_id = c.object_id and a.process_id=c.process_id
        left outer join nabu.dataplace_file_metadata b on a.object_id = b.file_id
        where  b.dataplace_component_type_id in (2,3) and a.metadata_category in ( 'file' ) and b.valid_to_ts = '9999-12-31'
)bb
group by data_movement_id, batch_id
union all

select data_movement_id, batch_id ,coalesce(count(object_id),0) as file_objects,
coalesce(sum( case when outputmetrics_byteswritten <= 0 then size else outputmetrics_byteswritten end),0) as size_in_bytes
from
(
        select a.data_movement_id, batch_id,c.object_id,outputmetrics_byteswritten,b.file_size as size
        from get_spark_metrics c
        left outer join dm_batchid_object_map a on a.data_movement_id =c.data_movement_id and a.object_id = c.object_id and a.process_id=c.process_id
        left outer join nabu.dataplace_file_sharepoint_metadata b on a.object_id = b.file_id
        where  b.dataplace_component_type_id in (2,3) and a.metadata_category in ( 'sharepoint' ) and b.valid_to_ts = '9999-12-31'
)bb
group by data_movement_id, batch_id
union all

select data_movement_id, batch_id ,coalesce(count(object_id),0) as file_objects,
coalesce(sum( case when outputmetrics_byteswritten <= 0 then size else outputmetrics_byteswritten end),0) as size_in_bytes
from
(
        select a.data_movement_id, batch_id,c.object_id,outputmetrics_byteswritten,b.file_size as size
        from get_spark_metrics c
        left outer join dm_batchid_object_map a on a.data_movement_id =c.data_movement_id and a.object_id = c.object_id and a.process_id=c.process_id
        left outer join nabu.dataplace_file_documentum_metadata b on a.object_id = b.file_id
        where  b.dataplace_component_type_id in (2,3) and a.metadata_category in ( 'documentum' ) and b.valid_to_ts = '9999-12-31'
)bb
group by data_movement_id, batch_id
union all

select data_movement_id, batch_id ,coalesce(count(object_id),0) as file_objects,
coalesce(sum( case when outputmetrics_byteswritten <= 0 then size else outputmetrics_byteswritten end),0) as size_in_bytes
from
(
        select a.data_movement_id, batch_id,c.object_id,outputmetrics_byteswritten,b.file_size as size
        from get_spark_metrics c
        left outer join dm_batchid_object_map a on a.data_movement_id =c.data_movement_id and a.object_id = c.object_id and a.process_id=c.process_id
        left outer join nabu.dataplace_file_drive_metadata b on a.object_id = b.file_id
        where  b.dataplace_component_type_id in (2,3) and a.metadata_category in ( 'file' ) and b.valid_to_ts = '9999-12-31'
)bb
group by data_movement_id, batch_id


) x

group by data_movement_id, batch_id
)
,collection_details as(
select a.data_movement_id , batch_id, coalesce(sum(cm.collection_size),0) as estimated_size_collections,
count( cm.collection_id) as collections_count
from dm_batchid_object_map a
inner join nabu.dataplace_collection_metadata cm on a.object_id = cm.collection_id and cm.valid_to_ts = '9999-12-31'
and a.metadata_category in ( 'collection' )
group by a.data_movement_id , batch_id
)

,field_details as(
select a.data_movement_id , batch_id, coalesce (count(c.field_id),0) as fields_count
from dm_batchid_object_map a
inner join nabu.dataplace_collection_field_metadata c on a.object_id = c.collection_id and c.valid_to_ts = '9999-12-31'
and a.metadata_category in ( 'collection' )
group by a.data_movement_id , batch_id
)

INSERT INTO nabu_ui.data_movement_pre_aggregate_stats_archive_log
(data_movement_id, batch_id, job_type_id, total_count, success_count, failed_count, source_dataplace_count, tables_count, views_count, collections_count, files_count, columns_count, fields_count, objects_size, dm_status_code, start_ts, end_ts, crt_ts,status_code_id,job_schedule_id)

select  a.data_movement_id, a.batch_id, 1 as job_type_id, coalesce(a.total_count,0) as total_count, coalesce(a.success_count,0) as success_count, coalesce(a.failed_count,0) as failed_count, coalesce(a.source_dataplace_count,0) as source_dataplace_count, coalesce(b.tables_count,0) as tables_count, coalesce(c.views_count,0) as views_count, coalesce(d.collections_count,0) as collections_count, coalesce(e.files_count,0) as files_count, coalesce(f.columns_count,0) as columns_count, coalesce(g.fields_count,0) as fields_count,
 coalesce(estimated_size_collections,0) + coalesce(file_size_in_bytes,0) + coalesce(table_size_in_bytes,0) + coalesce(view_size_in_bytes,0) as objects_size,
a.dm_status_code, a.start_ts, a.end_ts, current_timestamp as crt_ts, i.status_code_id,1568 as job_schedule_id
from flow_status_agg a left outer join table_details b on a.data_movement_id = b.data_movement_id and a.batch_id = b.batch_id
left outer join view_details c on a.data_movement_id = c.data_movement_id and a.batch_id = c.batch_id
left outer join collection_details d on a.data_movement_id = d.data_movement_id and a.batch_id = d.batch_id
left outer join file_details e on a.data_movement_id = e.data_movement_id and a.batch_id = e.batch_id
left outer join column_details f on a.data_movement_id = f.data_movement_id and a.batch_id = f.batch_id
left outer join get_status_code_id i on i.data_movement_id=a.data_movement_id  and i.batch_id = a.batch_id
left outer join field_details g on a.data_movement_id = g.data_movement_id and a.batch_id = g.batch_id
""2023-11-15 16:44:58.795 [Thread-184] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 8950f9f1-2dc3-43f6-9301-48688d3f0707 has finished process logic with message_id 7f40c4d6-9a7e-4453-bd77-ef2e3f89bf46 and thread_id 275
""2023-11-15 16:44:58.796 [Thread-184] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:58.796 [Thread-184] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 7f40c4d6-9a7e-4453-bd77-ef2e3f89bf46
""2023-11-15 16:44:58.802 [Thread-536] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with rows_to_be_deleted as
(
select *
from ( select data_movement_id , batch_id, start_ts, row_number() over (partition by data_movement_id order by start_ts desc) as rownum
from (
select data_movement_id , batch_id , max(start_ts) as start_ts
from nabu_ui.data_movement_pre_aggregate_stats
where data_movement_id = 261
group by 1,2 )x
) A
where rownum >10
)

delete from nabu_ui.data_movement_pre_aggregate_stats
where (data_movement_id, batch_id)
in (select data_movement_id, batch_id from rows_to_be_deleted)
""2023-11-15 16:44:58.808 [Thread-536] DEBUG com.modak.bots.DBOpsBot - to execute query timeTakenInMillis : 250
""2023-11-15 16:44:58.808 [Thread-536] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 595ce3db-e0fb-4e57-b238-a2f959af2c69 has finished process logic with message_id aa107a2f-155c-440c-9cc7-2ab900b08cab and thread_id 686
""2023-11-15 16:44:58.808 [Thread-536] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-15 16:44:58.822 [Thread-536] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "57bd410e-36d3-45d4-bc0f-7c90b300426b", "parent_id": "aa107a2f-155c-440c-9cc7-2ab900b08cab", "bot_id": "595ce3db-e0fb-4e57-b238-a2f959af2c69", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":1700066438126424, "initial_ts":1700066438126, "batch_id":17000664380239952, "batch_name":"", "job_schedule_id":1568, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "DBOpsBot", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"595ce3db-e0fb-4e57-b238-a2f959af2c69", "bot_name":"DBOpsBot", "process_context":"inserting_pre_aggregate_stats", "task_name":"inserting_pre_aggregate_stats", "process_id":"1700066438126424", "task_ts":1700066698808, "batch_id":"17000664380239952", "status_code_id": 6 } } ] }
""2023-11-15 16:44:58.825 [Thread-536] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:44:58.828 [Thread-536] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:44:58.828 [Thread-536] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:58.828 [Thread-536] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot finished processing message with id aa107a2f-155c-440c-9cc7-2ab900b08cab
""2023-11-15 16:44:58.863 [Thread-520] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 7b28e22d-3ddf-4bc2-8582-71b466eff01f has started processing message with message_id 57bd410e-36d3-45d4-bc0f-7c90b300426b and thread_id 667 
""2023-11-15 16:44:58.863 [Thread-520] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:58.863 [Thread-520] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=aa107a2f-155c-440c-9cc7-2ab900b08cab, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=57bd410e-36d3-45d4-bc0f-7c90b300426b, task_retry_intervals_secs=[], bot_id=595ce3db-e0fb-4e57-b238-a2f959af2c69, message_topic=nabu_2_taskmonitor, tags={process_id=1700066438126424, initial_ts=1700066438126, batch_name=, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, DBOpsBot, TaskMonitorBot]}}
""2023-11-15 16:44:58.874 [Thread-520] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 1700066438126424, 'DBOpsBot', 'inserting_pre_aggregate_stats', 'inserting_pre_aggregate_stats', 6 , TO_TIMESTAMP(1700066698808::double precision / 1000) ,'595ce3db-e0fb-4e57-b238-a2f959af2c69');
""2023-11-15 16:44:58.874 [Thread-520] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 7b28e22d-3ddf-4bc2-8582-71b466eff01f has started process logic with message_id 57bd410e-36d3-45d4-bc0f-7c90b300426b and thread_id 667
""2023-11-15 16:44:58.880 [Thread-520] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 7b28e22d-3ddf-4bc2-8582-71b466eff01f has finished process logic with message_id 57bd410e-36d3-45d4-bc0f-7c90b300426b and thread_id 667
""2023-11-15 16:44:58.880 [Thread-520] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:58.880 [Thread-520] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 57bd410e-36d3-45d4-bc0f-7c90b300426b
""2023-11-15 16:44:58.946 [Thread-892] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select
case when ce.valid_to_ts = '9999-12-31' then true else false
end as is_valid_compute_engine
from nabu.data_movement_physical dmp
left outer join nabu.compute_engine ce
on dmp.compute_engine_id = ce.compute_engine_id
where dmp.data_movement_id = 261
and dmp.valid_to_ts ='9999-12-31'
""2023-11-15 16:44:59.048 [Thread-892] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with fetch_ssh_configuration as (
select  case when c.config_json->>'hostname' = '' or c.config_json->>'hostname' is null then 'null' else c.config_json->>'hostname' end as ssh_host,
        case when c.config_json->>'username' = '' or c.config_json->>'username' is null then 'null' else c.config_json->>'username' end as ssh_username,
       case when b.compute_engine_info->>'nabu_external_path'= '' or b.compute_engine_info->>'nabu_external_path' is null  then 'null' else b.compute_engine_info->>'nabu_external_path' end as spark_location,
        c.config_json->>'kerberos' as kerberos,
        a.data_movement_id , b.engine_mapping_id,b.compute_engine_info
      from nabu.data_movement_physical a
inner join nabu.compute_engine b on a.compute_engine_id = b.compute_engine_id
inner join nabu.config c on  b.compute_engine_config_id = c.config_id
where a.data_movement_id =261
)
select ssh_host,ssh_username,kerberos::boolean,d.spark_location,
case when engine_sub_type ~*'cdh|cdp' and kerberos ='false'
          then additional_properties ->> 'non_kerberos_sub_engine_path'
          else additional_properties ->> 'default_sub_engine_path' end as engine_path,replace(encode(compute_engine_info::text::bytea,'base64'),E'\n','') as compute_engine_info,
case when engine_sub_type ~*'cdh|cdp|insight|standalone' then spark_location||'/nabu-spark-bots/keys/privateKey'
     when engine_sub_type ~*'cde' then '/app/mount/privateKey'
     when engine_sub_type ~*'dataproc|glue|databricks' then 'privateKey'
     else null
     end as private_key_path
from fetch_ssh_configuration d
inner join nabu.engine_mapping_lookup e on d.engine_mapping_id = e.engine_mapping_id
inner join nabu.engine_sub_type_lookup f on f.engine_sub_type_id = e.engine_sub_type_id
""2023-11-15 16:44:59.068 [Thread-892] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select '1568_261_17000664380239952' as file_path
""2023-11-15 16:44:59.082 [Thread-892] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select * from nabu.job_type_lookup jtl where job_type_id =1 and job_type ~*'ingestion'
""2023-11-15 16:44:59.087 [Thread-892] DEBUG com.modak.bots.DBOpsBot - to execute query timeTakenInMillis : 526
""2023-11-15 16:44:59.087 [Thread-892] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 88f8e05b-fa7f-43f1-a36e-71e7922935a9 has finished process logic with message_id b3b6ac55-71c9-458c-a4a0-06742c566dc3 and thread_id 1105
""2023-11-15 16:44:59.087 [Thread-892] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : true
""2023-11-15 16:44:59.087 [Thread-892] INFO  com.modak.bots.basebot.AbstractBaseBot -  skipBotLogic == false && useIncomingData == true ..,so both inputData map and botLogic output map is send as output message
""2023-11-15 16:44:59.087 [Thread-892] INFO  com.modak.bots.basebot.AbstractBaseBot - botLogicOutput : { "check_compute_engine_validity" : [ { "is_valid_compute_engine" : true } ], "get_worlflow_type" : [ { "job_type_id" : 1, "job_type" : "ingestion", "job_description" : "This is an Ingestion Job" } ], "fetching_credential_inputs" : [ { "file_path" : "1568_261_17000664380239952" } ], "fetching_script_inputs" : [ { "ssh_host" : "null", "ssh_username" : "null", "kerberos" : null, "spark_location" : "null", "engine_path" : "azure_databricks", "compute_engine_info" : "ewoiY2x1c3Rlcl9pZCI6IjA5MjItMDAzMTM4LW9ybjlyMHRlIiwic3BhcmtfdmVyc2lvbl92YWx1ZSI6IjNfMSIsInNjYWxhX3ZlcnNpb25fdmFsdWUiOiIyXzEyIiwiY3JlZGVudGlhbHNfZmlsZXBhdGgiOiIiLCJjbHVzdGVyX2xpYnJhcnlfcGF0aCI6Ii9kYmZzL3RtcCIsInNwYXJrX3ZlcnNpb24iOiIzLjEiLCJzY2FsYV92ZXJzaW9uIjoiMi4xMiIKfQ==", "private_key_path" : "privateKey" } ] }
""2023-11-15 16:44:59.123 [Thread-892] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "ScriptBot", "bot_metadata": { "message_id": "da7ece55-4495-467a-8eb4-3abf993801f8", "parent_id": "b3b6ac55-71c9-458c-a4a0-06742c566dc3", "bot_id": "88f8e05b-fa7f-43f1-a36e-71e7922935a9", "message_topic":"nabu_2_scriptbot", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":1700066438126424, "initial_ts":1700066438126, "batch_id":17000664380239952, "batch_name":"", "job_schedule_id":1568, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "DBOpsBot", "ScriptBot" ]}, "message_context": "delete_filecontent_credentials", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "delete_filecontent_credentials", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "pre_task_logging_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "pre_log_template" }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "command_to_delete_credentials" }, "input_data": { "is_valid_compute_engine":true, "data":{ "query_input" : { "start_time" : 1700066442527, "batch_id" : "17000664380239952", "job_schedule_id" : "1568", "datastore_id" : null, "data_movement_id" : "261", "end_time" : 1700066698240, "job_type_id" : 1, "is_flow_timed_out" : false, "metadata_category" : null }, "botLogicOutputMap" : { "check_compute_engine_validity" : [ { "is_valid_compute_engine" : true } ], "get_worlflow_type" : [ { "job_type" : "ingestion", "job_description" : "This is an Ingestion Job", "job_type_id" : 1 } ], "fetching_credential_inputs" : [ { "file_path" : "1568_261_17000664380239952" } ], "fetching_script_inputs" : [ { "engine_path" : "azure_databricks", "ssh_username" : "null", "spark_location" : "null", "ssh_host" : "null", "kerberos" : null, "compute_engine_info" : "ewoiY2x1c3Rlcl9pZCI6IjA5MjItMDAzMTM4LW9ybjlyMHRlIiwic3BhcmtfdmVyc2lvbl92YWx1ZSI6IjNfMSIsInNjYWxhX3ZlcnNpb25fdmFsdWUiOiIyXzEyIiwiY3JlZGVudGlhbHNfZmlsZXBhdGgiOiIiLCJjbHVzdGVyX2xpYnJhcnlfcGF0aCI6Ii9kYmZzL3RtcCIsInNwYXJrX3ZlcnNpb24iOiIzLjEiLCJzY2FsYV92ZXJzaW9uIjoiMi4xMiIKfQ==", "private_key_path" : "privateKey" } ] }, "batch_id" : "17000664380239952", "template_execution_type" : "sequential", "useTransactionControl" : true, "currentBotMessageMap" : { "parent_id" : "b3b6ac55-71c9-458c-a4a0-06742c566dc3", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "message_context" : "get_created_credentials_details_if_exists", "message_id" : "b3b6ac55-71c9-458c-a4a0-06742c566dc3", "task_retry_intervals_secs" : [], "bot_id" : "9a243656-a8f6-45a1-bf1a-431a00d18e91", "message_topic" : "nabu_2_jdbc", "tags" : { "process_id" : 1700066438126424, "initial_ts" : 1700066438126, "batch_name" : "", "environment" : "modak", "batch_id" : 17000664380239952, "job_schedule_id" : 1568, "data_movement_id" : 261, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "last_run_timestamp" : "", "retry_attempt" : 0, "ignore_job_termination" : true, "tags" : [ "AuthToken", "DBOpsBot", "DBOpsBot", "DBOpsBot" ] } } }, "batch_id": 17000664380239952, "file_path":"1568_261_17000664380239952", "ssh_host":"null", "ssh_username":"null", "spark_location":"null", "compute_engine_info":"ewoiY2x1c3Rlcl9pZCI6IjA5MjItMDAzMTM4LW9ybjlyMHRlIiwic3BhcmtfdmVyc2lvbl92YWx1ZSI6IjNfMSIsInNjYWxhX3ZlcnNpb25fdmFsdWUiOiIyXzEyIiwiY3JlZGVudGlhbHNfZmlsZXBhdGgiOiIiLCJjbHVzdGVyX2xpYnJhcnlfcGF0aCI6Ii9kYmZzL3RtcCIsInNwYXJrX3ZlcnNpb24iOiIzLjEiLCJzY2FsYV92ZXJzaW9uIjoiMi4xMiIKfQ==", "engine_path":"azure_databricks" }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "task_status_success_msg" } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "error_template_create_msg" } ] } , { "task_name": "delete_ondemandbot_credentials", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "pre_task_logging_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "pre_log_template" }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "command_to_delete_ondemand_credentials" }, "input_data": { "is_valid_compute_engine":true , "data":{ "query_input" : { "start_time" : 1700066442527, "batch_id" : "17000664380239952", "job_schedule_id" : "1568", "datastore_id" : null, "data_movement_id" : "261", "end_time" : 1700066698240, "job_type_id" : 1, "is_flow_timed_out" : false, "metadata_category" : null }, "botLogicOutputMap" : { "check_compute_engine_validity" : [ { "is_valid_compute_engine" : true } ], "get_worlflow_type" : [ { "job_type" : "ingestion", "job_description" : "This is an Ingestion Job", "job_type_id" : 1 } ], "fetching_credential_inputs" : [ { "file_path" : "1568_261_17000664380239952" } ], "fetching_script_inputs" : [ { "engine_path" : "azure_databricks", "ssh_username" : "null", "spark_location" : "null", "ssh_host" : "null", "kerberos" : null, "compute_engine_info" : "ewoiY2x1c3Rlcl9pZCI6IjA5MjItMDAzMTM4LW9ybjlyMHRlIiwic3BhcmtfdmVyc2lvbl92YWx1ZSI6IjNfMSIsInNjYWxhX3ZlcnNpb25fdmFsdWUiOiIyXzEyIiwiY3JlZGVudGlhbHNfZmlsZXBhdGgiOiIiLCJjbHVzdGVyX2xpYnJhcnlfcGF0aCI6Ii9kYmZzL3RtcCIsInNwYXJrX3ZlcnNpb24iOiIzLjEiLCJzY2FsYV92ZXJzaW9uIjoiMi4xMiIKfQ==", "private_key_path" : "privateKey" } ] }, "batch_id" : "17000664380239952", "template_execution_type" : "sequential", "useTransactionControl" : true, "currentBotMessageMap" : { "parent_id" : "b3b6ac55-71c9-458c-a4a0-06742c566dc3", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "message_context" : "get_created_credentials_details_if_exists", "message_id" : "b3b6ac55-71c9-458c-a4a0-06742c566dc3", "task_retry_intervals_secs" : [], "bot_id" : "9a243656-a8f6-45a1-bf1a-431a00d18e91", "message_topic" : "nabu_2_jdbc", "tags" : { "process_id" : 1700066438126424, "initial_ts" : 1700066438126, "batch_name" : "", "environment" : "modak", "batch_id" : 17000664380239952, "job_schedule_id" : 1568, "data_movement_id" : 261, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "last_run_timestamp" : "", "retry_attempt" : 0, "ignore_job_termination" : true, "tags" : [ "AuthToken", "DBOpsBot", "DBOpsBot", "DBOpsBot" ] } } }, "file_path":"1568_261_17000664380239952", "ssh_host":"null", "ssh_username":"null", "spark_location":"null", "compute_engine_info":"ewoiY2x1c3Rlcl9pZCI6IjA5MjItMDAzMTM4LW9ybjlyMHRlIiwic3BhcmtfdmVyc2lvbl92YWx1ZSI6IjNfMSIsInNjYWxhX3ZlcnNpb25fdmFsdWUiOiIyXzEyIiwiY3JlZGVudGlhbHNfZmlsZXBhdGgiOiIiLCJjbHVzdGVyX2xpYnJhcnlfcGF0aCI6Ii9kYmZzL3RtcCIsInNwYXJrX3ZlcnNpb24iOiIzLjEiLCJzY2FsYV92ZXJzaW9uIjoiMi4xMiIKfQ==", "engine_path":"azure_databricks" }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "task_status_success_msg" } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "error_template_create_msg" } ] } ] }
""2023-11-15 16:44:59.127 [Thread-892] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_scriptbot
""2023-11-15 16:44:59.131 [Thread-892] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_scriptbot
""2023-11-15 16:44:59.131 [Thread-892] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:59.131 [Thread-892] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot finished processing message with id b3b6ac55-71c9-458c-a4a0-06742c566dc3
""2023-11-15 16:44:59.211 [Thread-764] INFO  com.modak.bots.basebot.AbstractBaseBot - ScriptBot with bot_id 25d0cc28-1d9c-4797-94cb-234db3d8fe4f has started processing message with message_id da7ece55-4495-467a-8eb4-3abf993801f8 and thread_id 954 
""2023-11-15 16:44:59.211 [Thread-764] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:59.211 [Thread-764] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=b3b6ac55-71c9-458c-a4a0-06742c566dc3, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=delete_filecontent_credentials, message_id=da7ece55-4495-467a-8eb4-3abf993801f8, task_retry_intervals_secs=[], bot_id=88f8e05b-fa7f-43f1-a36e-71e7922935a9, message_topic=nabu_2_scriptbot, tags={process_id=1700066438126424, initial_ts=1700066438126, batch_name=, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, DBOpsBot, ScriptBot]}}
""2023-11-15 16:44:59.226 [Thread-764] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
["sh","-l","-c","$NABU_ROOT_INSTALLATION/botworks/scripts/deleteCredentials.sh null null azure_databricks null 1568_261_17000664380239952"]
""2023-11-15 16:44:59.239 [Thread-764] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 16:44:59.241 [Thread-764] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:44:59.245 [Thread-764] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:44:59.245 [Thread-764] INFO  com.modak.bots.basebot.AbstractBaseBot - ScriptBot with bot_id 25d0cc28-1d9c-4797-94cb-234db3d8fe4f has started process logic with message_id da7ece55-4495-467a-8eb4-3abf993801f8 and thread_id 954
""2023-11-15 16:44:59.245 [Thread-764] INFO  ScriptBot - templateProcessedOutput : ["sh","-l","-c","$NABU_ROOT_INSTALLATION/botworks/scripts/deleteCredentials.sh null null azure_databricks null 1568_261_17000664380239952"]
""2023-11-15 16:44:59.245 [Thread-764] DEBUG ScriptBot - command to be executed  [sh, -l, -c, $NABU_ROOT_INSTALLATION/botworks/scripts/deleteCredentials.sh null null azure_databricks null 1568_261_17000664380239952]
""2023-11-15 16:44:59.274 [Thread-128] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 568ef160-0090-481a-b7fb-be051b3c6ef2 has started processing message with message_id dad1d9e0-4afb-4411-b92e-b512ba3dc371 and thread_id 210 
""2023-11-15 16:44:59.274 [Thread-128] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:59.274 [Thread-128] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=da7ece55-4495-467a-8eb4-3abf993801f8, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=dad1d9e0-4afb-4411-b92e-b512ba3dc371, task_retry_intervals_secs=[], bot_id=25d0cc28-1d9c-4797-94cb-234db3d8fe4f, message_topic=nabu_2_taskmonitor, tags={process_id=1700066438126424, initial_ts=1700066438126, batch_name=, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, DBOpsBot, ScriptBot, TaskMonitorBot]}}
""2023-11-15 16:44:59.282 [Thread-764] DEBUG ScriptBot - spark engine is azure_databricks
""2023-11-15 16:44:59.284 [Thread-128] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 1700066438126424, 'ScriptBot', 'delete_filecontent_credentials', 'delete_filecontent_credentials', 10 , TO_TIMESTAMP(1700066699211::double precision / 1000) ,'25d0cc28-1d9c-4797-94cb-234db3d8fe4f');
""2023-11-15 16:44:59.285 [Thread-128] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 568ef160-0090-481a-b7fb-be051b3c6ef2 has started process logic with message_id dad1d9e0-4afb-4411-b92e-b512ba3dc371 and thread_id 210
""2023-11-15 16:44:59.315 [Thread-128] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 568ef160-0090-481a-b7fb-be051b3c6ef2 has finished process logic with message_id dad1d9e0-4afb-4411-b92e-b512ba3dc371 and thread_id 210
""2023-11-15 16:44:59.315 [Thread-128] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:59.315 [Thread-128] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id dad1d9e0-4afb-4411-b92e-b512ba3dc371
""2023-11-15 16:44:59.612 [Thread-764] DEBUG ScriptBot - [2023-11-15 16:44:59,612] 	 INFO:Deleted /opt/nabu/nabu-spark-bots/azure_databricks/creds/1568_261_17000664380239952 directory successfully
""2023-11-15 16:44:59.683 [Thread-764] INFO  ScriptBot -  exit status : 0
""2023-11-15 16:44:59.683 [Thread-764] INFO  ScriptBot - Script executed successfully
""2023-11-15 16:44:59.684 [Thread-764] INFO  com.modak.bots.basebot.AbstractBaseBot - ScriptBot with bot_id 25d0cc28-1d9c-4797-94cb-234db3d8fe4f has finished process logic with message_id da7ece55-4495-467a-8eb4-3abf993801f8 and thread_id 954
""2023-11-15 16:44:59.684 [Thread-764] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-15 16:44:59.694 [Thread-764] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "3eeb7d39-4707-4904-89b2-cd361788a4ff", "parent_id": "da7ece55-4495-467a-8eb4-3abf993801f8", "bot_id": "25d0cc28-1d9c-4797-94cb-234db3d8fe4f", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":1700066438126424, "initial_ts":1700066438126, "batch_id":17000664380239952, "batch_name":"", "job_schedule_id":1568, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "DBOpsBot", "ScriptBot", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"25d0cc28-1d9c-4797-94cb-234db3d8fe4f", "bot_name":"ScriptBot", "process_context":"delete_filecontent_credentials", "task_name":"delete_filecontent_credentials", "process_id":"1700066438126424", "task_ts":1700066699684, "batch_id":"17000664380239952", "status_code_id": 6 } } ] }
""2023-11-15 16:44:59.696 [Thread-764] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:44:59.700 [Thread-764] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:44:59.700 [Thread-764] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:59.701 [Thread-764] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:59.701 [Thread-764] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=b3b6ac55-71c9-458c-a4a0-06742c566dc3, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=delete_filecontent_credentials, message_id=da7ece55-4495-467a-8eb4-3abf993801f8, task_retry_intervals_secs=[], bot_id=88f8e05b-fa7f-43f1-a36e-71e7922935a9, message_topic=nabu_2_scriptbot, tags={process_id=1700066438126424, initial_ts=1700066438126, batch_name=, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, DBOpsBot, ScriptBot]}}
""2023-11-15 16:44:59.713 [Thread-764] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
["sh","-l","-c","$NABU_ROOT_INSTALLATION/botworks/scripts/deleteBotCredentials.sh 1568_261_17000664380239952"]
""2023-11-15 16:44:59.723 [Thread-128] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 568ef160-0090-481a-b7fb-be051b3c6ef2 has started processing message with message_id 3eeb7d39-4707-4904-89b2-cd361788a4ff and thread_id 210 
""2023-11-15 16:44:59.723 [Thread-128] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:59.723 [Thread-128] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=da7ece55-4495-467a-8eb4-3abf993801f8, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=3eeb7d39-4707-4904-89b2-cd361788a4ff, task_retry_intervals_secs=[], bot_id=25d0cc28-1d9c-4797-94cb-234db3d8fe4f, message_topic=nabu_2_taskmonitor, tags={process_id=1700066438126424, initial_ts=1700066438126, batch_name=, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, DBOpsBot, ScriptBot, TaskMonitorBot]}}
""2023-11-15 16:44:59.729 [Thread-764] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-15 16:44:59.730 [Thread-764] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:44:59.736 [Thread-764] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:44:59.736 [Thread-764] INFO  com.modak.bots.basebot.AbstractBaseBot - ScriptBot with bot_id 25d0cc28-1d9c-4797-94cb-234db3d8fe4f has started process logic with message_id da7ece55-4495-467a-8eb4-3abf993801f8 and thread_id 954
""2023-11-15 16:44:59.736 [Thread-764] INFO  ScriptBot - templateProcessedOutput : ["sh","-l","-c","$NABU_ROOT_INSTALLATION/botworks/scripts/deleteBotCredentials.sh 1568_261_17000664380239952"]
""2023-11-15 16:44:59.736 [Thread-764] DEBUG ScriptBot - command to be executed  [sh, -l, -c, $NABU_ROOT_INSTALLATION/botworks/scripts/deleteBotCredentials.sh 1568_261_17000664380239952]
""2023-11-15 16:44:59.746 [Thread-128] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 1700066438126424, 'ScriptBot', 'delete_filecontent_credentials', 'delete_filecontent_credentials', 6 , TO_TIMESTAMP(1700066699684::double precision / 1000) ,'25d0cc28-1d9c-4797-94cb-234db3d8fe4f');
""2023-11-15 16:44:59.746 [Thread-128] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 568ef160-0090-481a-b7fb-be051b3c6ef2 has started process logic with message_id 3eeb7d39-4707-4904-89b2-cd361788a4ff and thread_id 210
""2023-11-15 16:44:59.752 [Thread-128] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 568ef160-0090-481a-b7fb-be051b3c6ef2 has finished process logic with message_id 3eeb7d39-4707-4904-89b2-cd361788a4ff and thread_id 210
""2023-11-15 16:44:59.752 [Thread-128] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:59.752 [Thread-128] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 3eeb7d39-4707-4904-89b2-cd361788a4ff
""2023-11-15 16:44:59.813 [Thread-352] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 26150391-fc68-4008-a147-71e1ad030380 has started processing message with message_id f060ad36-dc22-494b-8d6b-08fc0b56a66f and thread_id 471 
""2023-11-15 16:44:59.813 [Thread-352] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:59.813 [Thread-352] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=da7ece55-4495-467a-8eb4-3abf993801f8, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=f060ad36-dc22-494b-8d6b-08fc0b56a66f, task_retry_intervals_secs=[], bot_id=25d0cc28-1d9c-4797-94cb-234db3d8fe4f, message_topic=nabu_2_taskmonitor, tags={process_id=1700066438126424, initial_ts=1700066438126, batch_name=, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, DBOpsBot, ScriptBot, TaskMonitorBot]}}
""2023-11-15 16:44:59.830 [Thread-352] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 1700066438126424, 'ScriptBot', 'delete_filecontent_credentials', 'delete_ondemandbot_credentials', 10 , TO_TIMESTAMP(1700066699701::double precision / 1000) ,'25d0cc28-1d9c-4797-94cb-234db3d8fe4f');
""2023-11-15 16:44:59.830 [Thread-352] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 26150391-fc68-4008-a147-71e1ad030380 has started process logic with message_id f060ad36-dc22-494b-8d6b-08fc0b56a66f and thread_id 471
""2023-11-15 16:44:59.912 [Thread-352] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 26150391-fc68-4008-a147-71e1ad030380 has finished process logic with message_id f060ad36-dc22-494b-8d6b-08fc0b56a66f and thread_id 471
""2023-11-15 16:44:59.912 [Thread-352] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:44:59.912 [Thread-352] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id f060ad36-dc22-494b-8d6b-08fc0b56a66f
""2023-11-15 16:45:00.073 [Thread-764] DEBUG ScriptBot - [2023-11-15 16:45:00,073] 	 INFO:checking for path /opt/nabu/botworks/scripts/creds/1568_261_17000664380239952 
""2023-11-15 16:45:00.073 [Thread-764] DEBUG ScriptBot - [2023-11-15 16:45:00,073] 	 ERROR:No directory to be deleted
""2023-11-15 16:45:00.073 [Thread-764] DEBUG ScriptBot - False
""2023-11-15 16:45:00.151 [Thread-764] INFO  ScriptBot -  exit status : 0
""2023-11-15 16:45:00.151 [Thread-764] INFO  ScriptBot - Script executed successfully
""2023-11-15 16:45:00.151 [Thread-764] INFO  com.modak.bots.basebot.AbstractBaseBot - ScriptBot with bot_id 25d0cc28-1d9c-4797-94cb-234db3d8fe4f has finished process logic with message_id da7ece55-4495-467a-8eb4-3abf993801f8 and thread_id 954
""2023-11-15 16:45:00.151 [Thread-764] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-15 16:45:00.163 [Thread-764] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "51b45f32-44be-4dab-951e-d6640745027b", "parent_id": "da7ece55-4495-467a-8eb4-3abf993801f8", "bot_id": "25d0cc28-1d9c-4797-94cb-234db3d8fe4f", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":1700066438126424, "initial_ts":1700066438126, "batch_id":17000664380239952, "batch_name":"", "job_schedule_id":1568, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "DBOpsBot", "ScriptBot", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"25d0cc28-1d9c-4797-94cb-234db3d8fe4f", "bot_name":"ScriptBot", "process_context":"delete_filecontent_credentials", "task_name":"delete_ondemandbot_credentials", "process_id":"1700066438126424", "task_ts":1700066700151, "batch_id":"17000664380239952", "status_code_id": 6 } } ] }
""2023-11-15 16:45:00.165 [Thread-764] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:45:00.169 [Thread-764] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:45:00.169 [Thread-764] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:45:00.169 [Thread-764] INFO  com.modak.bots.basebot.AbstractBaseBot - ScriptBot finished processing message with id da7ece55-4495-467a-8eb4-3abf993801f8
""2023-11-15 16:45:00.213 [Thread-680] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id b1b82409-9b47-41cf-be41-09ddeb2d8af9 has started processing message with message_id 51b45f32-44be-4dab-951e-d6640745027b and thread_id 856 
""2023-11-15 16:45:00.213 [Thread-680] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:45:00.213 [Thread-680] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=da7ece55-4495-467a-8eb4-3abf993801f8, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=51b45f32-44be-4dab-951e-d6640745027b, task_retry_intervals_secs=[], bot_id=25d0cc28-1d9c-4797-94cb-234db3d8fe4f, message_topic=nabu_2_taskmonitor, tags={process_id=1700066438126424, initial_ts=1700066438126, batch_name=, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, DBOpsBot, ScriptBot, TaskMonitorBot]}}
""2023-11-15 16:45:00.224 [Thread-680] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 1700066438126424, 'ScriptBot', 'delete_filecontent_credentials', 'delete_ondemandbot_credentials', 6 , TO_TIMESTAMP(1700066700151::double precision / 1000) ,'25d0cc28-1d9c-4797-94cb-234db3d8fe4f');
""2023-11-15 16:45:00.224 [Thread-680] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id b1b82409-9b47-41cf-be41-09ddeb2d8af9 has started process logic with message_id 51b45f32-44be-4dab-951e-d6640745027b and thread_id 856
""2023-11-15 16:45:00.251 [Thread-680] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id b1b82409-9b47-41cf-be41-09ddeb2d8af9 has finished process logic with message_id 51b45f32-44be-4dab-951e-d6640745027b and thread_id 856
""2023-11-15 16:45:00.251 [Thread-680] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:45:00.251 [Thread-680] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 51b45f32-44be-4dab-951e-d6640745027b
""2023-11-15 16:45:06.452 [pool-24-thread-1] DEBUG com.modak.bots.flowcontroller.FlowController - Flow : ingestion_261_17000664380239952 has completed
""2023-11-15 16:45:06.452 [pool-24-thread-1] DEBUG com.modak.bots.flowcontroller.FlowController - start flow inside the loop
""2023-11-15 16:45:06.653 [pool-24-thread-1] DEBUG com.modak.bots.flowcontroller.FlowController - Inside startFlows() of batchid 17000664380239952
""2023-11-15 16:45:06.653 [pool-24-thread-1] DEBUG com.modak.bots.flowcontroller.FlowController - flowsToBeStartedMap in startflows() : {}
""2023-11-15 16:45:06.653 [pool-24-thread-1] DEBUG com.modak.bots.flowcontroller.FlowController - done with startFlows() inside while loop
""2023-11-15 16:45:06.653 [pool-24-thread-1] DEBUG com.modak.bots.flowcontroller.FlowController - All Flows in flow controller has completed
""2023-11-15 16:45:06.653 [pool-24-thread-1] DEBUG com.modak.bots.flowcontroller.FlowController - Time taken to complete all flows: 264 sec
""2023-11-15 16:45:06.654 [pool-24-thread-1] INFO  com.modak.bots.basebot.AbstractBaseBot - FlowControllerBot with bot_id 9a243656-a8f6-45a1-bf1a-431a00d18e91 has finished process logic with message_id f4fca0e9-0d78-4928-b49f-ecea9eb3b5cf and thread_id 2466
""2023-11-15 16:45:06.654 [pool-24-thread-1] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-15 16:45:06.666 [pool-24-thread-1] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "4f2b7c09-6b36-46a1-a2b1-2026e1843047", "parent_id": "f4fca0e9-0d78-4928-b49f-ecea9eb3b5cf", "bot_id": "9a243656-a8f6-45a1-bf1a-431a00d18e91", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":1700066438126424, "initial_ts":1700066438126, "batch_id":17000664380239952, "batch_name":"", "job_schedule_id":1568, "data_movement_id": 261, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"9a243656-a8f6-45a1-bf1a-431a00d18e91", "bot_name":"FlowControllerBot", "process_context":"flowcontroller_message_to_generate_flows", "task_name":"generate_flows", "process_id":"1700066438126424", "task_ts":1700066706654, "batch_id":"17000664380239952", "status_code_id": 6 } } ] }
""2023-11-15 16:45:06.668 [pool-24-thread-1] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:45:06.672 [pool-24-thread-1] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-15 16:45:06.684 [pool-24-thread-1] INFO  com.modak.utils.logging.LoggingTemplateUtitlity - 2023-11-15 16:45:06.673 Task end generate_flows of process_id 1700066438126424 of bot FlowControllerBot  with id 9a243656-a8f6-45a1-bf1a-431a00d18e91
""2023-11-15 16:45:06.685 [pool-24-thread-1] INFO  com.modak.utils.logging.FileLogger - ../logs/logger_output.log
""2023-11-15 16:45:06.685 [pool-24-thread-1] DEBUG com.modak.utils.logging.FileLogger - Log file executed 2023-11-15 16:45:06.673 Task end generate_flows of process_id 1700066438126424 of bot FlowControllerBot  with id 9a243656-a8f6-45a1-bf1a-431a00d18e91 
""2023-11-15 16:45:06.685 [pool-24-thread-1] INFO  com.modak.bots.basebot.AbstractBaseBot - FlowControllerBot finished processing message with id f4fca0e9-0d78-4928-b49f-ecea9eb3b5cf
""2023-11-15 16:45:06.688 [Thread-1268] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 1b2aa280-8a50-4145-a5ec-9e43e0244f78 has started processing message with message_id 4f2b7c09-6b36-46a1-a2b1-2026e1843047 and thread_id 1543 
""2023-11-15 16:45:06.688 [Thread-1268] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:45:06.688 [Thread-1268] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=f4fca0e9-0d78-4928-b49f-ecea9eb3b5cf, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=4f2b7c09-6b36-46a1-a2b1-2026e1843047, task_retry_intervals_secs=[], bot_id=9a243656-a8f6-45a1-bf1a-431a00d18e91, message_topic=nabu_2_taskmonitor, tags={process_id=1700066438126424, initial_ts=1700066438126, batch_name=, environment=modak, batch_id=17000664380239952, job_schedule_id=1568, data_movement_id=261, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, TaskMonitorBot]}}
""2023-11-15 16:45:06.699 [Thread-1268] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17000664380239952, 1700066438126424, 'FlowControllerBot', 'flowcontroller_message_to_generate_flows', 'generate_flows', 6 , TO_TIMESTAMP(1700066706654::double precision / 1000) ,'9a243656-a8f6-45a1-bf1a-431a00d18e91');
""2023-11-15 16:45:06.699 [Thread-1268] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 1b2aa280-8a50-4145-a5ec-9e43e0244f78 has started process logic with message_id 4f2b7c09-6b36-46a1-a2b1-2026e1843047 and thread_id 1543
""2023-11-15 16:45:06.725 [Thread-1268] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 1b2aa280-8a50-4145-a5ec-9e43e0244f78 has finished process logic with message_id 4f2b7c09-6b36-46a1-a2b1-2026e1843047 and thread_id 1543
""2023-11-15 16:45:06.725 [Thread-1268] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-15 16:45:06.725 [Thread-1268] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 4f2b7c09-6b36-46a1-a2b1-2026e1843047
"