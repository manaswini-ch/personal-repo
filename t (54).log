"2023-11-17 07:56:00.371 [Thread-480] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 330cfcdb-58fd-46f9-8954-91528f06bc95 has started processing message with message_id 510c3800-7f17-4ff3-a1a1-40aa1d2b5aa7 and thread_id 621 
""2023-11-17 07:56:00.386 [Thread-480] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:00.386 [Thread-480] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, parent_id=e035080f-88d6-4fdb-a318-a1ad0f1a8cc9, message_context=data_movement_initial_flow_queries, message_id=510c3800-7f17-4ff3-a1a1-40aa1d2b5aa7, task_retry_intervals_secs=[], message_topic=nabu_2_jdbc, bot_id=e035080f-88d6-4fdb-a318-a1ad0f1a8cc9, tags={process_id=1700207760003780, initial_ts=1700207760106, environment=modak, batch_id=17002077600028566, job_schedule_id=1624, data_movement_id=271, job_scheduled_user_id=Manaswini Chinthalapudi, generated_ts=1700207760106, task_dependency=true, retry_attempt=0, tags=[AuthToken]}}
""2023-11-17 07:56:00.433 [Thread-480] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
select dm.data_movement_id, case when jsd.job_type_id = 6 then true else false end as manual_retry, coalesce(data_movement_additional_info->'flow_details'->>'retry',data_movement_additional_info->'flow_details'->>'pipeline_retry','false') :: boolean as pipeline_retry, coalesce(data_movement_additional_info->'flow_details'->'pre_conditions'->>'enabled','false') :: boolean as pipeline_pre_conditions_enabled, coalesce(data_movement_additional_info->'flow_details'->>'ignore_null_tables','false') :: boolean as ignore_null_tables_flag from nabu.data_movement_physical dm inner join nabu.job_schedule_details jsd on jsd.data_movement_id =dm.data_movement_id where jsd.valid_to_ts ='9999-12-31' and dm.valid_to_ts = '9999-12-31' and dm.data_movement_id=271 and jsd.job_schedule_id=1624
""2023-11-17 07:56:00.442 [Thread-480] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-17 07:56:00.443 [Thread-480] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-17 07:56:00.449 [Thread-480] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-17 07:56:00.449 [Thread-480] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 330cfcdb-58fd-46f9-8954-91528f06bc95 has started process logic with message_id 510c3800-7f17-4ff3-a1a1-40aa1d2b5aa7 and thread_id 621
""2023-11-17 07:56:00.453 [Thread-408] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ed3cd22-40fc-41f0-a1bf-2e8df394dc31 has started processing message with message_id 8a0be8cc-2add-496f-8d40-439670288ebf and thread_id 537 
""2023-11-17 07:56:00.588 [Thread-408] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:00.588 [Thread-408] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=510c3800-7f17-4ff3-a1a1-40aa1d2b5aa7, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=8a0be8cc-2add-496f-8d40-439670288ebf, task_retry_intervals_secs=[], bot_id=330cfcdb-58fd-46f9-8954-91528f06bc95, message_topic=nabu_2_taskmonitor, tags={process_id=1700207760003780, initial_ts=1700207760106, batch_name=, environment=modak, batch_id=17002077600028566, job_schedule_id=1624, data_movement_id=271, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, TaskMonitorBot]}}
""2023-11-17 07:56:00.601 [Thread-408] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17002077600028566, 1700207760003780, 'DBOpsBot', 'data_movement_initial_flow_queries', 'data_movement_flow_queries', 10 , TO_TIMESTAMP(1700207760386::double precision / 1000) ,'330cfcdb-58fd-46f9-8954-91528f06bc95');
""2023-11-17 07:56:00.602 [Thread-408] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ed3cd22-40fc-41f0-a1bf-2e8df394dc31 has started process logic with message_id 8a0be8cc-2add-496f-8d40-439670288ebf and thread_id 537
""2023-11-17 07:56:01.036 [Thread-480] DEBUG com.modak.bots.DBOpsBot - to execute query timeTakenInMillis : 587
""2023-11-17 07:56:01.036 [Thread-480] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 330cfcdb-58fd-46f9-8954-91528f06bc95 has finished process logic with message_id 510c3800-7f17-4ff3-a1a1-40aa1d2b5aa7 and thread_id 621
""2023-11-17 07:56:01.036 [Thread-480] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : true
""2023-11-17 07:56:01.036 [Thread-480] INFO  com.modak.bots.basebot.AbstractBaseBot -  skipBotLogic == false && useIncomingData == true ..,so both inputData map and botLogic output map is send as output message
""2023-11-17 07:56:01.036 [Thread-480] INFO  com.modak.bots.basebot.AbstractBaseBot - botLogicOutput : { "outputList" : [ { "data_movement_id" : 271, "manual_retry" : false, "pipeline_retry" : false, "pipeline_pre_conditions_enabled" : false, "ignore_null_tables_flag" : false } ] }
""2023-11-17 07:56:01.388 [Thread-408] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ed3cd22-40fc-41f0-a1bf-2e8df394dc31 has finished process logic with message_id 8a0be8cc-2add-496f-8d40-439670288ebf and thread_id 537
""2023-11-17 07:56:01.388 [Thread-408] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:01.388 [Thread-408] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 8a0be8cc-2add-496f-8d40-439670288ebf
""2023-11-17 07:56:01.459 [Thread-480] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "DBOpsBot", "bot_metadata": { "message_topic": "nabu_2_jdbc", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "message_id": "be7daf9f-8d06-44b7-b94d-399b614bdd44", "bot_id": "e035080f-88d6-4fdb-a318-a1ad0f1a8cc9", "parent_id": "e035080f-88d6-4fdb-a318-a1ad0f1a8cc9", "tags": { "process_id": 1700207760003780, "initial_ts": 1700207760106, "generated_ts": 1700207760106, "batch_id":17002077600028566, "data_movement_id": 271, "job_scheduled_user_id": "Manaswini Chinthalapudi", "environment": "modak", "tags": [ "AuthToken", ], "job_schedule_id":1624, "task_dependency": true, "retry_attempt": 0 }, "task_retry_intervals_secs": [ ], "message_context": "starting_message_for_ingestion" }, "bot_tasks": [ { "task_name": "checking_pre_conditions_or_starting_msg_of_ingestion", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "skipLogicPattern": "doNothing", "pre_task_logging_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "pre_log_template" }, "app_template_details": { "template_group": "templates/artifact_ingestion/ingestion_fc.stg", "template_name": "data_movement_queries" }, "input_data": { "template_execution_type": "sequential", "useTransactionControl":false, "query_input": { "bot_topic_prefix" : "nabu_", "workflow_engine_id" : 2, "batch_id": 17002077600028566, "process_id": 1700207760003780, "batch_name": "Ingestion_20231117", "data_movement_id":271, "environment": "DEV", "pipeline_retry": false, "ignore_null_tables_flag":false, "include_blobs": "", "manual_retry":false, "job_schedule_id":1624, "job_scheduled_user_id":"Manaswini Chinthalapudi", "job_type": "ingestion", "destination_type":"", "workflow_route_bot_topic_details" : {"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"} } }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/ingestion_fc.stg", "template_name": "data_movement_deciding_msg" }, { "template_group": "templates/artifact_ingestion/ingestion_flow.stg", "template_name": "task_status_success_msg" } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "error_template_create_msg" } ] } ] }
""2023-11-17 07:56:01.461 [Thread-480] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_jdbc
""2023-11-17 07:56:01.464 [Thread-480] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_jdbc
""2023-11-17 07:56:01.464 [Thread-480] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-17 07:56:01.476 [Thread-480] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "2aa9a72f-4f8a-45f2-8aa0-ba3492e81086", "parent_id": "510c3800-7f17-4ff3-a1a1-40aa1d2b5aa7", "bot_id": "330cfcdb-58fd-46f9-8954-91528f06bc95", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":1700207760003780, "initial_ts":1700207760106, "batch_id":17002077600028566, "batch_name":"", "job_schedule_id":1624, "data_movement_id": 271, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"330cfcdb-58fd-46f9-8954-91528f06bc95", "bot_name":"DBOpsBot", "process_context":"data_movement_initial_flow_queries", "task_name":"data_movement_flow_queries", "process_id":"1700207760003780", "task_ts":1700207761036, "batch_id":"17002077600028566", "status_code_id": 6 } } ] }
""2023-11-17 07:56:01.477 [Thread-480] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-17 07:56:01.480 [Thread-480] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-17 07:56:01.480 [Thread-480] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:01.480 [Thread-480] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot finished processing message with id 510c3800-7f17-4ff3-a1a1-40aa1d2b5aa7
""2023-11-17 07:56:01.594 [Thread-408] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ed3cd22-40fc-41f0-a1bf-2e8df394dc31 has started processing message with message_id 2aa9a72f-4f8a-45f2-8aa0-ba3492e81086 and thread_id 537 
""2023-11-17 07:56:01.594 [Thread-408] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:01.594 [Thread-408] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=510c3800-7f17-4ff3-a1a1-40aa1d2b5aa7, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=2aa9a72f-4f8a-45f2-8aa0-ba3492e81086, task_retry_intervals_secs=[], bot_id=330cfcdb-58fd-46f9-8954-91528f06bc95, message_topic=nabu_2_taskmonitor, tags={process_id=1700207760003780, initial_ts=1700207760106, batch_name=, environment=modak, batch_id=17002077600028566, job_schedule_id=1624, data_movement_id=271, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, TaskMonitorBot]}}
""2023-11-17 07:56:01.604 [Thread-408] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17002077600028566, 1700207760003780, 'DBOpsBot', 'data_movement_initial_flow_queries', 'data_movement_flow_queries', 6 , TO_TIMESTAMP(1700207761036::double precision / 1000) ,'330cfcdb-58fd-46f9-8954-91528f06bc95');
""2023-11-17 07:56:01.604 [Thread-408] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ed3cd22-40fc-41f0-a1bf-2e8df394dc31 has started process logic with message_id 2aa9a72f-4f8a-45f2-8aa0-ba3492e81086 and thread_id 537
""2023-11-17 07:56:01.619 [Thread-408] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ed3cd22-40fc-41f0-a1bf-2e8df394dc31 has finished process logic with message_id 2aa9a72f-4f8a-45f2-8aa0-ba3492e81086 and thread_id 537
""2023-11-17 07:56:01.619 [Thread-408] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:01.619 [Thread-408] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 2aa9a72f-4f8a-45f2-8aa0-ba3492e81086
""2023-11-17 07:56:01.622 [Thread-1084] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id bfb7aff8-e3e2-41bd-b799-ad3147187c77 has started processing message with message_id be7daf9f-8d06-44b7-b94d-399b614bdd44 and thread_id 1329 
""2023-11-17 07:56:01.622 [Thread-1084] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:01.622 [Thread-1084] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, parent_id=e035080f-88d6-4fdb-a318-a1ad0f1a8cc9, message_context=starting_message_for_ingestion, message_id=be7daf9f-8d06-44b7-b94d-399b614bdd44, task_retry_intervals_secs=[], message_topic=nabu_2_jdbc, bot_id=e035080f-88d6-4fdb-a318-a1ad0f1a8cc9, tags={process_id=1700207760003780, initial_ts=1700207760106, environment=modak, batch_id=17002077600028566, job_schedule_id=1624, data_movement_id=271, job_scheduled_user_id=Manaswini Chinthalapudi, generated_ts=1700207760106, task_dependency=true, retry_attempt=0, tags=[AuthToken]}}
""2023-11-17 07:56:01.659 [Thread-1084] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
{ "input_data": { "batch_id": 17002077600028566, "process_id": 1700207760003780, "batch_name": "Ingestion_20231117", "data_movement_id":271, "environment": "DEV", "pipeline_retry": false, "ignore_null_tables_flag": false, "include_blobs": "", "destination_type":"", "job_type":"ingestion", "manual_retry":false, "job_schedule_id":1624, "job_scheduled_user_id":"Manaswini Chinthalapudi", "workflow_route_bot_topic_details" : {"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"} }, "sequential_templates":[ { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "fetch_source_metadata_category", "query_output_key": "source_metadata_category", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "fetch_data_movement_info", "query_output_key": "data_movement_info", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "schema_drift_object_info", "query_output_key": "schema_drift_table_info", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "fetch_job_type_id", "query_output_key": "job_type_id", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "check_if_selected_schemas_are_empty", "query_output_key": "check_if_selected_schemas_are_empty", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "get_deleted_objects", "query_output_key": "get_deleted_objects", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "get_schema_drift_ignore_tables", "query_output_key": "get_schema_drift_ignore_tables", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "insert_schema_drift_ignore_tables", "query_output_key": "insert_schema_drift_ignore_tables", "query_type":"insert" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "advanced_options_mapping_details", "query_output_key": "advanced_options_mapping_details", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "insert_data_movement_schema_drift_table", "query_output_key": "insert_data_movement_schema_drift_table", "query_type":"insert" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "get_datatype_ignore_tables", "query_output_key": "get_datatype_ignore_tables", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "insert_datatype_ignore_tables", "query_output_key": "insert_datatype_ignore_tables", "query_type":"insert" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "fetch_pipeline_data", "query_output_key": "fetch_pipeline_data", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "get_jwt_details", "query_output_key": "get_jwt_details", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "ingestion_object_info", "query_output_key": "nabu_ingestion", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "email_input", "query_output_key": "email_input", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "rest_api_input", "query_output_key": "rest_api_input", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "condition_for_success_mail", "query_output_key": "condition_for_success_mail", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "condition_for_failure_mail", "query_output_key": "condition_for_failure_mail", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "condition_for_schema_drift_mail", "query_output_key": "condition_for_schema_drift_mail", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "get_rest_apis", "query_output_key": "get_rest_apis", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "flows_list_query", "query_output_key": "flows", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "get_batch_datamovement_id", "query_output_key": "get_batch_datamovement_id", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_fc.stg", "query_template_name": "flow_controller_timeout", "query_output_key": "flow_controller_timeout", "query_type":"select" } ], "output_keys":["flows","schema_drift_table_info","get_schema_drift_ignore_tables","get_datatype_ignore_tables","get_batch_datamovement_id","nabu_ingestion","email_input","rest_api_input","condition_for_schema_drift_mail","condition_for_success_mail","condition_for_failure_mail","flow_controller_timeout","get_deleted_objects","source_metadata_category","get_jwt_details", "get_ignore_null_tables","check_if_selected_schemas_are_empty"] }
""2023-11-17 07:56:01.673 [Thread-1084] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-17 07:56:01.674 [Thread-1084] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-17 07:56:01.694 [Thread-1084] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-17 07:56:01.694 [Thread-1084] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id bfb7aff8-e3e2-41bd-b799-ad3147187c77 has started process logic with message_id be7daf9f-8d06-44b7-b94d-399b614bdd44 and thread_id 1329
""2023-11-17 07:56:01.824 [Thread-1268] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 1b2aa280-8a50-4145-a5ec-9e43e0244f78 has started processing message with message_id 1c53ac16-7054-4daf-8ffc-273ba3ed7417 and thread_id 1543 
""2023-11-17 07:56:01.824 [Thread-1268] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:01.824 [Thread-1268] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=be7daf9f-8d06-44b7-b94d-399b614bdd44, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=1c53ac16-7054-4daf-8ffc-273ba3ed7417, task_retry_intervals_secs=[], bot_id=bfb7aff8-e3e2-41bd-b799-ad3147187c77, message_topic=nabu_2_taskmonitor, tags={process_id=1700207760003780, initial_ts=1700207760106, batch_name=, environment=modak, batch_id=17002077600028566, job_schedule_id=1624, data_movement_id=271, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, TaskMonitorBot]}}
""2023-11-17 07:56:01.834 [Thread-1084] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select distinct dm.data_movement_id,dcml.metadata_category as source_type, dscl.dataplace_sub_component_type as source from nabu.data_movement_details_physical dm inner join nabu.dataplace_physical dp on dp.dataplace_id=dm.source_dataplace_id
inner join  nabu.dataplace_component_mapping_lookup dcml on dcml.dataplace_sub_component_id =dp.dataplace_sub_component_id
inner join nabu.dataplace_sub_component_lookup dscl on dcml.dataplace_sub_component_id =dscl.dataplace_sub_component_id
where dm.data_movement_id=271 and dp.valid_to_ts='9999-12-31 00:00:00' and dm.valid_to_ts ='9999-12-31 00:00:00'
""2023-11-17 07:56:01.836 [Thread-1268] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17002077600028566, 1700207760003780, 'DBOpsBot', 'starting_message_for_ingestion', 'checking_pre_conditions_or_starting_msg_of_ingestion', 10 , TO_TIMESTAMP(1700207761622::double precision / 1000) ,'bfb7aff8-e3e2-41bd-b799-ad3147187c77');
""2023-11-17 07:56:01.836 [Thread-1268] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 1b2aa280-8a50-4145-a5ec-9e43e0244f78 has started process logic with message_id 1c53ac16-7054-4daf-8ffc-273ba3ed7417 and thread_id 1543
""2023-11-17 07:56:01.844 [Thread-1268] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 1b2aa280-8a50-4145-a5ec-9e43e0244f78 has finished process logic with message_id 1c53ac16-7054-4daf-8ffc-273ba3ed7417 and thread_id 1543
""2023-11-17 07:56:01.844 [Thread-1268] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:01.844 [Thread-1268] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 1c53ac16-7054-4daf-8ffc-273ba3ed7417
""2023-11-17 07:56:01.878 [Thread-1084] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select  string_agg('('||where_condition||')',' or ') as where_condition,string_agg('('||table_id_where_condition||')',' or ') as table_id_where_condition,workflow_name,schema_drift_option, schema_drift_option_id
from(
select  data_movement_id,source_dataplace_id,source_schema_id,
case when where_condition is null then 'schema_id = '|| source_schema_id || ' and table_type in ('||ingest_all_tables_views||')'||' and dataplace_id = '||source_dataplace_id
          else string_agg('('||where_condition||')',' and ') over(partition by data_movement_id,source_dataplace_id,source_schema_id) || ' and schema_id = ' || source_schema_id || ' and table_type in ('||ingest_all_tables_views||')'||' and dataplace_id = '||source_dataplace_id end as where_condition,
case when where_condition is null then 'schema_id = '|| source_schema_id ||' and dataplace_id = '||source_dataplace_id
          else string_agg('('||where_condition||')',' and ') over(partition by data_movement_id,source_dataplace_id,source_schema_id) || ' and schema_id = ' || source_schema_id || ' and dataplace_id = '||source_dataplace_id end as table_id_where_condition,
ingest_all_tables_views,workflow_name,schema_drift_option, schema_drift_option_id
from(
select  data_movement_id,source_dataplace_id,source_schema_id,
string_agg('('||where_condition||')',' and ') over(partition by data_movement_id,source_dataplace_id,filter_type_id,source_schema_id) as where_condition,
ingest_all_tables_views,workflow_name,schema_drift_option, schema_drift_option_id
from (
select a.data_movement_id, a.source_dataplace_id, a.source_schema_id, a.filter_type_id,workflow_name,
case when a.filter_type_id = 1 then 'table_name ~* '''||regexp_replace(a.filter_rule::text,'\[|\]|"'::text,''::text,'g')||''''
     when a.filter_type_id = 2 then 'table_name !~* '''||regexp_replace(a.filter_rule::text,'\[|\]|"'::text,''::text,'g')||''''
     when a.filter_type_id = 3 then 'table_name like ''%'||regexp_replace(a.filter_rule::text,'\[|\]|"'::text,''::text,'g')||'%'''
     when a.filter_type_id = 4 then 'table_name not like ''%'||regexp_replace(a.filter_rule::text,'\[|\]|"'::text,''::text,'g')||'%'''
     when a.filter_type_id = 5 then 'table_id in ('||regexp_replace(a.filter_rule::text,'\[|\]|"'::text,''::text,'g')||')'
     else null
     end as where_condition,
     regexp_replace(regexp_replace(a.ingest_all_tables_views::text,'"','''','g'),'\[|\]|'::text,''::text,'g') as ingest_all_tables_views,schema_drift_option, schema_drift_option_id
from
(
select b.data_movement_id,source_dataplace_id,
source_schema_directory_id as source_schema_id,destination_dataplace_id,destination_schema_directory_id as destination_schema_id,
filter_rule,filter_type_id,
ingest_all_tables_views,a.priority_order,d.workflow_name,
case when ((((data_movement_additional_info->>'flow_details')::json->>'schema_drift')::json)->>'advanced_options_sub_type') is null then 'drop_create_table' else ((((data_movement_additional_info->>'flow_details')::json->>'schema_drift')::json)->>'advanced_options_sub_type') end as schema_drift_option,
((((data_movement_additional_info->>'flow_details')::json->>'schema_drift')::json)->>'advanced_options_sub_type_id')::int as schema_drift_option_id
from nabu.data_movement_details_physical a
inner join nabu.dataplace_physical dp
on a.destination_dataplace_id =dp.dataplace_id
inner join nabu.data_movement_physical b
on a.data_movement_id = b.data_movement_id
inner join nabu.workflow_engine c on c.workflow_engine_id = b.workflow_engine_id
inner join nabu.bot_configuration_workflow d on d.workflow_id = b.workflow_id
where b.data_movement_id = 271 and a.valid_to_ts = '9999-12-31'
and b.valid_to_ts = '9999-12-31') a
inner join nabu.filter_type_lookup b
on a.filter_type_id = b.filter_type_id
order by data_movement_id,priority_order
) x
) y
) z
group by data_movement_id,workflow_name,schema_drift_option, schema_drift_option_id

""2023-11-17 07:56:01.916 [Thread-1084] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with data_movement_schema_drift_table_ids as(
select * from(
select data_movement_id, dataplace_id, schema_directory_id, object_id, cru_ts, row_number() over(partition by object_id order by cru_ts desc) as rownum
from nabu.data_movement_schema_drift_details
where data_movement_id = 271) a
where rownum = 1
),
get_table_ids as (
select table_id from nabu.dataplace_table_metadata_physical dtmp where ((((table_id in (37234))) and schema_id = 453 and table_type in ('T','V','M') and dataplace_id = 42)) and valid_to_ts = '9999-12-31'
),
get_non_schema_drifted_table_ids as(
select a.dataplace_id,a.schema_id, a.dataplace_component_type_id,a.table_id
from nabu.dataplace_table_schema_drift_details a
inner join
data_movement_schema_drift_table_ids b
on a.table_id = b.object_id
and a.schema_id = b.schema_directory_id
and a.dataplace_id = b.dataplace_id
where a.valid_to_ts = '9999-12-31'
and a.crt_ts < b.cru_ts
and b.data_movement_id = 271
union all
select a.dataplace_id,a.schema_id, a.dataplace_component_type_id,a.table_id
from nabu.dataplace_table_schema_drift_details a
inner join
nabu.structured_jobtotable b
on a.table_id = b.object_id
and a.dataplace_id = b.dataplace_id
where b.data_movement_id = 271
and b.object_type = 'S'
and a.valid_to_ts = '9999-12-31'
and b.cru_ts > a.crt_ts
union all
select a.dataplace_id,a.schema_id, a.dataplace_component_type_id,a.table_id
from nabu.dataplace_table_schema_drift_details a
where table_id in(select * from get_table_ids)
and a.valid_to_ts = '9999-12-31'
and table_id not in (select object_id as table_id from nabu.structured_jobtotable b
where b.data_movement_id = 271 and b.object_type = 'S'
)
)
select string_agg(a.table_id::text,',') as schema_drifted_table_id_list from nabu.dataplace_table_schema_drift_details a
where table_id in (select table_id from get_table_ids)
and a.valid_to_ts = '9999-12-31'
and table_id not in (select table_id from get_non_schema_drifted_table_ids)
""2023-11-17 07:56:01.951 [Thread-1084] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select job_type_id from nabu.job_type_lookup where job_type='ingestion'
""2023-11-17 07:56:01.982 [Thread-1084] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select case count(*) when 0 then true else false end as empty_schma from nabu.dataplace_table_metadata_physical where ((((table_id in (37234))) and schema_id = 453 and table_type in ('T','V','M') and dataplace_id = 42))
""2023-11-17 07:56:02.015 [Thread-1084] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with get_table_ids as(
select row_number()over(partition by table_id order by valid_to_ts desc) as rownum,* from nabu.dataplace_table_metadata_physical
where ((((table_id in (37234))) and schema_id = 453 and table_type in ('T','V','M') and dataplace_id = 42))
)
select string_agg(a.table_id::text,',') as object_id from get_table_ids a where rownum =1 and valid_to_ts != '9999-12-31'
""2023-11-17 07:56:02.050 [Thread-1084] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with cte2 as(
select rows/1 as flow_number,*
from (
select row_number()over(order by table_id) as rows,* from nabu.dataplace_table_metadata_physical
where ((((table_id in (37234))) and schema_id = 453 and table_type in ('T','V','M') and dataplace_id = 42)) and valid_to_ts='9999-12-31'
)a
),
get_schema_drifted_table_ids as(
select a.dataplace_id,a.schema_id, a.schema_name, a.dataplace_component_type_id,a.table_id
from nabu.table_schema_drift a
where 1 = 0
),
table_ids_for_ingestion as(
select a.* from cte2 a left outer join get_schema_drifted_table_ids b
on a.table_id = b.table_id
and a.schema_id = b.schema_id
and a.schema_name = b.schema_name
and a.dataplace_id = b.dataplace_id
and a.dataplace_component_type_id = b.dataplace_component_type_id
where b.table_id is not null)

select string_agg(a.table_id::text,',') as object_id,
30 as status_code_id,
0 as retry_count
from table_ids_for_ingestion a
""2023-11-17 07:56:02.085 [Thread-1084] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : INSERT INTO nabu.flow_task_status
(data_movement_id,  batch_id,job_type_id, status_code_id, retry_count,object_id,process_id, flow_task_ts, flow_task_date)
with cte as (
select 271 as data_movement_id ,  17002077600028566 as batch_id ,1 as job_type_id,30 as status_code_id,0 as retry_count,
unnest(string_to_array('',',' ))::int4 as object_id
)
select a.data_movement_id,a.batch_id,a.job_type_id,a.status_code_id,a.retry_count,a.object_id,('1700207760003780'||a.flow_number) :: bigint as process_id,current_timestamp,current_date from (select cte.*,row_number ()over( order by cte.object_id )as flow_number from cte)a

""2023-11-17 07:56:02.117 [Thread-1084] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query :     select case when ((((data_movement_additional_info->>'flow_details')::json->>'schema_drift')::json)->>'advanced_options_sub_type') is null then 'drop_create_table'
else ((((data_movement_additional_info->>'flow_details')::json->>'schema_drift')::json)->>'advanced_options_sub_type') end as schema_drift_option,
case when ((((data_movement_additional_info->>'flow_details')::json->>'schema_drift')::json)->>'advanced_options_sub_type_id') is null then '3'
else ((((data_movement_additional_info->>'flow_details')::json->>'schema_drift')::json)->>'advanced_options_sub_type_id') end as schema_drift_option_id
,data_movement_id
from nabu.data_movement_physical
where data_movement_id = 271
and valid_to_ts = '9999-12-31'
""2023-11-17 07:56:02.149 [Thread-1084] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with process_id_for_ignore_tables as(select * from nabu.flow_task_status
where status_code_id= 30
and batch_id = 17002077600028566)

INSERT INTO nabu.data_movement_schema_drift_details
(data_movement_id, dataplace_id, schema_directory_id, object_id, advanced_options_sub_type_id, advanced_options_sub_type, cru_by, cru_ts, batch_id, process_id)
select 271 as data_movement_id, a.dataplace_id, a.schema_id as schema_directory_id, a.table_id as object_id,
4 as advanced_options_sub_type_id,
'drop_create_table' as advanced_options_sub_type, 'Modak', now(),
b.batch_id, b.process_id
from nabu.dataplace_table_schema_drift_details a
inner join process_id_for_ignore_tables b
on a.table_id = b.object_id
where 1 = 0

""2023-11-17 07:56:02.179 [Thread-1084] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with datatypes_to_be_ignored as (
 select replace((json_array_elements(data_movement_additional_info->'flow_details'->'ignore_data_types'))::text,'"','') as ignore_data_types
 from nabu.data_movement_physical
 where data_movement_id =271 and valid_to_ts='9999-12-31'
 union
 select source_datatype_name as ignore_data_types from nabu.user_defined_trans_for_unsupported_datatype udtfud where advanced_options_sub_type_id =16 and
	data_movement_id =271 and valid_to_ts='9999-12-31'
),
get_table_ids as(
select table_id from nabu.dataplace_table_metadata_physical dtmp where ((((table_id in (37234))) and schema_id = 453 and table_type in ('T','V','M') and dataplace_id = 42)) and valid_to_ts='9999-12-31'
),
tables_with_valid_column_data_types as (
select table_id, count(*) as cnt
from nabu.dataplace_column_metadata_physical
where table_id in(select * from get_table_ids) and valid_to_ts='9999-12-31'
and data_type not in ( select * from datatypes_to_be_ignored ) group by table_id
),
datatype_ignored_tables as (
select a.table_id, case when b.cnt is null then true when b.cnt is not null then false end as ignore_status_flag
from get_table_ids a
left outer join tables_with_valid_column_data_types b on a.table_id = b.table_id
),
ignored_tables_in_pipeline_adv_opt as(
Select * from datatype_ignored_tables where table_id not in (select object_id from nabu.advanced_options_object_details aood where data_movement_id = 271  and valid_to_ts = '9999-12-31')
)
select string_agg(a.table_id::text,',') as object_id,
 31 as status_code_id,
 0 as retry_count
 from ignored_tables_in_pipeline_adv_opt a where ignore_status_flag=true
""2023-11-17 07:56:02.214 [Thread-1084] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : INSERT INTO nabu.flow_task_status
(data_movement_id,batch_id,job_type_id, status_code_id, retry_count,object_id,process_id, flow_task_ts, flow_task_date)
with cte as (
select 271 as data_movement_id , 17002077600028566 as batch_id ,1 as job_type_id,31 as status_code_id,0 as retry_count,
unnest(string_to_array('',',' ))::int4 as object_id
)
select a.data_movement_id,a.batch_id,a.job_type_id,a.status_code_id,a.retry_count,a.object_id,('1700207760003780'||a.flow_number) :: bigint as process_id,current_timestamp,current_date from (select cte.*,row_number ()over( order by cte.object_id )as flow_number from cte)a

""2023-11-17 07:56:02.245 [Thread-1084] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select
data_movement_additional_info->'flow_details'->'schema_drift'->'config'->>'suffix' as suffix,
case when ((data_movement_additional_info->>'ingestion_table_format')::json->>'prefix')::boolean
then (data_movement_additional_info->>'ingestion_table_format')::json->>'prefix_value' || '_'
else '' end as ingestion_table_format,
'17002077600028566' as batch_id,(data_movement_additional_info->>'target_relative_path') as relative_file_path,
case when (data_movement_additional_info->>'target_relative_path'='') then false
when ((data_movement_additional_info->>'overwrite_default_relative_path')::varchar='true')then true
 else false end as is_relative_file_path,
data_movement_name
from nabu.data_movement_physical
where
data_movement_id =271
and
valid_to_ts ='9999-12-31'
""2023-11-17 07:56:02.278 [Thread-1084] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with cte1 as(select coalesce(data_movement_additional_info->'flow_details'->>'flow_timeout',data_movement_additional_info->'flow_details'->>'pipeline_flow_timeout')::int *3600000 as flow_timeout
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 271 and dmp.valid_to_ts = '9999-12-31' )
select ae.job_type,case when ct.flow_timeout is null then ae.jwt_ttl else flow_timeout end as jwt_ttl
from nabu.authtoken_expiration ae,cte1 as ct where job_type ='default'
""2023-11-17 07:56:02.311 [Thread-1084] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with cte2 as(
select rows/1 as flow_number,*
from (
select row_number()over(order by table_id) as rows, table_id,schema_name, dataplace_id from nabu.dataplace_table_metadata_physical
where ((((table_id in (37234))) and schema_id = 453 and table_type in ('T','V','M') and dataplace_id = 42)) and valid_to_ts='9999-12-31'
)a
),
dataplace_details as(
select c.*,
case when (b.dataplace_sub_component_type='hive' or b.dataplace_sub_component_type='cloudera_hive')  then trim(((dataplace_info->>'jdbc_info')::json)->>'database_name')
when ((b.dataplace_sub_component_type = 'bigquery')) then dataplace_info->>'bucket_name'
else trim(dataplace_info->>'database_name') end as source_db
from nabu.dataplace_physical a, nabu.dataplace_sub_component_lookup b, cte2 c
where a.dataplace_sub_component_id = b.dataplace_sub_component_id
and a.dataplace_id = c.dataplace_id
),

get_last_run_timestamp as (
    select flow_task_ts, object_id, data_movement_id from (
    	select flow_task_ts, object_id, data_movement_id,
    	row_number() over( partition by data_movement_id, object_id order by flow_task_ts desc ) as rownum
    	from nabu.flow_task_status
    	where process_id in (
    				select process_id from (
    						select process_id, row_number() over( partition by data_movement_id, object_id order by flow_task_ts desc ) as rownum
    						from nabu.flow_task_status
    						where data_movement_id = 271
    						and object_id in ( select table_id from dataplace_details )
    						and status_code_id = 15
    				)a
    				where rownum = 1
    	)
    	and status_code_id = 19
    )b
    where rownum = 1 and data_movement_id = 271
)

select  17002077600028566 as batch_id,
       'Ingestion_20231117' as batch_name,
       271 as data_movement_id,
       '' as relative_file_path,
       '' as ingestion_table_format,
       '' as suffix,
	  false as is_relative_file_path,
	   lower(a.schema_name) as source_schema_name_lowercase,
	  lower(a.source_db) as source_database_name_lowercase,
	   a.schema_name as source_schema_name,
	  a.source_db as source_database_name,
	   upper(a.schema_name) as source_schema_name_uppercase,
	  upper(a.source_db) as source_database_name_uppercase,
	   'ss_compass_adb_validation_MIC7018' as data_movement_name,
       'DEV' as environment,
       1 as job_type_id,
       '' as type,
       1624 as job_schedule_id,
       'Manaswini Chinthalapudi' as job_scheduled_user_id,
       case when b.flow_task_ts is null then '0001-01-01T00:00:00.103+02'::timestamp else b.flow_task_ts end as last_run_timestamp,
        '{
             "payload_variables": {
             }
         }'::json as variables,
        '{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}' :: json as workflow_route_bot_topic_details,
       'artifact_generation' as workflow_name,
       '1700207760003780'||flow_number :: text as process_id,
        table_id  as where_condition,flow_number
        from dataplace_details a
        left outer join get_last_run_timestamp b
        on a.table_id = b.object_id

""2023-11-17 07:56:02.348 [Thread-1084] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select 17002077600028566 as batch_id,
       'Ingestion_20231117' as batch_name,
       271 as data_movement_id,
       1624 as job_schedule_id,
       'Manaswini Chinthalapudi' as job_scheduled_user_id,
       'artifact_generation' as workflow_name,
	   '1700207760003780'||workflow_engine_id :: text as process_id,
	   '{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}' :: json as workflow_route_bot_topic_details,
       'email_notification_enable' as flow_name,15 as job_type_id,
       'DEV' as environment from nabu.data_movement_physical where data_movement_id = 271
""2023-11-17 07:56:02.377 [Thread-1084] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select 17002077600028566 as batch_id,
       'Ingestion_20231117' as batch_name,
       271 as data_movement_id,
       1624 as job_schedule_id,
       data_movement_name,
       '0001-01-01 00:00:00.103' as last_run_timestamp,
       'Manaswini Chinthalapudi' as job_scheduled_user_id,
       'artifact_generation' as workflow_name,
	   '1700207760003780'||workflow_engine_id :: text as process_id,
        '{
             "payload_variables": {
             }
         }'::json as variables,
	   '{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}' :: json as workflow_route_bot_topic_details,
       'rest_api_notification_enable' as flow_name,
       19 as job_type_id,
       'DEV' as environment from nabu.data_movement_physical
       where data_movement_id = 271
       and valid_to_ts = '9999-12-31'
""2023-11-17 07:56:02.412 [Thread-1084] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select case when a.email_id='' then false else true end as email_id  from
(select
replace( trim(trailing ']' from trim( leading '[' from (data_movement_additional_info->'flow_details'->>'email_notification')::json->>'on_success' )),'"','')  as email_id
from nabu.data_movement_physical where data_movement_id=271 and valid_to_ts='9999-12-31')a
""2023-11-17 07:56:02.444 [Thread-1084] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select case when a.email_id='' then false else true end as email_id  from
(select
replace( trim(trailing ']' from trim( leading '[' from (data_movement_additional_info->'flow_details'->>'email_notification')::json->>'on_failure' )),'"','')  as email_id
from nabu.data_movement_physical where data_movement_id=271 and valid_to_ts='9999-12-31')a
""2023-11-17 07:56:02.478 [Thread-1084] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select ((data_movement_additional_info->'flow_details'->>'schema_drift')::json->>'enabled')::boolean as  email_id from nabu.data_movement_physical where data_movement_id = 271 and valid_to_ts='9999-12-31'

""2023-11-17 07:56:02.515 [Thread-1084] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : 
with get_rest_api_details as(
    select a.is_postconditions_enabled,
    (a.rest_api_details->>'rest_api_id')::int as rest_api_id,
    (a.rest_api_details->>'rest_api_name')::text as rest_api_name,
    (a.rest_api_details->>'status_code_id')::int as status_code_id,
    (a.rest_api_details->>'payload') as payload,
    (a.rest_api_details->>'ordinal_position')::int ordinal_position
    from (
        select
        (data_movement_additional_info ->'flow_details'->'post_conditions'->>'enabled')::boolean as is_postconditions_enabled,
        json_array_elements(data_movement_additional_info ->'flow_details'->'post_conditions'->'rest_api_details') as rest_api_details
        from nabu.data_movement_physical
        where data_movement_id = 271
        and valid_to_ts ='9999-12-31'
    )a
)
,get_valid_apis as (
	select c.*
	from get_rest_api_details c left outer join nabu_ui.rest_api_info rai
    on c.rest_api_id = rai.rest_api_id
    where rai.valid_to_ts ='9999-12-31'
)
select a.*,
case
	when a.status_code_id = 21 then 'complete'
	when a.status_code_id = 13 then 'error'
	else 'success'
end as status_code_description,
b.rest_api_name||'_'||b.ordinal_position as input_flow from get_valid_apis a
left outer join get_valid_apis b
on a.ordinal_position=b.ordinal_position+1
and a.status_code_id = b.status_code_id
""2023-11-17 07:56:02.550 [Thread-1084] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with flows as(
select 1 as task,
'' as emptyOutputTemplate,
'' as outputflows_template,
'' as input_flows,
cast((extract(epoch from now())*100) as bigint)::text||1624||1 as flow_id,
'fc_ingestion_flow_task' as flowtask_template,
 'ingestion_'||'271_17002077600028566' as flow_name,
false as is_success_mail,'ingestion' as flow_type,
'' as output_flows,
'nabu_ingestion' as task_data_key,
17002077600028566
 as batch_id,
271 as data_movement_id,
1624 as job_schedule_id,
coalesce(data_movement_additional_info->'flow_details'->>'flow_timeout',data_movement_additional_info->'flow_details'->>'pipeline_flow_timeout','72') as flow_timeout,
coalesce((data_movement_additional_info->>'flow_details')::json->>'parallel_count',
(data_movement_additional_info->>'flow_details')::json->>'parallel_source_connections','10') as parallel_count,
coalesce(data_movement_additional_info->'flow_details'->>'retry_count','3'):: int as number_of_retries,
true as loggers_required ,
true as pre_agg_stats_required,
true as delete_credentials,
true as delete_almaren,
'' as rest_api_id,'' as payload,
true as flow_condition,259200000 as jwt_ttl, 'default' as authtoken_job_type
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 271 and dmp.valid_to_ts = '9999-12-31'

union all

select 2 as task,
'' as emptyOutputTemplate,
'' as outputflows_template,
'"ingestion_271_17002077600028566.success"' as input_flows,
cast((extract(epoch from now())*100) as bigint)::text||1624||2 as flow_id,
'end_mail_flow_task' as flowtask_template,
'success_notification_email' as flow_name, true as is_success_mail,'success' as flow_type,
'' as output_flows,
'email_input' as task_data_key,
 17002077600028566  as batch_id,
271 as data_movement_id,
1624 as job_schedule_id,
coalesce(data_movement_additional_info->'flow_details'->>'flow_timeout','72') as flow_timeout,
coalesce(data_movement_additional_info->'flow_details'->>'parallel_count','10') as parallel_count,
coalesce(data_movement_additional_info->'flow_details'->>'retry_count','10'):: int as number_of_retries,
false as loggers_required ,
false as pre_agg_stats_required,
false as delete_credentials,
false as delete_almaren,
'' as rest_api_id,'' as payload,
true as flow_condition,259200000 as jwt_ttl,'default' as authtoken_job_type
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 271 and dmp.valid_to_ts = '9999-12-31'
union all

select 3 as task,
'' as emptyOutputTemplate,
'' as outputflows_template,
'"ingestion_271_17002077600028566.error"' as input_flows,
cast((extract(epoch from now())*100) as bigint)::text||1624||3 as flow_id,
'end_mail_flow_task' as flowtask_template,
'failure_notification_email' as flow_name, false as is_success_mail, 'failure' as flow_type,
'' as output_flows,
'email_input' as task_data_key,
 17002077600028566  as batch_id,
271 as data_movement_id,
1624 as job_schedule_id,
coalesce(data_movement_additional_info->'flow_details'->>'flow_timeout','72') as flow_timeout,
coalesce(data_movement_additional_info->'flow_details'->>'parallel_count','10') as parallel_count,
coalesce(data_movement_additional_info->'flow_details'->>'retry_count','10'):: int as number_of_retries,
false as loggers_required ,
false as pre_agg_stats_required,
false as delete_credentials,
false as delete_almaren,
'' as rest_api_id,'' as payload,
true as flow_condition,259200000 as jwt_ttl, 'default' as authtoken_job_type
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 271 and dmp.valid_to_ts = '9999-12-31'

union all

select 4 as task,
'' as emptyOutputTemplate,
'' as outputflows_template,
'"ingestion_271_17002077600028566.flow_timeout"' as input_flows,
cast((extract(epoch from now())*100) as bigint)::text||1624||4 as flow_id,
'timed_out_end_mail_flow_task' as flowtask_template,
'flow_timeout_notification_email' as flow_name, false as is_success_mail, null as flow_type,
'' as output_flows,
'email_input' as task_data_key,
 17002077600028566  as batch_id,
271 as data_movement_id,
1624 as job_schedule_id,
coalesce(data_movement_additional_info->'flow_details'->>'flow_timeout','72') as flow_timeout,
coalesce(data_movement_additional_info->'flow_details'->>'parallel_count','10') as parallel_count,
coalesce(data_movement_additional_info->'flow_details'->>'retry_count','10'):: int as number_of_retries,
false as loggers_required ,
false as pre_agg_stats_required,
false as delete_credentials,
false as delete_almaren,
'' as rest_api_id,'' as payload,
true as flow_condition,259200000 as jwt_ttl, 'default' as authtoken_job_type
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 271 and dmp.valid_to_ts = '9999-12-31'

union all

select 5 as task,
'' as emptyOutputTemplate,
'' as outputflows_template,
'' as input_flows,
cast((extract(epoch from now())*100) as bigint)::text||1624||5 as flow_id,
'schema_drift_mail_flow_task' as flowtask_template,
'schema_drift_notification_email' as flow_name, false as is_success_mail, 'schema_drift' as flow_type,
'' as output_flows,
'email_input' as task_data_key,
 17002077600028566  as batch_id,
271 as data_movement_id,
1624 as job_schedule_id,
coalesce(data_movement_additional_info->'flow_details'->>'flow_timeout','72') as flow_timeout,
coalesce(data_movement_additional_info->'flow_details'->>'parallel_count','3') as parallel_count,
coalesce(data_movement_additional_info->'flow_details'->>'retry_count','10'):: int as number_of_retries,
false as loggers_required ,
false as pre_agg_stats_required,
false as delete_credentials,
false as delete_almaren,
'' as rest_api_id,'' as payload,
false as flow_condition,259200000 as jwt_ttl, 'default' as authtoken_job_type
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 271 and dmp.valid_to_ts = '9999-12-31'

union all

select 6 as task,
'' as emptyOutputTemplate,'' as outputflows_template,
'"ingestion_271_17002077600028566.success"' as input_flows,
cast((extract(epoch from now())*100) as bigint)::text||1624||6 as flow_id,
'end_mail_flow_task_manual_retry' as flowtask_template,
'success_notification_email_manual_retry' as flow_name, true as is_success_mail, 'success' as flow_type,
'' as output_flows,
'email_input' as task_data_key,
 17002077600028566  as batch_id,
271 as data_movement_id,
1624 as job_schedule_id,
coalesce(data_movement_additional_info->'flow_details'->>'flow_timeout','72') as flow_timeout,
coalesce(data_movement_additional_info->'flow_details'->>'parallel_count','10') as parallel_count,
coalesce(data_movement_additional_info->'flow_details'->>'retry_count','10'):: int as number_of_retries,
false as loggers_required ,
false as pre_agg_stats_required,
false as delete_credentials,
false as delete_almaren,
'' as rest_api_id,'' as payload,
false as flow_condition,259200000 as jwt_ttl, 'default' as authtoken_job_type
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 271 and dmp.valid_to_ts = '9999-12-31'

union all

select 7 as task,
'' as emptyOutputTemplate,
'' as outputflows_template,
'"ingestion_271_17002077600028566.error"' as input_flows,
cast((extract(epoch from now())*100) as bigint)::text||1624||7 as flow_id,
'end_mail_flow_task_manual_retry' as flowtask_template,
'failure_notification_email_manual_retry' as flow_name, false as is_success_mail, 'failure' as flow_type,
'' as output_flows,
'email_input' as task_data_key,
 17002077600028566  as batch_id,
271 as data_movement_id,
1624 as job_schedule_id,
coalesce(data_movement_additional_info->'flow_details'->>'flow_timeout','72') as flow_timeout,
coalesce(data_movement_additional_info->'flow_details'->>'parallel_count','3') as parallel_count,
coalesce(data_movement_additional_info->'flow_details'->>'retry_count','10'):: int as number_of_retries,
false as loggers_required ,
false as pre_agg_stats_required,
false as delete_credentials,
false as delete_almaren,
'' as rest_api_id,'' as payload,
false as flow_condition,259200000 as jwt_ttl, 'default' as authtoken_job_type
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 271 and dmp.valid_to_ts = '9999-12-31'

union all

select 8 as task,
'' as emptyOutputTemplate,
'' as outputflows_template,
'"ingestion_271_17002077600028566.flow_timeout"' as input_flows,
cast((extract(epoch from now())*100) as bigint)::text||1624||8 as flow_id,
'timed_out_end_mail_flow_task' as flowtask_template,
'flow_timeout_notification_email_manual_retry' as flow_name, true as is_success_mail, '_manual_retry' as flow_type,
'' as output_flows,
'email_input' as task_data_key,
 17002077600028566  as batch_id,
271 as data_movement_id,
1624 as job_schedule_id,
coalesce(data_movement_additional_info->'flow_details'->>'flow_timeout','72') as flow_timeout,
coalesce(data_movement_additional_info->'flow_details'->>'parallel_count','3') as parallel_count,
coalesce(data_movement_additional_info->'flow_details'->>'retry_count','10'):: int as number_of_retries,
false as loggers_required ,
false as pre_agg_stats_required,
false as delete_credentials,
false as delete_almaren,
'' as rest_api_id,'' as payload,
false as flow_condition,259200000 as jwt_ttl, 'default' as authtoken_job_type
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 271 and dmp.valid_to_ts = '9999-12-31'

)
select * from flows where flow_condition=true order by  task asc
""2023-11-17 07:56:02.589 [Thread-1084] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select 271 as data_movement_id,1 as job_type_id, 17002077600028566 as batch_id  ,36  as status_code_id , 1624 as job_schedule_id
""2023-11-17 07:56:02.622 [Thread-1084] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select
coalesce (data_movement_additional_info->'flow_details'->>'pipeline_flow_timeout','72') as flow_timeout
from nabu.data_movement_physical dmp
where dmp.data_movement_id = 271 and dmp.valid_to_ts = '9999-12-31'
""2023-11-17 07:56:02.626 [Thread-1084] DEBUG com.modak.bots.DBOpsBot - to execute query timeTakenInMillis : 932
""2023-11-17 07:56:02.626 [Thread-1084] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id bfb7aff8-e3e2-41bd-b799-ad3147187c77 has finished process logic with message_id be7daf9f-8d06-44b7-b94d-399b614bdd44 and thread_id 1329
""2023-11-17 07:56:02.626 [Thread-1084] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-17 07:56:02.658 [Thread-1084] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "DBOpsBot", "bot_metadata": { "message_id": "e56f48fd-3254-4aef-82b2-ecb838397bf0", "parent_id": "be7daf9f-8d06-44b7-b94d-399b614bdd44", "bot_id": "bfb7aff8-e3e2-41bd-b799-ad3147187c77", "message_topic":"nabu_2_jdbc", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":1700207760003780, "initial_ts":1700207760106, "batch_id":17002077600028566, "batch_name":"", "job_schedule_id":1624, "data_movement_id": 271, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "", "environment": "modak", "ignore_job_termination" : false, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot" ],"task_dependency":true}, "task_retry_intervals_secs": [ ], "message_context": "data_movement_deciding" }, "bot_tasks": [ { "task_name": "data_movement_deciding_msg", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "pre_task_logging_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "pre_log_template" }, "app_template_details": { "template_group": "templates/artifact_ingestion/ingestion_fc.stg", "template_name": "doNothingTemplate" }, "input_data": { "template_execution_type": "single", "query_type":"json", "encryption_details" : {"encryption" : "no"}, "query_input": { "condition_for_success_mail" : [ { "email_id" : true } ], "get_deleted_objects" : [ { "object_id" : null } ], "get_batch_datamovement_id" : [ { "data_movement_id" : 271, "job_type_id" : 1, "batch_id" : 17002077600028566, "status_code_id" : 36, "job_schedule_id" : 1624 } ], "email_input" : [ { "batch_id" : 17002077600028566, "batch_name" : "Ingestion_20231117", "data_movement_id" : 271, "job_schedule_id" : 1624, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "workflow_name" : "artifact_generation", "process_id" : "17002077600037802", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "flow_name" : "email_notification_enable", "job_type_id" : 15, "environment" : "DEV" } ], "rest_api_input" : [ { "batch_id" : 17002077600028566, "batch_name" : "Ingestion_20231117", "data_movement_id" : 271, "job_schedule_id" : 1624, "data_movement_name" : "ss_compass_adb_validation_MIC7018", "last_run_timestamp" : "0001-01-01 00:00:00.103", "job_scheduled_user_id" : "Manaswini Chinthalapudi", "workflow_name" : "artifact_generation", "process_id" : "17002077600037802", "variables" : { "payload_variables" : {} }, "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "flow_name" : "rest_api_notification_enable", "job_type_id" : 19, "environment" : "DEV" } ], "get_ignore_null_tables" : null, "condition_for_schema_drift_mail" : [ { "email_id" : true } ], "check_if_selected_schemas_are_empty" : [ { "empty_schma" : false } ], "get_datatype_ignore_tables" : [ { "object_id" : null, "status_code_id" : 31, "retry_count" : 0 } ], "get_schema_drift_ignore_tables" : [ { "object_id" : null, "status_code_id" : 30, "retry_count" : 0 } ], "condition_for_failure_mail" : [ { "email_id" : true } ], "schema_drift_table_info" : [ { "schema_drifted_table_id_list" : null } ], "flows" : [ { "task" : 1, "emptyoutputtemplate" : "", "outputflows_template" : "", "input_flows" : "", "flow_id" : "17002077625516241", "flowtask_template" : "fc_ingestion_flow_task", "flow_name" : "ingestion_271_17002077600028566", "is_success_mail" : false, "flow_type" : "ingestion", "output_flows" : "", "task_data_key" : "nabu_ingestion", "batch_id" : 17002077600028566, "data_movement_id" : 271, "job_schedule_id" : 1624, "flow_timeout" : "72", "parallel_count" : "10", "number_of_retries" : 3, "loggers_required" : true, "pre_agg_stats_required" : true, "delete_credentials" : true, "delete_almaren" : true, "rest_api_id" : "", "payload" : "", "flow_condition" : true, "jwt_ttl" : 259200000, "authtoken_job_type" : "default" }, { "task" : 2, "emptyoutputtemplate" : "", "outputflows_template" : "", "input_flows" : "\"ingestion_271_17002077600028566.success\"", "flow_id" : "17002077625516242", "flowtask_template" : "end_mail_flow_task", "flow_name" : "success_notification_email", "is_success_mail" : true, "flow_type" : "success", "output_flows" : "", "task_data_key" : "email_input", "batch_id" : 17002077600028566, "data_movement_id" : 271, "job_schedule_id" : 1624, "flow_timeout" : "72", "parallel_count" : "10", "number_of_retries" : 3, "loggers_required" : false, "pre_agg_stats_required" : false, "delete_credentials" : false, "delete_almaren" : false, "rest_api_id" : "", "payload" : "", "flow_condition" : true, "jwt_ttl" : 259200000, "authtoken_job_type" : "default" }, { "task" : 3, "emptyoutputtemplate" : "", "outputflows_template" : "", "input_flows" : "\"ingestion_271_17002077600028566.error\"", "flow_id" : "17002077625516243", "flowtask_template" : "end_mail_flow_task", "flow_name" : "failure_notification_email", "is_success_mail" : false, "flow_type" : "failure", "output_flows" : "", "task_data_key" : "email_input", "batch_id" : 17002077600028566, "data_movement_id" : 271, "job_schedule_id" : 1624, "flow_timeout" : "72", "parallel_count" : "10", "number_of_retries" : 3, "loggers_required" : false, "pre_agg_stats_required" : false, "delete_credentials" : false, "delete_almaren" : false, "rest_api_id" : "", "payload" : "", "flow_condition" : true, "jwt_ttl" : 259200000, "authtoken_job_type" : "default" }, { "task" : 4, "emptyoutputtemplate" : "", "outputflows_template" : "", "input_flows" : "\"ingestion_271_17002077600028566.flow_timeout\"", "flow_id" : "17002077625516244", "flowtask_template" : "timed_out_end_mail_flow_task", "flow_name" : "flow_timeout_notification_email", "is_success_mail" : false, "flow_type" : null, "output_flows" : "", "task_data_key" : "email_input", "batch_id" : 17002077600028566, "data_movement_id" : 271, "job_schedule_id" : 1624, "flow_timeout" : "72", "parallel_count" : "10", "number_of_retries" : 3, "loggers_required" : false, "pre_agg_stats_required" : false, "delete_credentials" : false, "delete_almaren" : false, "rest_api_id" : "", "payload" : "", "flow_condition" : true, "jwt_ttl" : 259200000, "authtoken_job_type" : "default" } ], "get_jwt_details" : [ { "job_type" : "default", "jwt_ttl" : 259200000 } ], "nabu_ingestion" : [ { "batch_id" : 17002077600028566, "batch_name" : "Ingestion_20231117", "data_movement_id" : 271, "relative_file_path" : "", "ingestion_table_format" : "", "suffix" : "", "is_relative_file_path" : false, "source_schema_name_lowercase" : "acuity-develop", "source_database_name_lowercase" : "development-db", "source_schema_name" : "acuity-develop", "source_database_name" : "development-db", "source_schema_name_uppercase" : "ACUITY-DEVELOP", "source_database_name_uppercase" : "DEVELOPMENT-DB", "data_movement_name" : "ss_compass_adb_validation_MIC7018", "environment" : "DEV", "job_type_id" : 1, "type" : "", "job_schedule_id" : 1624, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "last_run_timestamp" : "0001-01-01 00:00:00.103", "variables" : { "payload_variables" : {} }, "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "workflow_name" : "artifact_generation", "process_id" : "17002077600037801", "where_condition" : 37234, "flow_number" : 1 } ], "source_metadata_category" : [ { "data_movement_id" : 271, "source_type" : "relational", "source" : "sql_server" } ], "flow_controller_timeout" : [ { "flow_timeout" : "72" } ] } }, "skipLogicPattern" : "doNothing", "output_message_templates": [ { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "flow_controller_message_for_ingestion", "useIncomingData":true }, { "template_group": "templates/artifact_ingestion/ingestion_flow.stg", "template_name": "task_status_success_msg", "useIncomingData":true } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/ingestion_templates.stg", "template_name": "error_template_create_msg" } ] } ] }
""2023-11-17 07:56:02.661 [Thread-1084] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_jdbc
""2023-11-17 07:56:02.681 [Thread-1084] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_jdbc
""2023-11-17 07:56:02.681 [Thread-1084] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : false
""2023-11-17 07:56:02.699 [Thread-480] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id 330cfcdb-58fd-46f9-8954-91528f06bc95 has started processing message with message_id e56f48fd-3254-4aef-82b2-ecb838397bf0 and thread_id 621 
""2023-11-17 07:56:02.699 [Thread-480] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:02.699 [Thread-480] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=be7daf9f-8d06-44b7-b94d-399b614bdd44, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=data_movement_deciding, message_id=e56f48fd-3254-4aef-82b2-ecb838397bf0, task_retry_intervals_secs=[], bot_id=bfb7aff8-e3e2-41bd-b799-ad3147187c77, message_topic=nabu_2_jdbc, tags={process_id=1700207760003780, batch_id=17002077600028566, job_scheduled_user_id=Manaswini Chinthalapudi, tags=[AuthToken, DBOpsBot], initial_ts=1700207760106, batch_name=, environment=modak, job_schedule_id=1624, data_movement_id=271, last_run_timestamp=, retry_attempt=0, task_dependency=true, ignore_job_termination=false}}
""2023-11-17 07:56:02.732 [Thread-480] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
doNothing
""2023-11-17 07:56:02.742 [Thread-480] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-17 07:56:02.743 [Thread-480] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-17 07:56:02.751 [Thread-480] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-17 07:56:02.751 [Thread-480] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : true
""2023-11-17 07:56:02.782 [Thread-480] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "FlowControllerBot", "bot_metadata": { "message_id": "1d0e2355-7bbd-4323-937d-1be505bb907a", "parent_id": "e56f48fd-3254-4aef-82b2-ecb838397bf0", "bot_id": "330cfcdb-58fd-46f9-8954-91528f06bc95", "message_topic":"nabu_2_flowcontroller", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":1700207760003780, "initial_ts":1700207760106, "batch_id":17002077600028566, "batch_name":"", "job_schedule_id":1624, "data_movement_id": 271, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "", "environment": "modak", "ignore_job_termination" : false, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot" ],"task_dependency":true}, "task_retry_intervals_secs": [ ], "message_context": "flowcontroller_message_to_generate_flows" }, "bot_tasks": [ { "task_name": "generate_flows", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "pre_task_logging_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "pre_log_template" }, "app_template_details": { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "generate_flows" }, "input_data":{ "query_input" : { "condition_for_success_mail" : [ { "email_id" : true } ], "get_deleted_objects" : [ { "object_id" : null } ], "get_batch_datamovement_id" : [ { "status_code_id" : 36, "batch_id" : 17002077600028566, "job_schedule_id" : 1624, "data_movement_id" : 271, "job_type_id" : 1 } ], "email_input" : [ { "process_id" : "17002077600037802", "batch_name" : "Ingestion_20231117", "environment" : "DEV", "batch_id" : 17002077600028566, "workflow_name" : "artifact_generation", "job_schedule_id" : 1624, "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "data_movement_id" : 271, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "flow_name" : "email_notification_enable", "job_type_id" : 15 } ], "rest_api_input" : [ { "process_id" : "17002077600037802", "variables" : { "payload_variables" : {} }, "batch_id" : 17002077600028566, "workflow_name" : "artifact_generation", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "flow_name" : "rest_api_notification_enable", "job_type_id" : 19, "batch_name" : "Ingestion_20231117", "environment" : "DEV", "job_schedule_id" : 1624, "data_movement_id" : 271, "last_run_timestamp" : "0001-01-01 00:00:00.103", "data_movement_name" : "ss_compass_adb_validation_MIC7018" } ], "get_ignore_null_tables" : null, "condition_for_schema_drift_mail" : [ { "email_id" : true } ], "check_if_selected_schemas_are_empty" : [ { "empty_schma" : false } ], "get_datatype_ignore_tables" : [ { "status_code_id" : 31, "retry_count" : 0, "object_id" : null } ], "get_schema_drift_ignore_tables" : [ { "status_code_id" : 30, "retry_count" : 0, "object_id" : null } ], "condition_for_failure_mail" : [ { "email_id" : true } ], "schema_drift_table_info" : [ { "schema_drifted_table_id_list" : null } ], "flows" : [ { "jwt_ttl" : 259200000, "rest_api_id" : "", "batch_id" : 17002077600028566, "pre_agg_stats_required" : true, "outputflows_template" : "", "parallel_count" : "10", "emptyoutputtemplate" : "", "payload" : "", "flow_id" : "17002077625516241", "job_schedule_id" : 1624, "delete_credentials" : true, "number_of_retries" : 3, "delete_almaren" : true, "input_flows" : "", "flow_name" : "ingestion_271_17002077600028566", "output_flows" : "", "task_data_key" : "nabu_ingestion", "flow_condition" : true, "task" : 1, "flow_type" : "ingestion", "authtoken_job_type" : "default", "is_success_mail" : false, "flowtask_template" : "fc_ingestion_flow_task", "data_movement_id" : 271, "flow_timeout" : "72", "loggers_required" : true }, { "jwt_ttl" : 259200000, "rest_api_id" : "", "batch_id" : 17002077600028566, "pre_agg_stats_required" : false, "outputflows_template" : "", "parallel_count" : "10", "emptyoutputtemplate" : "", "payload" : "", "flow_id" : "17002077625516242", "job_schedule_id" : 1624, "delete_credentials" : false, "number_of_retries" : 3, "delete_almaren" : false, "input_flows" : "\"ingestion_271_17002077600028566.success\"", "flow_name" : "success_notification_email", "output_flows" : "", "task_data_key" : "email_input", "flow_condition" : true, "task" : 2, "flow_type" : "success", "authtoken_job_type" : "default", "is_success_mail" : true, "flowtask_template" : "end_mail_flow_task", "data_movement_id" : 271, "flow_timeout" : "72", "loggers_required" : false }, { "jwt_ttl" : 259200000, "rest_api_id" : "", "batch_id" : 17002077600028566, "pre_agg_stats_required" : false, "outputflows_template" : "", "parallel_count" : "10", "emptyoutputtemplate" : "", "payload" : "", "flow_id" : "17002077625516243", "job_schedule_id" : 1624, "delete_credentials" : false, "number_of_retries" : 3, "delete_almaren" : false, "input_flows" : "\"ingestion_271_17002077600028566.error\"", "flow_name" : "failure_notification_email", "output_flows" : "", "task_data_key" : "email_input", "flow_condition" : true, "task" : 3, "flow_type" : "failure", "authtoken_job_type" : "default", "is_success_mail" : false, "flowtask_template" : "end_mail_flow_task", "data_movement_id" : 271, "flow_timeout" : "72", "loggers_required" : false }, { "jwt_ttl" : 259200000, "rest_api_id" : "", "batch_id" : 17002077600028566, "pre_agg_stats_required" : false, "outputflows_template" : "", "parallel_count" : "10", "emptyoutputtemplate" : "", "payload" : "", "flow_id" : "17002077625516244", "job_schedule_id" : 1624, "delete_credentials" : false, "number_of_retries" : 3, "delete_almaren" : false, "input_flows" : "\"ingestion_271_17002077600028566.flow_timeout\"", "flow_name" : "flow_timeout_notification_email", "output_flows" : "", "task_data_key" : "email_input", "flow_condition" : true, "task" : 4, "flow_type" : null, "authtoken_job_type" : "default", "is_success_mail" : false, "flowtask_template" : "timed_out_end_mail_flow_task", "data_movement_id" : 271, "flow_timeout" : "72", "loggers_required" : false } ], "get_jwt_details" : [ { "job_type" : "default", "jwt_ttl" : 259200000 } ], "nabu_ingestion" : [ { "process_id" : "17002077600037801", "flow_number" : 1, "source_database_name_lowercase" : "development-db", "batch_id" : 17002077600028566, "workflow_name" : "artifact_generation", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "where_condition" : 37234, "suffix" : "", "type" : "", "job_type_id" : 1, "ingestion_table_format" : "", "job_schedule_id" : 1624, "relative_file_path" : "", "data_movement_name" : "ss_compass_adb_validation_MIC7018", "source_schema_name_lowercase" : "acuity-develop", "variables" : { "payload_variables" : {} }, "source_database_name_uppercase" : "DEVELOPMENT-DB", "job_scheduled_user_id" : "Manaswini Chinthalapudi", "source_schema_name_uppercase" : "ACUITY-DEVELOP", "source_schema_name" : "acuity-develop", "batch_name" : "Ingestion_20231117", "environment" : "DEV", "source_database_name" : "development-db", "data_movement_id" : 271, "last_run_timestamp" : "0001-01-01 00:00:00.103", "is_relative_file_path" : false } ], "source_metadata_category" : [ { "data_movement_id" : 271, "source_type" : "relational", "source" : "sql_server" } ], "flow_controller_timeout" : [ { "flow_timeout" : "72" } ] }, "encryption_details" : { "encryption" : "no" }, "batch_id" : "17002077600028566", "template_execution_type" : "single", "query_type" : "json", "currentBotMessageMap" : { "parent_id" : "be7daf9f-8d06-44b7-b94d-399b614bdd44", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "message_context" : "data_movement_deciding", "message_id" : "e56f48fd-3254-4aef-82b2-ecb838397bf0", "task_retry_intervals_secs" : [], "bot_id" : "bfb7aff8-e3e2-41bd-b799-ad3147187c77", "message_topic" : "nabu_2_jdbc", "tags" : { "process_id" : 1700207760003780, "batch_id" : 17002077600028566, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "tags" : [ "AuthToken", "DBOpsBot" ], "initial_ts" : 1700207760106, "batch_name" : "", "environment" : "modak", "job_schedule_id" : 1624, "data_movement_id" : 271, "last_run_timestamp" : "", "retry_attempt" : 0, "task_dependency" : true, "ignore_job_termination" : false } } }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "task_status_success_msg" } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "error_template_create_msg" } ], "loggers":{ "pre_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "bot_pre_log", "log_type": "FILE", "log_file_location": "../logs/logger_output.log" } ], "post_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "bot_post_log", "log_type": "FILE", "log_file_location": "../logs/logger_output.log" } ], "error_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "bot_error_log", "log_type": "FILE", "log_file_location": "../logs/logger_output.log" } ] } } ] } 
""2023-11-17 07:56:02.786 [Thread-480] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_flowcontroller
""2023-11-17 07:56:02.790 [Thread-480] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_flowcontroller
""2023-11-17 07:56:02.790 [Thread-480] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : true
""2023-11-17 07:56:02.815 [pool-24-thread-31] INFO  com.modak.bots.basebot.AbstractBaseBot - FlowControllerBot with bot_id 9a243656-a8f6-45a1-bf1a-431a00d18e91 has started processing message with message_id 1d0e2355-7bbd-4323-937d-1be505bb907a and thread_id 4437 
""2023-11-17 07:56:02.826 [pool-24-thread-31] INFO  com.modak.utils.logging.LoggingTemplateUtitlity - 2023-11-17 07:56:02.815 Task start generate_flows of process_id 1700207760003780 of bot FlowControllerBot  with id 9a243656-a8f6-45a1-bf1a-431a00d18e91
""2023-11-17 07:56:02.826 [pool-24-thread-31] INFO  com.modak.utils.logging.FileLogger - ../logs/logger_output.log
""2023-11-17 07:56:02.826 [pool-24-thread-31] DEBUG com.modak.utils.logging.FileLogger - Log file executed 2023-11-17 07:56:02.815 Task start generate_flows of process_id 1700207760003780 of bot FlowControllerBot  with id 9a243656-a8f6-45a1-bf1a-431a00d18e91 
""2023-11-17 07:56:02.826 [pool-24-thread-31] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=e56f48fd-3254-4aef-82b2-ecb838397bf0, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=flowcontroller_message_to_generate_flows, message_id=1d0e2355-7bbd-4323-937d-1be505bb907a, task_retry_intervals_secs=[], bot_id=330cfcdb-58fd-46f9-8954-91528f06bc95, message_topic=nabu_2_flowcontroller, tags={process_id=1700207760003780, batch_id=17002077600028566, job_scheduled_user_id=Manaswini Chinthalapudi, tags=[AuthToken, DBOpsBot, DBOpsBot], initial_ts=1700207760106, batch_name=, environment=modak, job_schedule_id=1624, data_movement_id=271, last_run_timestamp=, retry_attempt=0, task_dependency=true, ignore_job_termination=false}}
""2023-11-17 07:56:02.851 [pool-24-thread-31] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
{ "flows":[ { "flowName": "ingestion_271_17002077600028566", "flowId":17002077625516241, "batch_id":17002077600028566, "job_schedule_id": "1624", "job_type_id": 1, "data_movement_id":"271", "flow_type": "ingestion", "metaflowData": { "tags": { "tags": [ "ingestion_271_17002077600028566" ] } }, "configuration": { "parallel":10, "flowTimeoutHrs":72 }, "uiInfo": { "description": "Auto generated by flow controller for flow ingestion_271_17002077600028566" }, "flowTasks": [ { "flowTaskName": "spark_ingestion_almaren_271_1", "flowTaskId": 2711, "processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "bot_metadata": { "tags":{ "process_id":17002077600037801, "batch_id": 17002077600028566, "batch_name": "Ingestion_20231117", "environment": "DEV", "data_movement_id": 271, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "0001-01-01 00:00:00.103", "job_schedule_id": 1624, "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"} } }, "app_template_details": { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "generate_input_data" }, "input_data": { "variables": { "env_variables": { }, "user_variables": { }, "payload_variables": { } }, "environment": "DEV", "data_movement_id":"271", "process_id": "17002077600037801", "batch_id": "17002077600028566", "batch_name": "Ingestion_20231117", "workflow_name": "artifact_generation", "where_condition":"37234", "flow_number":1, "job_schedule_id": 1624, "job_scheduled_user_id": "Manaswini Chinthalapudi", "relative_file_path": "", "ingestion_table_format": "", "suffix": "", "is_relative_file_path": false, "source_schema_name": "acuity-develop", "source_database_name": "development-db", "source_schema_name_lowercase": "acuity-develop", "source_database_name_lowercase": "development-db", "source_database_name_uppercase": "DEVELOPMENT-DB", "source_schema_name_uppercase": "ACUITY-DEVELOP", "data_movement_name":"ss_compass_adb_validation_MIC7018", "last_run_timestamp": "0001-01-01 00:00:00.103", "job_type_id":"1", "jwt_ttl":"259200000", "authtoken_job_type":"default" }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "artifact_generation_auth_token_msg" } ], "retry_template": { "retry_template_group": "templates/artifact_ingestion/flow_controller.stg", "retry_template_name": "artifact_generation_auth_token_msg_retry" }, "loggers":{ "scheduled_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_scheduled_log", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" } ], "pre_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_running_log", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_pre_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" } ], "post_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_post_log_db", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_post_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" } ], "retry_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_retry_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" } ] }, "completionCriteria": { "success":{ "botTopics": [ "nabu_2_completion" ], "criteria":[ "AND", { "bot_metadata.tags.process_id": 17002077600037801, "opOperator": "==" }, { "bot_metadata.message_context": "end_of_the_flow", "opOperator": "==" } ] }, "error": { "botTopics": [ "nabu_2_errorbot" ], "criteria": [ "AND", { "opOperator": "==", "bot_metadata.tags.process_id": 17002077600037801 }, { "opOperator": "==", "bot_metadata.message_context": "taskstatus_bot_error_msg" } ] }, "retry": [ "AND", { "error_data.retry_attempt": 3, "opOperator": "<" }, { "error_data.error_json": "(?i).*exception.*", "opOperator": "~" } ] } } ], "inputFlows": [], "outputFlows": [], "flowOutputTemplates": [ { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "delete_almaren_code_from_kosh" }, { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "delete_created_credentials" } ,{ "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "insert_pre_agg_stats_template" } ] ,"loggers":{ "pre_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_pre_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_pre_log_db", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" } ], "post_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_post_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_post_log_db", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" } ] } } ,{ "flowName": "success_notification_email", "flowId":17002077625516242, "batch_id":17002077600028566, "job_schedule_id": "1624", "job_type_id": 15, "data_movement_id":"271", "flow_type": "success", "metaflowData": { "tags": { "tags": [ "success_notification_email" ] } }, "configuration": { "parallel":10, "flowTimeoutHrs":72 }, "uiInfo": { "description": "Auto generated by flow controller for flow success_notification_email" }, "flowTasks": [ { "flowTaskName": "email_flow_2712", "flowTaskId": 2712, "processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "bot_metadata": { "tags":{ "process_id":217002077600037802, "batch_id": 17002077600028566, "batch_name": "Ingestion_20231117", "environment": "DEV", "data_movement_id": 271, "job_scheduled_user_id": "Manaswini Chinthalapudi", "job_schedule_id": 1624, "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"} } }, "app_template_details": { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "generate_table_input_data" }, "input_data": { "is_success_mail":true, "flow_type": "success", "environment": "DEV", "data_movement_id":"271", "process_id": "217002077600037802", "batch_id": "17002077600028566", "batch_name": "Ingestion_20231117", "workflow_name": "artifact_generation", "where_condition":"", "job_type_id":"15", "job_schedule_id": 1624, "jwt_ttl":"259200000", "authtoken_job_type":"default" }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/email_templates.stg", "template_name": "success_or_failure_notification_email" } ], "completionCriteria": { "success":{ "botTopics": [ "nabu_2_completion" ], "criteria":[ "AND", { "bot_metadata.tags.process_id": 217002077600037802, "opOperator": "==" }, { "bot_metadata.message_context": "end_of_the_flow", "opOperator": "==" } ] }, "error": { "botTopics": [ "nabu_2_errorbot" ], "criteria": [ "AND", { "opOperator": "==", "bot_metadata.tags.process_id": 217002077600037802 }, { "opOperator": "==", "bot_metadata.message_context": "taskstatus_bot_error_msg" } ] } } } ], "inputFlows": ["ingestion_271_17002077600028566.success"], "outputFlows": [], "flowOutputTemplates": [ ] } ,{ "flowName": "failure_notification_email", "flowId":17002077625516243, "batch_id":17002077600028566, "job_schedule_id": "1624", "job_type_id": 15, "data_movement_id":"271", "flow_type": "failure", "metaflowData": { "tags": { "tags": [ "failure_notification_email" ] } }, "configuration": { "parallel":10, "flowTimeoutHrs":72 }, "uiInfo": { "description": "Auto generated by flow controller for flow failure_notification_email" }, "flowTasks": [ { "flowTaskName": "email_flow_2713", "flowTaskId": 2713, "processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "bot_metadata": { "tags":{ "process_id":317002077600037802, "batch_id": 17002077600028566, "batch_name": "Ingestion_20231117", "environment": "DEV", "data_movement_id": 271, "job_scheduled_user_id": "Manaswini Chinthalapudi", "job_schedule_id": 1624, "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"} } }, "app_template_details": { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "generate_table_input_data" }, "input_data": { "is_success_mail":false, "flow_type": "failure", "environment": "DEV", "data_movement_id":"271", "process_id": "317002077600037802", "batch_id": "17002077600028566", "batch_name": "Ingestion_20231117", "workflow_name": "artifact_generation", "where_condition":"", "job_type_id":"15", "job_schedule_id": 1624, "jwt_ttl":"259200000", "authtoken_job_type":"default" }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/email_templates.stg", "template_name": "success_or_failure_notification_email" } ], "completionCriteria": { "success":{ "botTopics": [ "nabu_2_completion" ], "criteria":[ "AND", { "bot_metadata.tags.process_id": 317002077600037802, "opOperator": "==" }, { "bot_metadata.message_context": "end_of_the_flow", "opOperator": "==" } ] }, "error": { "botTopics": [ "nabu_2_errorbot" ], "criteria": [ "AND", { "opOperator": "==", "bot_metadata.tags.process_id": 317002077600037802 }, { "opOperator": "==", "bot_metadata.message_context": "taskstatus_bot_error_msg" } ] } } } ], "inputFlows": ["ingestion_271_17002077600028566.error"], "outputFlows": [], "flowOutputTemplates": [ ] } ,{ "flowName": "flow_timeout_notification_email", "flowId":17002077625516244, "batch_id":17002077600028566, "job_schedule_id": "1624", "job_type_id": 15, "data_movement_id":"271", "flow_type": "", "metaflowData": { "tags": { "tags": [ "flow_timeout_notification_email" ] } }, "configuration": { "parallel":10, "flowTimeoutHrs":72 }, "uiInfo": { "description": "Auto generated by flow controller for flow flow_timeout_notification_email" }, "flowTasks": [ { "flowTaskName": "email_flow_2714", "flowTaskId": 2714, "processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "bot_metadata": { "tags":{ "process_id":417002077600037802, "batch_id": 17002077600028566, "batch_name": "Ingestion_20231117", "environment": "DEV", "data_movement_id": 271, "job_scheduled_user_id": "Manaswini Chinthalapudi", "job_schedule_id": 1624, "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"} } }, "app_template_details": { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "generate_table_input_data" }, "input_data": { "environment": "DEV", "data_movement_id":"271", "process_id": "417002077600037802", "batch_id": "17002077600028566", "batch_name": "Ingestion_20231117", "workflow_name": "artifact_generation", "where_condition":"", "job_type_id":"15", "job_schedule_id": 1624, "is_success_mail":false, "flow_type":"", "jwt_ttl":"259200000", "authtoken_job_type":"default" }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/email_templates_flow_timed_out.stg", "template_name": "flow_timeout_notification_email_retry_or_not" } ], "completionCriteria": { "success":{ "botTopics": [ "nabu_2_completion" ], "criteria":[ "AND", { "bot_metadata.tags.process_id": 417002077600037802, "opOperator": "==" }, { "bot_metadata.message_context": "end_of_the_flow", "opOperator": "==" } ] }, "error": { "botTopics": [ "nabu_2_errorbot" ], "criteria": [ "AND", { "opOperator": "==", "bot_metadata.tags.process_id": 417002077600037802 }, { "opOperator": "==", "bot_metadata.message_context": "taskstatus_bot_error_msg" } ] } } } ], "inputFlows": ["ingestion_271_17002077600028566.flow_timeout"], "outputFlows": [], "flowOutputTemplates": [ ] } ], "flow_timeout":72 }
""2023-11-17 07:56:02.862 [pool-24-thread-31] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-17 07:56:02.863 [pool-24-thread-31] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-17 07:56:02.886 [Thread-408] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ed3cd22-40fc-41f0-a1bf-2e8df394dc31 has started processing message with message_id d4325a7a-8cd0-430e-a7a9-941959cdc88a and thread_id 537 
""2023-11-17 07:56:02.886 [Thread-408] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:02.886 [Thread-408] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=e56f48fd-3254-4aef-82b2-ecb838397bf0, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=d4325a7a-8cd0-430e-a7a9-941959cdc88a, task_retry_intervals_secs=[], bot_id=330cfcdb-58fd-46f9-8954-91528f06bc95, message_topic=nabu_2_taskmonitor, tags={process_id=1700207760003780, initial_ts=1700207760106, batch_name=, environment=modak, batch_id=17002077600028566, job_schedule_id=1624, data_movement_id=271, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, TaskMonitorBot]}}
""2023-11-17 07:56:02.891 [Thread-1084] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "f5d22052-99ed-46a1-91e9-fc2fc89cdc67", "parent_id": "be7daf9f-8d06-44b7-b94d-399b614bdd44", "bot_id": "bfb7aff8-e3e2-41bd-b799-ad3147187c77", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":1700207760003780, "initial_ts":1700207760106, "batch_id":17002077600028566, "batch_name":"", "job_schedule_id":1624, "data_movement_id": 271, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"bfb7aff8-e3e2-41bd-b799-ad3147187c77", "bot_name":"DBOpsBot", "process_context":"starting_message_for_ingestion", "task_name":"checking_pre_conditions_or_starting_msg_of_ingestion", "process_id":"1700207760003780", "task_ts":1700207762626, "batch_id":"17002077600028566", "status_code_id": 6 } } ] }
""2023-11-17 07:56:02.893 [Thread-1084] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-17 07:56:02.897 [Thread-408] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17002077600028566, 1700207760003780, 'DBOpsBot', 'data_movement_deciding', 'data_movement_deciding_msg', 10 , TO_TIMESTAMP(1700207762699::double precision / 1000) ,'330cfcdb-58fd-46f9-8954-91528f06bc95');
""2023-11-17 07:56:02.897 [Thread-408] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ed3cd22-40fc-41f0-a1bf-2e8df394dc31 has started process logic with message_id d4325a7a-8cd0-430e-a7a9-941959cdc88a and thread_id 537
""2023-11-17 07:56:03.013 [Thread-1084] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-17 07:56:03.013 [Thread-1084] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:03.013 [Thread-1084] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot finished processing message with id be7daf9f-8d06-44b7-b94d-399b614bdd44
""2023-11-17 07:56:03.020 [pool-24-thread-31] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-17 07:56:03.020 [pool-24-thread-31] INFO  com.modak.bots.basebot.AbstractBaseBot - FlowControllerBot with bot_id 9a243656-a8f6-45a1-bf1a-431a00d18e91 has started process logic with message_id 1d0e2355-7bbd-4323-937d-1be505bb907a and thread_id 4437
""2023-11-17 07:56:03.020 [Thread-408] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ed3cd22-40fc-41f0-a1bf-2e8df394dc31 has finished process logic with message_id d4325a7a-8cd0-430e-a7a9-941959cdc88a and thread_id 537
""2023-11-17 07:56:03.020 [Thread-408] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:03.020 [Thread-408] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id d4325a7a-8cd0-430e-a7a9-941959cdc88a
""2023-11-17 07:56:03.021 [pool-24-thread-31] DEBUG com.modak.bots.FlowControllerBot - FlowController bot data : { "flows":[ { "flowName": "ingestion_271_17002077600028566", "flowId":17002077625516241, "batch_id":17002077600028566, "job_schedule_id": "1624", "job_type_id": 1, "data_movement_id":"271", "flow_type": "ingestion", "metaflowData": { "tags": { "tags": [ "ingestion_271_17002077600028566" ] } }, "configuration": { "parallel":10, "flowTimeoutHrs":72 }, "uiInfo": { "description": "Auto generated by flow controller for flow ingestion_271_17002077600028566" }, "flowTasks": [ { "flowTaskName": "spark_ingestion_almaren_271_1", "flowTaskId": 2711, "processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "bot_metadata": { "tags":{ "process_id":17002077600037801, "batch_id": 17002077600028566, "batch_name": "Ingestion_20231117", "environment": "DEV", "data_movement_id": 271, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "0001-01-01 00:00:00.103", "job_schedule_id": 1624, "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"} } }, "app_template_details": { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "generate_input_data" }, "input_data": { "variables": { "env_variables": { }, "user_variables": { }, "payload_variables": { } }, "environment": "DEV", "data_movement_id":"271", "process_id": "17002077600037801", "batch_id": "17002077600028566", "batch_name": "Ingestion_20231117", "workflow_name": "artifact_generation", "where_condition":"37234", "flow_number":1, "job_schedule_id": 1624, "job_scheduled_user_id": "Manaswini Chinthalapudi", "relative_file_path": "", "ingestion_table_format": "", "suffix": "", "is_relative_file_path": false, "source_schema_name": "acuity-develop", "source_database_name": "development-db", "source_schema_name_lowercase": "acuity-develop", "source_database_name_lowercase": "development-db", "source_database_name_uppercase": "DEVELOPMENT-DB", "source_schema_name_uppercase": "ACUITY-DEVELOP", "data_movement_name":"ss_compass_adb_validation_MIC7018", "last_run_timestamp": "0001-01-01 00:00:00.103", "job_type_id":"1", "jwt_ttl":"259200000", "authtoken_job_type":"default" }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "artifact_generation_auth_token_msg" } ], "retry_template": { "retry_template_group": "templates/artifact_ingestion/flow_controller.stg", "retry_template_name": "artifact_generation_auth_token_msg_retry" }, "loggers":{ "scheduled_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_scheduled_log", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" } ], "pre_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_running_log", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_pre_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" } ], "post_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_post_log_db", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_post_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" } ], "retry_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_task_retry_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" } ] }, "completionCriteria": { "success":{ "botTopics": [ "nabu_2_completion" ], "criteria":[ "AND", { "bot_metadata.tags.process_id": 17002077600037801, "opOperator": "==" }, { "bot_metadata.message_context": "end_of_the_flow", "opOperator": "==" } ] }, "error": { "botTopics": [ "nabu_2_errorbot" ], "criteria": [ "AND", { "opOperator": "==", "bot_metadata.tags.process_id": 17002077600037801 }, { "opOperator": "==", "bot_metadata.message_context": "taskstatus_bot_error_msg" } ] }, "retry": [ "AND", { "error_data.retry_attempt": 3, "opOperator": "<" }, { "error_data.error_json": "(?i).*exception.*", "opOperator": "~" } ] } } ], "inputFlows": [], "outputFlows": [], "flowOutputTemplates": [ { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "delete_almaren_code_from_kosh" }, { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "delete_created_credentials" } ,{ "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "insert_pre_agg_stats_template" } ] ,"loggers":{ "pre_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_pre_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_pre_log_db", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" } ], "post_loggers": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_post_log", "log_type": "FILE", "log_file_location": "../logs/flow_controller_logger_output.log" }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "flow_post_log_db", "log_type": "DB", "log_file_location": "../logs/flow_controller_logger_output.log" } ] } } ,{ "flowName": "success_notification_email", "flowId":17002077625516242, "batch_id":17002077600028566, "job_schedule_id": "1624", "job_type_id": 15, "data_movement_id":"271", "flow_type": "success", "metaflowData": { "tags": { "tags": [ "success_notification_email" ] } }, "configuration": { "parallel":10, "flowTimeoutHrs":72 }, "uiInfo": { "description": "Auto generated by flow controller for flow success_notification_email" }, "flowTasks": [ { "flowTaskName": "email_flow_2712", "flowTaskId": 2712, "processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "bot_metadata": { "tags":{ "process_id":217002077600037802, "batch_id": 17002077600028566, "batch_name": "Ingestion_20231117", "environment": "DEV", "data_movement_id": 271, "job_scheduled_user_id": "Manaswini Chinthalapudi", "job_schedule_id": 1624, "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"} } }, "app_template_details": { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "generate_table_input_data" }, "input_data": { "is_success_mail":true, "flow_type": "success", "environment": "DEV", "data_movement_id":"271", "process_id": "217002077600037802", "batch_id": "17002077600028566", "batch_name": "Ingestion_20231117", "workflow_name": "artifact_generation", "where_condition":"", "job_type_id":"15", "job_schedule_id": 1624, "jwt_ttl":"259200000", "authtoken_job_type":"default" }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/email_templates.stg", "template_name": "success_or_failure_notification_email" } ], "completionCriteria": { "success":{ "botTopics": [ "nabu_2_completion" ], "criteria":[ "AND", { "bot_metadata.tags.process_id": 217002077600037802, "opOperator": "==" }, { "bot_metadata.message_context": "end_of_the_flow", "opOperator": "==" } ] }, "error": { "botTopics": [ "nabu_2_errorbot" ], "criteria": [ "AND", { "opOperator": "==", "bot_metadata.tags.process_id": 217002077600037802 }, { "opOperator": "==", "bot_metadata.message_context": "taskstatus_bot_error_msg" } ] } } } ], "inputFlows": ["ingestion_271_17002077600028566.success"], "outputFlows": [], "flowOutputTemplates": [ ] } ,{ "flowName": "failure_notification_email", "flowId":17002077625516243, "batch_id":17002077600028566, "job_schedule_id": "1624", "job_type_id": 15, "data_movement_id":"271", "flow_type": "failure", "metaflowData": { "tags": { "tags": [ "failure_notification_email" ] } }, "configuration": { "parallel":10, "flowTimeoutHrs":72 }, "uiInfo": { "description": "Auto generated by flow controller for flow failure_notification_email" }, "flowTasks": [ { "flowTaskName": "email_flow_2713", "flowTaskId": 2713, "processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "bot_metadata": { "tags":{ "process_id":317002077600037802, "batch_id": 17002077600028566, "batch_name": "Ingestion_20231117", "environment": "DEV", "data_movement_id": 271, "job_scheduled_user_id": "Manaswini Chinthalapudi", "job_schedule_id": 1624, "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"} } }, "app_template_details": { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "generate_table_input_data" }, "input_data": { "is_success_mail":false, "flow_type": "failure", "environment": "DEV", "data_movement_id":"271", "process_id": "317002077600037802", "batch_id": "17002077600028566", "batch_name": "Ingestion_20231117", "workflow_name": "artifact_generation", "where_condition":"", "job_type_id":"15", "job_schedule_id": 1624, "jwt_ttl":"259200000", "authtoken_job_type":"default" }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/email_templates.stg", "template_name": "success_or_failure_notification_email" } ], "completionCriteria": { "success":{ "botTopics": [ "nabu_2_completion" ], "criteria":[ "AND", { "bot_metadata.tags.process_id": 317002077600037802, "opOperator": "==" }, { "bot_metadata.message_context": "end_of_the_flow", "opOperator": "==" } ] }, "error": { "botTopics": [ "nabu_2_errorbot" ], "criteria": [ "AND", { "opOperator": "==", "bot_metadata.tags.process_id": 317002077600037802 }, { "opOperator": "==", "bot_metadata.message_context": "taskstatus_bot_error_msg" } ] } } } ], "inputFlows": ["ingestion_271_17002077600028566.error"], "outputFlows": [], "flowOutputTemplates": [ ] } ,{ "flowName": "flow_timeout_notification_email", "flowId":17002077625516244, "batch_id":17002077600028566, "job_schedule_id": "1624", "job_type_id": 15, "data_movement_id":"271", "flow_type": "", "metaflowData": { "tags": { "tags": [ "flow_timeout_notification_email" ] } }, "configuration": { "parallel":10, "flowTimeoutHrs":72 }, "uiInfo": { "description": "Auto generated by flow controller for flow flow_timeout_notification_email" }, "flowTasks": [ { "flowTaskName": "email_flow_2714", "flowTaskId": 2714, "processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "bot_metadata": { "tags":{ "process_id":417002077600037802, "batch_id": 17002077600028566, "batch_name": "Ingestion_20231117", "environment": "DEV", "data_movement_id": 271, "job_scheduled_user_id": "Manaswini Chinthalapudi", "job_schedule_id": 1624, "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"} } }, "app_template_details": { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "generate_table_input_data" }, "input_data": { "environment": "DEV", "data_movement_id":"271", "process_id": "417002077600037802", "batch_id": "17002077600028566", "batch_name": "Ingestion_20231117", "workflow_name": "artifact_generation", "where_condition":"", "job_type_id":"15", "job_schedule_id": 1624, "is_success_mail":false, "flow_type":"", "jwt_ttl":"259200000", "authtoken_job_type":"default" }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/email_templates_flow_timed_out.stg", "template_name": "flow_timeout_notification_email_retry_or_not" } ], "completionCriteria": { "success":{ "botTopics": [ "nabu_2_completion" ], "criteria":[ "AND", { "bot_metadata.tags.process_id": 417002077600037802, "opOperator": "==" }, { "bot_metadata.message_context": "end_of_the_flow", "opOperator": "==" } ] }, "error": { "botTopics": [ "nabu_2_errorbot" ], "criteria": [ "AND", { "opOperator": "==", "bot_metadata.tags.process_id": 417002077600037802 }, { "opOperator": "==", "bot_metadata.message_context": "taskstatus_bot_error_msg" } ] } } } ], "inputFlows": ["ingestion_271_17002077600028566.flow_timeout"], "outputFlows": [], "flowOutputTemplates": [ ] } ], "flow_timeout":72 }
""2023-11-17 07:56:03.023 [pool-24-thread-31] DEBUG com.modak.bots.FlowControllerBot - flowMap to flowcontroller is {flows=[{flowOutputTemplates=[{template_name=delete_almaren_code_from_kosh, template_group=templates/artifact_ingestion/flow_controller.stg}, {template_name=delete_created_credentials, template_group=templates/artifact_ingestion/flow_controller.stg}, {template_name=insert_pre_agg_stats_template, template_group=templates/artifact_ingestion/flow_controller.stg}], batch_id=17002077600028566, configuration={parallel=10, flowTimeoutHrs=72}, loggers={post_loggers=[{template_name=flow_post_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_post_log_db, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], pre_loggers=[{template_name=flow_pre_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_pre_log_db, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}]}, flowName=ingestion_271_17002077600028566, job_type_id=1, flow_type=ingestion, uiInfo={description=Auto generated by flow controller for flow ingestion_271_17002077600028566}, flowTasks=[{input_data={jwt_ttl=259200000, process_id=17002077600037801, flow_number=1, source_database_name_lowercase=development-db, batch_id=17002077600028566, workflow_name=artifact_generation, where_condition=37234, suffix=, job_type_id=1, ingestion_table_format=, job_schedule_id=1624, relative_file_path=, data_movement_name=ss_compass_adb_validation_MIC7018, source_schema_name_lowercase=acuity-develop, variables={env_variables={}, user_variables={}, payload_variables={}}, source_database_name_uppercase=DEVELOPMENT-DB, job_scheduled_user_id=Manaswini Chinthalapudi, source_schema_name_uppercase=ACUITY-DEVELOP, source_schema_name=acuity-develop, environment=DEV, batch_name=Ingestion_20231117, source_database_name=development-db, authtoken_job_type=default, data_movement_id=271, last_run_timestamp=0001-01-01 00:00:00.103, is_relative_file_path=false}, flowTaskId=2711, bot_metadata={tags={process_id=17002077600037801, batch_name=Ingestion_20231117, environment=DEV, batch_id=17002077600028566, job_schedule_id=1624, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, data_movement_id=271, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=0001-01-01 00:00:00.103}}, retry_template={retry_template_name=artifact_generation_auth_token_msg_retry, retry_template_group=templates/artifact_ingestion/flow_controller.stg}, loggers={scheduled_loggers=[{template_name=flow_task_scheduled_log, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], post_loggers=[{template_name=flow_task_post_log_db, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_task_post_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], pre_loggers=[{template_name=flow_task_running_log, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_task_pre_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], retry_loggers=[{template_name=flow_task_retry_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}]}, completionCriteria={success={botTopics=[nabu_2_completion], criteria=[AND, {bot_metadata.tags.process_id=17002077600037801, opOperator===}, {opOperator===, bot_metadata.message_context=end_of_the_flow}]}, error={botTopics=[nabu_2_errorbot], criteria=[AND, {bot_metadata.tags.process_id=17002077600037801, opOperator===}, {opOperator===, bot_metadata.message_context=taskstatus_bot_error_msg}]}, retry=[AND, {error_data.retry_attempt=3, opOperator=<}, {error_data.error_json=(?i).*exception.*, opOperator=~}]}, app_template_details={template_name=generate_input_data, template_group=templates/artifact_ingestion/flow_controller.stg}, output_message_templates=[{template_name=artifact_generation_auth_token_msg, template_group=templates/artifact_ingestion/flow_controller.stg}], processor={classname=com.modak.bots.processor.NullProcessor, props={}}, flowTaskName=spark_ingestion_almaren_271_1}], job_schedule_id=1624, data_movement_id=271, inputFlows=[], outputFlows=[], flowId=17002077625516241, metaflowData={tags={tags=[ingestion_271_17002077600028566]}}}, {flowOutputTemplates=[], batch_id=17002077600028566, configuration={parallel=10, flowTimeoutHrs=72}, flowName=success_notification_email, job_type_id=15, flow_type=success, uiInfo={description=Auto generated by flow controller for flow success_notification_email}, flowTasks=[{input_data={jwt_ttl=259200000, process_id=217002077600037802, batch_id=17002077600028566, workflow_name=artifact_generation, where_condition=, job_type_id=15, environment=DEV, batch_name=Ingestion_20231117, flow_type=success, authtoken_job_type=default, is_success_mail=true, job_schedule_id=1624, data_movement_id=271}, flowTaskId=2712, bot_metadata={tags={process_id=217002077600037802, batch_name=Ingestion_20231117, environment=DEV, batch_id=17002077600028566, job_schedule_id=1624, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, data_movement_id=271, job_scheduled_user_id=Manaswini Chinthalapudi}}, completionCriteria={success={botTopics=[nabu_2_completion], criteria=[AND, {bot_metadata.tags.process_id=217002077600037802, opOperator===}, {opOperator===, bot_metadata.message_context=end_of_the_flow}]}, error={botTopics=[nabu_2_errorbot], criteria=[AND, {bot_metadata.tags.process_id=217002077600037802, opOperator===}, {opOperator===, bot_metadata.message_context=taskstatus_bot_error_msg}]}}, app_template_details={template_name=generate_table_input_data, template_group=templates/artifact_ingestion/flow_controller.stg}, output_message_templates=[{template_name=success_or_failure_notification_email, template_group=templates/artifact_ingestion/email_templates.stg}], processor={classname=com.modak.bots.processor.NullProcessor, props={}}, flowTaskName=email_flow_2712}], job_schedule_id=1624, data_movement_id=271, inputFlows=[ingestion_271_17002077600028566.success], outputFlows=[], flowId=17002077625516242, metaflowData={tags={tags=[success_notification_email]}}}, {flowOutputTemplates=[], batch_id=17002077600028566, configuration={parallel=10, flowTimeoutHrs=72}, flowName=failure_notification_email, job_type_id=15, flow_type=failure, uiInfo={description=Auto generated by flow controller for flow failure_notification_email}, flowTasks=[{input_data={jwt_ttl=259200000, process_id=317002077600037802, batch_id=17002077600028566, workflow_name=artifact_generation, where_condition=, job_type_id=15, environment=DEV, batch_name=Ingestion_20231117, flow_type=failure, authtoken_job_type=default, is_success_mail=false, job_schedule_id=1624, data_movement_id=271}, flowTaskId=2713, bot_metadata={tags={process_id=317002077600037802, batch_name=Ingestion_20231117, environment=DEV, batch_id=17002077600028566, job_schedule_id=1624, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, data_movement_id=271, job_scheduled_user_id=Manaswini Chinthalapudi}}, completionCriteria={success={botTopics=[nabu_2_completion], criteria=[AND, {bot_metadata.tags.process_id=317002077600037802, opOperator===}, {opOperator===, bot_metadata.message_context=end_of_the_flow}]}, error={botTopics=[nabu_2_errorbot], criteria=[AND, {bot_metadata.tags.process_id=317002077600037802, opOperator===}, {opOperator===, bot_metadata.message_context=taskstatus_bot_error_msg}]}}, app_template_details={template_name=generate_table_input_data, template_group=templates/artifact_ingestion/flow_controller.stg}, output_message_templates=[{template_name=success_or_failure_notification_email, template_group=templates/artifact_ingestion/email_templates.stg}], processor={classname=com.modak.bots.processor.NullProcessor, props={}}, flowTaskName=email_flow_2713}], job_schedule_id=1624, data_movement_id=271, inputFlows=[ingestion_271_17002077600028566.error], outputFlows=[], flowId=17002077625516243, metaflowData={tags={tags=[failure_notification_email]}}}, {flowOutputTemplates=[], batch_id=17002077600028566, configuration={parallel=10, flowTimeoutHrs=72}, flowName=flow_timeout_notification_email, job_type_id=15, flow_type=, uiInfo={description=Auto generated by flow controller for flow flow_timeout_notification_email}, flowTasks=[{input_data={jwt_ttl=259200000, process_id=417002077600037802, batch_id=17002077600028566, workflow_name=artifact_generation, where_condition=, job_type_id=15, environment=DEV, batch_name=Ingestion_20231117, flow_type=, authtoken_job_type=default, job_schedule_id=1624, is_success_mail=false, data_movement_id=271}, flowTaskId=2714, bot_metadata={tags={process_id=417002077600037802, batch_name=Ingestion_20231117, environment=DEV, batch_id=17002077600028566, job_schedule_id=1624, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, data_movement_id=271, job_scheduled_user_id=Manaswini Chinthalapudi}}, completionCriteria={success={botTopics=[nabu_2_completion], criteria=[AND, {bot_metadata.tags.process_id=417002077600037802, opOperator===}, {opOperator===, bot_metadata.message_context=end_of_the_flow}]}, error={botTopics=[nabu_2_errorbot], criteria=[AND, {bot_metadata.tags.process_id=417002077600037802, opOperator===}, {opOperator===, bot_metadata.message_context=taskstatus_bot_error_msg}]}}, app_template_details={template_name=generate_table_input_data, template_group=templates/artifact_ingestion/flow_controller.stg}, output_message_templates=[{template_name=flow_timeout_notification_email_retry_or_not, template_group=templates/artifact_ingestion/email_templates_flow_timed_out.stg}], processor={classname=com.modak.bots.processor.NullProcessor, props={}}, flowTaskName=email_flow_2714}], job_schedule_id=1624, data_movement_id=271, inputFlows=[ingestion_271_17002077600028566.flow_timeout], outputFlows=[], flowId=17002077625516244, metaflowData={tags={tags=[flow_timeout_notification_email]}}}], flow_timeout=72}
""2023-11-17 07:56:03.023 [pool-24-thread-31] DEBUG com.modak.bots.FlowControllerBot - inputMessageMetadataMap to flowcontroller is {flowControllerMetadata={parent_id=e56f48fd-3254-4aef-82b2-ecb838397bf0, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=flowcontroller_message_to_generate_flows, message_id=1d0e2355-7bbd-4323-937d-1be505bb907a, task_retry_intervals_secs=[], bot_id=330cfcdb-58fd-46f9-8954-91528f06bc95, message_topic=nabu_2_flowcontroller, tags={process_id=1700207760003780, batch_id=17002077600028566, job_scheduled_user_id=Manaswini Chinthalapudi, tags=[AuthToken, DBOpsBot, DBOpsBot], initial_ts=1700207760106, batch_name=, environment=modak, job_schedule_id=1624, data_movement_id=271, last_run_timestamp=, retry_attempt=0, task_dependency=true, ignore_job_termination=false}}, bot_id=9a243656-a8f6-45a1-bf1a-431a00d18e91}
""2023-11-17 07:56:03.024 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - FlowController input : 
{"flows":[{"flowOutputTemplates":[{"template_group":"templates/artifact_ingestion/flow_controller.stg","template_name":"delete_almaren_code_from_kosh"},{"template_group":"templates/artifact_ingestion/flow_controller.stg","template_name":"delete_created_credentials"},{"template_group":"templates/artifact_ingestion/flow_controller.stg","template_name":"insert_pre_agg_stats_template"}],"batch_id":17002077600028566,"configuration":{"parallel":10,"flowTimeoutHrs":72},"loggers":{"post_loggers":[{"template_name":"flow_post_log","log_type":"FILE","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"},{"template_name":"flow_post_log_db","log_type":"DB","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"}],"pre_loggers":[{"template_name":"flow_pre_log","log_type":"FILE","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"},{"template_name":"flow_pre_log_db","log_type":"DB","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"}]},"flowName":"ingestion_271_17002077600028566","job_type_id":1,"flow_type":"ingestion","uiInfo":{"description":"Auto generated by flow controller for flow ingestion_271_17002077600028566"},"flowTasks":[{"input_data":{"jwt_ttl":"259200000","process_id":"17002077600037801","flow_number":1,"source_database_name_lowercase":"development-db","batch_id":"17002077600028566","workflow_name":"artifact_generation","where_condition":"37234","suffix":"","job_type_id":"1","ingestion_table_format":"","job_schedule_id":1624,"relative_file_path":"","data_movement_name":"ss_compass_adb_validation_MIC7018","source_schema_name_lowercase":"acuity-develop","variables":{"env_variables":{},"user_variables":{},"payload_variables":{}},"source_database_name_uppercase":"DEVELOPMENT-DB","job_scheduled_user_id":"Manaswini Chinthalapudi","source_schema_name_uppercase":"ACUITY-DEVELOP","source_schema_name":"acuity-develop","environment":"DEV","batch_name":"Ingestion_20231117","source_database_name":"development-db","authtoken_job_type":"default","data_movement_id":"271","last_run_timestamp":"0001-01-01 00:00:00.103","is_relative_file_path":false},"flowTaskId":2711,"bot_metadata":{"tags":{"process_id":17002077600037801,"batch_name":"Ingestion_20231117","environment":"DEV","batch_id":17002077600028566,"job_schedule_id":1624,"workflow_route_bot_topic_details":{"DBOpsBot":"nabu_2_jdbc","ScriptBot":"nabu_2_scriptbot","SparkComputeEngineBot":"nabu_2_spark_compute","FilterResolverDBOpsBot":"nabu_2_filter_resolver_jdbc","S3StreamBot":"nabu_2_s3_stream","ErrorBot":"nabu_2_errorbot","AuthTokenBot":"nabu_2_authtoken","OnDemandBot":"nabu_2_ondemand_bot","EmailBot":"nabu_2_emailbot","PipelineDependencyCheckerBot":"nabu_2_pipelinedependency_checker","RPCSparkScriptBot":"nabu_2_rpc_spark_script","SparkScriptBot":"nabu_2_spark_script","RestAPIBot":"nabu_2_restapibot","CurationSparkScriptBot":"nabu_2_curation_script","TaskMonitorBot":"nabu_2_taskmonitor","completion_topic":"nabu_2_completion","FlowControllerBot":"nabu_2_flowcontroller","UpdateDBOpsBot":"nabu_2_update_jdbc"},"data_movement_id":271,"job_scheduled_user_id":"Manaswini Chinthalapudi","last_run_timestamp":"0001-01-01 00:00:00.103"}},"retry_template":{"retry_template_name":"artifact_generation_auth_token_msg_retry","retry_template_group":"templates/artifact_ingestion/flow_controller.stg"},"loggers":{"scheduled_loggers":[{"template_name":"flow_task_scheduled_log","log_type":"DB","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"}],"post_loggers":[{"template_name":"flow_task_post_log_db","log_type":"DB","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"},{"template_name":"flow_task_post_log","log_type":"FILE","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"}],"pre_loggers":[{"template_name":"flow_task_running_log","log_type":"DB","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"},{"template_name":"flow_task_pre_log","log_type":"FILE","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"}],"retry_loggers":[{"template_name":"flow_task_retry_log","log_type":"FILE","log_file_location":"../logs/flow_controller_logger_output.log","template_group":"templates/artifact_ingestion/common_templates.stg"}]},"completionCriteria":{"error":{"botTopics":["nabu_2_errorbot"],"criteria":["AND",{"opOperator":"==","bot_metadata.tags.process_id":17002077600037801},{"opOperator":"==","bot_metadata.message_context":"taskstatus_bot_error_msg"}]},"success":{"botTopics":["nabu_2_completion"],"criteria":["AND",{"opOperator":"==","bot_metadata.tags.process_id":17002077600037801},{"opOperator":"==","bot_metadata.message_context":"end_of_the_flow"}]},"retry":["AND",{"opOperator":"<","error_data.retry_attempt":3},{"error_data.error_json":"(?i).*exception.*","opOperator":"~"}]},"app_template_details":{"template_group":"templates/artifact_ingestion/flow_controller.stg","template_name":"generate_input_data"},"output_message_templates":[{"template_group":"templates/artifact_ingestion/flow_controller.stg","template_name":"artifact_generation_auth_token_msg"}],"processor":{"classname":"com.modak.bots.processor.NullProcessor","props":{}},"flowTaskName":"spark_ingestion_almaren_271_1"}],"job_schedule_id":"1624","data_movement_id":"271","inputFlows":[],"outputFlows":[],"flowId":17002077625516241,"metaflowData":{"tags":{"tags":["ingestion_271_17002077600028566"]}}},{"flowOutputTemplates":[],"batch_id":17002077600028566,"configuration":{"parallel":10,"flowTimeoutHrs":72},"flowName":"success_notification_email","job_type_id":15,"flow_type":"success","uiInfo":{"description":"Auto generated by flow controller for flow success_notification_email"},"flowTasks":[{"input_data":{"jwt_ttl":"259200000","process_id":"217002077600037802","batch_id":"17002077600028566","workflow_name":"artifact_generation","where_condition":"","job_type_id":"15","environment":"DEV","batch_name":"Ingestion_20231117","flow_type":"success","authtoken_job_type":"default","is_success_mail":true,"job_schedule_id":1624,"data_movement_id":"271"},"flowTaskId":2712,"bot_metadata":{"tags":{"process_id":217002077600037802,"batch_name":"Ingestion_20231117","environment":"DEV","batch_id":17002077600028566,"job_schedule_id":1624,"workflow_route_bot_topic_details":{"DBOpsBot":"nabu_2_jdbc","ScriptBot":"nabu_2_scriptbot","SparkComputeEngineBot":"nabu_2_spark_compute","FilterResolverDBOpsBot":"nabu_2_filter_resolver_jdbc","S3StreamBot":"nabu_2_s3_stream","ErrorBot":"nabu_2_errorbot","AuthTokenBot":"nabu_2_authtoken","OnDemandBot":"nabu_2_ondemand_bot","EmailBot":"nabu_2_emailbot","PipelineDependencyCheckerBot":"nabu_2_pipelinedependency_checker","RPCSparkScriptBot":"nabu_2_rpc_spark_script","SparkScriptBot":"nabu_2_spark_script","RestAPIBot":"nabu_2_restapibot","CurationSparkScriptBot":"nabu_2_curation_script","TaskMonitorBot":"nabu_2_taskmonitor","completion_topic":"nabu_2_completion","FlowControllerBot":"nabu_2_flowcontroller","UpdateDBOpsBot":"nabu_2_update_jdbc"},"data_movement_id":271,"job_scheduled_user_id":"Manaswini Chinthalapudi"}},"completionCriteria":{"error":{"botTopics":["nabu_2_errorbot"],"criteria":["AND",{"opOperator":"==","bot_metadata.tags.process_id":217002077600037802},{"opOperator":"==","bot_metadata.message_context":"taskstatus_bot_error_msg"}]},"success":{"botTopics":["nabu_2_completion"],"criteria":["AND",{"opOperator":"==","bot_metadata.tags.process_id":217002077600037802},{"opOperator":"==","bot_metadata.message_context":"end_of_the_flow"}]}},"app_template_details":{"template_group":"templates/artifact_ingestion/flow_controller.stg","template_name":"generate_table_input_data"},"output_message_templates":[{"template_group":"templates/artifact_ingestion/email_templates.stg","template_name":"success_or_failure_notification_email"}],"processor":{"classname":"com.modak.bots.processor.NullProcessor","props":{}},"flowTaskName":"email_flow_2712"}],"job_schedule_id":"1624","data_movement_id":"271","inputFlows":["ingestion_271_17002077600028566.success"],"outputFlows":[],"flowId":17002077625516242,"metaflowData":{"tags":{"tags":["success_notification_email"]}}},{"flowOutputTemplates":[],"batch_id":17002077600028566,"configuration":{"parallel":10,"flowTimeoutHrs":72},"flowName":"failure_notification_email","job_type_id":15,"flow_type":"failure","uiInfo":{"description":"Auto generated by flow controller for flow failure_notification_email"},"flowTasks":[{"input_data":{"jwt_ttl":"259200000","process_id":"317002077600037802","batch_id":"17002077600028566","workflow_name":"artifact_generation","where_condition":"","job_type_id":"15","environment":"DEV","batch_name":"Ingestion_20231117","flow_type":"failure","authtoken_job_type":"default","is_success_mail":false,"job_schedule_id":1624,"data_movement_id":"271"},"flowTaskId":2713,"bot_metadata":{"tags":{"process_id":317002077600037802,"batch_name":"Ingestion_20231117","environment":"DEV","batch_id":17002077600028566,"job_schedule_id":1624,"workflow_route_bot_topic_details":{"DBOpsBot":"nabu_2_jdbc","ScriptBot":"nabu_2_scriptbot","SparkComputeEngineBot":"nabu_2_spark_compute","FilterResolverDBOpsBot":"nabu_2_filter_resolver_jdbc","S3StreamBot":"nabu_2_s3_stream","ErrorBot":"nabu_2_errorbot","AuthTokenBot":"nabu_2_authtoken","OnDemandBot":"nabu_2_ondemand_bot","EmailBot":"nabu_2_emailbot","PipelineDependencyCheckerBot":"nabu_2_pipelinedependency_checker","RPCSparkScriptBot":"nabu_2_rpc_spark_script","SparkScriptBot":"nabu_2_spark_script","RestAPIBot":"nabu_2_restapibot","CurationSparkScriptBot":"nabu_2_curation_script","TaskMonitorBot":"nabu_2_taskmonitor","completion_topic":"nabu_2_completion","FlowControllerBot":"nabu_2_flowcontroller","UpdateDBOpsBot":"nabu_2_update_jdbc"},"data_movement_id":271,"job_scheduled_user_id":"Manaswini Chinthalapudi"}},"completionCriteria":{"error":{"botTopics":["nabu_2_errorbot"],"criteria":["AND",{"opOperator":"==","bot_metadata.tags.process_id":317002077600037802},{"opOperator":"==","bot_metadata.message_context":"taskstatus_bot_error_msg"}]},"success":{"botTopics":["nabu_2_completion"],"criteria":["AND",{"opOperator":"==","bot_metadata.tags.process_id":317002077600037802},{"opOperator":"==","bot_metadata.message_context":"end_of_the_flow"}]}},"app_template_details":{"template_group":"templates/artifact_ingestion/flow_controller.stg","template_name":"generate_table_input_data"},"output_message_templates":[{"template_group":"templates/artifact_ingestion/email_templates.stg","template_name":"success_or_failure_notification_email"}],"processor":{"classname":"com.modak.bots.processor.NullProcessor","props":{}},"flowTaskName":"email_flow_2713"}],"job_schedule_id":"1624","data_movement_id":"271","inputFlows":["ingestion_271_17002077600028566.error"],"outputFlows":[],"flowId":17002077625516243,"metaflowData":{"tags":{"tags":["failure_notification_email"]}}},{"flowOutputTemplates":[],"batch_id":17002077600028566,"configuration":{"parallel":10,"flowTimeoutHrs":72},"flowName":"flow_timeout_notification_email","job_type_id":15,"flow_type":"","uiInfo":{"description":"Auto generated by flow controller for flow flow_timeout_notification_email"},"flowTasks":[{"input_data":{"jwt_ttl":"259200000","process_id":"417002077600037802","batch_id":"17002077600028566","workflow_name":"artifact_generation","where_condition":"","job_type_id":"15","environment":"DEV","batch_name":"Ingestion_20231117","flow_type":"","authtoken_job_type":"default","job_schedule_id":1624,"is_success_mail":false,"data_movement_id":"271"},"flowTaskId":2714,"bot_metadata":{"tags":{"process_id":417002077600037802,"batch_name":"Ingestion_20231117","environment":"DEV","batch_id":17002077600028566,"job_schedule_id":1624,"workflow_route_bot_topic_details":{"DBOpsBot":"nabu_2_jdbc","ScriptBot":"nabu_2_scriptbot","SparkComputeEngineBot":"nabu_2_spark_compute","FilterResolverDBOpsBot":"nabu_2_filter_resolver_jdbc","S3StreamBot":"nabu_2_s3_stream","ErrorBot":"nabu_2_errorbot","AuthTokenBot":"nabu_2_authtoken","OnDemandBot":"nabu_2_ondemand_bot","EmailBot":"nabu_2_emailbot","PipelineDependencyCheckerBot":"nabu_2_pipelinedependency_checker","RPCSparkScriptBot":"nabu_2_rpc_spark_script","SparkScriptBot":"nabu_2_spark_script","RestAPIBot":"nabu_2_restapibot","CurationSparkScriptBot":"nabu_2_curation_script","TaskMonitorBot":"nabu_2_taskmonitor","completion_topic":"nabu_2_completion","FlowControllerBot":"nabu_2_flowcontroller","UpdateDBOpsBot":"nabu_2_update_jdbc"},"data_movement_id":271,"job_scheduled_user_id":"Manaswini Chinthalapudi"}},"completionCriteria":{"error":{"botTopics":["nabu_2_errorbot"],"criteria":["AND",{"opOperator":"==","bot_metadata.tags.process_id":417002077600037802},{"opOperator":"==","bot_metadata.message_context":"taskstatus_bot_error_msg"}]},"success":{"botTopics":["nabu_2_completion"],"criteria":["AND",{"opOperator":"==","bot_metadata.tags.process_id":417002077600037802},{"opOperator":"==","bot_metadata.message_context":"end_of_the_flow"}]}},"app_template_details":{"template_group":"templates/artifact_ingestion/flow_controller.stg","template_name":"generate_table_input_data"},"output_message_templates":[{"template_group":"templates/artifact_ingestion/email_templates_flow_timed_out.stg","template_name":"flow_timeout_notification_email_retry_or_not"}],"processor":{"classname":"com.modak.bots.processor.NullProcessor","props":{}},"flowTaskName":"email_flow_2714"}],"job_schedule_id":"1624","data_movement_id":"271","inputFlows":["ingestion_271_17002077600028566.flow_timeout"],"outputFlows":[],"flowId":17002077625516244,"metaflowData":{"tags":{"tags":["flow_timeout_notification_email"]}}}],"flow_timeout":72}
""2023-11-17 07:56:03.025 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - Flow Timeout is configured as: 72
""2023-11-17 07:56:03.025 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - executorService FixedThreadPool size is : 4 for batchid : 17002077600028566
""2023-11-17 07:56:03.025 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - start flow out side the loop flowcontroller object com.modak.bots.flowcontroller.FlowController@6803e544 with batchid 17002077600028566
""2023-11-17 07:56:03.025 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - Inside startFlows() of batchid 17002077600028566
""2023-11-17 07:56:03.025 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - flowsToBeStartedMap in startflows() : {failure_notification_email={flowOutputTemplates=[], batch_id=17002077600028566, configuration={parallel=10, flowTimeoutHrs=72}, flowName=failure_notification_email, job_type_id=15, flow_type=failure, uiInfo={description=Auto generated by flow controller for flow failure_notification_email}, flowTasks=[{input_data={jwt_ttl=259200000, process_id=317002077600037802, batch_id=17002077600028566, workflow_name=artifact_generation, where_condition=, job_type_id=15, environment=DEV, batch_name=Ingestion_20231117, flow_type=failure, authtoken_job_type=default, is_success_mail=false, job_schedule_id=1624, data_movement_id=271}, flowTaskId=2713, bot_metadata={tags={process_id=317002077600037802, batch_name=Ingestion_20231117, environment=DEV, batch_id=17002077600028566, job_schedule_id=1624, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, data_movement_id=271, job_scheduled_user_id=Manaswini Chinthalapudi}}, completionCriteria={success={botTopics=[nabu_2_completion], criteria=[AND, {bot_metadata.tags.process_id=317002077600037802, opOperator===}, {opOperator===, bot_metadata.message_context=end_of_the_flow}]}, error={botTopics=[nabu_2_errorbot], criteria=[AND, {bot_metadata.tags.process_id=317002077600037802, opOperator===}, {opOperator===, bot_metadata.message_context=taskstatus_bot_error_msg}]}}, app_template_details={template_name=generate_table_input_data, template_group=templates/artifact_ingestion/flow_controller.stg}, output_message_templates=[{template_name=success_or_failure_notification_email, template_group=templates/artifact_ingestion/email_templates.stg}], processor={classname=com.modak.bots.processor.NullProcessor, props={}}, flowTaskName=email_flow_2713}], job_schedule_id=1624, data_movement_id=271, inputFlows=[ingestion_271_17002077600028566.error], outputFlows=[], flowId=17002077625516243, metaflowData={tags={tags=[failure_notification_email]}}}, flow_timeout_notification_email={flowOutputTemplates=[], batch_id=17002077600028566, configuration={parallel=10, flowTimeoutHrs=72}, flowName=flow_timeout_notification_email, job_type_id=15, flow_type=, uiInfo={description=Auto generated by flow controller for flow flow_timeout_notification_email}, flowTasks=[{input_data={jwt_ttl=259200000, process_id=417002077600037802, batch_id=17002077600028566, workflow_name=artifact_generation, where_condition=, job_type_id=15, environment=DEV, batch_name=Ingestion_20231117, flow_type=, authtoken_job_type=default, job_schedule_id=1624, is_success_mail=false, data_movement_id=271}, flowTaskId=2714, bot_metadata={tags={process_id=417002077600037802, batch_name=Ingestion_20231117, environment=DEV, batch_id=17002077600028566, job_schedule_id=1624, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, data_movement_id=271, job_scheduled_user_id=Manaswini Chinthalapudi}}, completionCriteria={success={botTopics=[nabu_2_completion], criteria=[AND, {bot_metadata.tags.process_id=417002077600037802, opOperator===}, {opOperator===, bot_metadata.message_context=end_of_the_flow}]}, error={botTopics=[nabu_2_errorbot], criteria=[AND, {bot_metadata.tags.process_id=417002077600037802, opOperator===}, {opOperator===, bot_metadata.message_context=taskstatus_bot_error_msg}]}}, app_template_details={template_name=generate_table_input_data, template_group=templates/artifact_ingestion/flow_controller.stg}, output_message_templates=[{template_name=flow_timeout_notification_email_retry_or_not, template_group=templates/artifact_ingestion/email_templates_flow_timed_out.stg}], processor={classname=com.modak.bots.processor.NullProcessor, props={}}, flowTaskName=email_flow_2714}], job_schedule_id=1624, data_movement_id=271, inputFlows=[ingestion_271_17002077600028566.flow_timeout], outputFlows=[], flowId=17002077625516244, metaflowData={tags={tags=[flow_timeout_notification_email]}}}, success_notification_email={flowOutputTemplates=[], batch_id=17002077600028566, configuration={parallel=10, flowTimeoutHrs=72}, flowName=success_notification_email, job_type_id=15, flow_type=success, uiInfo={description=Auto generated by flow controller for flow success_notification_email}, flowTasks=[{input_data={jwt_ttl=259200000, process_id=217002077600037802, batch_id=17002077600028566, workflow_name=artifact_generation, where_condition=, job_type_id=15, environment=DEV, batch_name=Ingestion_20231117, flow_type=success, authtoken_job_type=default, is_success_mail=true, job_schedule_id=1624, data_movement_id=271}, flowTaskId=2712, bot_metadata={tags={process_id=217002077600037802, batch_name=Ingestion_20231117, environment=DEV, batch_id=17002077600028566, job_schedule_id=1624, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, data_movement_id=271, job_scheduled_user_id=Manaswini Chinthalapudi}}, completionCriteria={success={botTopics=[nabu_2_completion], criteria=[AND, {bot_metadata.tags.process_id=217002077600037802, opOperator===}, {opOperator===, bot_metadata.message_context=end_of_the_flow}]}, error={botTopics=[nabu_2_errorbot], criteria=[AND, {bot_metadata.tags.process_id=217002077600037802, opOperator===}, {opOperator===, bot_metadata.message_context=taskstatus_bot_error_msg}]}}, app_template_details={template_name=generate_table_input_data, template_group=templates/artifact_ingestion/flow_controller.stg}, output_message_templates=[{template_name=success_or_failure_notification_email, template_group=templates/artifact_ingestion/email_templates.stg}], processor={classname=com.modak.bots.processor.NullProcessor, props={}}, flowTaskName=email_flow_2712}], job_schedule_id=1624, data_movement_id=271, inputFlows=[ingestion_271_17002077600028566.success], outputFlows=[], flowId=17002077625516242, metaflowData={tags={tags=[success_notification_email]}}}, ingestion_271_17002077600028566={flowOutputTemplates=[{template_name=delete_almaren_code_from_kosh, template_group=templates/artifact_ingestion/flow_controller.stg}, {template_name=delete_created_credentials, template_group=templates/artifact_ingestion/flow_controller.stg}, {template_name=insert_pre_agg_stats_template, template_group=templates/artifact_ingestion/flow_controller.stg}], batch_id=17002077600028566, configuration={parallel=10, flowTimeoutHrs=72}, loggers={post_loggers=[{template_name=flow_post_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_post_log_db, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], pre_loggers=[{template_name=flow_pre_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_pre_log_db, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}]}, flowName=ingestion_271_17002077600028566, job_type_id=1, flow_type=ingestion, uiInfo={description=Auto generated by flow controller for flow ingestion_271_17002077600028566}, flowTasks=[{input_data={jwt_ttl=259200000, process_id=17002077600037801, flow_number=1, source_database_name_lowercase=development-db, batch_id=17002077600028566, workflow_name=artifact_generation, where_condition=37234, suffix=, job_type_id=1, ingestion_table_format=, job_schedule_id=1624, relative_file_path=, data_movement_name=ss_compass_adb_validation_MIC7018, source_schema_name_lowercase=acuity-develop, variables={env_variables={}, user_variables={}, payload_variables={}}, source_database_name_uppercase=DEVELOPMENT-DB, job_scheduled_user_id=Manaswini Chinthalapudi, source_schema_name_uppercase=ACUITY-DEVELOP, source_schema_name=acuity-develop, environment=DEV, batch_name=Ingestion_20231117, source_database_name=development-db, authtoken_job_type=default, data_movement_id=271, last_run_timestamp=0001-01-01 00:00:00.103, is_relative_file_path=false}, flowTaskId=2711, bot_metadata={tags={process_id=17002077600037801, batch_name=Ingestion_20231117, environment=DEV, batch_id=17002077600028566, job_schedule_id=1624, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, data_movement_id=271, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=0001-01-01 00:00:00.103}}, retry_template={retry_template_name=artifact_generation_auth_token_msg_retry, retry_template_group=templates/artifact_ingestion/flow_controller.stg}, loggers={scheduled_loggers=[{template_name=flow_task_scheduled_log, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], post_loggers=[{template_name=flow_task_post_log_db, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_task_post_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], pre_loggers=[{template_name=flow_task_running_log, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_task_pre_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], retry_loggers=[{template_name=flow_task_retry_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}]}, completionCriteria={success={botTopics=[nabu_2_completion], criteria=[AND, {bot_metadata.tags.process_id=17002077600037801, opOperator===}, {opOperator===, bot_metadata.message_context=end_of_the_flow}]}, error={botTopics=[nabu_2_errorbot], criteria=[AND, {bot_metadata.tags.process_id=17002077600037801, opOperator===}, {opOperator===, bot_metadata.message_context=taskstatus_bot_error_msg}]}, retry=[AND, {error_data.retry_attempt=3, opOperator=<}, {error_data.error_json=(?i).*exception.*, opOperator=~}]}, app_template_details={template_name=generate_input_data, template_group=templates/artifact_ingestion/flow_controller.stg}, output_message_templates=[{template_name=artifact_generation_auth_token_msg, template_group=templates/artifact_ingestion/flow_controller.stg}], processor={classname=com.modak.bots.processor.NullProcessor, props={}}, flowTaskName=spark_ingestion_almaren_271_1}], job_schedule_id=1624, data_movement_id=271, inputFlows=[], outputFlows=[], flowId=17002077625516241, metaflowData={tags={tags=[ingestion_271_17002077600028566]}}}}
""2023-11-17 07:56:03.026 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - Inside startFlows() if block
""2023-11-17 07:56:03.026 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - flowsToBeStartedMap.keySet() is : [failure_notification_email, flow_timeout_notification_email, success_notification_email, ingestion_271_17002077600028566]
""2023-11-17 07:56:03.026 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - checking the dependencies of flow failure_notification_email
""2023-11-17 07:56:03.026 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - dependencies are : [ingestion_271_17002077600028566.error]
""2023-11-17 07:56:03.026 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - isAllDependenciesCompleted value is  : true
""2023-11-17 07:56:03.026 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - completedFlowsStatusMap value is : {}
""2023-11-17 07:56:03.026 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - isAllDependenciesCompleted value is : false
""2023-11-17 07:56:03.026 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - checking the dependencies of flow flow_timeout_notification_email
""2023-11-17 07:56:03.026 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - dependencies are : [ingestion_271_17002077600028566.flow_timeout]
""2023-11-17 07:56:03.026 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - isAllDependenciesCompleted value is  : true
""2023-11-17 07:56:03.026 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - completedFlowsStatusMap value is : {}
""2023-11-17 07:56:03.026 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - isAllDependenciesCompleted value is : false
""2023-11-17 07:56:03.026 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - checking the dependencies of flow success_notification_email
""2023-11-17 07:56:03.026 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - dependencies are : [ingestion_271_17002077600028566.success]
""2023-11-17 07:56:03.026 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - isAllDependenciesCompleted value is  : true
""2023-11-17 07:56:03.026 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - completedFlowsStatusMap value is : {}
""2023-11-17 07:56:03.027 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - isAllDependenciesCompleted value is : false
""2023-11-17 07:56:03.027 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - checking the dependencies of flow ingestion_271_17002077600028566
""2023-11-17 07:56:03.027 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - dependencies are : []
""2023-11-17 07:56:03.027 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - isAllDependenciesCompleted value is  : true
""2023-11-17 07:56:03.027 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - completedFlowsStatusMap value is : {}
""2023-11-17 07:56:03.027 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - isAllDependenciesCompleted value is : true
""2023-11-17 07:56:03.027 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - flowTasks ingestion_271_17002077600028566 all dependencies [] are completed
""2023-11-17 07:56:03.027 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - flowInputMap when isAllDependenciesCompleted is true : {flowOutputTemplates=[{template_name=delete_almaren_code_from_kosh, template_group=templates/artifact_ingestion/flow_controller.stg}, {template_name=delete_created_credentials, template_group=templates/artifact_ingestion/flow_controller.stg}, {template_name=insert_pre_agg_stats_template, template_group=templates/artifact_ingestion/flow_controller.stg}], batch_id=17002077600028566, configuration={parallel=10, flowTimeoutHrs=72}, loggers={post_loggers=[{template_name=flow_post_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_post_log_db, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], pre_loggers=[{template_name=flow_pre_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_pre_log_db, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}]}, flowName=ingestion_271_17002077600028566, job_type_id=1, flow_type=ingestion, uiInfo={description=Auto generated by flow controller for flow ingestion_271_17002077600028566}, flowTasks=[{input_data={jwt_ttl=259200000, process_id=17002077600037801, flow_number=1, source_database_name_lowercase=development-db, batch_id=17002077600028566, workflow_name=artifact_generation, where_condition=37234, suffix=, job_type_id=1, ingestion_table_format=, job_schedule_id=1624, relative_file_path=, data_movement_name=ss_compass_adb_validation_MIC7018, source_schema_name_lowercase=acuity-develop, variables={env_variables={}, user_variables={}, payload_variables={}}, source_database_name_uppercase=DEVELOPMENT-DB, job_scheduled_user_id=Manaswini Chinthalapudi, source_schema_name_uppercase=ACUITY-DEVELOP, source_schema_name=acuity-develop, environment=DEV, batch_name=Ingestion_20231117, source_database_name=development-db, authtoken_job_type=default, data_movement_id=271, last_run_timestamp=0001-01-01 00:00:00.103, is_relative_file_path=false}, flowTaskId=2711, bot_metadata={tags={process_id=17002077600037801, batch_name=Ingestion_20231117, environment=DEV, batch_id=17002077600028566, job_schedule_id=1624, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, data_movement_id=271, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=0001-01-01 00:00:00.103}}, retry_template={retry_template_name=artifact_generation_auth_token_msg_retry, retry_template_group=templates/artifact_ingestion/flow_controller.stg}, loggers={scheduled_loggers=[{template_name=flow_task_scheduled_log, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], post_loggers=[{template_name=flow_task_post_log_db, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_task_post_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], pre_loggers=[{template_name=flow_task_running_log, log_type=DB, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}, {template_name=flow_task_pre_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}], retry_loggers=[{template_name=flow_task_retry_log, log_type=FILE, log_file_location=../logs/flow_controller_logger_output.log, template_group=templates/artifact_ingestion/common_templates.stg}]}, completionCriteria={success={botTopics=[nabu_2_completion], criteria=[AND, {bot_metadata.tags.process_id=17002077600037801, opOperator===}, {opOperator===, bot_metadata.message_context=end_of_the_flow}]}, error={botTopics=[nabu_2_errorbot], criteria=[AND, {bot_metadata.tags.process_id=17002077600037801, opOperator===}, {opOperator===, bot_metadata.message_context=taskstatus_bot_error_msg}]}, retry=[AND, {error_data.retry_attempt=3, opOperator=<}, {error_data.error_json=(?i).*exception.*, opOperator=~}]}, app_template_details={template_name=generate_input_data, template_group=templates/artifact_ingestion/flow_controller.stg}, output_message_templates=[{template_name=artifact_generation_auth_token_msg, template_group=templates/artifact_ingestion/flow_controller.stg}], processor={classname=com.modak.bots.processor.NullProcessor, props={}}, flowTaskName=spark_ingestion_almaren_271_1}], job_schedule_id=1624, data_movement_id=271, inputFlows=[], outputFlows=[], flowId=17002077625516241, metaflowData={tags={tags=[ingestion_271_17002077600028566]}}}
""2023-11-17 07:56:03.027 [pool-24-thread-31] INFO  com.modak.bots.flowcontroller.Flow - Flow ingestion_271_17002077600028566 with FlowId 17002077625516241 subscribed topics : [nabu_2_errorbot, nabu_2_completion]
""2023-11-17 07:56:03.027 [pool-24-thread-31] INFO  com.modak.bots.flowcontroller.Flow - topics : [nabu_2_errorbot, nabu_2_completion]
""2023-11-17 07:56:03.027 [pool-24-thread-31] INFO  com.modak.bots.flowcontroller.Flow - topic : nabu_2_errorbot
""2023-11-17 07:56:03.027 [pool-24-thread-31] INFO  com.modak.bots.flowcontroller.Flow - not null
""2023-11-17 07:56:03.027 [pool-24-thread-31] INFO  com.modak.bots.flowcontroller.Flow - groupId fc_1700207763027346
""2023-11-17 07:56:03.027 [pool-24-thread-31] INFO  com.modak.bots.flowcontroller.Flow - topic : nabu_2_completion
""2023-11-17 07:56:03.027 [pool-24-thread-31] INFO  com.modak.bots.flowcontroller.Flow - not null
""2023-11-17 07:56:03.027 [pool-24-thread-31] INFO  com.modak.bots.flowcontroller.Flow - groupId fc_1700207763027346
""2023-11-17 07:56:03.027 [pool-24-thread-31] INFO  com.modak.bots.flowcontroller.Flow - subscribeTopicList : [{routing=nabu_2_errorbot, is_durable_queue=false, queue=fc_1700207763027346}, {routing=nabu_2_completion, is_durable_queue=false, queue=fc_1700207763027346}]
""2023-11-17 07:56:03.027 [pool-24-thread-31] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - messageBusConfig : {messageBusClassName=com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusPullAdapter, privateKeyPath=NABU_PRIVATE_KEY_PATH, rabbitMQConnectionConfig={control_topic=NABU_CONTROL_TOPIC, rabbitmq_ssl_enabled=NABU_RABBITMQ_SSL_ENABLED, control_messagebus_classname=com.modak.bots.messagebus.rabbitmq.RabbitMQControlMessageBusAdapter, heart_beat_frequency=5, heart_beat_duration=NABU_RABBITMQ_HEARTBEAT_DURATION, status_topic=NABU_STATUS_TOPIC, public_key_path=NABU_PUBLIC_KEY_PATH, password=NABU_RABBITMQ_ACCOUNT_PASS, rabbitmq_port=NABU_RABBITMQ_PORT, exchange=NABU_BOTWORKS_EXCHANGE_NAME, num_connections=10, rabbitmq_host=NABU_RABBITMQ_HOSTNAME, username=NABU_RABBITMQ_ACCOUNT, encrypted_password=N, virtual_host=NABU_RABBITMQ_VIRTUAL_HOST}, maximumMessageSize=1, botTopics=[{routing=nabu_2_errorbot, is_durable_queue=false, queue=fc_1700207763027346}, {routing=nabu_2_completion, is_durable_queue=false, queue=fc_1700207763027346}], publicKeyPath=NABU_PUBLIC_KEY_PATH}
""2023-11-17 07:56:03.028 [Thread-240] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 2bdf5beb-b9f9-486e-bd85-bd0f4356f939 has started processing message with message_id 09eba928-8e82-40e8-8255-8bcf10b1e6ea and thread_id 341 
""2023-11-17 07:56:03.028 [Thread-240] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:03.028 [Thread-240] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=1d0e2355-7bbd-4323-937d-1be505bb907a, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=09eba928-8e82-40e8-8255-8bcf10b1e6ea, task_retry_intervals_secs=[], bot_id=9a243656-a8f6-45a1-bf1a-431a00d18e91, message_topic=nabu_2_taskmonitor, tags={process_id=1700207760003780, initial_ts=1700207760106, batch_name=, environment=modak, batch_id=17002077600028566, job_schedule_id=1624, data_movement_id=271, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, TaskMonitorBot]}}
""2023-11-17 07:56:03.028 [pool-24-thread-31] DEBUG com.modak.utils.connectionutils.rabbitmq.RabbitMQNabuConnectionFactory - rabbitMQConnectionConfig is : {control_topic=NABU_CONTROL_TOPIC, rabbitmq_ssl_enabled=NABU_RABBITMQ_SSL_ENABLED, control_messagebus_classname=com.modak.bots.messagebus.rabbitmq.RabbitMQControlMessageBusAdapter, heart_beat_frequency=5, heart_beat_duration=NABU_RABBITMQ_HEARTBEAT_DURATION, status_topic=NABU_STATUS_TOPIC, public_key_path=NABU_PUBLIC_KEY_PATH, password=NABU_RABBITMQ_ACCOUNT_PASS, rabbitmq_port=NABU_RABBITMQ_PORT, exchange=NABU_BOTWORKS_EXCHANGE_NAME, num_connections=10, rabbitmq_host=NABU_RABBITMQ_HOSTNAME, username=NABU_RABBITMQ_ACCOUNT, encrypted_password=N, virtual_host=NABU_RABBITMQ_VIRTUAL_HOST}
""2023-11-17 07:56:03.030 [pool-24-thread-31] INFO  com.modak.utils.connectionutils.rabbitmq.RabbitMQNabuConnectionFactory - Using Existing RabbitMQ connections
""2023-11-17 07:56:03.030 [pool-24-thread-31] INFO  com.modak.utils.connectionutils.rabbitmq.RabbitMQNabuConnectionFactory - Returning connection of address amqp://srv_account_rabbitmq@10.213.53.98:5672/
""2023-11-17 07:56:03.038 [Thread-240] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17002077600028566, 1700207760003780, 'FlowControllerBot', 'flowcontroller_message_to_generate_flows', 'generate_flows', 10 , TO_TIMESTAMP(1700207762815::double precision / 1000) ,'9a243656-a8f6-45a1-bf1a-431a00d18e91');
""2023-11-17 07:56:03.039 [Thread-240] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 2bdf5beb-b9f9-486e-bd85-bd0f4356f939 has started process logic with message_id 09eba928-8e82-40e8-8255-8bcf10b1e6ea and thread_id 341
""2023-11-17 07:56:03.154 [Thread-240] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 2bdf5beb-b9f9-486e-bd85-bd0f4356f939 has finished process logic with message_id 09eba928-8e82-40e8-8255-8bcf10b1e6ea and thread_id 341
""2023-11-17 07:56:03.154 [Thread-240] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:03.154 [Thread-240] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 09eba928-8e82-40e8-8255-8bcf10b1e6ea
""2023-11-17 07:56:03.158 [Thread-628] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 36eb6878-e0a2-4c36-aa72-014700443066 has started processing message with message_id f5d22052-99ed-46a1-91e9-fc2fc89cdc67 and thread_id 794 
""2023-11-17 07:56:03.158 [Thread-628] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:03.159 [Thread-628] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=be7daf9f-8d06-44b7-b94d-399b614bdd44, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=f5d22052-99ed-46a1-91e9-fc2fc89cdc67, task_retry_intervals_secs=[], bot_id=bfb7aff8-e3e2-41bd-b799-ad3147187c77, message_topic=nabu_2_taskmonitor, tags={process_id=1700207760003780, initial_ts=1700207760106, batch_name=, environment=modak, batch_id=17002077600028566, job_schedule_id=1624, data_movement_id=271, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, TaskMonitorBot]}}
""2023-11-17 07:56:03.171 [Thread-628] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17002077600028566, 1700207760003780, 'DBOpsBot', 'starting_message_for_ingestion', 'checking_pre_conditions_or_starting_msg_of_ingestion', 6 , TO_TIMESTAMP(1700207762626::double precision / 1000) ,'bfb7aff8-e3e2-41bd-b799-ad3147187c77');
""2023-11-17 07:56:03.171 [Thread-628] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 36eb6878-e0a2-4c36-aa72-014700443066 has started process logic with message_id f5d22052-99ed-46a1-91e9-fc2fc89cdc67 and thread_id 794
""2023-11-17 07:56:03.175 [Thread-628] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 36eb6878-e0a2-4c36-aa72-014700443066 has finished process logic with message_id f5d22052-99ed-46a1-91e9-fc2fc89cdc67 and thread_id 794
""2023-11-17 07:56:03.175 [Thread-628] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:03.175 [Thread-628] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id f5d22052-99ed-46a1-91e9-fc2fc89cdc67
""2023-11-17 07:56:03.180 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.Flow - parallelTaskCount for taskexecutors is 10
""2023-11-17 07:56:03.180 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - flow ingestion_271_17002077600028566 got submitted, the flowid of the flow 17002077625516241
""2023-11-17 07:56:03.180 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - runningFutureObjectsMap value is : {ingestion_271_17002077600028566=java.util.concurrent.FutureTask@5a81876b}
""2023-11-17 07:56:03.181 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - triggered startFlows outside of loop
""2023-11-17 07:56:03.181 [pool-24-thread-31] DEBUG com.modak.bots.flowcontroller.FlowController - runningFutureObjectsMap is : {ingestion_271_17002077600028566=java.util.concurrent.FutureTask@5a81876b}
""2023-11-17 07:56:03.267 [Thread-480] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "fb127bef-0649-44c8-a42d-ce66409758d6", "parent_id": "e56f48fd-3254-4aef-82b2-ecb838397bf0", "bot_id": "330cfcdb-58fd-46f9-8954-91528f06bc95", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":1700207760003780, "initial_ts":1700207760106, "batch_id":17002077600028566, "batch_name":"", "job_schedule_id":1624, "data_movement_id": 271, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "", "environment": "modak", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"330cfcdb-58fd-46f9-8954-91528f06bc95", "bot_name":"DBOpsBot", "process_context":"data_movement_deciding", "task_name":"data_movement_deciding_msg", "process_id":"1700207760003780", "task_ts":1700207762751, "batch_id":"17002077600028566", "status_code_id": 6 } } ] }
""2023-11-17 07:56:03.268 [Thread-480] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-17 07:56:03.271 [Thread-480] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-17 07:56:03.271 [Thread-480] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:03.271 [Thread-480] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot finished processing message with id e56f48fd-3254-4aef-82b2-ecb838397bf0
""2023-11-17 07:56:03.361 [Thread-240] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 2bdf5beb-b9f9-486e-bd85-bd0f4356f939 has started processing message with message_id fb127bef-0649-44c8-a42d-ce66409758d6 and thread_id 341 
""2023-11-17 07:56:03.361 [Thread-240] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:03.361 [Thread-240] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=e56f48fd-3254-4aef-82b2-ecb838397bf0, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=fb127bef-0649-44c8-a42d-ce66409758d6, task_retry_intervals_secs=[], bot_id=330cfcdb-58fd-46f9-8954-91528f06bc95, message_topic=nabu_2_taskmonitor, tags={process_id=1700207760003780, initial_ts=1700207760106, batch_name=, environment=modak, batch_id=17002077600028566, job_schedule_id=1624, data_movement_id=271, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, TaskMonitorBot]}}
""2023-11-17 07:56:03.373 [Thread-240] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17002077600028566, 1700207760003780, 'DBOpsBot', 'data_movement_deciding', 'data_movement_deciding_msg', 6 , TO_TIMESTAMP(1700207762751::double precision / 1000) ,'330cfcdb-58fd-46f9-8954-91528f06bc95');
""2023-11-17 07:56:03.373 [Thread-240] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 2bdf5beb-b9f9-486e-bd85-bd0f4356f939 has started process logic with message_id fb127bef-0649-44c8-a42d-ce66409758d6 and thread_id 341
""2023-11-17 07:56:03.376 [Thread-240] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 2bdf5beb-b9f9-486e-bd85-bd0f4356f939 has finished process logic with message_id fb127bef-0649-44c8-a42d-ce66409758d6 and thread_id 341
""2023-11-17 07:56:03.376 [Thread-240] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:03.376 [Thread-240] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id fb127bef-0649-44c8-a42d-ce66409758d6
""2023-11-17 07:56:13.314 [Thread-1281] INFO  com.modak.bots.basebot.AbstractBaseBot - AuthTokenBot with bot_id f8255862-92cd-409e-8e3c-a8bdabc72d87 has started processing message with message_id d9e4291f-6b21-4a6c-a846-d5c538a8f82c and thread_id 1559 
""2023-11-17 07:56:13.314 [Thread-1281] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:13.315 [Thread-1281] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=1d0e2355-7bbd-4323-937d-1be505bb907a, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=generating_token_for_credentials, message_id=d9e4291f-6b21-4a6c-a846-d5c538a8f82c, task_retry_intervals_secs=[], bot_id=9a243656-a8f6-45a1-bf1a-431a00d18e91, message_topic=nabu_2_authtoken, tags={process_id=17002077600037801, initial_ts=1700207760106, batch_name=Ingestion_20231117, environment=DEV, batch_id=17002077600028566, job_schedule_id=1624, job_scheduled_user_id=Manaswini Chinthalapudi, data_movement_id=271, last_run_timestamp=0001-01-01 00:00:00.103, include_blobs=, retry_attempt=0, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken]}}
""2023-11-17 07:56:13.326 [Thread-1281] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
doNothing
""2023-11-17 07:56:13.335 [Thread-1281] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-17 07:56:13.337 [Thread-1281] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-17 07:56:13.340 [Thread-1281] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-17 07:56:13.340 [Thread-1281] INFO  com.modak.bots.basebot.AbstractBaseBot - AuthTokenBot with bot_id f8255862-92cd-409e-8e3c-a8bdabc72d87 has started process logic with message_id d9e4291f-6b21-4a6c-a846-d5c538a8f82c and thread_id 1559
""2023-11-17 07:56:13.354 [Thread-184] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 8950f9f1-2dc3-43f6-9301-48688d3f0707 has started processing message with message_id 4920266f-7ad4-4439-9253-55b7ca582640 and thread_id 275 
""2023-11-17 07:56:13.354 [Thread-184] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:13.354 [Thread-184] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=d9e4291f-6b21-4a6c-a846-d5c538a8f82c, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=4920266f-7ad4-4439-9253-55b7ca582640, task_retry_intervals_secs=[], bot_id=f8255862-92cd-409e-8e3c-a8bdabc72d87, message_topic=nabu_2_taskmonitor, tags={process_id=17002077600037801, initial_ts=1700207760106, batch_name=Ingestion_20231117, environment=DEV, batch_id=17002077600028566, job_schedule_id=1624, data_movement_id=271, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=0001-01-01 00:00:00.103, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, TaskMonitorBot]}}
""2023-11-17 07:56:13.790 [Thread-1281] INFO  com.modak.bots.AuthTokenBot - connection closed!
""2023-11-17 07:56:13.791 [Thread-1281] DEBUG com.modak.bots.AuthTokenBot - redisConfig map is : {minConnectionsIdleSize=NABU_REDIS_MIN_CONNECTION_IDLE_SIZE, password=NABU_REDIS_PASSWORD, PrivateKey=NABU_PRIVATE_KEY_PATH, redis_url=NABU_REDIS_URL, connection_pool_size=NABU_REDIS_CONNECTION_POOL_SIZE, idle_connection_timeout=NABU_REDIS_IDLE_CONNECTION_TIME_OUT, connection_timeout=NABU_REDIS_CONNECTION_TIME_OUT, encrypted_password=N}
""2023-11-17 07:56:13.791 [Thread-1281] INFO  com.modak.bots.AuthTokenBot - authMapType: authTokenBotMap
""2023-11-17 07:56:13.791 [Thread-1281] DEBUG com.modak.utils.jwt.AuthTokenGenerator - redisson object value is org.redisson.Redisson@31a4ebd2
""2023-11-17 07:56:13.791 [Thread-1281] DEBUG com.modak.utils.jwt.AuthTokenGenerator - Redisson client is already configured
""2023-11-17 07:56:13.845 [Thread-184] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17002077600028566, 17002077600037801, 'AuthTokenBot', 'generating_token_for_credentials', 'generating_token_for_credentials', 10 , TO_TIMESTAMP(1700207773314::double precision / 1000) ,'f8255862-92cd-409e-8e3c-a8bdabc72d87');
""2023-11-17 07:56:13.845 [Thread-184] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 8950f9f1-2dc3-43f6-9301-48688d3f0707 has started process logic with message_id 4920266f-7ad4-4439-9253-55b7ca582640 and thread_id 275
""2023-11-17 07:56:13.852 [Thread-184] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 8950f9f1-2dc3-43f6-9301-48688d3f0707 has finished process logic with message_id 4920266f-7ad4-4439-9253-55b7ca582640 and thread_id 275
""2023-11-17 07:56:13.852 [Thread-184] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:13.852 [Thread-184] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 4920266f-7ad4-4439-9253-55b7ca582640
""2023-11-17 07:56:14.694 [Thread-1281] INFO  com.modak.bots.basebot.AbstractBaseBot - AuthTokenBot with bot_id f8255862-92cd-409e-8e3c-a8bdabc72d87 has finished process logic with message_id d9e4291f-6b21-4a6c-a846-d5c538a8f82c and thread_id 1559
""2023-11-17 07:56:14.694 [Thread-1281] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : true
""2023-11-17 07:56:14.694 [Thread-1281] INFO  com.modak.bots.basebot.AbstractBaseBot -  skipBotLogic == false && useIncomingData == true ..,so both inputData map and botLogic output map is send as output message
""2023-11-17 07:56:14.694 [Thread-1281] INFO  com.modak.bots.basebot.AbstractBaseBot - botLogicOutput : { "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMjA3Nzc0NDc0NTU1MCwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDQ2Njk3NCwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDIwNzc3NH0.TWZyjOoQVBeikFCOlYX7iDZSg6_1SItKfJLvDPO9hTPLAn4ych8ntt7JQPFX6j788mRXWCiV87B70GHOAh9h-GFgFQ228Svo6AH2nT8pIRIDrnfdBGbk3E28vCF12aLGz_tZ3PRLt9hFT6vkYguIu9vMTtlPKU5eMCmfNi8G9crnqgdz5m8Pc2r3sr2-kbGTTBcGCiDRh6NIj6-aKT-WjwCyo5PTfxG478LeF3FB4eeA-33ZLDB9idm2be4weVWPO36G9MKqgZ4Gch8v9zWBUJhS6PU27Sa0DWMgbS_1PoA9h-HUhbOPpgFwcnWQ6sdCONz3eVOrj48Yh7iu8dKMng", "end_point" : "http:\/\/dev-dha.humana.com:8889\/fireshots\/credentialsFetchWebService" }
""2023-11-17 07:56:14.731 [Thread-1281] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "DBOpsBot", "bot_metadata": { "message_id": "62554341-9099-484b-a9a9-5276ea65885f", "parent_id": "d9e4291f-6b21-4a6c-a846-d5c538a8f82c", "bot_id": "f8255862-92cd-409e-8e3c-a8bdabc72d87", "message_topic":"nabu_2_jdbc", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":17002077600037801, "initial_ts":1700207760106, "batch_id":17002077600028566, "batch_name":"Ingestion_20231117", "job_schedule_id":1624, "data_movement_id": 271, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "0001-01-01 00:00:00.103", "environment": "DEV", "ignore_job_termination" : false, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot" ],"task_dependency":true}, "task_retry_intervals_secs": [ ], "message_context": "generating pipeline start timestamp" }, "bot_tasks": [ { "task_name": "generating_relative_file_path", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "pre_task_logging_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "pre_log_template" }, "app_template_details": { "template_group": "templates/artifact_ingestion/ingestion_templates.stg", "template_name": "get_pipeline_run_timestamp_object_name" }, "input_data":{ "input_data" : { "jwt_ttl" : "259200000", "process_id" : "17002077600037801", "flow_number" : 1, "source_database_name_lowercase" : "development-db", "batch_id" : "17002077600028566", "workflow_name" : "artifact_generation", "where_condition" : "37234", "suffix" : "", "job_type_id" : "1", "ingestion_table_format" : "", "job_schedule_id" : 1624, "relative_file_path" : "", "data_movement_name" : "ss_compass_adb_validation_MIC7018", "source_schema_name_lowercase" : "acuity-develop", "currentBotMessageMap" : { "parent_id" : "1d0e2355-7bbd-4323-937d-1be505bb907a", "workflow_route_bot_topic_details" : { "DBOpsBot" : "nabu_2_jdbc", "ScriptBot" : "nabu_2_scriptbot", "SparkComputeEngineBot" : "nabu_2_spark_compute", "FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc", "S3StreamBot" : "nabu_2_s3_stream", "ErrorBot" : "nabu_2_errorbot", "AuthTokenBot" : "nabu_2_authtoken", "OnDemandBot" : "nabu_2_ondemand_bot", "EmailBot" : "nabu_2_emailbot", "PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker", "RPCSparkScriptBot" : "nabu_2_rpc_spark_script", "SparkScriptBot" : "nabu_2_spark_script", "RestAPIBot" : "nabu_2_restapibot", "CurationSparkScriptBot" : "nabu_2_curation_script", "TaskMonitorBot" : "nabu_2_taskmonitor", "completion_topic" : "nabu_2_completion", "FlowControllerBot" : "nabu_2_flowcontroller", "UpdateDBOpsBot" : "nabu_2_update_jdbc" }, "message_context" : "generating_token_for_credentials", "message_id" : "d9e4291f-6b21-4a6c-a846-d5c538a8f82c", "task_retry_intervals_secs" : [], "bot_id" : "9a243656-a8f6-45a1-bf1a-431a00d18e91", "message_topic" : "nabu_2_authtoken", "tags" : { "process_id" : 17002077600037801, "initial_ts" : 1700207760106, "batch_name" : "Ingestion_20231117", "environment" : "DEV", "batch_id" : 17002077600028566, "job_schedule_id" : 1624, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "data_movement_id" : 271, "last_run_timestamp" : "0001-01-01 00:00:00.103", "include_blobs" : "", "retry_attempt" : 0, "tags" : [ "AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken" ] } }, "variables" : { "env_variables" : {}, "user_variables" : {}, "payload_variables" : {} }, "source_database_name_uppercase" : "DEVELOPMENT-DB", "botLogicOutputMap" : { "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMjA3Nzc0NDc0NTU1MCwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDQ2Njk3NCwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDIwNzc3NH0.TWZyjOoQVBeikFCOlYX7iDZSg6_1SItKfJLvDPO9hTPLAn4ych8ntt7JQPFX6j788mRXWCiV87B70GHOAh9h-GFgFQ228Svo6AH2nT8pIRIDrnfdBGbk3E28vCF12aLGz_tZ3PRLt9hFT6vkYguIu9vMTtlPKU5eMCmfNi8G9crnqgdz5m8Pc2r3sr2-kbGTTBcGCiDRh6NIj6-aKT-WjwCyo5PTfxG478LeF3FB4eeA-33ZLDB9idm2be4weVWPO36G9MKqgZ4Gch8v9zWBUJhS6PU27Sa0DWMgbS_1PoA9h-HUhbOPpgFwcnWQ6sdCONz3eVOrj48Yh7iu8dKMng", "end_point" : "http:\/\/dev-dha.humana.com:8889\/fireshots\/credentialsFetchWebService" }, "job_scheduled_user_id" : "Manaswini Chinthalapudi", "source_schema_name_uppercase" : "ACUITY-DEVELOP", "source_schema_name" : "acuity-develop", "environment" : "DEV", "batch_name" : "Ingestion_20231117", "source_database_name" : "development-db", "authtoken_job_type" : "default", "data_movement_id" : "271", "last_run_timestamp" : "0001-01-01 00:00:00.103", "is_relative_file_path" : false }, "template_execution_type": "sequential", "useTransactionControl": true }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/flow_controller.stg", "template_name": "generating_relative_file_path", "useIncomingData":true }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "task_status_success_msg" } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "error_template_create_msg" } ] } ] }
""2023-11-17 07:56:14.733 [Thread-1281] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_jdbc
""2023-11-17 07:56:14.736 [Thread-1281] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_jdbc
""2023-11-17 07:56:14.736 [Thread-1281] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : true
""2023-11-17 07:56:14.736 [Thread-1281] INFO  com.modak.bots.basebot.AbstractBaseBot -  skipBotLogic == false && useIncomingData == true ..,so both inputData map and botLogic output map is send as output message
""2023-11-17 07:56:14.736 [Thread-1281] INFO  com.modak.bots.basebot.AbstractBaseBot - botLogicOutput : { "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMjA3Nzc0NDc0NTU1MCwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDQ2Njk3NCwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDIwNzc3NH0.TWZyjOoQVBeikFCOlYX7iDZSg6_1SItKfJLvDPO9hTPLAn4ych8ntt7JQPFX6j788mRXWCiV87B70GHOAh9h-GFgFQ228Svo6AH2nT8pIRIDrnfdBGbk3E28vCF12aLGz_tZ3PRLt9hFT6vkYguIu9vMTtlPKU5eMCmfNi8G9crnqgdz5m8Pc2r3sr2-kbGTTBcGCiDRh6NIj6-aKT-WjwCyo5PTfxG478LeF3FB4eeA-33ZLDB9idm2be4weVWPO36G9MKqgZ4Gch8v9zWBUJhS6PU27Sa0DWMgbS_1PoA9h-HUhbOPpgFwcnWQ6sdCONz3eVOrj48Yh7iu8dKMng", "end_point" : "http:\/\/dev-dha.humana.com:8889\/fireshots\/credentialsFetchWebService" }
""2023-11-17 07:56:14.747 [Thread-1281] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "TaskMonitorBot", "bot_metadata": { "message_id": "a9a6ec3d-c786-4c83-ae55-d5ef66141511", "parent_id": "d9e4291f-6b21-4a6c-a846-d5c538a8f82c", "bot_id": "f8255862-92cd-409e-8e3c-a8bdabc72d87", "message_topic":"nabu_2_taskmonitor", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":17002077600037801, "initial_ts":1700207760106, "batch_id":17002077600028566, "batch_name":"Ingestion_20231117", "job_schedule_id":1624, "data_movement_id": 271, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "0001-01-01 00:00:00.103", "environment": "DEV", "ignore_job_termination" : true, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "TaskMonitorBot" ]}, "message_context": "taskstatus_bot_success_msg", "task_retry_intervals_secs": [ ] }, "bot_tasks": [ { "task_name": "taskmonitor_bot_status", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "insert_job_load_result_v2" }, "input_data": { "bot_uuid":"f8255862-92cd-409e-8e3c-a8bdabc72d87", "bot_name":"AuthTokenBot", "process_context":"generating_token_for_credentials", "task_name":"generating_token_for_credentials", "process_id":"17002077600037801", "task_ts":1700207774694, "batch_id":"17002077600028566", "status_code_id": 6 } } ] }
""2023-11-17 07:56:14.748 [Thread-1281] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-17 07:56:14.751 [Thread-1281] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-17 07:56:14.751 [Thread-1281] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:14.751 [Thread-1281] INFO  com.modak.bots.basebot.AbstractBaseBot - AuthTokenBot finished processing message with id d9e4291f-6b21-4a6c-a846-d5c538a8f82c
""2023-11-17 07:56:14.886 [Thread-980] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ea7e160-7f7b-468f-9046-a99a4ec663a6 has started processing message with message_id a9a6ec3d-c786-4c83-ae55-d5ef66141511 and thread_id 1207 
""2023-11-17 07:56:14.886 [Thread-1084] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id bfb7aff8-e3e2-41bd-b799-ad3147187c77 has started processing message with message_id 62554341-9099-484b-a9a9-5276ea65885f and thread_id 1329 
""2023-11-17 07:56:14.886 [Thread-980] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:14.886 [Thread-980] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=d9e4291f-6b21-4a6c-a846-d5c538a8f82c, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=taskstatus_bot_success_msg, message_id=a9a6ec3d-c786-4c83-ae55-d5ef66141511, task_retry_intervals_secs=[], bot_id=f8255862-92cd-409e-8e3c-a8bdabc72d87, message_topic=nabu_2_taskmonitor, tags={process_id=17002077600037801, initial_ts=1700207760106, batch_name=Ingestion_20231117, environment=DEV, batch_id=17002077600028566, job_schedule_id=1624, data_movement_id=271, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=0001-01-01 00:00:00.103, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, TaskMonitorBot]}}
""2023-11-17 07:56:14.886 [Thread-1084] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:14.886 [Thread-1084] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=d9e4291f-6b21-4a6c-a846-d5c538a8f82c, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=generating pipeline start timestamp, message_id=62554341-9099-484b-a9a9-5276ea65885f, task_retry_intervals_secs=[], bot_id=f8255862-92cd-409e-8e3c-a8bdabc72d87, message_topic=nabu_2_jdbc, tags={process_id=17002077600037801, batch_id=17002077600028566, job_scheduled_user_id=Manaswini Chinthalapudi, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot], initial_ts=1700207760106, batch_name=Ingestion_20231117, environment=DEV, job_schedule_id=1624, data_movement_id=271, last_run_timestamp=0001-01-01 00:00:00.103, retry_attempt=0, task_dependency=true, ignore_job_termination=false}}
""2023-11-17 07:56:14.899 [Thread-980] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17002077600028566, 17002077600037801, 'AuthTokenBot', 'generating_token_for_credentials', 'generating_token_for_credentials', 6 , TO_TIMESTAMP(1700207774694::double precision / 1000) ,'f8255862-92cd-409e-8e3c-a8bdabc72d87');
""2023-11-17 07:56:14.899 [Thread-980] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ea7e160-7f7b-468f-9046-a99a4ec663a6 has started process logic with message_id a9a6ec3d-c786-4c83-ae55-d5ef66141511 and thread_id 1207
""2023-11-17 07:56:14.903 [Thread-980] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ea7e160-7f7b-468f-9046-a99a4ec663a6 has finished process logic with message_id a9a6ec3d-c786-4c83-ae55-d5ef66141511 and thread_id 1207
""2023-11-17 07:56:14.904 [Thread-980] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:14.904 [Thread-980] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id a9a6ec3d-c786-4c83-ae55-d5ef66141511
""2023-11-17 07:56:15.090 [Thread-1084] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
{ "input_data": { "data_movement_id" : 271, "where_condition":"37234" }, "sequential_templates":[ { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "fetch_source_type", "query_output_key": "fetch_source_type", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_pipeline_run_timestamp", "query_output_key": "pipeline_run_timestamp", "query_type":"select" }, { "query_template_group": "templates/artifact_ingestion/ingestion_templates.stg", "query_template_name": "get_object_name", "query_output_key": "object_name", "query_type":"select" } ], "output_keys":["fetch_source_type","pipeline_run_timestamp","object_name"] }
""2023-11-17 07:56:15.100 [Thread-1084] INFO  com.modak.bots.basebot.AbstractBaseBot - publishing preTaskLogMessage...
""2023-11-17 07:56:15.102 [Thread-1084] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message is being published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-17 07:56:15.105 [Thread-1084] INFO  com.modak.bots.messagebus.rabbitmq.RabbitMQMessageBusAdapter - message was successfully published to following exchange nabu and topic nabu_2_taskmonitor
""2023-11-17 07:56:15.105 [Thread-1084] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id bfb7aff8-e3e2-41bd-b799-ad3147187c77 has started process logic with message_id 62554341-9099-484b-a9a9-5276ea65885f and thread_id 1329
""2023-11-17 07:56:15.108 [Thread-980] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ea7e160-7f7b-468f-9046-a99a4ec663a6 has started processing message with message_id 6b599ff0-5218-4b81-8377-6606781565e6 and thread_id 1207 
""2023-11-17 07:56:15.108 [Thread-980] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:15.108 [Thread-980] INFO  com.modak.bots.basebot.AbstractBaseBot - currentBotMessageMap is {parent_id=62554341-9099-484b-a9a9-5276ea65885f, workflow_route_bot_topic_details={DBOpsBot=nabu_2_jdbc, ScriptBot=nabu_2_scriptbot, SparkComputeEngineBot=nabu_2_spark_compute, FilterResolverDBOpsBot=nabu_2_filter_resolver_jdbc, S3StreamBot=nabu_2_s3_stream, ErrorBot=nabu_2_errorbot, AuthTokenBot=nabu_2_authtoken, OnDemandBot=nabu_2_ondemand_bot, EmailBot=nabu_2_emailbot, PipelineDependencyCheckerBot=nabu_2_pipelinedependency_checker, RPCSparkScriptBot=nabu_2_rpc_spark_script, SparkScriptBot=nabu_2_spark_script, RestAPIBot=nabu_2_restapibot, CurationSparkScriptBot=nabu_2_curation_script, TaskMonitorBot=nabu_2_taskmonitor, completion_topic=nabu_2_completion, FlowControllerBot=nabu_2_flowcontroller, UpdateDBOpsBot=nabu_2_update_jdbc}, message_context=pre_task_logging, message_id=6b599ff0-5218-4b81-8377-6606781565e6, task_retry_intervals_secs=[], bot_id=bfb7aff8-e3e2-41bd-b799-ad3147187c77, message_topic=nabu_2_taskmonitor, tags={process_id=17002077600037801, initial_ts=1700207760106, batch_name=Ingestion_20231117, environment=DEV, batch_id=17002077600028566, job_schedule_id=1624, data_movement_id=271, job_scheduled_user_id=Manaswini Chinthalapudi, last_run_timestamp=0001-01-01 00:00:00.103, retry_attempt=0, ignore_job_termination=true, tags=[AuthToken, DBOpsBot, DBOpsBot, AuthToken, KoshBot, TaskMonitorBot]}}
""2023-11-17 07:56:15.121 [Thread-980] INFO  com.modak.bots.basebot.AbstractBaseBot - templateProcessedOutput :
INSERT INTO nabu.job_load_result (batch_id, process_id, bot_type, process_context, task_name, status_code_id, task_ts, bot_uuid) VALUES(17002077600028566, 17002077600037801, 'DBOpsBot', 'generating pipeline start timestamp', 'generating_relative_file_path', 10 , TO_TIMESTAMP(1700207774886::double precision / 1000) ,'bfb7aff8-e3e2-41bd-b799-ad3147187c77');
""2023-11-17 07:56:15.121 [Thread-980] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ea7e160-7f7b-468f-9046-a99a4ec663a6 has started process logic with message_id 6b599ff0-5218-4b81-8377-6606781565e6 and thread_id 1207
""2023-11-17 07:56:15.125 [Thread-980] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot with bot_id 4ea7e160-7f7b-468f-9046-a99a4ec663a6 has finished process logic with message_id 6b599ff0-5218-4b81-8377-6606781565e6 and thread_id 1207
""2023-11-17 07:56:15.125 [Thread-980] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:15.125 [Thread-980] INFO  com.modak.bots.basebot.AbstractBaseBot - TaskMonitorBot finished processing message with id 6b599ff0-5218-4b81-8377-6606781565e6
""2023-11-17 07:56:15.298 [Thread-1084] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with CTE1 as (
select distinct dm.data_movement_id,dcml.metadata_category as source_type, dscl.dataplace_sub_component_type as source from nabu.data_movement_details_physical dm inner join nabu.dataplace_physical dp on dp.dataplace_id=dm.source_dataplace_id
inner join  nabu.dataplace_component_mapping_lookup dcml on dcml.dataplace_sub_component_id =dp.dataplace_sub_component_id
inner join nabu.dataplace_sub_component_lookup dscl on dcml.dataplace_sub_component_id =dscl.dataplace_sub_component_id
where dm.data_movement_id=271 and dp.valid_to_ts='9999-12-31 00:00:00' and dm.valid_to_ts ='9999-12-31 00:00:00'
),
CTE2 as (
select distinct dm.data_movement_id,dcml.metadata_category as destination_type, dscl.dataplace_sub_component_type as destination,dscl.dataplace_sub_component_id as id from nabu.data_movement_details_physical dm inner join nabu.dataplace_physical dp on dp.dataplace_id=dm.destination_dataplace_id
inner join  nabu.dataplace_component_mapping_lookup dcml on dcml.dataplace_sub_component_id =dp.dataplace_sub_component_id
inner join nabu.dataplace_sub_component_lookup dscl on dcml.dataplace_sub_component_id =dscl.dataplace_sub_component_id
where dm.data_movement_id=271 and dp.valid_to_ts='9999-12-31 00:00:00' and dm.valid_to_ts ='9999-12-31 00:00:00'
)
select a.data_movement_id,a.source_type as source_metadata_category,b.destination_type as destination_metadata_category, a.source , b.destination  ,
 case when(a.source_type = 'file') then true else false end as is_source_filetype ,
 case when(a.source_type = 'salesforce') then true else false end as is_source_salesforce,
 case when(a.source_type = 'collection') then true else false end as is_source_mongodb,
 case when(b.destination_type = 'file') then true else false end as is_destination_filetype
,case when b.id in (7,11,25,27) then true else false end as is_ordinalpos_startwith_zero,
case when b.destination='redshift' then true else false end as is_destination_redshift
from CTE1 a
inner join
CTE2 b on a.data_movement_id=b.data_movement_id
""2023-11-17 07:56:15.502 [Thread-1084] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : select flow_ts, data_movement_id, job_type_id,
to_char(flow_ts::timestamp,'dd Month yyyy HH24:mi:ss ')||(SELECT abbrev  FROM pg_timezone_names WHERE name = current_setting('TIMEZONE')) as pipeline_run_time, flow_ts::timestamp(6) as pipeline_start_ts
from
(select *,ROW_NUMBER () OVER (order by flow_ts desc) rank from nabu.flow_status
where data_movement_id = 271
and status_code_id = 11
)a where rank=1
""2023-11-17 07:56:15.739 [Thread-1084] INFO  com.modak.utils.jdbc.SequentialQueryUtil - Executing query : with flow_tables as (
select table_id,schema_id,table_name as source_object_name,upper(table_name) as source_object_name_uppercase,lower(table_name) as source_object_name_lowercase,
schema_name as schema_name,dataplace_id,estimated_rows
from nabu.dataplace_table_metadata_physical
where table_id in (37234)
and valid_to_ts = '9999-12-31'
)select source_object_name,source_object_name_uppercase,source_object_name_lowercase  from flow_tables;
""2023-11-17 07:56:15.744 [Thread-1084] DEBUG com.modak.bots.DBOpsBot - to execute query timeTakenInMillis : 639
""2023-11-17 07:56:15.744 [Thread-1084] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot with bot_id bfb7aff8-e3e2-41bd-b799-ad3147187c77 has finished process logic with message_id 62554341-9099-484b-a9a9-5276ea65885f and thread_id 1329
""2023-11-17 07:56:15.744 [Thread-1084] DEBUG com.modak.bots.basebot.AbstractBaseBot - useIncomingData : true
""2023-11-17 07:56:15.744 [Thread-1084] INFO  com.modak.bots.basebot.AbstractBaseBot -  skipBotLogic == false && useIncomingData == true ..,so both inputData map and botLogic output map is send as output message
""2023-11-17 07:56:15.744 [Thread-1084] INFO  com.modak.bots.basebot.AbstractBaseBot - botLogicOutput : { "pipeline_run_timestamp" : [ { "flow_ts" : "2023-11-17 07:56:03.202287", "data_movement_id" : 271, "job_type_id" : 1, "pipeline_run_time" : "17 November  2023 07:56:03 UTC", "pipeline_start_ts" : "2023-11-17 07:56:03.202287" } ], "object_name" : [ { "source_object_name" : "aaaa", "source_object_name_uppercase" : "AAAA", "source_object_name_lowercase" : "aaaa" } ], "fetch_source_type" : [ { "data_movement_id" : 271, "source_metadata_category" : "relational", "destination_metadata_category" : "file", "source" : "sql_server", "destination" : "adls_gen2", "is_source_filetype" : false, "is_source_salesforce" : false, "is_source_mongodb" : false, "is_destination_filetype" : true, "is_ordinalpos_startwith_zero" : false, "is_destination_redshift" : false } ] }
""2023-11-17 07:56:15.770 [Thread-1084] INFO  com.modak.bots.basebot.AbstractBaseBot - output message 
 { "bot_name": "DBOpsBot", "bot_metadata": { "message_id": "7284fdf7-550d-4b6e-84c9-80f41f586177", "parent_id": "62554341-9099-484b-a9a9-5276ea65885f", "bot_id": "bfb7aff8-e3e2-41bd-b799-ad3147187c77", "message_topic":"nabu_2_jdbc", "workflow_route_bot_topic_details":{"DBOpsBot" : "nabu_2_jdbc","ScriptBot" : "nabu_2_scriptbot","SparkComputeEngineBot" : "nabu_2_spark_compute","FilterResolverDBOpsBot" : "nabu_2_filter_resolver_jdbc","S3StreamBot" : "nabu_2_s3_stream","ErrorBot" : "nabu_2_errorbot","AuthTokenBot" : "nabu_2_authtoken","OnDemandBot" : "nabu_2_ondemand_bot","EmailBot" : "nabu_2_emailbot","PipelineDependencyCheckerBot" : "nabu_2_pipelinedependency_checker","RPCSparkScriptBot" : "nabu_2_rpc_spark_script","SparkScriptBot" : "nabu_2_spark_script","RestAPIBot" : "nabu_2_restapibot","CurationSparkScriptBot" : "nabu_2_curation_script","TaskMonitorBot" : "nabu_2_taskmonitor","completion_topic" : "nabu_2_completion","FlowControllerBot" : "nabu_2_flowcontroller","UpdateDBOpsBot" : "nabu_2_update_jdbc"}, "tags": {"process_id":17002077600037801, "initial_ts":1700207760106, "batch_id":17002077600028566, "batch_name":"Ingestion_20231117", "job_schedule_id":1624, "data_movement_id": 271, "job_scheduled_user_id": "Manaswini Chinthalapudi", "last_run_timestamp": "0001-01-01 00:00:00.103", "environment": "DEV", "ignore_job_termination" : false, "retry_attempt": 0, "tags": ["AuthToken", "DBOpsBot", "DBOpsBot", "AuthToken", "KoshBot", "KoshBot" ],"task_dependency":true}, "task_retry_intervals_secs": [ ], "message_context": "generating relative file path" }, "bot_tasks": [ { "task_name": "generating_relative_file_path", "data_processor": { "classname": "com.modak.bots.processor.NullProcessor", "props": {} }, "skipLogicPattern": "doNothing", "pre_task_logging_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "pre_log_template" }, "app_template_details": { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "doNothingTemplate" }, "input_data":{ "query_input" : { "environment": "DEV", "data_movement_id": "271", "data_movement_name": "ss_compass_adb_validation_MIC7018", "process_id": "17002077600037801", "batch_id": "17002077600028566", "batch_name": "Ingestion_20231117", "workflow_name": "artifact_generation", "flow_number": 1, "jwt_token" : "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJGSVJFU0hPVFNfQVBQTElDQVRJT04iLCJzZXNzaW9uX2lkIjoxNzAwMjA3Nzc0NDc0NTU1MCwicmVxdWVzdGVkX3VzZXJfaWQiOiJNYW5hc3dpbmkgQ2hpbnRoYWxhcHVkaSIsImV4cCI6MTcwMDQ2Njk3NCwidXNlcklkIjoiYm90cy1zcnYtYWNjb3VudCIsImlhdCI6MTcwMDIwNzc3NH0.TWZyjOoQVBeikFCOlYX7iDZSg6_1SItKfJLvDPO9hTPLAn4ych8ntt7JQPFX6j788mRXWCiV87B70GHOAh9h-GFgFQ228Svo6AH2nT8pIRIDrnfdBGbk3E28vCF12aLGz_tZ3PRLt9hFT6vkYguIu9vMTtlPKU5eMCmfNi8G9crnqgdz5m8Pc2r3sr2-kbGTTBcGCiDRh6NIj6-aKT-WjwCyo5PTfxG478LeF3FB4eeA-33ZLDB9idm2be4weVWPO36G9MKqgZ4Gch8v9zWBUJhS6PU27Sa0DWMgbS_1PoA9h-HUhbOPpgFwcnWQ6sdCONz3eVOrj48Yh7iu8dKMng", "end_point" : "http://dev-dha.humana.com:8889/fireshots/credentialsFetchWebService", "where_condition": "37234", "job_schedule_id": 1624, "job_type_id": "1", "job_scheduled_user_id": "Manaswini Chinthalapudi", "is_relative_file_path": false, "source_schema_name": "acuity-develop", "source_database_name": "development-db", "source_database_name_uppercase": "DEVELOPMENT-DB", "source_database_name_lowercase": "development-db", "source_schema_name_lowercase": "acuity-develop", "source_schema_name_uppercase": "ACUITY-DEVELOP", "relative_file_path": "", "ingestion_table_format": "", "suffix": "", "new_table_for_rename": "", "modified_columns": [ ], "virtual_column": [ ], "reorder_columns": [ ], "last_run_timestamp": "0001-01-01 00:00:00.103" }, "variables": , "pipelineInfoMap": { "pipeline_id" : 271, "pipeline_name" : "ss_compass_adb_validation_MIC7018", "pipeline_lastrun_ts" : "0001-01-01 00:00:00.103", "pipeline_run_id" : 17002077600028566, "source_schema_name" : "acuity-develop", "source_database_name": "development-db", "source_schema_name_lowercase" : "acuity-develop", "source_database_name_lowercase": "development-db", "source_schema_name_uppercase" : "ACUITY-DEVELOP", "source_database_name_uppercase": "DEVELOPMENT-DB", "pipeline_start_ts" : "2023-11-17 07:56:03.202287", "pipeline_start_year" : "", "pipeline_start_month" : "", "pipeline_start_day" : "", "pipeline_start_date" : "", "pipeline_start_time" : "", "pipeline_start_hour" : "", "pipeline_start_minute" : "", "pipeline_start_second" : "", "source_object_name": "aaaa", "source_object_name_lowercase":"aaaa", "source_object_name_uppercase":"AAAA", "file_name_with_extension" : "", "file_name_with_extension_uppercase" : "", "file_name_with_extension_lowercase" : "", "parent_folder_structure" : "", "parent_folder_structure_uppercase" : "", "parent_folder_structure_lowercase" : "" }, }, "output_message_templates": [ { "template_group": "templates/artifact_ingestion/ingestion_flow.stg", "template_name": "get_metadata_and_generate_almaren", "useIncomingData":true }, { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "task_status_success_msg", "useIncomingData":true } ], "error_message_templates": [ { "template_group": "templates/artifact_ingestion/common_templates.stg", "template_name": "error_template_create_msg" } ] } ] }
""2023-11-17 07:56:15.771 [Thread-1084] WARN  com.modak.utils.MapUtils - provided input map is null
""2023-11-17 07:56:15.772 [Thread-1084] ERROR com.modak.bots.basebot.AbstractBaseBot - org.json.JSONException: Missing value at 3720 [character 3721 line 1]
	at org.json.JSONTokener.syntaxError(JSONTokener.java:521)
	at org.json.JSONTokener.nextValue(JSONTokener.java:471)
	at org.json.JSONObject.<init>(JSONObject.java:262)
	at org.json.JSONTokener.nextValue(JSONTokener.java:438)
	at org.json.JSONObject.<init>(JSONObject.java:262)
	at org.json.JSONTokener.nextValue(JSONTokener.java:438)
	at org.json.JSONArray.<init>(JSONArray.java:125)
	at org.json.JSONTokener.nextValue(JSONTokener.java:445)
	at org.json.JSONObject.<init>(JSONObject.java:262)
	at org.json.JSONObject.<init>(JSONObject.java:421)
	at com.modak.utils.JSONUtils.jsonToMap(JSONUtils.java:66)
	at com.modak.bots.basebot.AbstractBaseBot.processMessage(AbstractBaseBot.java:459)
	at com.modak.bots.basebot.AbstractPullBot.lambda$startBot$0(AbstractPullBot.java:56)
	at java.lang.Thread.run(Thread.java:750)

""2023-11-17 07:56:15.772 [Thread-1084] INFO  com.modak.bots.basebot.AbstractBaseBot - DBOpsBot finished processing message with id 62554341-9099-484b-a9a9-5276ea65885f
"