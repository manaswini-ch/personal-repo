select * from nabu.dataplace_table_metadata_physical dtmp 
inner join nabu.dataplace_physical dp on dtmp.dataplace_id = dp.dataplace_id 
where dp.dataplace_sub_component_id =2 and table_type = 'V' and table_size is not null

 

 

select * from nabu.dataplace_table_metadata_physical dtmp 
inner join nabu.dataplace_physical dp on dtmp.dataplace_id = dp.dataplace_id 
where dp.dataplace_sub_component_id =2 and table_type = 'M' and table_size is not null



	val query="select * from nabu.dba  ".split(" ")
	val schema_nam=query(query.length-1).split(".")
	val schema_name="nabu.da".split("""\.""")
	print(schema_name(0), schema_name(1))
	
	
	var query="select from   nabu.dba  from where ca_id= n.a".split(" ").map(_.trim)
	query=query.filter(_ !="")
	query.foreach(println) 
	
	
	var index= query.indexOf("from")
	val schema_name=query(index+1).split("""\.""")

SELECT 
    t.name AS [Table], 
    c.name AS [Partitioning Column],
    TYPE_NAME(c.user_type_id) AS [Column Type],
    ps.name AS [Partition Scheme] 
FROM sys.tables AS t   
JOIN sys.indexes AS i   
    ON t.[object_id] = i.[object_id]   
    AND i.[type] <= 1
JOIN sys.partition_schemes AS ps   
    ON ps.data_space_id = i.data_space_id   
JOIN sys.index_columns AS ic   
    ON ic.[object_id] = i.[object_id]   
    AND ic.index_id = i.index_id   
    AND ic.partition_ordinal >= 1 
JOIN sys.columns AS c   
    ON t.[object_id] = c.[object_id]   
    AND ic.column_id = c.column_id   
WHERE t.name = 'Movies';

select count(*)
from sys.partitions
where object_id = object_id(@YourTableNameHere)

SELECT * FROM Cats
WHERE $PARTITION.CatsPartitionFunction(CatId) = 1;

select f.name as NameHere,f.type_desc as TypeHere
,(case when f.boundary_value_on_right=0 then 'LEFT' else 'Right' end) as LeftORRightHere
,v.value,v.boundary_id,t.name from sys.partition_functions f
inner join  sys.partition_range_values v
on f.function_id = v.function_id
inner join sys.partition_parameters p
on f.function_id = p.function_id
inner join sys.types t
on t.system_type_id = p.system_type_id
